/*! For license information please see 2.d4aa7607.chunk.js.LICENSE.txt */
(this.webpackJsonpportfolio=this.webpackJsonpportfolio||[]).push([[2],[function(e,t,n){e.exports=n(33)},function(e,t,n){"use strict";e.exports=n(26)},function(e,t,n){"use strict";function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}n.d(t,"a",(function(){return o}))},function(e,t,n){"use strict";function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t,n){return t&&r(e.prototype,t),n&&r(e,n),e}n.d(t,"a",(function(){return i}))},function(e,t,n){"use strict";n.d(t,"a",(function(){return o}));var r=n(10);var i=n(8);function o(e){return function(e){if(Array.isArray(e))return Object(r.a)(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||Object(i.a)(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(8);function i(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(e,t)||Object(r.a)(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}},function(e,t,n){"use strict";!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE){0;try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}}(),e.exports=n(27)},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(10);function i(e,t){if(e){if("string"===typeof e)return Object(r.a)(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(n):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Object(r.a)(e,t):void 0}}},function(e,t,n){"use strict";n.d(t,"a",(function(){return f})),n.d(t,"b",(function(){return p}));var r=n(5),i=n(0),o=n.n(i),a=n(6),s=n(1),u=n.n(s),c=n(12);function l(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}var d=Object(s.createContext)(null),f=Object(s.memo)((function(e){var t=e.children,n=e.fallback,r=void 0===n?null:n,i=e.settings,c=function(e){var t=Object(s.useState)(null),n=Object(a.a)(t,2),r=n[0],i=n[1];return Object(s.useEffect)((function(){l(void 0,void 0,void 0,o.a.mark((function t(){var n,r,a,s,u,c,l,d,f,p,h,g,v,y,m,b;return o.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!e.web||!e.webPlatform){t.next=3;break}throw new Error("Cannot initialize, because the settings are over-specified: defined are both web and webPlatform. Please set one or the other");case 3:if("undefined"===typeof window.glue42gd){t.next=12;break}return h=(null===(n=e.desktop)||void 0===n?void 0:n.factory)||(null===(r=e.web)||void 0===r?void 0:r.factory)||(null===(a=e.webPlatform)||void 0===a?void 0:a.factory)||window.Glue,g=(null===(s=e.desktop)||void 0===s?void 0:s.config)||(null===(u=e.web)||void 0===u?void 0:u.config)||(null===(c=e.webPlatform)||void 0===c?void 0:c.config),t.next=9,h(g);case 9:return v=t.sent,i(v.glue||v),t.abrupt("return");case 12:return y=(null===(l=e.web)||void 0===l?void 0:l.config)||(null===(d=e.webPlatform)||void 0===d?void 0:d.config),m=(null===(f=e.web)||void 0===f?void 0:f.factory)||(null===(p=e.webPlatform)||void 0===p?void 0:p.factory)||window.GlueWeb||window.GlueWebPlatform,t.next=16,m(y);case 16:b=t.sent,i(b.glue||b),t.next=23;break;case 20:t.prev=20,t.t0=t.catch(0),console.error(t.t0);case 23:case"end":return t.stop()}}),t,null,[[0,20]])})))}),[]),r}(void 0===i?{}:i);return c?u.a.createElement(d.Provider,{value:c},t):u.a.createElement(u.a.Fragment,null,r)}));f.propTypes={children:c.node,settings:c.object,fallback:c.node},f.displayName="GlueProvider";var p=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[],n=Object(s.useState)(),i=Object(a.a)(n,2),u=i[0],c=i[1],f=Object(s.useContext)(d);return Object(s.useEffect)((function(){f&&l(void 0,void 0,void 0,o.a.mark((function n(){var i;return o.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.apply(void 0,[f].concat(Object(r.a)(t)));case 3:"undefined"!==typeof(i=n.sent)&&c("function"===typeof i?function(){return i}:i),n.next=10;break;case 7:n.prev=7,n.t0=n.catch(0),console.error(n.t0);case 10:case"end":return n.stop()}}),n,null,[[0,7]])})))}),[f].concat(Object(r.a)(t))),u}},function(e,t,n){"use strict";function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}n.d(t,"a",(function(){return r}))},function(e,t,n){"use strict";function r(e,t,n,r,i,o,a){try{var s=e[o](a),u=s.value}catch(c){return void n(c)}s.done?t(u):Promise.resolve(u).then(r,i)}function i(e){return function(){var t=this,n=arguments;return new Promise((function(i,o){var a=e.apply(t,n);function s(e){r(a,i,o,s,u,"next",e)}function u(e){r(a,i,o,s,u,"throw",e)}s(void 0)}))}}n.d(t,"a",(function(){return i}))},function(e,t,n){e.exports=n(53)()},function(e,t){var n;n=function(){return this}();try{n=n||new Function("return this")()}catch(r){"object"===typeof window&&(n=window)}e.exports=n},function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var r=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},i=function(){function e(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,n,r){return n&&e(t.prototype,n),r&&e(t,r),t}}(),o=n(1),a=u(o),s=u(n(12));function u(e){return e&&e.__esModule?e:{default:e}}var c={position:"absolute",top:0,left:0,visibility:"hidden",height:0,overflow:"scroll",whiteSpace:"pre"},l=["extraWidth","injectStyles","inputClassName","inputRef","inputStyle","minWidth","onAutosize","placeholderIsMinWidth"],d=function(e,t){t.style.fontSize=e.fontSize,t.style.fontFamily=e.fontFamily,t.style.fontWeight=e.fontWeight,t.style.fontStyle=e.fontStyle,t.style.letterSpacing=e.letterSpacing,t.style.textTransform=e.textTransform},f=!("undefined"===typeof window||!window.navigator)&&/MSIE |Trident\/|Edge\//.test(window.navigator.userAgent),p=function(){return f?"_"+Math.random().toString(36).substr(2,12):void 0},h=function(e){function t(e){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!==typeof t&&"function"!==typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e));return n.inputRef=function(e){n.input=e,"function"===typeof n.props.inputRef&&n.props.inputRef(e)},n.placeHolderSizerRef=function(e){n.placeHolderSizer=e},n.sizerRef=function(e){n.sizer=e},n.state={inputWidth:e.minWidth,inputId:e.id||p(),prevId:e.id},n}return function(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,e),i(t,null,[{key:"getDerivedStateFromProps",value:function(e,t){var n=e.id;return n!==t.prevId?{inputId:n||p(),prevId:n}:null}}]),i(t,[{key:"componentDidMount",value:function(){this.mounted=!0,this.copyInputStyles(),this.updateInputWidth()}},{key:"componentDidUpdate",value:function(e,t){t.inputWidth!==this.state.inputWidth&&"function"===typeof this.props.onAutosize&&this.props.onAutosize(this.state.inputWidth),this.updateInputWidth()}},{key:"componentWillUnmount",value:function(){this.mounted=!1}},{key:"copyInputStyles",value:function(){if(this.mounted&&window.getComputedStyle){var e=this.input&&window.getComputedStyle(this.input);e&&(d(e,this.sizer),this.placeHolderSizer&&d(e,this.placeHolderSizer))}}},{key:"updateInputWidth",value:function(){if(this.mounted&&this.sizer&&"undefined"!==typeof this.sizer.scrollWidth){var e=void 0;e=this.props.placeholder&&(!this.props.value||this.props.value&&this.props.placeholderIsMinWidth)?Math.max(this.sizer.scrollWidth,this.placeHolderSizer.scrollWidth)+2:this.sizer.scrollWidth+2,(e+="number"===this.props.type&&void 0===this.props.extraWidth?16:parseInt(this.props.extraWidth)||0)<this.props.minWidth&&(e=this.props.minWidth),e!==this.state.inputWidth&&this.setState({inputWidth:e})}}},{key:"getInput",value:function(){return this.input}},{key:"focus",value:function(){this.input.focus()}},{key:"blur",value:function(){this.input.blur()}},{key:"select",value:function(){this.input.select()}},{key:"renderStyles",value:function(){var e=this.props.injectStyles;return f&&e?a.default.createElement("style",{dangerouslySetInnerHTML:{__html:"input#"+this.state.inputId+"::-ms-clear {display: none;}"}}):null}},{key:"render",value:function(){var e=[this.props.defaultValue,this.props.value,""].reduce((function(e,t){return null!==e&&void 0!==e?e:t})),t=r({},this.props.style);t.display||(t.display="inline-block");var n=r({boxSizing:"content-box",width:this.state.inputWidth+"px"},this.props.inputStyle),i=function(e,t){var n={};for(var r in e)t.indexOf(r)>=0||Object.prototype.hasOwnProperty.call(e,r)&&(n[r]=e[r]);return n}(this.props,[]);return function(e){l.forEach((function(t){return delete e[t]}))}(i),i.className=this.props.inputClassName,i.id=this.state.inputId,i.style=n,a.default.createElement("div",{className:this.props.className,style:t},this.renderStyles(),a.default.createElement("input",r({},i,{ref:this.inputRef})),a.default.createElement("div",{ref:this.sizerRef,style:c},e),this.props.placeholder?a.default.createElement("div",{ref:this.placeHolderSizerRef,style:c},this.props.placeholder):null)}}]),t}(o.Component);h.propTypes={className:s.default.string,defaultValue:s.default.any,extraWidth:s.default.oneOfType([s.default.number,s.default.string]),id:s.default.string,injectStyles:s.default.bool,inputClassName:s.default.string,inputRef:s.default.func,inputStyle:s.default.object,minWidth:s.default.oneOfType([s.default.number,s.default.string]),onAutosize:s.default.func,onChange:s.default.func,placeholder:s.default.string,placeholderIsMinWidth:s.default.bool,style:s.default.object,value:s.default.any},h.defaultProps={minWidth:1,injectStyles:!0},t.default=h},function(e,t,n){"use strict";(function(e,r,i){var o=n(22),a=n(6),s=n(5),u=n(0),c=n.n(u),l=n(3),d=n(4);function f(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){var t;e.done?i(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(a,s)}u((r=r.apply(e,t||[])).next())}))}var p={logger:"trace",gateway:{webPlatform:{}},libraries:[]},h=function(e){var t,n=Object.assign({},p,e);return n.systemLogger&&(n.logger=null!==(t=n.systemLogger.level)&&void 0!==t?t:"trace"),n},g=function(){var e=window.glue42core;if(e){if(e.webStarted)throw new Error("The Glue42 Core Web has already been started for this application.");e.webStarted=!0}else window.glue42core={webStarted:!0}},v=function(e){var t,n,r={windows:!0,layouts:"full",appManager:"full",channels:!0,libraries:e.libraries,logger:null!==(n=null===(t=null===e||void 0===e?void 0:e.systemLogger)||void 0===t?void 0:t.level)&&void 0!==n?n:"warn"};return window.Glue(r)},y=function(e){return{ok:!0,result:e}},m=function(e){return{ok:!1,error:e}},b=function(e){return!0===e.ok?Promise.resolve(e.result):Promise.reject(e.error)},w=function(e,t){return!0===t.ok?t.result:e},_=function(e){if(!0===e.ok)return e.result;throw e.error},k=function(e,t){return!0===t.ok?y(e(t.result)):t},x=function(e,t,n){return!1===t.ok?t:!1===n.ok?n:y(e(t.result,n.result))},S=function(e,t){return!0===t.ok?t:m(e(t.error))},I=function(e,t){return!0===t.ok?e(t.result):t},C=(Object.freeze({ok:y,isOk:function(e){return!0===e.ok},err:m,isErr:function(e){return!1===e.ok},asPromise:b,withDefault:w,withException:_,successes:function(e){return e.reduce((function(e,t){return!0===t.ok?e.concat(t.result):e}),[])},map:k,map2:x,mapError:S,andThen:I}),function(){return(C=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)});var T=function(e){return Array.isArray(e)},P=function(e){return"object"===typeof e&&null!==e&&!T(e)},A=function(e,t){return"expected "+e+", got "+function(e){switch(typeof e){case"string":return"a string";case"number":return"a number";case"boolean":return"a boolean";case"undefined":return"undefined";case"object":return e instanceof Array?"an array":null===e?"null":"an object";default:return JSON.stringify(e)}}(t)},E=function(e){return e.map((function(e){return"string"===typeof e?"."+e:"["+e+"]"})).join("")},O=function(e,t){var n=t.at,r=function(e,t){var n={};for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&t.indexOf(r)<0&&(n[r]=e[r]);if(null!=e&&"function"===typeof Object.getOwnPropertySymbols){var i=0;for(r=Object.getOwnPropertySymbols(e);i<r.length;i++)t.indexOf(r[i])<0&&Object.prototype.propertyIsEnumerable.call(e,r[i])&&(n[r[i]]=e[r[i]])}return n}(t,["at"]);return C({at:e+(n||"")},r)},M=function(){function e(t){var n=this;this.decode=t,this.run=function(e){return S((function(t){return{kind:"DecoderError",input:e,at:"input"+(t.at||""),message:t.message||""}}),n.decode(e))},this.runPromise=function(e){return b(n.run(e))},this.runWithException=function(e){return _(n.run(e))},this.map=function(t){return new e((function(e){return k(t,n.decode(e))}))},this.andThen=function(t){return new e((function(e){return I((function(n){return t(n).decode(e)}),n.decode(e))}))},this.where=function(t,r){return n.andThen((function(n){return t(n)?e.succeed(n):e.fail(r)}))}}return e.string=function(){return new e((function(e){return"string"===typeof e?y(e):m({message:A("a string",e)})}))},e.number=function(){return new e((function(e){return"number"===typeof e?y(e):m({message:A("a number",e)})}))},e.boolean=function(){return new e((function(e){return"boolean"===typeof e?y(e):m({message:A("a boolean",e)})}))},e.constant=function(t){return new e((function(e){return function e(t,n){if(t===n)return!0;if(null===t&&null===n)return!0;if(typeof t!==typeof n)return!1;if("object"===typeof t){if(Array.isArray(t)){if(!Array.isArray(n))return!1;if(t.length!==n.length)return!1;for(var r=0;r<t.length;r++)if(!e(t[r],n[r]))return!1;return!0}var i=Object.keys(t);if(i.length!==Object.keys(n).length)return!1;for(r=0;r<i.length;r++){if(!n.hasOwnProperty(i[r]))return!1;if(!e(t[i[r]],n[i[r]]))return!1}return!0}}(e,t)?y(t):m({message:"expected "+JSON.stringify(t)+", got "+JSON.stringify(e)})}))},e.object=function(t){return new e((function(e){if(P(e)&&t){var n={};for(var r in t)if(t.hasOwnProperty(r)){var i=t[r].decode(e[r]);if(!0!==i.ok)return void 0===e[r]?m({message:"the key '"+r+"' is required but was not present"}):m(O("."+r,i.error));void 0!==i.result&&(n[r]=i.result)}return y(n)}return P(e)?y(e):m({message:A("an object",e)})}))},e.array=function(t){return new e((function(e){if(T(e)&&t){return e.reduce((function(e,n,r){return x((function(e,t){return e.concat([t])}),e,function(e,n){return S((function(e){return O("["+n+"]",e)}),t.decode(e))}(n,r))}),y([]))}return T(e)?y(e):m({message:A("an array",e)})}))},e.tuple=function(t){return new e((function(e){if(T(e)){if(e.length!==t.length)return m({message:"expected a tuple of length "+t.length+", got one of length "+e.length});for(var n=[],r=0;r<t.length;r++){var i=t[r].decode(e[r]);if(!i.ok)return m(O("["+r+"]",i.error));n[r]=i.result}return y(n)}return m({message:A("a tuple of length "+t.length,e)})}))},e.union=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return e.oneOf.apply(e,[t,n].concat(r))},e.intersection=function(t,n){for(var r=[],i=2;i<arguments.length;i++)r[i-2]=arguments[i];return new e((function(e){return[t,n].concat(r).reduce((function(t,n){return x(Object.assign,t,n.decode(e))}),y({}))}))},e.anyJson=function(){return new e((function(e){return y(e)}))},e.unknownJson=function(){return new e((function(e){return y(e)}))},e.dict=function(t){return new e((function(e){if(P(e)){var n={};for(var r in e)if(e.hasOwnProperty(r)){var i=t.decode(e[r]);if(!0!==i.ok)return m(O("."+r,i.error));n[r]=i.result}return y(n)}return m({message:A("an object",e)})}))},e.optional=function(t){return new e((function(e){return void 0===e||null===e?y(void 0):t.decode(e)}))},e.oneOf=function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];return new e((function(e){for(var n=[],r=0;r<t.length;r++){var i=t[r].decode(e);if(!0===i.ok)return i;n[r]=i.error}var o=n.map((function(e){return"at error"+(e.at||"")+": "+e.message})).join('", "');return m({message:'expected a value matching one of the decoders, got the errors ["'+o+'"]'})}))},e.withDefault=function(t,n){return new e((function(e){return y(w(t,n.decode(e)))}))},e.valueAt=function(t,n){return new e((function(e){for(var r=e,i=0;i<t.length;i++){if(void 0===r)return m({at:E(t.slice(0,i+1)),message:"path does not exist"});if("string"===typeof t[i]&&!P(r))return m({at:E(t.slice(0,i+1)),message:A("an object",r)});if("number"===typeof t[i]&&!T(r))return m({at:E(t.slice(0,i+1)),message:A("an array",r)});r=r[t[i]]}return S((function(e){return void 0===r?{at:E(t),message:"path does not exist"}:O(E(t),e)}),n.decode(r))}))},e.succeed=function(t){return new e((function(e){return y(t)}))},e.fail=function(t){return new e((function(e){return m({message:t})}))},e.lazy=function(t){return new e((function(e){return t().decode(e)}))},e}(),j=M.string,R=M.number,N=M.boolean,L=M.anyJson,D=M.constant,W=M.object,F=M.array,U=M.optional,B=M.oneOf,V=M.lazy,H=j().where((function(e){return e.length>0}),"Expected a non-empty string"),z=R().where((function(e){return e>=0}),"Expected a non-negative number"),q=B(D("windows"),D("appManager"),D("layouts"),D("intents")),G=B(D("openWindow"),D("windowHello"),D("windowAdded"),D("windowRemoved"),D("getBounds"),D("getUrl"),D("moveResize"),D("focus"),D("close"),D("getTitle"),D("setTitle")),J=B(D("appHello"),D("applicationAdded"),D("applicationRemoved"),D("applicationChanged"),D("instanceStarted"),D("instanceStopped"),D("applicationStart"),D("instanceStop"),D("clear")),K=B(D("layoutAdded"),D("layoutChanged"),D("layoutRemoved"),D("get"),D("getAll"),D("export"),D("import"),D("remove")),Y=B(D("top"),D("left"),D("right"),D("bottom")),$=U(W({top:U(R()),left:U(R()),width:U(z),height:U(z),context:U(L()),relativeTo:U(H),relativeDirection:U(Y),windowId:U(H)})),Q=W({name:H,url:H,options:$}),X=W({windowId:U(H)}),Z=W({windowId:H,name:H}),ee=W({windowId:H}),te=W({windows:F(Z),isWorkspaceFrame:N()}),ne=W({windowId:H,title:j()}),re=W({windowId:H,top:U(R()),left:U(R()),width:U(z),height:U(z),relative:U(N())}),ie=W({windowId:H,bounds:W({top:R(),left:R(),width:z,height:z})}),oe=W({windowId:H,url:H}),ae=L(),se=W({top:U(R()),left:U(R()),width:U(z),height:U(z)}),ue=W({id:H,applicationName:H}),ce=W({url:H,top:U(R()),left:U(R()),width:U(z),height:U(z)}),le=W({name:H,displayName:U(j()),contexts:U(F(j())),customConfig:U(W())}),de=W({name:H,title:U(H),version:U(H),appId:H,manifest:H,manifestType:H,tooltip:U(H),description:U(H),contactEmail:U(H),supportEmail:U(H),publisher:U(H),images:U(F(W({url:U(H)}))),icons:U(F(W({icon:U(H)}))),customConfig:L(),intents:U(F(le))}),fe=W({name:H,type:H.where((function(e){return"window"===e}),"Expected a value of window"),title:U(H),version:U(H),customProperties:U(L()),icon:U(H),caption:U(H),details:ce,intents:U(F(le))}),pe=B(fe,de),he=(W({definitions:F(pe),mode:B(D("replace"),D("merge"))}),W({name:H})),ge=W({definitions:F(fe)}),ve=W({name:H,type:H.where((function(e){return"window"===e}),"Expected a value of window"),instances:F(ue),userProperties:U(L()),title:U(H),version:U(H),icon:U(H),caption:U(H)}),ye=W({name:H,type:H.where((function(e){return"window"===e}),"Expected a value of window"),userProperties:L(),title:U(H),version:U(H),icon:U(H),caption:U(H)}),me=W({apps:F(ve)}),be=W({id:H}),we=W({name:H,waitForAGMReady:N(),context:U(L()),top:U(R()),left:U(R()),width:U(z),height:U(z),relativeTo:U(H),relativeDirection:U(B(D("top"),D("left"),D("right"),D("bottom")))}),_e=B(D("Global"),D("Activity"),D("ApplicationDefault"),D("Swimlane"),D("Workspace")),ke=B(D("application"),D("activity")),xe=W({type:H.where((function(e){return"window"===e}),"Expected a value of window"),componentType:U(ke),state:W({name:L(),context:L(),url:H,bounds:L(),id:H,parentId:U(H),main:N()})}),Se=W({type:D("window"),config:W({appName:H,url:U(H)})}),Ie=W({type:D("group"),config:L(),children:F(B(Se))}),Ce=W({type:D("column"),config:L(),children:F(B(Ie,Se,V((function(){return Ce})),V((function(){return Te}))))}),Te=W({type:D("row"),config:L(),children:F(B(Ce,Ie,Se,V((function(){return Te}))))}),Pe=W({type:D("Workspace"),state:W({config:L(),context:L(),children:F(B(Te,Ce,Ie,Se))})}),Ae=W({name:H,type:_e,components:F(B(xe,Pe)),version:U(H),context:U(L()),metadata:U(L())}),Ee=W({name:H,context:U(L()),metadata:U(L())}),Oe=W({name:H,context:U(L()),closeRunningInstance:U(N())}),Me=W({name:H,type:_e,context:U(L()),metadata:U(L())}),je=W({name:H,type:_e}),Re=W({type:_e}),Ne=W({layouts:F(Ae)}),Le=B(D("replace"),D("merge")),De=W({layouts:F(Ae),mode:Le}),We=W({summaries:F(Me)}),Fe=(W({layout:Ae}),W({layout:U(Ae)})),Ue=B(D("findIntent"),D("getIntents"),D("raiseIntent")),Be=W({applicationName:H,applicationTitle:j(),applicationDescription:U(j()),applicationIcon:U(j()),type:B(D("app"),D("instance")),displayName:U(j()),contextTypes:U(F(H)),instanceId:U(j()),instanceTitle:U(j())}),Ve=W({name:H,handlers:F(Be)}),He=B(D("startNew"),D("reuse"),W({app:U(H),instance:U(H)})),ze=W({type:U(H),data:U(W())}),qe=W({intents:F(Ve)}),Ge=W({name:U(H),contextType:U(H)}),Je=B(H,Ge),Ke=W({filter:U(Ge)}),Ye=W({intent:H,target:U(He),context:U(ze),options:U($)}),$e=B(H,Ye),Qe=W({request:Ye,handler:Be,result:L()}),Xe=W({intent:H,contextTypes:U(F(H)),displayName:U(j()),icon:U(j()),description:U(j())}),Ze=B(H,Xe),et=function(e){return H.where((function(t){return e.includes(t)}),"Expected a valid channel name")},tt={openWindow:{name:"openWindow",dataDecoder:Q,resultDecoder:Z},windowHello:{name:"windowHello",dataDecoder:X,resultDecoder:te},windowAdded:{name:"windowAdded",dataDecoder:Z},windowRemoved:{name:"windowRemoved",dataDecoder:ee},getBounds:{name:"getBounds",dataDecoder:ee,resultDecoder:ie},getUrl:{name:"getUrl",dataDecoder:ee,resultDecoder:oe},moveResize:{name:"moveResize",dataDecoder:re},focus:{name:"focus",dataDecoder:ee},close:{name:"close",dataDecoder:ee},getTitle:{name:"getTitle",dataDecoder:ee,resultDecoder:ne},setTitle:{name:"setTitle",dataDecoder:ne}};function nt(e){if(e&&e.errorHandling&&"function"!==typeof e.errorHandling&&"log"!==e.errorHandling&&"silent"!==e.errorHandling&&"throw"!==e.errorHandling)throw new Error('Invalid options passed to createRegistry. Prop errorHandling should be ["log" | "silent" | "throw" | (err) => void], but '+typeof e.errorHandling+" was passed");var t=e&&"function"===typeof e.errorHandling&&e.errorHandling,n={};function r(n,r){var i=n instanceof Error?n:new Error(n);if(t)t(i);else{var o='[ERROR] callback-registry: User callback for key "'+r+'" failed: '+i.stack;if(e)switch(e.errorHandling){case"log":return console.error(o);case"silent":return;case"throw":throw new Error(o)}console.error(o)}}return{add:function(e,t,i){var o=n[e];return o||(o=[],n[e]=o),o.push(t),i&&setTimeout((function(){i.forEach((function(i){var o;if(null===(o=n[e])||void 0===o?void 0:o.includes(t))try{Array.isArray(i)?t.apply(void 0,i):t.apply(void 0,[i])}catch(m){r(m,e)}}))}),0),function(){var r=n[e];r&&(r=r.reduce((function(e,n,r){return n===t&&e.length===r||e.push(n),e}),[]),n[e]=r)}},execute:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=n[e];if(!o||0===o.length)return[];var a=[];return o.forEach((function(n){try{var i=n.apply(void 0,t);a.push(i)}catch(m){a.push(void 0),r(m,e)}})),a},clear:function(){n={}},clearKey:function(e){n[e]&&delete n[e]}}}nt.default=nt;var rt=nt,it=function(){function e(t,n,r){Object(l.a)(this,e),this._id=t,this._name=n,this._bridge=r,this.registry=rt(),this.myCtxKey="___window___".concat(this.id)}return Object(d.a)(e,[{key:"clean",value:function(){this.ctxUnsubscribe&&this.ctxUnsubscribe()}},{key:"toApi",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t,n=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._bridge.contextLib.subscribe(this.myCtxKey,(function(e){return n.registry.execute("context-updated",e)}));case 2:return this.ctxUnsubscribe=e.sent,t={id:this.id,name:this.name,getURL:this.getURL.bind(this),moveResize:this.moveResize.bind(this),resizeTo:this.resizeTo.bind(this),moveTo:this.moveTo.bind(this),focus:this.focus.bind(this),close:this.close.bind(this),getTitle:this.getTitle.bind(this),setTitle:this.setTitle.bind(this),getBounds:this.getBounds.bind(this),getContext:this.getContext.bind(this),updateContext:this.updateContext.bind(this),setContext:this.setContext.bind(this),onContextUpdated:this.onContextUpdated.bind(this)},this.me=Object.freeze(t),e.abrupt("return",this.me);case 6:case"end":return e.stop()}}),e,this)})))}},{key:"getURL",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._bridge.send("windows",tt.getUrl,{windowId:this.id});case 2:return t=e.sent,e.abrupt("return",t.url);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"moveResize",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=se.runWithException(e),r=Object.assign({},n,{windowId:this.id,relative:!1}),t.next=4,this._bridge.send("windows",tt.moveResize,r);case 4:return t.abrupt("return",this.me);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"resizeTo",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("undefined"!==typeof e||"undefined"!==typeof t){n.next=2;break}return n.abrupt("return",this.me);case 2:return"undefined"!==typeof e&&z.runWithException(e),"undefined"!==typeof t&&z.runWithException(t),r=Object.assign({},{width:e,height:t},{windowId:this.id,relative:!0}),n.next=7,this._bridge.send("windows",tt.moveResize,r);case 7:return n.abrupt("return",this.me);case 8:case"end":return n.stop()}}),n,this)})))}},{key:"moveTo",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if("undefined"!==typeof e||"undefined"!==typeof t){n.next=2;break}return n.abrupt("return",this.me);case 2:return"undefined"!==typeof e&&R().runWithException(e),"undefined"!==typeof t&&R().runWithException(t),r=Object.assign({},{top:e,left:t},{windowId:this.id,relative:!0}),n.next=7,this._bridge.send("windows",tt.moveResize,r);case 7:return n.abrupt("return",this.me);case 8:case"end":return n.stop()}}),n,this)})))}},{key:"focus",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._bridge.send("windows",tt.focus,{windowId:this.id});case 2:return e.abrupt("return",this.me);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"close",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._bridge.send("windows",tt.close,{windowId:this.id});case 2:return e.abrupt("return",this.me);case 3:case"end":return e.stop()}}),e,this)})))}},{key:"getTitle",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._bridge.send("windows",tt.getTitle,{windowId:this.id});case 2:return t=e.sent,e.abrupt("return",t.title);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"setTitle",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=H.runWithException(e),t.next=3,this._bridge.send("windows",tt.setTitle,{windowId:this.id,title:n});case 3:return t.abrupt("return",this.me);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"getBounds",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._bridge.send("windows",tt.getBounds,{windowId:this.id});case 2:return t=e.sent,e.abrupt("return",t.bounds);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getContext",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this._bridge.contextLib.get(this.myCtxKey);case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"updateContext",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=ae.runWithException(e),t.next=3,this._bridge.contextLib.update(this.myCtxKey,n);case 3:return t.abrupt("return",this.me);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"setContext",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=ae.runWithException(e),t.next=3,this._bridge.contextLib.set(this.myCtxKey,n);case 3:return t.abrupt("return",this.me);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"onContextUpdated",value:function(e){var t=this;if("function"!==typeof e)throw new Error("Cannot subscribe to context changes, because the provided callback is not a function!");return this.registry.add("context-updated",(function(n){e(n,t.me)}))}},{key:"id",get:function(){return this._id.slice()}},{key:"name",get:function(){return this._name.slice()}}]),e}(),ot=function(){function e(){Object(l.a)(this,e),this.registry=rt(),this.allWindowProjections=[]}return Object(d.a)(e,[{key:"start",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.logger=e.logger.subLogger("windows.controller.web"),this.logger.trace("starting the web windows controller"),this.publicWindowId=e.connection.transport.publicWindowId,this.actualWindowId=e.interop.instance.windowId,this.addWindowOperationExecutors(),this.ioc=t,this.bridge=t.bridge,this.logger.trace("set the public window id: ".concat(this.publicWindowId," and actual window id: ").concat(this.actualWindowId,", set the bridge operations and ioc, registering with the platform now")),this.platformRegistration=this.registerWithPlatform(),n.next=11,this.platformRegistration;case 11:this.logger.trace("registration with the platform successful, attaching the windows property to glue and returning"),r=this.toApi(),e.windows=r;case 14:case"end":return n.stop()}}),n,this)})))}},{key:"handleBridgeMessage",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.platformRegistration;case 2:if(n=G.runWithException(e.operation),(r=tt[n]).execute){t.next=6;break}return t.abrupt("return");case 6:return i=e.data,r.dataDecoder&&(i=r.dataDecoder.runWithException(e.data)),t.next=10,r.execute(i);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t,this)})))}},{key:"open",value:function(e,t,n){return f(this,void 0,void 0,c.a.mark((function r(){var i,o,a;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return H.runWithException(e),H.runWithException(t),i=$.runWithException(n),r.next=5,this.bridge.send("windows",tt.openWindow,{name:e,url:t,options:i});case 5:return o=r.sent,r.next=8,this.ioc.buildWebWindow(o.windowId,o.name);case 8:return a=r.sent,r.abrupt("return",a.api);case 10:case"end":return r.stop()}}),r,this)})))}},{key:"list",value:function(){return this.allWindowProjections.map((function(e){return e.api}))}},{key:"findById",value:function(e){var t;return H.runWithException(e),null===(t=this.allWindowProjections.find((function(t){return t.id===e})))||void 0===t?void 0:t.api}},{key:"toApi",value:function(){return{open:this.open.bind(this),my:this.my.bind(this),list:this.list.bind(this),findById:this.findById.bind(this),onWindowAdded:this.onWindowAdded.bind(this),onWindowRemoved:this.onWindowRemoved.bind(this)}}},{key:"addWindowOperationExecutors",value:function(){tt.windowAdded.execute=this.handleWindowAdded.bind(this),tt.windowRemoved.execute=this.handleWindowRemoved.bind(this),tt.getBounds.execute=this.handleGetBounds.bind(this),tt.getTitle.execute=this.handleGetTitle.bind(this),tt.getUrl.execute=this.handleGetUrl.bind(this),tt.moveResize.execute=this.handleMoveResize.bind(this),tt.setTitle.execute=this.handleSetTitle.bind(this)}},{key:"my",value:function(){return Object.assign({},this.me)}},{key:"onWindowAdded",value:function(e){if("function"!==typeof e)throw new Error("Cannot subscribe to window added, because the provided callback is not a function!");return this.registry.add("window-added",e)}},{key:"onWindowRemoved",value:function(e){if("function"!==typeof e)throw new Error("Cannot subscribe to window removed, because the provided callback is not a function!");return this.registry.add("window-removed",e)}},{key:"sayHello",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bridge.send("windows",tt.windowHello,{windowId:this.actualWindowId});case 2:return t=e.sent,e.abrupt("return",t);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"registerWithPlatform",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t,n,r,i,o,a,u=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.sayHello();case 2:if(n=e.sent,r=n.windows,i=n.isWorkspaceFrame,this.logger.trace("the platform responded to the hello message"),i){e.next=14;break}if(this.logger.trace("i am not treated as a workspace frame, setting my window"),o=r.find((function(e){return e.windowId===u.publicWindowId}))){e.next=11;break}throw new Error("Cannot initialize the window library, because I received no information about me from the platform");case 11:return e.next=13,this.ioc.buildWebWindow(this.publicWindowId,o.name);case 13:this.me=e.sent.api;case 14:return e.next=16,Promise.all(r.map((function(e){return u.ioc.buildWebWindow(e.windowId,e.name)})));case 16:a=e.sent,this.logger.trace("all windows projections are completed, building the list collection"),(t=this.allWindowProjections).push.apply(t,Object(s.a)(a));case 19:case"end":return e.stop()}}),e,this)})))}},{key:"handleWindowAdded",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.allWindowProjections.some((function(t){return t.id===e.windowId}))){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.ioc.buildWebWindow(e.windowId,e.name);case 4:n=t.sent,this.allWindowProjections.push(n),this.registry.execute("window-added",n.api);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"handleWindowRemoved",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.allWindowProjections.find((function(t){return t.id===e.windowId}))){t.next=3;break}return t.abrupt("return");case 3:this.allWindowProjections=this.allWindowProjections.filter((function(t){return t.id!==e.windowId})),n.model.clean(),this.registry.execute("window-removed",n.api);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"handleGetBounds",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{windowId:this.me.id,bounds:{top:window.screenTop,left:window.screenLeft,width:window.innerWidth,height:window.innerHeight}});case 1:case"end":return e.stop()}}),e,this)})))}},{key:"handleGetTitle",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{windowId:this.me.id,title:document.title});case 1:case"end":return e.stop()}}),e,this)})))}},{key:"handleGetUrl",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",{windowId:this.me.id,url:window.location.href});case 1:case"end":return e.stop()}}),e,this)})))}},{key:"handleMoveResize",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i,o,a,s;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:n="number"===typeof e.top?e.top:e.relative?0:window.screenTop,r="number"===typeof e.left?e.left:e.relative?0:window.screenLeft,i="number"===typeof e.height?e.height:e.relative?0:window.innerHeight,o="number"===typeof e.width?e.width:e.relative?0:window.innerWidth,a=e.relative?window.moveBy:window.moveTo,s=e.relative?window.resizeBy:window.resizeTo,a(r,n),s(o,i);case 8:case"end":return t.stop()}}),t)})))}},{key:"handleSetTitle",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:document.title=e.title;case 1:case"end":return t.stop()}}),t)})))}}]),e}(),at=function(e,t,n){return new Promise((function(r,i){var o=!0,a=setTimeout((function(){if(o){o=!1;var e=n||"Promise timeout hit: ".concat(t);i(e)}}),t);e().then((function(e){o&&(o=!1,clearTimeout(a),r(e))})).catch((function(e){o&&(o=!1,clearTimeout(a),i(e))}))}))},st=function(){function e(t){Object(l.a)(this,e),this.coreGlue=t,this.platformMethodTimeoutMs=1e4}return Object(d.a)(e,[{key:"start",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i,o=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return this.controllers=e,t.next=3,Promise.all([this.checkWaitMethod("T42.Web.Platform.Control"),this.checkWaitMethod("T42.Web.Platform.Stream")]);case 3:return t.next=5,Promise.all([this.coreGlue.interop.subscribe("T42.Web.Platform.Stream"),this.coreGlue.interop.registerAsync("T42.Web.Client.Control",(function(e,t,n,r){return o.passMessageController(e,n,r)}))]);case 5:n=t.sent,r=Object(a.a)(n,1),i=r[0],this.sub=i,this.sub.onData((function(e){return o.passMessageController(e.data)}));case 10:case"end":return t.stop()}}),t,this)})))}},{key:"getInteropInstance",value:function(e){var t=this.coreGlue.interop.servers().find((function(t){return t.windowId&&t.windowId===e}));return{application:null===t||void 0===t?void 0:t.application,applicationName:null===t||void 0===t?void 0:t.applicationName,peerId:null===t||void 0===t?void 0:t.peerId,instance:null===t||void 0===t?void 0:t.instance,windowId:null===t||void 0===t?void 0:t.windowId}}},{key:"send",value:function(e,t,n){return f(this,void 0,void 0,c.a.mark((function r(){var i;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:if(!t.dataDecoder){r.next=8;break}r.prev=1,t.dataDecoder.runWithException(n),r.next=8;break;case 5:throw r.prev=5,r.t0=r.catch(1),new Error("Unexpected internal outgoing validation error: ".concat(r.t0.message,", for operation: ").concat(t.name," and input: ").concat(JSON.stringify(r.t0.input)));case 8:return r.prev=8,r.next=11,this.transmitMessage(e,t,n);case 11:i=r.sent,t.resultDecoder&&(i=t.resultDecoder.runWithException(i)),r.next=20;break;case 15:if(r.prev=15,r.t1=r.catch(8),!r.t1.kind){r.next=19;break}throw new Error("Unexpected internal incoming validation error: ".concat(r.t1.message,", for operation: ").concat(t.name," and input: ").concat(JSON.stringify(r.t1.input)));case 19:throw new Error(r.t1.message);case 20:return r.abrupt("return",i);case 21:case"end":return r.stop()}}),r,this,[[1,5],[8,15]])})))}},{key:"checkWaitMethod",value:function(e){var t,n,r,i=this;return t=function(t){if(i.coreGlue.interop.methods().some((function(t){return t.name===e})))return t();var n=i.coreGlue.interop.methodAdded((function(r){r.name===e&&(n(),t())}))},n=this.platformMethodTimeoutMs,r="Cannot initiate Glue Web, because a system method's discovery timed out: ".concat(e),new Promise((function(e,i){var o=setTimeout((function(){var e=r||"Promise timeout hit: ".concat(n);i(e)}),n);new Promise(t).then((function(t){clearTimeout(o),e(t)})).catch((function(e){clearTimeout(o),i(e)}))}))}},{key:"passMessageController",value:function(e,t,n){var r=q.run(e.domain);if(r.ok){var i=r.result;this.controllers[i].handleBridgeMessage(e).then((function(e){t&&t(e)})).catch((function(e){n&&n(e),console.warn(e)}))}else n&&n("Cannot execute this client control, because of domain validation error: ".concat(JSON.stringify(r.error)))}},{key:"transmitMessage",value:function(e,t,n){return f(this,void 0,void 0,c.a.mark((function r(){var i,o,a,s;return c.a.wrap((function(r){for(;;)switch(r.prev=r.next){case 0:return i={domain:e,data:n,operation:t.name},a="Internal Platform Communication Error. Attempted operation: ".concat(JSON.stringify(t.name)," with data: ").concat(JSON.stringify(n),". "),r.prev=2,r.next=5,this.coreGlue.interop.invoke("T42.Web.Platform.Control",i);case 5:if(o=r.sent){r.next=8;break}throw new Error("Received unsupported result from the platform - empty result");case 8:if(Array.isArray(o.all_return_values)&&0!==o.all_return_values.length){r.next=10;break}throw new Error("Received unsupported result from the platform - empty values collection");case 10:r.next=18;break;case 12:if(r.prev=12,r.t0=r.catch(2),!(r.t0&&r.t0.all_errors&&r.t0.all_errors.length)){r.next=17;break}throw s=r.t0.all_errors[0].message,new Error("".concat(a," -> Inner message: ").concat(s));case 17:throw new Error("".concat(a," -> Inner message: ").concat(r.t0.message));case 18:return r.abrupt("return",o.all_return_values[0].returned);case 19:case"end":return r.stop()}}),r,this,[[2,12]])})))}},{key:"contextLib",get:function(){return this.coreGlue.contexts}},{key:"interopInstance",get:function(){return this.coreGlue.interop.instance.instance}}]),e}(),ut={appHello:{name:"appHello",dataDecoder:X,resultDecoder:me},applicationAdded:{name:"applicationAdded",dataDecoder:ye},applicationRemoved:{name:"applicationRemoved",dataDecoder:ye},applicationChanged:{name:"applicationChanged",dataDecoder:ye},instanceStarted:{name:"instanceStarted",dataDecoder:ue},instanceStopped:{name:"instanceStopped",dataDecoder:ue},applicationStart:{name:"applicationStart",dataDecoder:we,resultDecoder:ue},instanceStop:{name:"instanceStop",dataDecoder:be},import:{name:"import"},remove:{name:"remove",dataDecoder:he},export:{name:"export",resultDecoder:ge},clear:{name:"clear"}},ct=function(){function e(){Object(l.a)(this,e),this.registry=rt(),this.applications=[],this.instances=[]}return Object(d.a)(e,[{key:"start",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return this.logger=e.logger.subLogger("appManger.controller.web"),this.logger.trace("starting the web appManager controller"),this.publicWindowId=e.connection.transport.publicWindowId,this.actualWindowId=e.interop.instance.windowId,this.addOperationsExecutors(),this.ioc=t,this.bridge=t.bridge,this.platformRegistration=this.registerWithPlatform(),n.next=10,this.platformRegistration;case 10:this.logger.trace("registration with the platform successful, attaching the appManager property to glue and returning"),r=this.toApi(),e.appManager=r;case 13:case"end":return n.stop()}}),n,this)})))}},{key:"handleBridgeMessage",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.platformRegistration;case 2:if(n=J.runWithException(e.operation),(r=ut[n]).execute){t.next=6;break}return t.abrupt("return");case 6:return i=e.data,r.dataDecoder&&(i=r.dataDecoder.runWithException(e.data)),t.next=10,r.execute(i);case 10:return t.abrupt("return",t.sent);case 11:case"end":return t.stop()}}),t,this)})))}},{key:"onInstanceStarted",value:function(e){return this.registry.add("instance-started",e,this.instances)}},{key:"onInstanceStopped",value:function(e){return this.registry.add("instance-stopped",e)}},{key:"startApplication",value:function(e,t,n){var r;return f(this,void 0,void 0,c.a.mark((function i(){var o,a,s;return c.a.wrap((function(i){for(;;)switch(i.prev=i.next){case 0:return o={name:e,waitForAGMReady:null===(r=null===n||void 0===n?void 0:n.waitForAGMReady)||void 0===r||r,context:t,top:null===n||void 0===n?void 0:n.top,left:null===n||void 0===n?void 0:n.left,width:null===n||void 0===n?void 0:n.width,height:null===n||void 0===n?void 0:n.height,relativeTo:null===n||void 0===n?void 0:n.relativeTo,relativeDirection:null===n||void 0===n?void 0:n.relativeDirection},i.next=3,this.bridge.send("appManager",ut.applicationStart,o);case 3:return a=i.sent,s=this.applications.find((function(e){return e.name===a.applicationName})),i.abrupt("return",this.ioc.buildInstance(a,s));case 6:case"end":return i.stop()}}),i,this)})))}},{key:"toApi",value:function(){var e={myInstance:this.me,inMemory:{import:this.import.bind(this),remove:this.remove.bind(this),export:this.export.bind(this),clear:this.clear.bind(this)},application:this.getApplication.bind(this),applications:this.getApplications.bind(this),instances:this.getInstances.bind(this),onAppAdded:this.onAppAdded.bind(this),onAppChanged:this.onAppChanged.bind(this),onAppRemoved:this.onAppRemoved.bind(this),onInstanceStarted:this.onInstanceStarted.bind(this),onInstanceStopped:this.onInstanceStopped.bind(this)};return Object.freeze(e)}},{key:"addOperationsExecutors",value:function(){ut.applicationAdded.execute=this.handleApplicationAddedMessage.bind(this),ut.applicationRemoved.execute=this.handleApplicationRemovedMessage.bind(this),ut.applicationChanged.execute=this.handleApplicationChangedMessage.bind(this),ut.instanceStarted.execute=this.handleInstanceStartedMessage.bind(this),ut.instanceStopped.execute=this.handleInstanceStoppedMessage.bind(this)}},{key:"onAppAdded",value:function(e){return this.registry.add("application-added",e,this.applications)}},{key:"onAppRemoved",value:function(e){return this.registry.add("application-removed",e)}},{key:"onAppChanged",value:function(e){return this.registry.add("application-changed",e)}},{key:"handleApplicationAddedMessage",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.applications.some((function(t){return t.name===e.name}))){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.ioc.buildApplication(e,[]);case 4:r=t.sent,i=this.instances.filter((function(e){return e.application.name===r.name})),(n=r.instances).push.apply(n,Object(s.a)(i)),this.applications.push(r),this.registry.execute("application-added",r);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"handleApplicationRemovedMessage",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!((n=this.applications.findIndex((function(t){return t.name===e.name})))<0)){t.next=3;break}return t.abrupt("return");case 3:r=this.applications[n],this.applications.splice(n,1),this.registry.execute("application-removed",r);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"handleApplicationChangedMessage",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=this.applications.find((function(t){return t.name===e.name}))){t.next=3;break}return t.abrupt("return",this.handleApplicationAddedMessage(e));case 3:n.title=e.title,n.version=e.version,n.icon=e.icon,n.caption=e.caption,n.userProperties=e.userProperties,this.registry.execute("application-changed",n);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"handleInstanceStartedMessage",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.instances.some((function(t){return t.id===e.id}))){t.next=2;break}return t.abrupt("return");case 2:if(n=this.applications.find((function(t){return t.name===e.applicationName}))){t.next=5;break}throw new Error("Cannot add instance: ".concat(e.id,", because there is no application definition associated with it"));case 5:r=this.ioc.buildInstance(e,n),this.instances.push(r),n.instances.push(r),this.registry.execute("instance-started",r);case 9:case"end":return t.stop()}}),t,this)})))}},{key:"handleInstanceStoppedMessage",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if((n=this.instances.find((function(t){return t.id===e.id})))&&(r=this.instances.findIndex((function(t){return t.id===e.id})),this.instances.splice(r,1)),(i=this.applications.find((function(t){return t.instances.some((function(t){return t.id===e.id}))})))&&(o=i.instances.findIndex((function(t){return t.id===e.id})),i.instances.splice(o,1)),n){t.next=6;break}return t.abrupt("return");case 6:this.registry.execute("instance-stopped",n);case 7:case"end":return t.stop()}}),t,this)})))}},{key:"import",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"replace";return f(this,void 0,void 0,c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Le.runWithException(t),Array.isArray(e)){n.next=3;break}throw new Error("Import must be called with an array of definitions");case 3:return r=e.reduce((function(e,t){var n=pe.run(t);return n.ok?e.valid.push(t):e.invalid.push({app:null===t||void 0===t?void 0:t.name,error:JSON.stringify(n.error)}),e}),{valid:[],invalid:[]}),n.next=6,this.bridge.send("appManager",ut.import,{definitions:r.valid,mode:t});case 6:return n.abrupt("return",{imported:r.valid.map((function(e){return e.name})),errors:r.invalid});case 7:case"end":return n.stop()}}),n,this)})))}},{key:"remove",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return H.runWithException(e),t.next=3,this.bridge.send("appManager",ut.remove,{name:e});case 3:case"end":return t.stop()}}),t,this)})))}},{key:"clear",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bridge.send("appManager",ut.clear,void 0);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"export",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bridge.send("appManager",ut.export,void 0);case 2:return t=e.sent,e.abrupt("return",t.definitions);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"getApplication",value:function(e){var t=H.runWithException(e);return this.applications.find((function(e){return e.name===t}))}},{key:"getApplications",value:function(){return this.applications.slice()}},{key:"getInstances",value:function(){return this.instances.slice()}},{key:"registerWithPlatform",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t,n=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bridge.send("appManager",ut.appHello,{windowId:this.actualWindowId});case 2:return t=e.sent,this.logger.trace("the platform responded to the hello message with a full list of apps"),e.next=6,Promise.all(t.apps.map((function(e){return n.ioc.buildApplication(e,e.instances)})));case 6:this.applications=e.sent,this.instances=this.applications.reduce((function(e,t){return e.push.apply(e,Object(s.a)(t.instances)),e}),[]),this.me=this.findMyInstance(),this.logger.trace("all applications were parsed and saved. I am ".concat(this.me?"NOT a":"a"," valid instance"));case 10:case"end":return e.stop()}}),e,this)})))}},{key:"findMyInstance",value:function(){var e,t=this,n=Object(o.a)(this.applications);try{for(n.s();!(e=n.n()).done;){var r=e.value.instances.find((function(e){return e.id===t.publicWindowId}));if(r)return r}}catch(m){n.e(m)}finally{n.f()}}}]),e}(),lt=function(){function e(t,n,r){Object(l.a)(this,e),this.data=t,this.bridge=n,this.application=r,this.myCtxKey="___instance___".concat(this.data.id)}return Object(d.a)(e,[{key:"toApi",value:function(){var e=this.bridge.getInteropInstance(this.data.id),t={id:this.data.id,agm:e,application:this.application,stop:this.stop.bind(this),getContext:this.getContext.bind(this)};return this.me=Object.freeze(t),this.me}},{key:"getContext",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.abrupt("return",this.bridge.contextLib.get(this.myCtxKey));case 1:case"end":return e.stop()}}),e,this)})))}},{key:"stop",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bridge.send("appManager",ut.instanceStop,{id:this.data.id});case 2:case"end":return e.stop()}}),e,this)})))}}]),e}(),dt=function(){function e(t,n,r){Object(l.a)(this,e),this.data=t,this.instances=n,this.controller=r}return Object(d.a)(e,[{key:"toApi",value:function(){var e={name:this.data.name,title:this.data.title,version:this.data.version,icon:this.data.icon,caption:this.data.caption,userProperties:this.data.userProperties,instances:this.instances,start:this.start.bind(this),onInstanceStarted:this.onInstanceStarted.bind(this),onInstanceStopped:this.onInstanceStopped.bind(this)};return this.me=e,this.me}},{key:"onInstanceStarted",value:function(e){var t=this;if("function"!==typeof e)throw new Error("OnInstanceStarted requires a single argument of type function");this.controller.onInstanceStarted((function(n){n.application.name===t.data.name&&e(n)}))}},{key:"onInstanceStopped",value:function(e){var t=this;if("function"!==typeof e)throw new Error("OnInstanceStarted requires a single argument of type function");this.controller.onInstanceStopped((function(n){n.application.name===t.data.name&&e(n)}))}},{key:"start",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return n.abrupt("return",this.controller.startApplication(this.data.name,e,t));case 1:case"end":return n.stop()}}),n,this)})))}}]),e}(),ft={layoutAdded:{name:"layoutAdded",dataDecoder:Ae},layoutChanged:{name:"layoutChanged",dataDecoder:Ae},layoutRemoved:{name:"layoutRemoved",dataDecoder:Ae},get:{name:"get",dataDecoder:je,resultDecoder:Fe},getAll:{name:"getAll",dataDecoder:Re,resultDecoder:We},export:{name:"export",dataDecoder:Re,resultDecoder:Ne},import:{name:"import",dataDecoder:De},remove:{name:"remove",dataDecoder:je}},pt=function(){function e(){Object(l.a)(this,e),this.registry=rt()}return Object(d.a)(e,[{key:"start",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.logger=e.logger.subLogger("layouts.controller.web"),this.logger.trace("starting the web layouts controller"),this.bridge=t.bridge,this.addOperationsExecutors(),r=this.toApi(),this.logger.trace("no need for platform registration, attaching the layouts property to glue and returning"),e.layouts=r;case 7:case"end":return n.stop()}}),n,this)})))}},{key:"handleBridgeMessage",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=K.runWithException(e.operation),(r=ft[n]).execute){t.next=4;break}return t.abrupt("return");case 4:return i=e.data,r.dataDecoder&&(i=r.dataDecoder.runWithException(e.data)),t.next=8,r.execute(i);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))}},{key:"toApi",value:function(){var e={get:this.get.bind(this),getAll:this.getAll.bind(this),export:this.export.bind(this),import:this.import.bind(this),save:this.save.bind(this),restore:this.restore.bind(this),remove:this.remove.bind(this),onAdded:this.onAdded.bind(this),onChanged:this.onChanged.bind(this),onRemoved:this.onRemoved.bind(this)};return Object.freeze(e)}},{key:"addOperationsExecutors",value:function(){ft.layoutAdded.execute=this.handleOnAdded.bind(this),ft.layoutChanged.execute=this.handleOnChanged.bind(this),ft.layoutRemoved.execute=this.handleOnRemoved.bind(this)}},{key:"get",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return H.runWithException(e),_e.runWithException(t),n.next=4,this.bridge.send("layouts",ft.get,{name:e,type:t});case 4:return r=n.sent,n.abrupt("return",r.layout);case 6:case"end":return n.stop()}}),n,this)})))}},{key:"getAll",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return _e.runWithException(e),t.next=3,this.bridge.send("layouts",ft.getAll,{type:e});case 3:return n=t.sent,t.abrupt("return",n.summaries);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"export",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e&&_e.runWithException(e),t.next=3,this.bridge.send("layouts",ft.export,{type:"Workspace"});case 3:return n=t.sent,t.abrupt("return",n.layouts);case 5:case"end":return t.stop()}}),t,this)})))}},{key:"import",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"replace";return f(this,void 0,void 0,c.a.mark((function n(){var r,i=this;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(Le.runWithException(t),Array.isArray(e)){n.next=3;break}throw new Error("Import must be called with an array of layouts");case 3:return r=e.reduce((function(e,t){var n=Ae.run(t);return n.ok?e.valid.push(t):i.logger.warn("A layout with name: ".concat(t.name," was not imported, because of error: ").concat(JSON.stringify(n.error))),e}),{valid:[]}),n.next=6,this.bridge.send("layouts",ft.import,{layouts:r.valid,mode:t});case 6:case"end":return n.stop()}}),n,this)})))}},{key:"save",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw Ee.runWithException(e),new Error("Save is not supported in Core at the moment");case 2:case"end":return t.stop()}}),t)})))}},{key:"restore",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:throw Oe.runWithException(e),new Error("Restore is not supported in Core at the moment");case 2:case"end":return t.stop()}}),t)})))}},{key:"remove",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return _e.runWithException(e),H.runWithException(t),n.next=4,this.bridge.send("layouts",ft.remove,{type:e,name:t});case 4:case"end":return n.stop()}}),n,this)})))}},{key:"onAdded",value:function(e){return this.registry.add(ft.layoutAdded.name,e)}},{key:"onChanged",value:function(e){return this.registry.add(ft.layoutChanged.name,e)}},{key:"onRemoved",value:function(e){return this.registry.add(ft.layoutRemoved.name,e)}},{key:"handleOnAdded",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.registry.execute(ft.layoutAdded.name,e);case 1:case"end":return t.stop()}}),t,this)})))}},{key:"handleOnChanged",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.registry.execute(ft.layoutChanged.name,e);case 1:case"end":return t.stop()}}),t,this)})))}},{key:"handleOnRemoved",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.registry.execute(ft.layoutRemoved.name,e);case 1:case"end":return t.stop()}}),t,this)})))}}]),e}(),ht=function(){function e(){Object(l.a)(this,e)}return Object(d.a)(e,[{key:"start",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.logger=e.logger.subLogger("notifications.controller.web"),this.logger.trace("starting the web notifications controller"),this.interop=e.interop,n=this.toApi(),e.notifications=n,this.logger.trace("notifications are ready");case 6:case"end":return t.stop()}}),t,this)})))}},{key:"handleBridgeMessage",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"toApi",value:function(){var e={raise:this.raise.bind(this)};return Object.freeze(e)}},{key:"raise",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i,o=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Notification"in window){t.next=2;break}throw new Error("this browser does not support desktop notification");case 2:return n="granted"===Notification.permission?Promise.resolve("granted"):"denied"===Notification.permission?Promise.reject("no permissions from user"):Notification.requestPermission(),t.next=5,n;case 5:return r=this.raiseUsingWebApi(e),e.clickInterop&&(i=e.clickInterop,r.onclick=function(){var e,t;o.interop.invoke(i.method,null!==(e=null===i||void 0===i?void 0:i.arguments)&&void 0!==e?e:{},null!==(t=null===i||void 0===i?void 0:i.target)&&void 0!==t?t:"best")}),t.abrupt("return",r);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"raiseUsingWebApi",value:function(e){return new Notification(e.title)}}]),e}(),gt={getIntents:{name:"getIntents",resultDecoder:qe},findIntent:{name:"findIntent",dataDecoder:Ke,resultDecoder:qe},raiseIntent:{name:"raiseIntent",dataDecoder:Ye,resultDecoder:Qe}},vt=function(){function e(){Object(l.a)(this,e),this.myIntents=new Set,this.GlueWebIntentsPrefix="Tick42.FDC3.Intents."}return Object(d.a)(e,[{key:"start",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:this.logger=e.logger.subLogger("intents.controller.web"),this.logger.trace("starting the web intents controller"),this.bridge=t.bridge,this.interop=e.interop,r=this.toApi(),this.logger.trace("no need for platform registration, attaching the intents property to glue and returning"),e.intents=r;case 7:case"end":return n.stop()}}),n,this)})))}},{key:"handleBridgeMessage",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=Ue.runWithException(e.operation),(r=gt[n]).execute){t.next=4;break}return t.abrupt("return");case 4:return i=e.data,r.dataDecoder&&(i=r.dataDecoder.runWithException(e.data)),t.next=8,r.execute(i);case 8:return t.abrupt("return",t.sent);case 9:case"end":return t.stop()}}),t)})))}},{key:"toApi",value:function(){var e={raise:this.raise.bind(this),all:this.all.bind(this),addIntentListener:this.addIntentListener.bind(this),find:this.find.bind(this)};return Object.freeze(e)}},{key:"raise",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=$e.runWithException(e),r="string"===typeof n?{intent:n}:n,t.next=4,this.bridge.send("intents",gt.raiseIntent,r);case 4:return i=t.sent,t.abrupt("return",i);case 6:case"end":return t.stop()}}),t,this)})))}},{key:"all",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.bridge.send("intents",gt.getIntents,void 0);case 2:return t=e.sent,e.abrupt("return",t.intents);case 4:case"end":return e.stop()}}),e,this)})))}},{key:"addIntentListener",value:function(e,t){var n=this;if(Ze.runWithException(e),"function"!==typeof t)throw new Error("Cannot add intent listener, because the provided handler is not a function!");var r=!0,i="string"===typeof e?e:e.intent,o="".concat(this.GlueWebIntentsPrefix).concat(i);if(this.myIntents.has(i))throw new Error("Intent listener for intent ".concat(i," already registered!"));this.myIntents.add(i);var a={unsubscribe:function(){r=!1;try{n.interop.unregister(o),n.myIntents.delete(i)}catch(e){n.logger.trace("Unsubscribed intent listener, but ".concat(o," unregistration failed!"))}}},s="string"===typeof e?{intent:e}:e;return this.interop.register({name:o,flags:s},(function(e){if(r)return t(e)})),a}},{key:"find",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r,i;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=void 0,"undefined"!==typeof e&&("string"===typeof(r=Je.runWithException(e))?n={filter:{name:r}}:"object"===typeof r&&(n={filter:r})),t.next=4,this.bridge.send("intents",gt.findIntent,n);case 4:return i=t.sent,t.abrupt("return",i.intents);case 6:case"end":return t.stop()}}),t,this)})))}}]),e}(),yt=function(){function e(){Object(l.a)(this,e),this.registry=rt(),this.GlueWebChannelsPrefix="___channel___",this.SubsKey="subs",this.ChangedKey="changed"}return Object(d.a)(e,[{key:"start",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:this.logger=e.logger.subLogger("channels.controller.web"),this.logger.trace("starting the web channels controller"),this.contexts=e.contexts,this.logger.trace("no need for platform registration, attaching the channels property to glue and returning"),n=this.toApi(),e.channels=n;case 6:case"end":return t.stop()}}),t,this)})))}},{key:"handleBridgeMessage",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:case"end":return e.stop()}}),e)})))}},{key:"toApi",value:function(){var e={subscribe:this.subscribe.bind(this),subscribeFor:this.subscribeFor.bind(this),publish:this.publish.bind(this),all:this.all.bind(this),list:this.list.bind(this),get:this.get.bind(this),join:this.join.bind(this),leave:this.leave.bind(this),current:this.current.bind(this),my:this.my.bind(this),changed:this.changed.bind(this),onChanged:this.onChanged.bind(this),add:this.add.bind(this)};return Object.freeze(e)}},{key:"createContextName",value:function(e){return"".concat(this.GlueWebChannelsPrefix).concat(e)}},{key:"getAllChannelNames",value:function(){var e=this;return this.contexts.all().filter((function(t){return t.startsWith(e.GlueWebChannelsPrefix)})).map((function(t){return t.replace(e.GlueWebChannelsPrefix,"")}))}},{key:"unsubscribe",value:function(){this.unsubscribeFunc&&(this.unsubscribeFunc(),this.unsubscribeFunc=void 0)}},{key:"switchToChannel",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n,r=this;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(this.unsubscribe(),this.currentChannelName=e,"undefined"===typeof e){t.next=7;break}return n=this.createContextName(e),t.next=6,this.contexts.subscribe(n,(function(e,t,n,i,o){r.registry.execute(r.SubsKey,e.data,e,null===o||void 0===o?void 0:o.updaterId)}));case 6:this.unsubscribeFunc=t.sent;case 7:this.registry.execute(this.ChangedKey,e);case 8:case"end":return t.stop()}}),t,this)})))}},{key:"updateData",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r,i;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.createContextName(e),!this.contexts.setPathSupported){n.next=7;break}return i=Object.keys(t).map((function(e){return{path:"data.".concat(e),value:t[e]}})),n.next=5,this.contexts.setPaths(r,i);case 5:n.next=9;break;case 7:return n.next=9,this.contexts.update(r,{data:t});case 9:case"end":return n.stop()}}),n,this)})))}},{key:"subscribe",value:function(e){if("function"!==typeof e)throw new Error("Cannot subscribe to channels, because the provided callback is not a function!");return this.registry.add(this.SubsKey,e)}},{key:"subscribeFor",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r,i;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(r=this.getAllChannelNames(),et(r).runWithException(e),"function"===typeof t){n.next=4;break}throw new Error("Cannot subscribe to channel ".concat(e,", because the provided callback is not a function!"));case 4:return i=this.createContextName(e),n.abrupt("return",this.contexts.subscribe(i,(function(e,n,r,i,o){t(e.data,e,null===o||void 0===o?void 0:o.updaterId)})));case 6:case"end":return n.stop()}}),n,this)})))}},{key:"publish",value:function(e,t){if("object"!==typeof e)throw new Error("Cannot publish to channel, because the provided data is not an object!");if("undefined"!==typeof t){var n=this.getAllChannelNames();return et(n).runWithException(t),this.updateData(t,e)}if("undefined"===typeof this.currentChannelName)throw new Error("Cannot publish to channel, because not joined to a channel!");return this.updateData(this.currentChannelName,e)}},{key:"all",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getAllChannelNames(),e.abrupt("return",t);case 2:case"end":return e.stop()}}),e,this)})))}},{key:"list",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){var t,n,r=this;return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=this.getAllChannelNames(),e.next=3,Promise.all(t.map((function(e){return r.get(e)})));case 3:return n=e.sent,e.abrupt("return",n);case 5:case"end":return e.stop()}}),e,this)})))}},{key:"get",value:function(e){var t=this.getAllChannelNames();et(t).runWithException(e);var n=this.createContextName(e);return this.contexts.get(n)}},{key:"join",value:function(e){return f(this,void 0,void 0,c.a.mark((function t(){var n;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return n=this.getAllChannelNames(),et(n).runWithException(e),t.next=4,this.switchToChannel(e);case 4:case"end":return t.stop()}}),t,this)})))}},{key:"leave",value:function(){return f(this,void 0,void 0,c.a.mark((function e(){return c.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.switchToChannel();case 2:case"end":return e.stop()}}),e,this)})))}},{key:"current",value:function(){return this.currentChannelName}},{key:"my",value:function(){return this.current()}},{key:"changed",value:function(e){if("function"!==typeof e)throw new Error("Cannot subscribe to channel changed, because the provided callback is not a function!");return this.registry.add(this.ChangedKey,e)}},{key:"onChanged",value:function(e){return this.changed(e)}},{key:"add",value:function(e){throw new Error("Method `add()` isn't implemented.")}}]),e}(),mt=function(){function e(t){Object(l.a)(this,e),this.coreGlue=t,this.controllers={windows:this.windowsController,appManager:this.appManagerController,layouts:this.layoutsController,notifications:this.notificationsController,intents:this.intentsController,channels:this.channelsController}}return Object(d.a)(e,[{key:"buildWebWindow",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r,i;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return r=new it(e,t,this.bridge),n.next=3,r.toApi();case 3:return i=n.sent,n.abrupt("return",{id:e,model:r,api:i});case 5:case"end":return n.stop()}}),n,this)})))}},{key:"buildApplication",value:function(e,t){return f(this,void 0,void 0,c.a.mark((function n(){var r,i,o,a=this;return c.a.wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return i=new dt(e,[],this.appManagerController).toApi(),o=t.map((function(e){return a.buildInstance(e,i)})),(r=i.instances).push.apply(r,Object(s.a)(o)),n.abrupt("return",i);case 4:case"end":return n.stop()}}),n,this)})))}},{key:"buildInstance",value:function(e,t){return new lt(e,this.bridge,t).toApi()}},{key:"windowsController",get:function(){return this._windowsControllerInstance||(this._windowsControllerInstance=new ot),this._windowsControllerInstance}},{key:"appManagerController",get:function(){return this._appManagerControllerInstance||(this._appManagerControllerInstance=new ct),this._appManagerControllerInstance}},{key:"layoutsController",get:function(){return this._layoutsControllerInstance||(this._layoutsControllerInstance=new pt),this._layoutsControllerInstance}},{key:"notificationsController",get:function(){return this._notificationsControllerInstance||(this._notificationsControllerInstance=new ht),this._notificationsControllerInstance}},{key:"intentsController",get:function(){return this._intentsControllerInstance||(this._intentsControllerInstance=new vt),this._intentsControllerInstance}},{key:"channelsController",get:function(){return this._channelsControllerInstance||(this._channelsControllerInstance=new yt),this._channelsControllerInstance}},{key:"bridge",get:function(){return this._bridgeInstance||(this._bridgeInstance=new st(this.coreGlue)),this._bridgeInstance}}]),e}(),bt=function(e,t){return(bt=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function wt(e,t){function n(){this.constructor=e}bt(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var _t=function(){return(_t=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function kt(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function xt(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function St(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var It=1,Ct=2,Tt=3,Pt=4;function At(e){return e.type===Tt?"timestamp":e.type===Ct?"number":e.type===It?"string":e.type===Pt?"object":"unknown"}function Et(e){return e.constructor===Date?"timestamp":"number"===typeof e?"number":"string"===typeof e?"string":"object"===typeof e?"object":"string"}function Ot(e){var t={},n=At(e);if("object"===n){var r=Object.keys(e.value).reduce((function(t,n){var r=Et(e.value[n]);if("object"===r){var i=function e(t){return Object.keys(t).reduce((function(n,r){var i=Et(t[r]);return n[r]="object"===i?{type:"object",description:"",context:{},composite:e(t[r])}:{type:i,description:"",context:{}},n}),{})}(e.value[n]);t[n]={type:"object",description:"",context:{},composite:i}}else t[n]={type:r,description:"",context:{}};return t}),{});t.composite=r}return t.name=Mt(e.path.join("/")+"/"+e.name),t.type=n,t.description=e.description,t.context={},t}function Mt(e){return"undefined"!==typeof e&&e.length>0&&"/"!==e[0]?"/"+e:e}function jt(e){return"timestamp"===At(e)?Date.now():function e(t){if("object"!==typeof t)return t;return Object.keys(t).reduce((function(n,r){var i=t[r];return"object"===typeof i&&i.constructor!==Date?n[r]=e(i):i.constructor===Date?n[r]=new Date(i).getTime():i.constructor===Boolean?n[r]=i.toString():n[r]=i,n}),{})}(e.value)}function Rt(e){var t=function e(t){return t.reduce((function(t,n){return t.concat(Array.isArray(n)?e(n):n)}),[])}(e.root.getAggregateState()),n=t.sort((function(e,t){return e.state?t.state?t.state-e.state:-1:1}))[0];return{description:function(e){var t="";return e.forEach((function(e,n,r){var i=e.path.join(".");n===r.length-1?t+=i+"."+e.name+": "+e.description:t+=i+"."+e.name+": "+e.description+","})),t.length>100?t.slice(0,100)+"...":t}(t),value:n.state}}var Nt=function(e,t,n){if(null===e||"object"!==typeof e)throw new Error("Missing definition");if(null===t||"object"!==typeof t)throw new Error("Missing parent");if(null===n||"object"!==typeof n)throw new Error("Missing transport")},Lt=function(){function e(e,t,n,r,i){this.definition=e,this.system=t,this.transport=n,this.value=r,this.type=i,this.path=[],Nt(e,t,n),this.path=t.path.slice(0),this.path.push(t.name),this.name=e.name,this.description=e.description,n.createMetric(this)}return Object.defineProperty(e.prototype,"repo",{get:function(){var e;return null===(e=this.system)||void 0===e?void 0:e.repo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.system.path+"/"+name},enumerable:!0,configurable:!0}),e.prototype.update=function(e){return this.value=e,this.transport.updateMetric(this)},e}(),Dt=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i,Ct)||this}return wt(t,e),t.prototype.incrementBy=function(e){this.update(this.value+e)},t.prototype.increment=function(){this.incrementBy(1)},t.prototype.decrement=function(){this.incrementBy(-1)},t.prototype.decrementBy=function(e){this.incrementBy(-1*e)},t}(Lt),Wt=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i,Pt)||this}return wt(t,e),t.prototype.update=function(e){return this.mergeValues(e),this.transport.updateMetric(this)},t.prototype.mergeValues=function(e){var t=this;return Object.keys(this.value).forEach((function(n){"undefined"!==typeof e[n]&&(t.value[n]=e[n])}))},t}(Lt),Ft=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i,It)||this}return wt(t,e),t}(Lt),Ut=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i,Tt)||this}return wt(t,e),t.prototype.now=function(){this.update(new Date)},t}(Lt);var Bt=function(){function e(e,t){t.init(this),this.root=function e(t,n,r,i,o){if(!n)throw new Error("Repository is required");if(!r)throw new Error("Transport is required");var a,s,u=r,c=t,l=o||"",d=n,f=i,p=function e(t){if(!t||!t.parent)return[];var n=e(t.parent);return n.push(t.name),n}(i),h={},g=(s="/",((a=p)&&a.length>0?a.join(s):"")+t),v=n.root,y=[],m=[];function b(e,t,n,r){var i={name:""};i="string"===typeof e?{name:e}:e;var o=m.filter((function(e){return e.name===i.name}));if(o.length>0){var a=o[0];if(a.type!==t)throw new Error("A metric named "+i.name+" is already defined with different type.");return"undefined"!==typeof n&&a.update(n).catch((function(){})),a}var s=r(i);return m.push(s),s}var w={get name(){return c},get description(){return l},get repo(){return d},get parent(){return f},path:p,id:g,root:v,get subSystems(){return y},get metrics(){return m},subSystem:function(t,n){if(!t||0===t.length)throw new Error("name is required");var r=y.filter((function(e){return e.name===t}));if(r.length>0)return r[0];var i=e(t,d,u,w,n);return y.push(i),i},getState:function(){return h},setState:function(e,t){h={state:e,description:t},u.updateSystem(w,h)},stringMetric:function(e,t){return b(e,It,t,(function(e){return new Ft(e,w,u,t)}))},timestampMetric:function(e,t){return b(e,Tt,t,(function(e){return new Ut(e,w,u,t)}))},objectMetric:function(e,t){return b(e,Pt,t,(function(e){return new Wt(e,w,u,t)}))},numberMetric:function(e,t){return b(e,Ct,t,(function(e){return new Dt(e,w,u,t)}))},getAggregateState:function(){var e=[];return Object.keys(h).length>0&&e.push({name:c,path:p,state:h.state,description:h.description}),y.forEach((function(t){var n=t.getAggregateState();n.length>0&&e.push.apply(e,n)})),e}};return u.createSystem(w),w}("",this,t),this.addSystemMetrics(this.root,e.clickStream||void 0===e.clickStream)}return e.prototype.addSystemMetrics=function(e,t){if("undefined"!==typeof navigator&&e.stringMetric("UserAgent",navigator.userAgent),t&&"undefined"!==typeof document){var n=e.subSystem("ClickStream"),r=function(e){if(e.target){var t=e.target;n.objectMetric("LastBrowserEvent",{type:"click",timestamp:new Date,target:{className:e.target?t.className:"",id:t.id,type:"<"+t.tagName.toLowerCase()+">",href:t.href||""}})}};n.objectMetric("Page",{title:document.title,page:window.location.href}),document.addEventListener?document.addEventListener("click",r):document.attachEvent("onclick",r)}e.stringMetric("StartTime",(new Date).toString());var i=e.stringMetric("StartURL",""),o=e.stringMetric("AppName","");if("undefined"!==typeof window){if("undefined"!==typeof window.location){var a=window.location.href;i.update(a)}"undefined"!==typeof window.glue42gd&&o.update(window.glue42gd.appName)}},e}(),Vt=function(){function e(){}return e.prototype.init=function(e){},e.prototype.createSystem=function(e){return Promise.resolve()},e.prototype.updateSystem=function(e,t){return Promise.resolve()},e.prototype.createMetric=function(e){return Promise.resolve()},e.prototype.updateMetric=function(e){return Promise.resolve()},e}(),Ht=function(){function e(e,t,n){this.api=e,this.lastCount=0,this.initialPublishTimeout=1e4,this.publishInterval=6e4,this.initialPublishTimeout=null!==t&&void 0!==t?t:this.initialPublishTimeout,this.publishInterval=null!==n&&void 0!==n?n:this.publishInterval,this.scheduleCollection(),this.system=this.api.subSystem("performance","Performance data published by the web application")}return e.prototype.scheduleCollection=function(){var e=this;setTimeout((function(){e.collect(),setInterval((function(){e.collect()}),e.publishInterval)}),this.initialPublishTimeout)},e.prototype.collect=function(){try{this.collectMemory(),this.collectEntries()}catch(e){}},e.prototype.collectMemory=function(){var e=window.performance.memory;this.system.stringMetric("memory",JSON.stringify({totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize}))},e.prototype.collectEntries=function(){var e=window.performance.getEntries();e.length<=this.lastCount||(this.lastCount=e.length,this.system.stringMetric("entries",JSON.stringify(e)))},e}(),zt=function(e){var t;t=e.connection&&"object"===typeof e.connection?function(e,t){var n,r,i=this;if(!e||"object"!==typeof e)throw new Error("Connection is required parameter");var o=function(e){a(e.root)},a=function e(t){s(t),t.metrics.forEach((function(e){u(e)})),t.subSystems.forEach((function(t){e(t)}))},s=function(e){return kt(i,void 0,void 0,(function(){var t,i;return xt(this,(function(o){switch(o.label){case 0:return void 0===e.parent?[2]:[4,n];case 1:return o.sent(),t={name:Mt(e.path.join("/")+"/"+e.name+"/State"),type:"object",composite:{Description:{type:"string",description:""},Value:{type:"number",description:""}},description:"System state",context:{}},i={type:"define",metrics:[t]},r.send(i),[2]}}))}))},u=function(e){return kt(i,void 0,void 0,(function(){var t,i,o;return xt(this,(function(a){switch(a.label){case 0:return t=l(e),[4,n];case 1:return a.sent(),i=Ot(t),o={type:"define",metrics:[i]},r.send(o),"undefined"!==typeof t.value&&c(t),[2]}}))}))},c=function(e){if(d()){var t=jt(e),n={type:"publish",values:[{name:Mt(e.path.join("/")+"/"+e.name),value:t,timestamp:Date.now()}]};return r.sendFireAndForget(n)}return Promise.resolve()},l=function(e){var t=_t({},e);return"object"===typeof e.value&&null!==e.value&&(t.value=_t({},e.value)),t},d=function(){var e;try{return(null!==(e=t.canUpdateMetric)&&void 0!==e?e:function(){return!0})()}catch(n){return!0}};return{init:function(i){var a;n=new Promise((function(e){a=e})),(r=e.domain("metrics")).onJoined((function(e){!e&&a&&(a(),a=void 0);var t={type:"define",metrics:[{name:"/State",type:"object",composite:{Description:{type:"string",description:""},Value:{type:"number",description:""}},description:"System state",context:{}}]};r.send(t),e&&o(i)})),r.join({system:t.system,service:t.service,instance:t.instance})},createSystem:s,updateSystem:function(t,o){return kt(i,void 0,void 0,(function(){var i,a,s;return xt(this,(function(u){switch(u.label){case 0:return[4,n];case 1:return u.sent(),i={type:"publish",values:[{name:Mt(t.path.join("/")+"/"+t.name+"/State"),value:{Description:o.description,Value:o.state},timestamp:Date.now()}]},r.send(i),a=Rt(t),s={type:"publish",peer_id:e.peerId,values:[{name:"/State",value:{Description:a.description,Value:a.value},timestamp:Date.now()}]},r.send(s),[2]}}))}))},createMetric:u,updateMetric:function(e){return kt(i,void 0,void 0,(function(){var t;return xt(this,(function(r){switch(r.label){case 0:return t=l(e),[4,n];case 1:return r.sent(),c(t),[2]}}))}))}}}(e.connection,e):new Vt;var n=new Bt(e,t).root;e.disableAutoAppSystem||(n=n.subSystem("App"));var r=function(e){var t,n=e.subSystem("reporting"),r={name:"features"};return e.featureMetric=function(e,i,o){if("undefined"===typeof e||""===e)throw new Error("name is mandatory");if("undefined"===typeof i||""===i)throw new Error("action is mandatory");if("undefined"===typeof o||""===o)throw new Error("payload is mandatory");t?t.update({name:e,action:i,payload:o}):t=n.objectMetric(r,{name:e,action:i,payload:o})},e}(n);return function(e,t){var n,r;if("undefined"===typeof window)return;var i=null===(r=null===(n=null===window||void 0===window?void 0:window.glue42gd)||void 0===n?void 0:n.metrics)||void 0===r?void 0:r.pagePerformanceMetrics;i&&(t=i);(null===t||void 0===t?void 0:t.enabled)&&new Ht(e,t.initialPublishTimeout,t.publishInterval)}(r,e.pagePerformanceMetrics),r};function qt(e){if(e&&e.errorHandling&&"function"!==typeof e.errorHandling&&"log"!==e.errorHandling&&"silent"!==e.errorHandling&&"throw"!==e.errorHandling)throw new Error('Invalid options passed to createRegistry. Prop errorHandling should be ["log" | "silent" | "throw" | (err) => void], but '+typeof e.errorHandling+" was passed");var t=e&&"function"===typeof e.errorHandling&&e.errorHandling,n={};function r(n,r){var i=n instanceof Error?n:new Error(n);if(t)t(i);else{var o='[ERROR] callback-registry: User callback for key "'+r+'" failed: '+i.stack;if(e)switch(e.errorHandling){case"log":return console.error(o);case"silent":return;case"throw":throw new Error(o)}console.error(o)}}return{add:function(e,t,i){var o=n[e];return o||(o=[],n[e]=o),o.push(t),i&&setTimeout((function(){i.forEach((function(i){var o;if(null===(o=n[e])||void 0===o?void 0:o.includes(t))try{Array.isArray(i)?t.apply(void 0,i):t.apply(void 0,[i])}catch(m){r(m,e)}}))}),0),function(){var r=n[e];r&&(0===(r=r.reduce((function(e,n,r){return n===t&&e.length===r||e.push(n),e}),[])).length?delete n[e]:n[e]=r)}},execute:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=n[e];if(!o||0===o.length)return[];var a=[];return o.forEach((function(n){try{var i=n.apply(void 0,t);a.push(i)}catch(m){a.push(void 0),r(m,e)}})),a},clear:function(){n={}},clearKey:function(e){n[e]&&delete n[e]}}}qt.default=qt;var Gt=qt,Jt=function(){function e(e,t){var n=this;this.registry=Gt(),this.gw=e.facade,this.gw.connect((function(e,t){n.messageHandler(t)})).then((function(e){n.client=e}))}return Object.defineProperty(e.prototype,"isObjectBasedTransport",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.sendObject=function(e){return this.client?(this.client.send(e),Promise.resolve(void 0)):Promise.reject("not connected")},e.prototype.send=function(e){return Promise.reject("not supported")},e.prototype.onMessage=function(e){return this.registry.add("onMessage",e)},e.prototype.onConnectedChanged=function(e){e(!0)},e.prototype.close=function(){return Promise.resolve()},e.prototype.open=function(){return Promise.resolve()},e.prototype.name=function(){return"in-memory"},e.prototype.reconnect=function(){return Promise.resolve()},e.prototype.messageHandler=function(e){this.registry.execute("onMessage",e)},e}(),Kt=function(){function e(e,t){var n=this;this.logger=t,this.registry=Gt(),this.worker=new SharedWorker(e),this.worker.port.onmessage=function(e){n.messageHandler(e.data)}}return Object.defineProperty(e.prototype,"isObjectBasedTransport",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.sendObject=function(e){return this.worker.port.postMessage(e),Promise.resolve()},e.prototype.send=function(e){return Promise.reject("not supported")},e.prototype.onMessage=function(e){return this.registry.add("onMessage",e)},e.prototype.onConnectedChanged=function(e){e(!0)},e.prototype.close=function(){return Promise.resolve()},e.prototype.open=function(){return Promise.resolve()},e.prototype.name=function(){return"shared-worker"},e.prototype.reconnect=function(){return Promise.resolve()},e.prototype.messageHandler=function(e){this.registry.execute("onMessage",e)},e}(),Yt=function(){function t(){}return t.getGDMajorVersion=function(){if("undefined"!==typeof window&&window.glueDesktop&&window.glueDesktop.version){var e=Number(window.glueDesktop.version.substr(0,1));return isNaN(e)?void 0:e}},t.isNode=function(){if("undefined"!==typeof t._isNode)return t._isNode;if("undefined"!==typeof window)return t._isNode=!1,!1;try{t._isNode="[object process]"===Object.prototype.toString.call(e.process)}catch(n){t._isNode=!1}return t._isNode},t}(),$t=function(){function e(){var e=this;this.rejected=!1,this.resolved=!1,this.promise=new Promise((function(t,n){e.resolve=function(n){e.resolved=!0,t(n)},e.reject=function(t){e.rejected=!0,n(t)}}))}return e.delay=function(e){return new Promise((function(t){return setTimeout(t,e)}))},Object.defineProperty(e.prototype,"ended",{get:function(){return this.rejected||this.resolved},enumerable:!0,configurable:!0}),e}(),Qt={};function Xt(e){var t=Qt[e];if(t)return t;var n=[];function r(){return(new Date).getTime()}var i,o,a=r();function s(e,t){var i=null!==t&&void 0!==t?t:r(),o=0;n.length>0&&(o=i-n[n.length-1].time),n.push({name:e,time:i,diff:o})}s("start",a);var u={get startTime(){return a},get endTime(){return i},get period(){return o},stop:function(){return s("end",i=r()),o=i-a},mark:s,marks:n};return Qt[e]=u,u}var Zt=Yt.isNode()?n(34):window.WebSocket,en=function(){function e(e,t){if(this.startupTimer=Xt("connection"),this._running=!0,this._registry=Gt(),this.wsRequests=[],this.settings=e,this.logger=t,!this.settings.ws)throw new Error("ws is missing")}return e.prototype.onMessage=function(e){return this._registry.add("onMessage",e)},e.prototype.send=function(e,t){var n=this;return new Promise((function(t,r){n.waitForSocketConnection((function(){var i;try{null===(i=n.ws)||void 0===i||i.send(e),t()}catch(o){r(o)}}),r)}))},e.prototype.open=function(){var e=this;return this.logger.info("opening ws..."),this._running=!0,new Promise((function(t,n){e.waitForSocketConnection(t,n)}))},e.prototype.close=function(){return this._running=!1,this.ws&&this.ws.close(),Promise.resolve()},e.prototype.onConnectedChanged=function(e){return this._registry.add("onConnectedChanged",e)},e.prototype.name=function(){return"ws "+this.settings.ws},e.prototype.reconnect=function(){var e;null===(e=this.ws)||void 0===e||e.close();var t=new $t;return this.waitForSocketConnection((function(){t.resolve()})),t.promise},e.prototype.waitForSocketConnection=function(e,t){var n;t=null!==t&&void 0!==t?t:function(){},this._running?1!==(null===(n=this.ws)||void 0===n?void 0:n.readyState)?(this.wsRequests.push({callback:e,failed:t}),this.wsRequests.length>1||this.openSocket()):e():t("wait for socket on "+this.settings.ws+" failed - socket closed by user")},e.prototype.openSocket=function(e,t){return kt(this,void 0,void 0,(function(){var n=this;return xt(this,(function(r){switch(r.label){case 0:if(this.startupTimer.mark("opening-socket"),void 0===e&&(e=this.settings.reconnectInterval),void 0!==t){if(0===t)return this.notifyForSocketState("wait for socket on "+this.settings.ws+" failed - no more retries left"),[2];this.logger.debug("will retry "+t+" more times (every "+e+" ms)")}r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.initiateSocket()];case 2:return r.sent(),this.startupTimer.mark("socket-initiated"),this.notifyForSocketState(),[3,4];case 3:return r.sent(),setTimeout((function(){var r=void 0===t?void 0:t-1;n.openSocket(e,r)}),e),[3,4];case 4:return[2]}}))}))},e.prototype.initiateSocket=function(){var e=this,t=new $t;return this.logger.debug("initiating ws to "+this.settings.ws+"..."),this.ws=new Zt(this.settings.ws||""),this.ws.onerror=function(n){var r="";try{r=JSON.stringify(n)}catch(o){var i=new WeakSet;r=JSON.stringify(n,(function(e,t){if("object"===typeof t&&null!==t){if(i.has(t))return;i.add(t)}return t}))}t.reject("error"),e.notifyStatusChanged(!1,r)},this.ws.onclose=function(n){e.logger.info("ws closed "+n),t.reject("closed"),e.notifyStatusChanged(!1)},this.ws.onopen=function(){var n;e.startupTimer.mark("ws-opened"),e.logger.info("ws opened "+(null===(n=e.settings.identity)||void 0===n?void 0:n.application)),t.resolve(),e.notifyStatusChanged(!0)},this.ws.onmessage=function(t){e._registry.execute("onMessage",t.data)},t.promise},e.prototype.notifyForSocketState=function(e){this.wsRequests.forEach((function(t){e?t.failed&&t.failed(e):t.callback()})),this.wsRequests=[]},e.prototype.notifyStatusChanged=function(e,t){this._registry.execute("onConnectedChanged",e,t)},e}();var tn=1;var nn,rn,on,an={nextValue:function(){return(tn=(9301*tn+49297)%233280)/233280},seed:function(e){tn=e}},sn="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function un(){on=!1}function cn(e){if(e){if(e!==nn){if(e.length!==sn.length)throw new Error("Custom alphabet for shortid must be "+sn.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter((function(e,t,n){return t!==n.lastIndexOf(e)}));if(t.length)throw new Error("Custom alphabet for shortid must be "+sn.length+" unique characters. These characters were not unique: "+t.join(", "));nn=e,un()}}else nn!==sn&&(nn=sn,un())}function ln(){return on||(on=function(){nn||cn(sn);for(var e,t=nn.split(""),n=[],r=an.nextValue();t.length>0;)r=an.nextValue(),e=Math.floor(r*t.length),n.push(t.splice(e,1)[0]);return n.join("")}())}var dn={characters:function(e){return cn(e),nn},seed:function(e){an.seed(e),rn!==e&&(un(),rn=e)},lookup:function(e){return ln()[e]},shuffled:ln},fn="object"===typeof window&&(window.crypto||window.msCrypto);var pn=function(){if(!fn||!fn.getRandomValues)return 48&Math.floor(256*Math.random());var e=new Uint8Array(1);return fn.getRandomValues(e),48&e[0]};var hn=function(e,t){for(var n,r=0,i="";!n;)i+=e(t>>4*r&15|pn()),n=t<Math.pow(16,r+1),r++;return i};var gn=function(e){var t=dn.shuffled();return{version:15&t.indexOf(e.substr(0,1)),worker:15&t.indexOf(e.substr(1,1))}};var vn=function(e){if(!e||"string"!==typeof e||e.length<6)return!1;for(var t=dn.characters(),n=e.length,r=0;r<n;r++)if(-1===t.indexOf(e[r]))return!1;return!0},yn=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t,n,r=0;function i(){var e="",i=Math.floor(.001*(Date.now()-1459707606518));return i===n?t++:(t=0,n=i),e+=hn(dn.lookup,6),e+=hn(dn.lookup,r),t>0&&(e+=hn(dn.lookup,t)),e+=hn(dn.lookup,i)}e.exports=i,e.exports.generate=i,e.exports.seed=function(t){return dn.seed(t),e.exports},e.exports.worker=function(t){return r=t,e.exports},e.exports.characters=function(e){return void 0!==e&&dn.characters(e),dn.shuffled()},e.exports.decode=gn,e.exports.isValid=vn})),mn=(yn.generate,yn.seed,yn.worker,yn.characters,yn.decode,yn.isValid,yn);function bn(e,t,n,r,i){null==e&&(e="global"),r=r||["success"],i=i||["error"];var o,a=!1,s=!1,u=!1,c=Gt();t.disconnected((function(){u=!1,n.debug("connection is down"),a=!1,s=!0,c.execute("onLeft",{disconnected:!0})})),t.loggedIn((function(){u=!0,s&&(n.debug("connection is now up - trying to reconnect..."),d(o))})),t.on("success",(function(e){return p(e)})),t.on("error",(function(e){return f(e)})),t.on("result",(function(e){return p(e)})),r&&r.forEach((function(e){t.on(e,(function(e){return p(e)}))})),i&&i.forEach((function(e){t.on(e,(function(e){return f(e)}))}));var l={};function d(t){return o=t,new Promise((function(r,i){if(a)r();else{var o;if("global"===e)o=u?Promise.resolve({}):Promise.reject("not connected to gateway");else n.debug("joining domain "+e),o=g({type:"join",destination:e,domain:"global",options:t});o.then((function(){!function(){n.debug("did join "+e),a=!0;var t=s;s=!1,c.execute("onJoined",t)}(),r()})).catch((function(t){n.debug("error joining "+e+" domain: "+JSON.stringify(t)),i(t)}))}}))}function f(t){if(e===t.domain){var n=t.request_id;if(n){var r=l[n];r&&r.error(t)}}}function p(t){if(t.domain===e){var n=t.request_id;if(n){var r=l[n];r&&r.success(t)}}}function h(){return mn()}function g(r,i,o){o=o||{},r.request_id=r.request_id||h(),r.domain=r.domain||e,o.skipPeerId||(r.peer_id=t.peerId);var a=r.request_id;return new Promise((function(e,s){l[a]={success:function(t){delete l[a],t._tag=i,e(t)},error:function(e){n.warn("GW error - "+JSON.stringify(e)+" for request "+JSON.stringify(r)),delete l[a],e._tag=i,s(e)}},t.send(r,o).catch((function(e){l[a].error({err:e})}))}))}return{join:d,leave:function(){return"global"===e?Promise.resolve():(n.debug("stopping session "+e+"..."),s=!1,g({type:"leave",destination:e,domain:"global"}).then((function(){a=!1,c.execute("onLeft")})))},onJoined:function(e){return a&&e(!1),c.add("onJoined",e)},onLeft:function(e){return a||e(),c.add("onLeft",e)},send:g,sendFireAndForget:function(n){return n.request_id=n.request_id?n.request_id:h(),n.domain=n.domain||e,n.peer_id=t.peerId,t.send(n)},on:function(r,i){t.on(r,(function(t){if(t.domain===e)try{i(t)}catch(r){n.error("Callback  failed: "+r+" \n "+r.stack+" \n msg was: "+JSON.stringify(t),r)}}))},loggedIn:function(e){return t.loggedIn(e)},connected:function(e){return t.connected(e)},disconnected:function(e){return t.disconnected(e)},get peerId(){return t.peerId},get domain(){return e}}}var wn=function(){function e(e,t,n){var r=this;this.connection=e,this.settings=t,this.logger=n,this.protocolVersion=3,this.datePrefix="#T42_DATE#",this.datePrefixLen=this.datePrefix.length,this.dateMinLen=this.datePrefixLen+1,this.datePrefixFirstChar=this.datePrefix[0],this.registry=Gt(),this._isLoggedIn=!1,this.shouldTryLogin=!0,this.initialLogin=!0,this.initialLoginAttempts=3,this.sessions=[],e.disconnected((function(){r.handleDisconnected()})),this.ping()}return Object.defineProperty(e.prototype,"isLoggedIn",{get:function(){return this._isLoggedIn},enumerable:!0,configurable:!0}),e.prototype.processStringMessage=function(e){var t=this,n=JSON.parse(e,(function(e,n){if("string"!==typeof n)return n;if(n.length<t.dateMinLen)return n;if(n[0]!==t.datePrefixFirstChar)return n;if(n.substring(0,t.datePrefixLen)!==t.datePrefix)return n;try{var r=parseInt(n.substring(t.datePrefixLen,n.length),10);return isNaN(r)?n:new Date(r)}catch(i){return n}}));return{msg:n,msgType:n.type}},e.prototype.createStringMessage=function(e){var t=Date.prototype.toJSON;try{var n=this.datePrefix;return Date.prototype.toJSON=function(){return n+this.getTime()},JSON.stringify(e)}finally{Date.prototype.toJSON=t}},e.prototype.processObjectMessage=function(e){if(!e.type)throw new Error("Object should have type property");return{msg:e,msgType:e.type}},e.prototype.createObjectMessage=function(e){return e},e.prototype.login=function(e,t){return kt(this,void 0,void 0,(function(){var n,i,o,a,s,u,c,l,d,f;return xt(this,(function(p){switch(p.label){case 0:if(this.logger.debug("logging in..."),this.loginConfig=e,this.loginConfig||(this.loginConfig={username:"",password:""}),this.shouldTryLogin=!0,n={},this.connection.gatewayToken=e.gatewayToken,!e.gatewayToken)return[3,5];if(!t)return[3,4];p.label=1;case 1:return p.trys.push([1,3,,4]),[4,this.getNewGWToken()];case 2:return l=p.sent(),e.gatewayToken=l,[3,4];case 3:return i=p.sent(),this.logger.warn("failed to get GW token when reconnecting "+((null===i||void 0===i?void 0:i.message)||i)),[3,4];case 4:return n.method="gateway-token",n.token=e.gatewayToken,this.connection.gatewayToken=e.gatewayToken,[3,10];case 5:return"sspi"!==e.flowName?[3,9]:(n.provider="win",n.method="access-token",e.flowCallback&&e.sessionId?(o=n,[4,e.flowCallback(e.sessionId,null)]):[3,7]);case 6:return o.token=p.sent().data.toString("base64"),[3,8];case 7:throw new Error("Invalid SSPI config");case 8:return[3,10];case 9:if(e.token)n.method="access-token",n.token=e.token;else{if(!e.username)throw new Error("invalid auth message"+JSON.stringify(e));n.method="secret",n.login=e.username,n.secret=e.password}p.label=10;case 10:a={type:"hello",identity:this.settings.identity,authentication:n},e.sessionId&&(a.request_id=e.sessionId),this.globalDomain=bn("global",this.connection,this.logger.subLogger("global-domain"),["welcome","token","authentication-request"]),s={skipPeerId:!0},this.initialLogin&&(s.retryInterval=this.settings.reconnectInterval,s.maxRetries=this.settings.reconnectAttempts),p.label=11;case 11:p.trys.push([11,19,20,21]),u=void 0,p.label=12;case 12:return[4,this.globalDomain.send(a,void 0,s)];case 13:return"authentication-request"!==(c=p.sent()).type?[3,16]:(l=r.from(c.authentication.token,"base64"),e.flowCallback&&e.sessionId?(d=a.authentication,[4,e.flowCallback(e.sessionId,l)]):[3,15]);case 14:d.token=p.sent().data.toString("base64"),p.label=15;case 15:return a.request_id=e.sessionId,[3,12];case 16:if("welcome"===c.type)return u=c,[3,18];throw"error"===c.type?new Error("Authentication failed: "+c.reason):new Error("Unexpected message type during authentication: "+c.type);case 17:return[3,12];case 18:return this.initialLogin=!1,this.logger.debug("login successful with peerId "+u.peer_id),this.connection.peerId=u.peer_id,this.connection.resolvedIdentity=u.resolved_identity,this.connection.availableDomains=u.available_domains,u.options&&(this.connection.token=u.options.access_token,this.connection.info=u.options.info),this.setLoggedIn(!0),[2,u.resolved_identity];case 19:throw f=p.sent(),this.logger.error("error sending hello message - "+(f.message||f.msg||f.reason||f),f),f;case 20:return e&&e.flowCallback&&e.sessionId&&e.flowCallback(e.sessionId,null),[7];case 21:return[2]}}))}))},e.prototype.logout=function(){return kt(this,void 0,void 0,(function(){var e;return xt(this,(function(t){switch(t.label){case 0:return this.logger.debug("logging out..."),this.shouldTryLogin=!1,this.pingTimer&&clearTimeout(this.pingTimer),e=this.sessions.map((function(e){e.leave()})),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.loggedIn=function(e){return this._isLoggedIn&&e(),this.registry.add("onLoggedIn",e)},e.prototype.domain=function(e,t,n,r){var i=this.sessions.filter((function(t){return t.domain===e}))[0];return i||(i=bn(e,this.connection,t,n,r),this.sessions.push(i)),i},e.prototype.handleDisconnected=function(){var e=this;if(this.setLoggedIn(!1),this.shouldTryLogin&&this.initialLogin){if(this.initialLoginAttempts<=0)return;this.initialLoginAttempts--}if(this.logger.debug("disconnected - will try new login?"+this.shouldTryLogin),this.shouldTryLogin){if(!this.loginConfig)throw new Error("no login info");this.connection.login(this.loginConfig,!0).catch((function(){setTimeout(e.handleDisconnected.bind(e),e.settings.reconnectInterval||1e3)}))}},e.prototype.setLoggedIn=function(e){this._isLoggedIn=e,this._isLoggedIn&&this.registry.execute("onLoggedIn")},e.prototype.ping=function(){var e=this;this.shouldTryLogin&&(this._isLoggedIn&&this.connection.send({type:"ping"}),this.pingTimer=setTimeout((function(){e.ping()}),3e4))},e.prototype.authToken=function(){return this.globalDomain?this.globalDomain.send({type:"create-token"}).then((function(e){return e.token})):Promise.reject(new Error("no global domain session"))},e.prototype.getNewGWToken=function(){if(void 0!==typeof window){var e=window.glue42gd;if(e)return e.getGWToken()}return Promise.reject(new Error("not running in GD"))},e}(),_n=function(){function e(e){this.specsNames=[],this.messages={},this.subs={},this.subsRefCount={},this.specs={};for(var t=0,n=e;t<n.length;t++){var r=n[t];this.specs[r.name]=r,this.specsNames.push(r.name)}}return e.prototype.init=function(e){var t=this;this.connection=e;for(var n=0,r=this.specsNames;n<r.length;n++)for(var i=r[n],o=function(n){var r=a.subsRefCount[n];if(r||(r=0),r+=1,a.subsRefCount[n]=r,r>1)return"continue";var i=e.on(n,(function(e){return t.processMessage(n,e)}));a.subs[n]=i},a=this,s=0,u=this.specs[i].types;s<u.length;s++){o(u[s])}},e.prototype.processMessage=function(e,t){if(!this.isDone&&t)for(var n=0,r=this.specsNames;n<r.length;n++){var i=r[n];if(-1!==this.specs[i].types.indexOf(e)){var o=this.messages[i]||[];this.messages[i]=o,o.push(t)}}},e.prototype.drain=function(e,t){var n;t&&(this.messages[e]||[]).forEach(t),delete this.messages[e];for(var r=0,i=this.specs[e].types;r<i.length;r++){var o=i[r];this.subsRefCount[o]-=1,this.subsRefCount[o]<=0&&(null===(n=this.connection)||void 0===n||n.off(this.subs[o]),delete this.subs[o],delete this.subsRefCount[o])}delete this.specs[e],this.specs.length||(this.isDone=!0)},e}(),kn=function(e,t,n){return new Promise((function(r,i){var o=setTimeout((function(){i(n||"Promise timeout hit: "+t)}),t);new Promise(e).then((function(e){clearTimeout(o),r(e)})).catch((function(e){clearTimeout(o),i(e)}))}))},xn=function(){function e(e,t,n){this.settings=e,this.logger=t,this.identity=n,this.parentReady=!1,this.iAmConnected=!1,this.rejected=!1,this.children=[],this.parentPingTimeout=3e3,this.connectionRequestTimeout=5e3,this.defaultTargetString="*",this.registry=Gt(),this.messages={connectionAccepted:{name:"connectionAccepted",handle:this.handleConnectionAccepted.bind(this)},connectionRejected:{name:"connectionRejected",handle:this.handleConnectionRejected.bind(this)},connectionRequest:{name:"connectionRequest",handle:this.handleConnectionRequest.bind(this)},parentReady:{name:"parentReady",handle:this.handleParentReady.bind(this)},parentPing:{name:"parentPing",handle:this.handleParentPing.bind(this)},platformPing:{name:"platformPing",handle:this.handlePlatformPing.bind(this)},platformUnload:{name:"platformUnload",handle:this.handlePlatformUnload.bind(this)},platformReady:{name:"platformReady",handle:this.handlePlatformReady.bind(this)},clientUnload:{name:"clientUnload",handle:this.handleClientUnload.bind(this)}},this.setUpMessageListener(),this.setUpUnload(),this.settings.port||(this.parent=window.opener||window.top,this.parentType=window.opener?"opener":-1!==window.name.indexOf("#wsp")?"workspace":"top")}return Object.defineProperty(e.prototype,"transportWindowId",{get:function(){return this.publicWindowId},enumerable:!0,configurable:!0}),e.prototype.sendObject=function(e){return kt(this,void 0,void 0,(function(){return xt(this,(function(t){if(!this.port)throw new Error("Cannot send message, because the port was not opened yet");return this.port.postMessage(e),[2]}))}))},Object.defineProperty(e.prototype,"isObjectBasedTransport",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.onMessage=function(e){return this.registry.add("onMessage",e)},e.prototype.send=function(){return Promise.reject("not supported")},e.prototype.onConnectedChanged=function(e){return this.registry.add("onConnectedChanged",e)},e.prototype.open=function(){return kt(this,void 0,void 0,(function(){return xt(this,(function(e){switch(e.label){case 0:return this.logger.debug("opening a connection to the web platform gateway."),[4,this.connect()];case 1:return e.sent(),this.notifyStatusChanged(!0),[2]}}))}))},e.prototype.close=function(){return Promise.resolve()},e.prototype.name=function(){return"web-platform"},e.prototype.reconnect=function(){return Promise.resolve()},e.prototype.connect=function(){return kt(this,void 0,void 0,(function(){var e=this;return xt(this,(function(t){switch(t.label){case 0:if(this.parentReady)return this.logger.debug("cancelling connection attempt, because this client's parent has already given a ready signal"),[2];if(this.settings.port)return this.logger.debug("opening an internal web platform connection"),this.port=this.settings.port,this.publicWindowId=this.settings.windowId,this.identity&&(this.identity.windowId=this.publicWindowId),this.port.onmessage=function(t){return e.registry.execute("onMessage",t.data)},this.logger.debug("internal web platform connection completed"),[2];if(!this.parentType||!this.parent)throw new Error("Cannot initiate a connection, because there is no opener, no top and no port.");return this.logger.debug("opening a "+("opener"===this.parentType?"child":"grandchild")+" client web platform connection"),[4,this.waitParent(this.parent,this.parentType)];case 1:return t.sent(),[4,this.initiateRemoteConnection(this.parent,this.parentType)];case 2:return t.sent(),this.logger.debug("the "+("opener"===this.parentType?"child":"grandchild")+" client is connected"),[2]}}))}))},e.prototype.initiateRemoteConnection=function(e,t){var n=this;return kn((function(r,i){n.connectionResolve=r,n.connectionReject=i,n.myClientId=mn();var o="workspace"===n.parentType?window.name.substring(0,window.name.indexOf("#wsp")):window.name,a={glue42core:{type:n.messages.connectionRequest.name,clientId:n.myClientId,clientType:"top"===t||"workspace"===t?"grandChild":"child",bridgeInstanceId:o}};n.logger.debug("sending connection request to "+t),e.postMessage(a,n.defaultTargetString)}),this.connectionRequestTimeout,"The connection to the opener/top window timed out")},e.prototype.waitParent=function(e,t){var n=this;return kn((function(r){n.parentPingResolve=r;var i={glue42core:{type:"opener"===t?n.messages.platformPing.name:n.messages.parentPing.name}};n.logger.debug("checking for "+t+" window availability"),e.postMessage(i,n.defaultTargetString)}),this.parentPingTimeout,"Cannot initiate glue, because this window was not opened or created by a glue client")},e.prototype.setUpMessageListener=function(){var e=this;this.settings.port?this.logger.debug("skipping generic message listener, because this is an internal client"):window.addEventListener("message",(function(t){var n,r=null===(n=t.data)||void 0===n?void 0:n.glue42core;if(r&&!e.rejected)if(e.checkMessageTypeValid(r.type)){var i=r.type;e.logger.debug("received valid glue42core message of type: "+i),e.messages[i].handle(t)}else e.logger.error("cannot handle the incoming glue42 core message, because the type is invalid: "+r.type)}))},e.prototype.setUpUnload=function(){var e=this;this.settings.port?this.logger.debug("skipping unload event listener, because this is an internal client"):window.addEventListener("beforeunload",(function(){var t,n,r={glue42core:{type:e.messages.clientUnload.name,data:{clientId:e.myClientId,ownWindowId:null===(t=e.identity)||void 0===t?void 0:t.windowId}}};e.parent&&e.parent.postMessage(r,e.defaultTargetString),null===(n=e.port)||void 0===n||n.postMessage(r)}))},e.prototype.handleParentReady=function(){if(this.logger.debug("handling the ready signal from the parent, by resoling the pending promise."),this.parentReady=!0,this.parentPingResolve)return this.parentPingResolve(),void delete this.parentPingResolve;this.logger.debug("silently handling the ready signal from the top parent, because there is no defined promise")},e.prototype.handlePlatformReady=function(){if(this.logger.debug("the web platform gave the ready signal"),this.parentReady=!0,this.parentPingResolve)return this.parentPingResolve(),void delete this.parentPingResolve;this.logger.debug("silently handling the ready signal from the top parent, because there is no defined promise")},e.prototype.handleConnectionAccepted=function(e){var t,n=null===(t=e.data)||void 0===t?void 0:t.glue42core;return this.myClientId===n.clientId?this.handleAcceptanceOfMyRequest(n):this.handleAcceptanceOfGrandChildRequest(n,e)},e.prototype.handleAcceptanceOfMyRequest=function(e){var t=this;if(this.logger.debug("handling a connection accepted signal targeted at me."),e.port){if(this.publicWindowId="opener"===this.parentType?window.name:"top"===this.parentType?e.parentWindowId:window.name.substring(0,window.name.indexOf("#wsp")),this.identity&&"top"!==this.parentType&&(this.identity.windowId=this.publicWindowId),this.identity&&e.appName&&(this.identity.application=e.appName,this.identity.applicationName=e.appName),this.port=e.port,this.port.onmessage=function(e){return t.registry.execute("onMessage",e.data)},this.connectionResolve)return this.logger.debug("my connection is set up, calling the connection resolve."),this.connectionResolve(),void delete this.connectionResolve;this.logger.error("unable to call the connection resolve, because no connection promise was found")}else this.logger.error("cannot set up my connection, because I was not provided with a port")},e.prototype.handleAcceptanceOfGrandChildRequest=function(e,t){this.logger.debug("handling a connection accepted signal targeted at a grandchild: "+e.clientId);var n=this.children.find((function(t){return t.grandChildId===e.clientId}));n?(n.connected=!0,this.logger.debug("the grandchild connection for "+e.clientId+" is set up, forwarding the success message and the gateway port"),e.parentWindowId=this.publicWindowId,n.source.postMessage(t.data,n.origin,[e.port])):this.logger.error("cannot handle connection accepted for grandchild: "+e.clientId+", because there is no grandchild with this id")},e.prototype.handleConnectionRejected=function(){this.logger.debug("handling a connection rejection. Most likely the reason is that this window was not created by a glue API call"),this.connectionReject&&(this.connectionReject("The platform connection was rejected. Most likely because this window was not created by a glue API call"),delete this.connectionReject)},e.prototype.handleConnectionRequest=function(e){var t=e.source,n=e.data.glue42core;return n.clientType&&"grandChild"===n.clientType?n.clientId?"opener"===this.parentType&&this.parent?(this.logger.debug("handling a connection request for a grandchild: "+n.clientId),this.children.push({grandChildId:n.clientId,source:t,connected:!1,origin:e.origin}),this.logger.debug("grandchild: "+n.clientId+" is prepared, forwarding connection request to the platform"),void this.parent.postMessage(e.data,this.defaultTargetString)):this.rejectConnectionRequest(t,e.origin,"Cannot forward the connection request, because no direct connection to the platform was found"):this.rejectConnectionRequest(t,e.origin,"rejecting a connection request, because the source did not provide a valid id"):this.rejectConnectionRequest(t,e.origin,"rejecting a connection request, because the source was not opened by a glue API call")},e.prototype.handleParentPing=function(e){if(this.parentReady)if(this.iAmConnected){var t={glue42core:{type:this.messages.parentReady.name}},n=e.source;this.logger.debug("responding to a parent ping with a ready message"),n.postMessage(t,e.origin)}else this.logger.debug("i am not fully connected yet, I am ignoring the parent ping");else this.logger.debug("my parent is not ready, I am ignoring the parent ping")},e.prototype.handlePlatformUnload=function(e){this.logger.debug("detected a web platform unload"),this.parentReady=!1,this.children.length&&(this.logger.debug("forwarding the platform unload to all known children and starting platform discovery polling"),this.children.forEach((function(t){return t.source.postMessage(e.data,t.origin)}))),this.notifyStatusChanged(!1,"Gateway unloaded")},e.prototype.handleClientUnload=function(e){var t=e.data.glue42core;t.clientId?this.children.find((function(e){return e.grandChildId===t.clientId}))?(this.logger.debug("handling grandchild unload for id: "+t.clientId),this.children=this.children.filter((function(e){return e.grandChildId!==t.clientId}))):this.logger.warn("cannot process grand child unload, because this client is unaware of this grandchild"):this.logger.warn("cannot process grand child unload, because the provided id was not valid")},e.prototype.handlePlatformPing=function(){this.logger.error("cannot handle platform ping, because this is not a platform calls handling component")},e.prototype.notifyStatusChanged=function(e,t){this.iAmConnected=e,this.registry.execute("onConnectedChanged",e,t)},e.prototype.checkMessageTypeValid=function(e){return"string"===typeof e&&!!this.messages[e]},e.prototype.rejectConnectionRequest=function(e,t,n){this.rejected=!0,this.logger.error(n);var r={glue42core:{type:this.messages.connectionRejected.name}};e.postMessage(r,t)},e}(),Sn=function(){function e(e,t){if(this.settings=e,this.logger=t,this.messageHandlers={},this.ids=1,this.registry=Gt(),this._connected=!1,this.isTrace=!1,(e=e||{}).reconnectAttempts=e.reconnectAttempts||10,e.reconnectInterval=e.reconnectInterval||1e3,e.inproc)this.transport=new Jt(e.inproc,t.subLogger("inMemory"));else if(e.sharedWorker)this.transport=new Kt(e.sharedWorker,t.subLogger("shared-worker"));else if(e.webPlatform)this.transport=new xn(e.webPlatform,t.subLogger("web-platform"),e.identity);else{if(void 0===e.ws)throw new Error("No connection information specified");this.transport=new en(e,t.subLogger("ws"))}this.isTrace=t.canPublish("trace"),t.debug("starting with "+this.transport.name()+" transport"),this.protocol=new wn(this,e,t.subLogger("protocol")),this.transport.onConnectedChanged(this.handleConnectionChanged.bind(this)),this.transport.onMessage(this.handleTransportMessage.bind(this)),e.replaySpecs&&e.replaySpecs.length&&(this.replayer=new _n(e.replaySpecs),this.replayer.init(this))}return Object.defineProperty(e.prototype,"protocolVersion",{get:function(){var e;return null===(e=this.protocol)||void 0===e?void 0:e.protocolVersion},enumerable:!0,configurable:!0}),e.prototype.send=function(e,t){if(this.transport.sendObject&&this.transport.isObjectBasedTransport){var n=this.protocol.createObjectMessage(e);return this.isTrace&&this.logger.trace(">> "+JSON.stringify(n)),this.transport.sendObject(n,t)}var r=this.protocol.createStringMessage(e);return this.isTrace&&this.logger.trace(">> "+r),this.transport.send(r,t)},e.prototype.on=function(e,t){e=e.toLowerCase(),void 0===this.messageHandlers[e]&&(this.messageHandlers[e]={});var n=this.ids++;return this.messageHandlers[e][n]=t,{type:e,id:n}},e.prototype.off=function(e){delete this.messageHandlers[e.type.toLowerCase()][e.id]},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this.protocol.isLoggedIn},enumerable:!0,configurable:!0}),e.prototype.connected=function(e){var t=this;return this.protocol.loggedIn((function(){e(t.settings.ws||t.settings.sharedWorker||"")}))},e.prototype.disconnected=function(e){return this.registry.add("disconnected",e)},e.prototype.login=function(e,t){return kt(this,void 0,void 0,(function(){var n;return xt(this,(function(r){switch(r.label){case 0:return[4,this.transport.open()];case 1:return r.sent(),Xt("connection").mark("transport-opened"),n=this.protocol.login(e,t),Xt("connection").mark("protocol-logged-in"),[2,n]}}))}))},e.prototype.logout=function(){return kt(this,void 0,void 0,(function(){return xt(this,(function(e){switch(e.label){case 0:return[4,this.protocol.logout()];case 1:return e.sent(),[4,this.transport.close()];case 2:return e.sent(),[2]}}))}))},e.prototype.loggedIn=function(e){return this.protocol.loggedIn(e)},e.prototype.domain=function(e,t,n){return this.protocol.domain(e,this.logger.subLogger("domain="+e),t,n)},e.prototype.authToken=function(){return this.protocol.authToken()},e.prototype.reconnect=function(){return this.transport.reconnect()},e.prototype.distributeMessage=function(e,t){var n=this,r=this.messageHandlers[t.toLowerCase()];void 0!==r&&Object.keys(r).forEach((function(t){var i=r[t];if(void 0!==i)try{i(e)}catch(o){try{n.logger.error("Message handler failed with "+o.stack,o)}catch(a){console.log("Message handler failed",o)}}}))},e.prototype.handleConnectionChanged=function(e){this._connected!==e&&(this._connected=e,e?this.registry.execute("connected"):this.registry.execute("disconnected"))},e.prototype.handleTransportMessage=function(e){var t;t="string"===typeof e?this.protocol.processStringMessage(e):this.protocol.processObjectMessage(e),this.isTrace&&this.logger.trace("<< "+JSON.stringify(t)),this.distributeMessage(t.msg,t.msgType)},e}(),In=["trace","debug","info","warn","error","off"],Cn=function(){function e(e,t,n){this.name=e,this.parent=t,this.subLoggers=[],this.logFn=console,this.customLogFn=!1,this.name=e,this.path=t?t.path+"."+e:e,this.loggerFullName="["+this.path+"]",this.includeTimeAndLevel=!n,n&&(this.logFn=n,this.customLogFn=!0)}return e.prototype.subLogger=function(t){var n=this.subLoggers.filter((function(e){return e.name===t}))[0];if(void 0!==n)return n;Object.keys(this).forEach((function(e){if(e===t)throw new Error("This sub logger name is not allowed.")}));var r=new e(t,this,this.customLogFn?this.logFn:void 0);return this.subLoggers.push(r),r},e.prototype.publishLevel=function(e){var t;return e&&(this._publishLevel=e),this._publishLevel||(null===(t=this.parent)||void 0===t?void 0:t.publishLevel())},e.prototype.consoleLevel=function(e){var t;return e&&(this._consoleLevel=e),this._consoleLevel||(null===(t=this.parent)||void 0===t?void 0:t.consoleLevel())},e.prototype.log=function(e,t,n){this.publishMessage(t||"info",e,n)},e.prototype.trace=function(e){this.log(e,"trace")},e.prototype.debug=function(e){this.log(e,"debug")},e.prototype.info=function(e){this.log(e,"info")},e.prototype.warn=function(e){this.log(e,"warn")},e.prototype.error=function(e,t){this.log(e,"error")},e.prototype.canPublish=function(e,t){return In.indexOf(e)>=In.indexOf(t||this.consoleLevel()||"trace")},e.prototype.publishMessage=function(t,n,r){var i=this.loggerFullName;if("error"===t&&!r){var o=new Error;o.stack&&(n=n+"\n"+o.stack.split("\n").slice(3).join("\n"))}if(this.canPublish(t,this.publishLevel())){var a=e.Interop;if(a)try{a.methods({name:e.InteropMethodName}).length>0&&a.invoke(e.InteropMethodName,{msg:""+n,logger:i,level:t})}catch(l){}}if(this.canPublish(t)){var s="";if(this.includeTimeAndLevel){var u=new Date;s="["+(u.getHours()+":"+u.getMinutes()+":"+u.getSeconds()+":"+u.getMilliseconds())+"] ["+t+"] "}var c=""+s+i+": "+n;switch(t){case"trace":this.logFn.debug(c);break;case"debug":this.logFn.debug?this.logFn.debug(c):this.logFn.log(c);break;case"info":this.logFn.info(c);break;case"warn":this.logFn.warn(c);break;case"error":this.logFn.error(c,r)}}},e.InteropMethodName="T42.AppLogger.Log",e}(),Tn={get name(){return"context"},get types(){return["create-context","created","destroyed","context-created","context-added","subscribe-context","subscribed-context","unsubscribe-context","destroy-context","context-destroyed","update-context","context-updated","joined"]}};var Pn=function(){function e(e,t,n,r){this.updateCallbacks={},this.contextId=e,this.name=t,this.isAnnounced=n,this.activityId=r,this.context={}}return e.prototype.hasCallbacks=function(){return Object.keys(this.updateCallbacks).length>0},e.prototype.getState=function(){return this.isAnnounced&&this.hasCallbacks()?3:this.isAnnounced?2:this.hasCallbacks()?1:0},e}();function An(e,t,n){try{if((null===n||void 0===n?void 0:n.canPublish("trace"))&&(null===n||void 0===n||n.trace("applying context delta "+JSON.stringify(t)+" on context "+JSON.stringify(e))),!t)return e;if(t.reset)return e=_t({},t.reset);if(e=En(e,void 0),t.commands){for(var r=0,i=t.commands;r<i.length;r++){var o=i[r];"remove"===o.type?Rn(e,o.path):"set"===o.type&&jn(e,o.value,o.path)}return e}var a=t.added,s=t.updated,u=t.removed;return a&&Object.keys(a).forEach((function(t){e[t]=a[t]})),s&&Object.keys(s).forEach((function(t){On(t,e,s)})),u&&u.forEach((function(t){delete e[t]})),e}catch(c){return null===n||void 0===n||n.error("error applying context delta "+JSON.stringify(t)+" on context "+JSON.stringify(e),c),e}}function En(e,t){if(t=t||new WeakMap,Object(e)!==e)return e;if(e instanceof Set)return new Set(e);if(t.has(e))return t.get(e);var n=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e.constructor?new e.constructor:Object.create(null);return t.set(e,n),Object.assign.apply(Object,St([n],Object.keys(e).map((function(n){var r;return(r={})[n]=En(e[n],t),r}))))}var On=function(e,t,n){var r=n[e];if(void 0===r)return t;var i=t[e];return i&&r?"string"===typeof i||"number"===typeof i||"boolean"===typeof i||"string"===typeof r||"number"===typeof r||"boolean"===typeof r||Array.isArray(i)||Array.isArray(r)?(t[e]=r,t):(t[e]=Object.assign({},i,r),t):(t[e]=r,t)};function Mn(e,t){if(e===t)return!0;if(!(e instanceof Object)||!(t instanceof Object))return!1;if(e.constructor!==t.constructor)return!1;for(var n in e)if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n))return!1;if(e[n]!==t[n]){if("object"!==typeof e[n])return!1;if(!Mn(e[n],t[n]))return!1}}for(var n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}function jn(e,t,n){var r,i=n.split(".");for(r=0;r<i.length-1;r++)e[i[r]]||(e[i[r]]={}),"object"!==typeof e[i[r]]&&(e[i[r]]={}),e=e[i[r]];e[i[r]]=t}function Rn(e,t){var n,r=t.split(".");for(n=0;n<r.length-1;n++){if(!e[r[n]])return;e=e[r[n]]}delete e[r[n]]}var Nn,Ln=function(){function e(e){var t,n=this;this._contextNameToData={},this._gw3Subscriptions=[],this._nextCallbackSubscriptionNumber=0,this._contextNameToId={},this._contextIdToName={},this._protocolVersion=void 0,this._connection=e.connection,this._logger=e.logger,this._gw3Session=this._connection.domain("global",["context-created","subscribed-context","context-destroyed","context-updated"]),this.subscribeToContextCreatedMessages(),this.subscribeToContextUpdatedMessages(),this.subscribeToContextDestroyedMessages(),null===(t=this._connection.replayer)||void 0===t||t.drain(Tn.name,(function(e){var t=e.type;t&&("context-created"===t||"context-added"===t||"created"===t?n.handleContextCreatedMessage(e):"subscribed-context"===t||"context-updated"===t||"joined"===t?n.handleContextUpdatedMessage(e):"context-destroyed"!==t&&"destroyed"!==t||n.handleContextDestroyedMessage(e))}))}return Object.defineProperty(e.prototype,"protocolVersion",{get:function(){var e;if(!this._protocolVersion){var t=this._connection.availableDomains.find((function(e){return"context"===e.uri}));this._protocolVersion=null!==(e=null===t||void 0===t?void 0:t.version)&&void 0!==e?e:1}return this._protocolVersion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setPathSupported",{get:function(){return this.protocolVersion>=2},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){for(var e=0,t=this._gw3Subscriptions;e<t.length;e++){var n=t[e];this._connection.off(n)}for(var r in this._gw3Subscriptions.length=0,this._contextNameToData)this._contextNameToId.hasOwnProperty(r)&&delete this._contextNameToData[r]},e.prototype.createContext=function(e,t){var n=this;return this._gw3Session.send({type:"create-context",domain:"global",name:e,data:t,lifetime:"retained"}).then((function(r){n._contextNameToId[e]=r.context_id,n._contextIdToName[r.context_id]=e;var i=n._contextNameToData[e]||new Pn(r.context_id,e,!0,void 0);return i.isAnnounced=!0,i.name=e,i.contextId=r.context_id,i.context=t,n._contextNameToData[e]=i,r.context_id}))},e.prototype.all=function(){var e=this;return Object.keys(this._contextNameToData).filter((function(t){return e._contextNameToData[t].isAnnounced}))},e.prototype.update=function(e,t){var n;return kt(this,void 0,void 0,(function(){var r,i,o,a=this;return xt(this,(function(s){switch(s.label){case 0:return(r=this._contextNameToData[e])&&r.isAnnounced?(i=r.context,r.hasCallbacks()?[3,2]:[4,this.get(r.name)]):[2,this.createContext(e,t)];case 1:i=s.sent(),s.label=2;case 2:return o=2===this.protocolVersion?this.calculateContextDeltaV2(i,t):this.calculateContextDeltaV1(i,t),Object.keys(o.added).length||Object.keys(o.updated).length||o.removed.length||(null===(n=o.commands)||void 0===n?void 0:n.length)?[2,this._gw3Session.send({type:"update-context",domain:"global",context_id:r.contextId,delta:o},{},{skipPeerId:!1}).then((function(e){a.handleUpdated(r,o,{updaterId:e.peer_id})}))]:[2,Promise.resolve()]}}))}))},e.prototype.set=function(e,t){var n=this,r=this._contextNameToData[e];return r&&r.isAnnounced?this._gw3Session.send({type:"update-context",domain:"global",context_id:r.contextId,delta:{reset:t}},{},{skipPeerId:!1}).then((function(e){n.handleUpdated(r,{reset:t,added:{},removed:[],updated:{}},{updaterId:e.peer_id})})):this.createContext(e,t)},e.prototype.setPath=function(e,t,n){return this.setPathSupported?this.setPaths(e,[{path:t,value:n}]):Promise.reject("glue.contexts.setPath operation is not supported, use Glue42 3.10 or later")},e.prototype.setPaths=function(e,t){var n=this;if(!this.setPathSupported)return Promise.reject("glue.contexts.setPaths operation is not supported, use Glue42 3.10 or later");var r=this._contextNameToData[e];if(!r||!r.isAnnounced){for(var i={},o=0,a=t;o<a.length;o++){jn(i,(l=a[o]).value,l.path)}return this.createContext(e,i)}for(var s=[],u=0,c=t;u<c.length;u++){var l;null===(l=c[u]).value?s.push({type:"remove",path:l.path}):s.push({type:"set",path:l.path,value:l.value})}return this._gw3Session.send({type:"update-context",domain:"global",context_id:r.contextId,delta:{commands:s}},{},{skipPeerId:!1}).then((function(e){n.handleUpdated(r,{added:{},removed:[],updated:{},commands:s},{updaterId:e.peer_id})}))},e.prototype.get=function(e){var t,n=this,r=this._contextNameToData[e];if(!r||!r.isAnnounced)return Promise.resolve({});if(r&&!r.hasCallbacks())return new Promise((function(t,r){return kt(n,void 0,void 0,(function(){var n=this;return xt(this,(function(r){return this.subscribe(e,(function(e,r,i,o){n.unsubscribe(o),t(e)})),[2]}))}))}));var i=null!==(t=null===r||void 0===r?void 0:r.context)&&void 0!==t?t:{};return Promise.resolve(i)},e.prototype.subscribe=function(e,t){var n=this._nextCallbackSubscriptionNumber;this._nextCallbackSubscriptionNumber+=1;var r=this._contextNameToData[e];if(!r||!r.isAnnounced)return r=r||new Pn(void 0,e,!1,void 0),this._contextNameToData[e]=r,r.updateCallbacks[n]=t,Promise.resolve(n);var i,o=r.hasCallbacks();return r.updateCallbacks[n]=t,o||r.joinedActivity||r.context&&r.sentExplicitSubscription?(t(i=En(r.context),i,[],n),Promise.resolve(n)):this.sendSubscribe(r).then((function(){return n}))},e.prototype.unsubscribe=function(e){for(var t=0,n=Object.keys(this._contextNameToData);t<n.length;t++){var r=n[t],i=(this._contextNameToId[r],this._contextNameToData[r]);if(!i)return;var o=i.hasCallbacks();delete i.updateCallbacks[e],i.isAnnounced&&o&&!i.hasCallbacks()&&i.sentExplicitSubscription&&this.sendUnsubscribe(i),i.isAnnounced||i.hasCallbacks()||delete this._contextNameToData[r]}},e.prototype.destroy=function(e){var t=this._contextNameToData[e];return t?this._gw3Session.send({type:"destroy-context",domain:"global",context_id:t.contextId}).then((function(e){})):Promise.reject("context with "+e+" does not exist")},e.prototype.handleUpdated=function(e,t,n){var r=e.context;e.context=An(e.context,t,this._logger),this._contextNameToData[e.name]!==e||Mn(r,e.context)||this.invokeUpdateCallbacks(e,t,n)},e.prototype.subscribeToContextCreatedMessages=function(){for(var e=0,t=["context-added","context-created","created"];e<t.length;e++){var n=t[e],r=this._connection.on(n,this.handleContextCreatedMessage.bind(this));this._gw3Subscriptions.push(r)}},e.prototype.handleContextCreatedMessage=function(e){var t=e.type;"created"===t?(this._contextNameToId[e.activity_id]=e.context_id,this._contextIdToName[e.context_id]=e.activity_id):"context-added"===t&&(this._contextNameToId[e.name]=e.context_id,this._contextIdToName[e.context_id]=e.name);var n=this._contextIdToName[e.context_id];if(!n)throw new Error("Received created event for context with unknown name: "+e.context_id);if(!this._contextNameToId[n])throw new Error("Received created event for context with unknown id: "+e.context_id);var r=this._contextNameToData[n];if(r){if(r.isAnnounced)return;if(!r.hasCallbacks())throw new Error("Assertion failure: contextData.hasCallbacks()");r.isAnnounced=!0,r.contextId=e.context_id,r.activityId=e.activity_id,r.sentExplicitSubscription||this.sendSubscribe(r)}else this._contextNameToData[n]=r=new Pn(e.context_id,n,!0,e.activity_id)},e.prototype.subscribeToContextUpdatedMessages=function(){for(var e=0,t=["context-updated","subscribed-context","joined"];e<t.length;e++){var n=t[e],r=this._connection.on(n,this.handleContextUpdatedMessage.bind(this));this._gw3Subscriptions.push(r)}},e.prototype.handleContextUpdatedMessage=function(e){var t=e.type,n=e.context_id,r=this._contextNameToData[this._contextIdToName[n]],i=!r||!r.isAnnounced;if("joined"===t)r?(r.contextId=n,r.isAnnounced=!0,r.activityId=e.activity_id):(r=new Pn(n,e.activity_id,!0,e.activity_id),this._contextNameToData[e.activity_id]=r,this._contextIdToName[n]=e.activity_id,this._contextNameToId[e.activity_id]=n),r.joinedActivity=!0;else if(!r||!r.isAnnounced)return void("subscribed-context"===t?((r=r||new Pn(n,e.name,!0,void 0)).sentExplicitSubscription=!0,this._contextNameToData[e.name]=r,this._contextIdToName[n]=e.name,this._contextNameToId[e.name]=n):this._logger.error("Received 'update' for unknown context: "+n));var o=r.context;if("subscribed-context"===t)r.context=e.data||{};else if("joined"===t)r.context=e.context_snapshot||{};else{if("context-updated"!==t)throw new Error("Unrecognized context update message "+t);r.context=An(r.context,e.delta,this._logger)}!i&&Mn(r.context,o)&&"subscribed-context"!==t||this.invokeUpdateCallbacks(r,e.delta,{updaterId:e.updater_id})},e.prototype.invokeUpdateCallbacks=function(e,t,n){if((t=t||{added:{},updated:{},reset:{},removed:[]}).commands){t.added=t.updated=t.reset={},t.removed=[];for(var r=0,i=t.commands;r<i.length;r++){var o=i[r];"remove"===o.type?(-1===o.path.indexOf(".")&&t.removed.push(o.path),jn(t.updated,null,o.path)):"set"===o.type&&jn(t.updated,o.value,o.path)}}for(var a in e.updateCallbacks)if(e.updateCallbacks.hasOwnProperty(a))try{(0,e.updateCallbacks[a])(En(e.context),Object.assign({},t.added||{},t.updated||{},t.reset||{}),t.removed,parseInt(a,10),n)}catch(m){this._logger.debug("callback error: "+JSON.stringify(m))}},e.prototype.subscribeToContextDestroyedMessages=function(){for(var e=0,t=["context-destroyed","destroyed"];e<t.length;e++){var n=t[e],r=this._connection.on(n,this.handleContextDestroyedMessage.bind(this));this._gw3Subscriptions.push(r)}},e.prototype.handleContextDestroyedMessage=function(e){var t,n;if("destroyed"===e.type){if(n=e.activity_id,!(t=this._contextNameToId[n]))return void this._logger.error("Received 'destroyed' for unknown activity: "+e.activity_id)}else if(t=e.context_id,!(n=this._contextIdToName[t]))return void this._logger.error("Received 'destroyed' for unknown context: "+e.context_id);delete this._contextIdToName[t],delete this._contextNameToId[n];var r=this._contextNameToData[n];delete this._contextNameToData[n],r&&r.isAnnounced||this._logger.error("Received 'destroyed' for unknown context: "+t)},e.prototype.sendSubscribe=function(e){return e.sentExplicitSubscription=!0,this._gw3Session.send({type:"subscribe-context",domain:"global",context_id:e.contextId}).then((function(e){}))},e.prototype.sendUnsubscribe=function(e){return e.sentExplicitSubscription=!1,this._gw3Session.send({type:"unsubscribe-context",domain:"global",context_id:e.contextId}).then((function(e){}))},e.prototype.calculateContextDeltaV1=function(e,t){var n={added:{},updated:{},removed:[],reset:void 0};if(e)for(var r=0,i=Object.keys(e);r<i.length;r++){var o=i[r];-1===Object.keys(t).indexOf(o)||null===t[o]||Mn(e[o],t[o])||(n.updated[o]=t[o])}for(var a=0,s=Object.keys(t);a<s.length;a++){o=s[a];e&&-1!==Object.keys(e).indexOf(o)?null===t[o]&&n.removed.push(o):null!==t[o]&&(n.added[o]=t[o])}return n},e.prototype.calculateContextDeltaV2=function(e,t){for(var n,r,i={added:{},updated:{},removed:[],reset:void 0,commands:[]},o=0,a=Object.keys(t);o<a.length;o++){var s=a[o];if(null!==t[s])Mn(e?e[s]:null,t[s])||null===(n=i.commands)||void 0===n||n.push({type:"set",path:s,value:t[s]});else null===(r=i.commands)||void 0===r||r.push({type:"remove",path:s})}return i},e}(),Dn=function(){function e(e){this._bridge=new Ln(e)}return e.prototype.all=function(){return this._bridge.all()},e.prototype.update=function(e,t){return this.checkName(e),this.checkData(t),this._bridge.update(e,t)},e.prototype.set=function(e,t){return this.checkName(e),this.checkData(t),this._bridge.set(e,t)},e.prototype.setPath=function(e,t,n){return this.checkName(e),this.checkPath(t),""===t?(this.checkData(n),this.set(e,n)):this._bridge.setPath(e,t,n)},e.prototype.setPaths=function(e,t){if(this.checkName(e),!Array.isArray(t))throw new Error("Please provide the paths as an array of PathValues!");for(var n=0,r=t;n<r.length;n++){var i=r[n],o=i.path,a=i.value;this.checkPath(o),""===o&&this.checkData(a)}return this._bridge.setPaths(e,t)},e.prototype.subscribe=function(e,t){var n=this;if(this.checkName(e),"function"!==typeof t)throw new Error("Please provide the callback as a function!");return this._bridge.subscribe(e,(function(e,r,i,o,a){return t(e,r,i,(function(){return n._bridge.unsubscribe(o)}),a)})).then((function(e){return function(){n._bridge.unsubscribe(e)}}))},e.prototype.get=function(e){return this.checkName(e),this._bridge.get(e)},e.prototype.ready=function(){return Promise.resolve(this)},e.prototype.destroy=function(e){return this.checkName(e),this._bridge.destroy(e)},Object.defineProperty(e.prototype,"setPathSupported",{get:function(){return this._bridge.setPathSupported},enumerable:!0,configurable:!0}),e.prototype.checkName=function(e){if("string"!==typeof e||""===e)throw new Error("Please provide the name as a non-empty string!")},e.prototype.checkPath=function(e){if("string"!==typeof e)throw new Error("Please provide the path as a dot delimited string!")},e.prototype.checkData=function(e){if("object"!==typeof e)throw new Error("Please provide the data as an object!")},e}();function Wn(e,t,n){return"function"!==typeof t&&"function"!==typeof n?e:("function"!==typeof t?t=function(){}:"function"!==typeof n&&(n=function(){}),e.then(t,n))}function Fn(e,t,n){var r;return void 0===e&&(e=0),t.finally((function(){r&&clearTimeout(r)})),new Promise((function(t,i){r=setTimeout((function(){return i(n)}),e)}))}!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(Nn||(Nn={}));var Un=function(){function e(e,t,n,r){this.protocol=e,this.repo=t,this.instance=n,this.configuration=r}return e.prototype.subscribe=function(e,t,n,r,i){var o=this,a=function(e,n,r,a){var s;t.methodResponseTimeout=null!==(s=t.methodResponseTimeout)&&void 0!==s?s:t.waitTimeoutMs,o.protocol.client.subscribe(n,t,e,r,a,i)};return Wn(new Promise((function(n,r){var i,s=function(e){n(e)},u=function(e){r(e)};if(e)if((i="string"===typeof e?{name:e}:e).name){void 0===t&&(t={});var c=t.target;if(void 0===c&&(c="best"),"string"!==typeof c||"all"===c||"best"===c){void 0===t.methodResponseTimeout&&(t.methodResponseTimeout=t.method_response_timeout,void 0===t.methodResponseTimeout&&(t.methodResponseTimeout=o.configuration.methodResponseTimeout)),void 0===t.waitTimeoutMs&&(t.waitTimeoutMs=t.wait_for_method_timeout,void 0===t.waitTimeoutMs&&(t.waitTimeoutMs=o.configuration.waitTimeoutMs));var l=0,d=o.getServerMethodsByFilterAndTarget(i,c);if(d.length>0)a(d,d[0].methods[0],s,u);else{setTimeout((function n(){if(c&&t.waitTimeoutMs)if(l+=500,(d=o.getServerMethodsByFilterAndTarget(i,c)).length>0){var r=d[0].methods[0];a(d,r,s,u)}else if(l>=t.waitTimeoutMs){a(d,"string"===typeof e?{name:e}:e,s,u)}else setTimeout(n,500)}),500)}}else r(new Error('"'+c+'" is not a valid target. Valid targets are "all", "best", or an instance.'))}else r("Method definition is required. Please, provide either a unique string for a method name or a \u201cmethodDefinition\u201d object with a required \u201cname\u201d property.");else r("Method definition is required. Please, provide either a unique string for a method name or a \u201cmethodDefinition\u201d object with a required \u201cname\u201d property.")})),n,r)},e.prototype.servers=function(e){var t=void 0===e?void 0:_t({},e);return this.getServers(t).map((function(e){return e.server.instance}))},e.prototype.methods=function(e){return e="string"===typeof e?{name:e}:_t({},e),this.getMethods(e)},e.prototype.methodsForInstance=function(e){return this.getMethodsForInstance(e)},e.prototype.methodAdded=function(e){return this.repo.onMethodAdded(e)},e.prototype.methodRemoved=function(e){return this.repo.onMethodRemoved(e)},e.prototype.serverAdded=function(e){return this.repo.onServerAdded(e)},e.prototype.serverRemoved=function(e){return this.repo.onServerRemoved((function(t,n){e(t,n)}))},e.prototype.serverMethodAdded=function(e){return this.repo.onServerMethodAdded((function(t,n){e({server:t,method:n})}))},e.prototype.serverMethodRemoved=function(e){return this.repo.onServerMethodRemoved((function(t,n){e({server:t,method:n})}))},e.prototype.invoke=function(e,t,n,r,i,o){return kt(this,void 0,void 0,(function(){var a=this;return xt(this,(function(s){return[2,Wn(function(){return kt(a,void 0,void 0,(function(){var i,o,a,s,u,c,l,d,f,p,h,g,v=this;return xt(this,(function(y){switch(y.label){case 0:if(!(i="string"===typeof e?{name:e}:_t({},e)).name)return[2,Promise.reject("Method definition is required. Please, provide either a unique string for a method name or a \u201cmethodDefinition\u201d object with a required \u201cname\u201d property.")];if(t||(t={}),n||(n="best"),"string"===typeof n&&"all"!==n&&"best"!==n&&"skipMine"!==n)return[2,Promise.reject(new Error('"'+n+'" is not a valid target. Valid targets are "all" and "best".'))];if(r||(r={}),void 0===r.methodResponseTimeoutMs&&(r.methodResponseTimeoutMs=r.method_response_timeout,void 0===r.methodResponseTimeoutMs&&(r.methodResponseTimeoutMs=this.configuration.methodResponseTimeout)),void 0===r.waitTimeoutMs&&(r.waitTimeoutMs=r.wait_for_method_timeout,void 0===r.waitTimeoutMs&&(r.waitTimeoutMs=this.configuration.waitTimeoutMs)),void 0!==r.waitTimeoutMs&&"number"!==typeof r.waitTimeoutMs)return[2,Promise.reject(new Error('"'+r.waitTimeoutMs+'" is not a valid number for "waitTimeoutMs" '))];if("object"!==typeof t)return[2,Promise.reject(new Error("The method arguments must be an object. method: "+i.name))];if(0!==(o=this.getServerMethodsByFilterAndTarget(i,n)).length)return[3,4];y.label=1;case 1:return y.trys.push([1,3,,4]),[4,this.tryToAwaitForMethods(i,n,r)];case 2:return o=y.sent(),[3,4];case 3:return y.sent(),a=_t(_t({},i),{getServers:function(){return[]},supportsStreaming:!1,objectTypes:null!==(p=i.objectTypes)&&void 0!==p?p:[],flags:null!==(g=null===(h=i.flags)||void 0===h?void 0:h.metadata)&&void 0!==g?g:{}}),s={method:a,called_with:t,message:"Can not find a method matching "+JSON.stringify(e)+" with server filter "+JSON.stringify(n),executed_by:void 0,returned:void 0,status:void 0},[2,Promise.reject(s)];case 4:return u=r.methodResponseTimeoutMs,c=r,l=o.map((function(e){var n=mn(),r=e.methods[0],i=e.server,o=v.protocol.client.invoke(n,r,t,i,c);return Promise.race([o,Fn(u,o,{invocationId:n,message:"Invocation timeout ("+u+" ms) reached for method name: "+(null===r||void 0===r?void 0:r.name)+", target instance: "+JSON.stringify(i.instance)+", options: "+JSON.stringify(c),status:Nn.Error})])})),[4,Promise.all(l)];case 5:return d=y.sent(),f=this.getInvocationResultObj(d,i,t),d.every((function(e){return e.status===Nn.Error}))?[2,Promise.reject(f)]:[2,f]}}))}))}(),i,o)]}))}))},e.prototype.getInvocationResultObj=function(e,t,n){var r=e.filter((function(e){return e.status===Nn.Success})).reduce((function(e,r){return e=St(e,[{executed_by:r.instance,returned:r.result,called_with:n,method:t,message:r.message,status:r.status}])}),[]),i=e.filter((function(e){return e.status===Nn.Error})).reduce((function(e,r){return e=St(e,[{executed_by:r.instance,called_with:n,name:t.name,message:r.message}])}),[]),o=e[0];return{method:t,called_with:n,returned:o.result,executed_by:o.instance,all_return_values:r,all_errors:i,message:o.message,status:o.status}},e.prototype.tryToAwaitForMethods=function(e,t,n){var r=this;return new Promise((function(i,o){if(0!==n.waitTimeoutMs)var a=0,s=setInterval((function(){a+=500;var u=r.getServerMethodsByFilterAndTarget(e,t);if(u.length>0)clearInterval(s),i(u);else if(a>=(n.waitTimeoutMs||1e4))return clearInterval(s),void o()}),500);else o()}))},e.prototype.filterByTarget=function(e,t){var n=this;if("string"!==typeof e){return(Array.isArray(e)?e:[e]).reduce((function(e,r){var i=t.filter((function(e){return n.instanceMatch(r,e.server.instance)}));return e.concat(i)}),[])}if("all"===e)return St(t);if("best"===e){var r=t.find((function(e){return e.server.instance.isLocal}));if(r)return[r];if(void 0!==t[0])return[t[0]]}else if("skipMine"===e)return t.filter((function(e){return e.server.instance.peerId!==n.instance.peerId}));return[]},e.prototype.instanceMatch=function(e,t){return this.containsProps(e,t)},e.prototype.methodMatch=function(e,t){return this.containsProps(e,t)},e.prototype.containsProps=function(e,t){return Object.keys(e).filter((function(t){return void 0!==e[t]&&"function"!==typeof e[t]&&"object_types"!==t&&"display_name"!==t&&"id"!==t&&"gatewayId"!==t&&"identifier"!==t&&"_"!==t[0]})).every((function(n){var r,i=e[n],o=t[n];switch(n){case"objectTypes":r=(i||[]).every((function(e){return(o||[]).includes(e)}));break;case"flags":r=function e(t,n){return Object.keys(n).every((function(r){return"object"===typeof n[r]?e((null===t||void 0===t?void 0:t[r])||{},n[r]||{}):n[r]===(null===t||void 0===t?void 0:t[r])}))}(o||{},i||{});break;default:r=String(i).toLowerCase()===String(o).toLowerCase()}return r}))},e.prototype.getMethods=function(e){var t=this;return void 0===e?this.repo.getMethods():this.repo.getMethods().filter((function(n){return t.methodMatch(e,n)}))},e.prototype.getMethodsForInstance=function(e){var t=this,n=this.repo.getServers().filter((function(n){return t.instanceMatch(e,n.instance)}));if(0===n.length)return[];var r={};return 1===n.length?r=n[0].methods:n.forEach((function(e){Object.keys(e.methods).forEach((function(t){var n=e.methods[t];r[n.identifier]=n}))})),Object.keys(r).map((function(e){return r[e]}))},e.prototype.getServers=function(e){var t=this,n=this.repo.getServers();return void 0===e?n.map((function(e){return{server:e,methods:[]}})):n.reduce((function(n,r){var i=Object.values(r.methods).filter((function(n){return t.methodMatch(e,n)}));return i.length>0&&n.push({server:r,methods:i}),n}),[])},e.prototype.getServerMethodsByFilterAndTarget=function(e,t){var n=this.getServers(e);return this.filterByTarget(t,n)},e}(),Bn=function(){function e(e,t,n){this.protocol=e,this.repoMethod=t,this.subscription=n}return Object.defineProperty(e.prototype,"stream",{get:function(){if(!this.repoMethod.stream)throw new Error("no stream");return this.repoMethod.stream},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"arguments",{get:function(){return this.subscription.arguments||{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"branchKey",{get:function(){return this.subscription.branchKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instance",{get:function(){if(!this.subscription.instance)throw new Error("no instance");return this.subscription.instance},enumerable:!0,configurable:!0}),e.prototype.close=function(){this.protocol.server.closeSingleSubscription(this.repoMethod,this.subscription)},e.prototype.push=function(e){this.protocol.server.pushDataToSingle(this.repoMethod,this.subscription,e)},e}(),Vn=function(){function e(e,t,n){this.protocol=e,this.repoMethod=t,this.requestContext=n,this.arguments=n.arguments,this.instance=n.instance}return e.prototype.accept=function(){this.protocol.server.acceptRequestOnBranch(this.requestContext,this.repoMethod,"")},e.prototype.acceptOnBranch=function(e){this.protocol.server.acceptRequestOnBranch(this.requestContext,this.repoMethod,e)},e.prototype.reject=function(e){this.protocol.server.rejectRequest(this.requestContext,this.repoMethod,e)},e}(),Hn=function(){function e(e,t){var n=this;this.protocol=e,this.server=t,e.server.onSubRequest((function(e,t){return n.handleSubRequest(e,t)})),e.server.onSubAdded((function(e,t){return n.handleSubAdded(e,t)})),e.server.onSubRemoved((function(e,t){return n.handleSubRemoved(e,t)}))}return e.prototype.handleSubRequest=function(e,t){if(t&&t.streamCallbacks&&"function"===typeof t.streamCallbacks.subscriptionRequestHandler){var n=new Vn(this.protocol,t,e);t.streamCallbacks.subscriptionRequestHandler(n)}},e.prototype.handleSubAdded=function(e,t){if(t&&t.streamCallbacks&&"function"===typeof t.streamCallbacks.subscriptionAddedHandler){var n=new Bn(this.protocol,t,e);t.streamCallbacks.subscriptionAddedHandler(n)}},e.prototype.handleSubRemoved=function(e,t){if(t&&t.streamCallbacks&&"function"===typeof t.streamCallbacks.subscriptionRemovedHandler){var n=new Bn(this.protocol,t,e);t.streamCallbacks.subscriptionRemovedHandler(n)}},e}(),zn=function(){function e(e,t,n){this.key=e,this.protocol=t,this.repoMethod=n}return e.prototype.subscriptions=function(){var e=this;return this.protocol.server.getSubscriptionList(this.repoMethod,this.key).map((function(t){return new Bn(e.protocol,e.repoMethod,t)}))},e.prototype.close=function(){this.protocol.server.closeAllSubscriptions(this.repoMethod,this.key)},e.prototype.push=function(e){this.protocol.server.pushData(this.repoMethod,e,[this.key])},e}(),qn=function(){function e(e,t,n){this._protocol=e,this._repoMethod=t,this._server=n,this.name=this._repoMethod.definition.name}return e.prototype.branches=function(e){var t=this,n=this._protocol.server.getBranchList(this._repoMethod);return e?n.indexOf(e)>-1?new zn(e,this._protocol,this._repoMethod):void 0:n.map((function(e){return new zn(e,t._protocol,t._repoMethod)}))},e.prototype.branch=function(e){return this.branches(e)},e.prototype.subscriptions=function(){var e=this;return this._protocol.server.getSubscriptionList(this._repoMethod).map((function(t){return new Bn(e._protocol,e._repoMethod,t)}))},Object.defineProperty(e.prototype,"definition",{get:function(){var e,t=this._repoMethod.definition;return{accepts:t.accepts,description:t.description,displayName:t.displayName,name:t.name,objectTypes:t.objectTypes,returns:t.returns,supportsStreaming:t.supportsStreaming,flags:null===(e=t.flags)||void 0===e?void 0:e.metadata}},enumerable:!0,configurable:!0}),e.prototype.close=function(){this._protocol.server.closeAllSubscriptions(this._repoMethod),this._server.unregister(this._repoMethod.definition,!0)},e.prototype.push=function(e,t){if("string"!==typeof t&&!Array.isArray(t)&&void 0!==t)throw new Error("invalid branches should be string or string array");if("object"!==typeof e)throw new Error("Invalid arguments. Data must be an object.");this._protocol.server.pushData(this._repoMethod,e,t)},e.prototype.updateRepoMethod=function(e){this._repoMethod=e},e}(),Gn=function(){function e(e,t){this.protocol=e,this.serverRepository=t,this.invocations=0,this.currentlyUnregistering={},this.streaming=new Hn(e,this),this.protocol.server.onInvoked(this.onMethodInvoked.bind(this))}return e.prototype.createStream=function(e,t,n,r,i){var o=this;return Wn(new Promise((function(n,r){if(e){var a;if(!(a="string"===typeof e?{name:""+e}:_t({},e)).name)return r("The \u201cname\u201d property is required for the \u201cstreamDefinition\u201d object and must be unique. Stream definition: "+JSON.stringify(a));if(o.serverRepository.getList().some((function(e){return e.definition.name===a.name})))return r('A stream with the name "'+a.name+'" already exists! Please, provide a unique name for the stream.');a.supportsStreaming=!0,t||(t={}),"function"!==typeof t.subscriptionRequestHandler&&(t.subscriptionRequestHandler=function(e){e.accept()});var s=o.serverRepository.add({definition:a,streamCallbacks:t,protocolState:{}});o.protocol.server.createStream(s).then((function(){var e;i?(e=i,i.updateRepoMethod(s)):e=new qn(o.protocol,s,o),s.stream=e,n(e)})).catch((function(e){s.repoId&&o.serverRepository.remove(s.repoId),r(e)}))}else r("The stream name must be unique! Please, provide either a unique string for a stream name to \u201cglue.interop.createStream()\u201d or a \u201cmethodDefinition\u201d object with a unique \u201cname\u201d property for the stream.")})),n,r)},e.prototype.register=function(e,t){var n=this;if(!e)return Promise.reject("Method definition is required. Please, provide either a unique string for a method name or a \u201cmethodDefinition\u201d object with a required \u201cname\u201d property.");if("function"!==typeof t)return Promise.reject("The second parameter must be a callback function. Method: "+("string"===typeof e?e:e.name));var r=function(e,r){return kt(n,void 0,void 0,(function(){var n,i,o;return xt(this,(function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),(n=t(e.args,e.instance))&&"function"===typeof n.then?[4,n]:[3,2];case 1:return i=a.sent(),r(void 0,i),[3,3];case 2:r(void 0,n),a.label=3;case 3:return[3,5];case 4:return(o=a.sent())||(o=""),r(o,o),[3,5];case 5:return[2]}}))}))};return r.userCallback=t,this.registerCore(e,r)},e.prototype.registerAsync=function(e,t){if(!e)return Promise.reject("Method definition is required. Please, provide either a unique string for a method name or a \u201cmethodDefinition\u201d object with a required \u201cname\u201d property.");if("function"!==typeof t)return Promise.reject("The second parameter must be a callback function. Method: "+("string"===typeof e?e:e.name));var n=function(e,n){try{var r=!1,i=function(e){r||n(void 0,e),r=!0},o=function(e){r||(e||(e=""),n(e,e)),r=!0},a=t(e.args,e.instance,i,o);a&&"function"===typeof a.then&&a.then(i).catch(o)}catch(s){n(s,void 0)}};return n.userCallbackAsync=t,this.registerCore(e,n)},e.prototype.unregister=function(e,t){return void 0===t&&(t=!1),kt(this,void 0,void 0,(function(){var n,r;return xt(this,(function(i){switch(i.label){case 0:return void 0===e?[2,Promise.reject("Please, provide either a unique string for a name or an object containing a \u201cname\u201d property.")]:"function"!==typeof e?[3,2]:[4,this.unregisterWithPredicate(e,t)];case 1:return i.sent(),[2];case 2:return void 0===(n="string"===typeof e?{name:e}:e).name?[2,Promise.reject("Method name is required. Cannot find a method if the method name is undefined!")]:(r=this.serverRepository.getList().find((function(e){return e.definition.name===n.name&&(e.definition.supportsStreaming||!1)===t})))?[4,this.removeMethodsOrStreams([r])]:[2,Promise.reject('Method with a name "'+n.name+'" does not exist or is not registered by your application!')];case 3:return i.sent(),[2]}}))}))},e.prototype.unregisterWithPredicate=function(e,t){return kt(this,void 0,void 0,(function(){var n;return xt(this,(function(r){switch(r.label){case 0:return(n=this.serverRepository.getList().filter((function(t){return e(t.definition)})).filter((function(e){return(e.definition.supportsStreaming||!1)===t})))&&0!==n.length?[4,this.removeMethodsOrStreams(n)]:[2,Promise.reject("Could not find a "+(t?"stream":"method")+" matching the specified condition!")];case 1:return r.sent(),[2]}}))}))},e.prototype.removeMethodsOrStreams=function(e){var t=this,n=[];return e.forEach((function(e){var r=t.protocol.server.unregister(e).then((function(){e.repoId&&t.serverRepository.remove(e.repoId)}));n.push(r),t.addAsCurrentlyUnregistering(e.definition.name,r)})),Promise.all(n)},e.prototype.addAsCurrentlyUnregistering=function(e,t){return kt(this,void 0,void 0,(function(){var n,r=this;return xt(this,(function(i){return n=new Promise((function(e){return setTimeout(e,5e3)})),this.currentlyUnregistering[e]=Promise.race([t,n]).then((function(){delete r.currentlyUnregistering[e]})),[2]}))}))},e.prototype.registerCore=function(e,t){return kt(this,void 0,void 0,(function(){var n,r,i,o=this;return xt(this,(function(a){switch(a.label){case 0:return(n="string"===typeof e?{name:""+e}:_t({},e)).name?(r=this.currentlyUnregistering[n.name])?[4,r]:[3,2]:[2,Promise.reject("Please, provide a (unique) string value for the \u201cname\u201d property in the \u201cmethodDefinition\u201d object: "+JSON.stringify(e))];case 1:a.sent(),a.label=2;case 2:return this.serverRepository.getList().some((function(e){return e.definition.name===n.name}))?[2,Promise.reject('A method with the name "'+n.name+'" already exists! Please, provide a unique name for the method.')]:n.supportsStreaming?[2,Promise.reject("When you create methods with \u201cglue.interop.register()\u201d or \u201cglue.interop.registerAsync()\u201d the property \u201csupportsStreaming\u201d cannot be \u201ctrue\u201d. If you want \u201c"+n.name+"\u201d to be a stream, please use the \u201cglue.interop.createStream()\u201d method.")]:(i=this.serverRepository.add({definition:n,theFunction:t,protocolState:{}}),[2,this.protocol.server.register(i).catch((function(e){throw(null===i||void 0===i?void 0:i.repoId)&&o.serverRepository.remove(i.repoId),e}))])}}))}))},e.prototype.onMethodInvoked=function(e,t,n){var r=this;e&&e.theFunction&&e.theFunction(n,(function(n,i){if(void 0!==n&&null!==n)if(n.message&&"string"===typeof n.message)n=n.message;else if("string"!==typeof n)try{n=JSON.stringify(n)}catch(o){n="un-stringifyable error in onMethodInvoked! Top level prop names: "+Object.keys(n)}i?("object"!==typeof i||Array.isArray(i))&&(i={_value:i}):i={},r.protocol.server.methodInvocationResult(e,t,n,i)}))},e}(),Jn=function(){function e(e,t,n){var r=this;this.wrapped={},this.wrapped.getMethods=function(){return e.methodsForInstance(this)},this.wrapped.getStreams=function(){return e.methodsForInstance(this).filter((function(e){return e.supportsStreaming}))},t&&this.refreshWrappedObject(t),n&&(n.loggedIn((function(){r.refresh(n)})),this.refresh(n))}return e.prototype.unwrap=function(){return this.wrapped},e.prototype.refresh=function(e){if(e){var t=null===e||void 0===e?void 0:e.resolvedIdentity,n=Object.assign({},null!==t&&void 0!==t?t:{},{peerId:null===e||void 0===e?void 0:e.peerId});this.refreshWrappedObject(n)}},e.prototype.refreshWrappedObject=function(e){var t,n,r;this.wrapped.user=e.user,this.wrapped.instance=e.instance,this.wrapped.application=null!==(t=e.application)&&void 0!==t?t:mn(),this.wrapped.applicationName=e.applicationName,this.wrapped.pid=null!==(r=null!==(n=e.pid)&&void 0!==n?n:e.process)&&void 0!==r?r:Math.floor(1e10*Math.random()),this.wrapped.machine=e.machine,this.wrapped.environment=e.environment,this.wrapped.region=e.region,this.wrapped.windowId=e.windowId,this.wrapped.isLocal=!0,this.wrapped.api=e.api,this.wrapped.service=e.service,this.wrapped.peerId=e.peerId},e}(),Kn=function(e){return _t(_t({},e),{flags:e.flags.metadata||{}})},Yn=function(){function e(e,t){this.logger=e,this.API=t,this.servers={},this.methodsCount={},this.callbacks=Gt();var n=this.API.instance.peerId;this.myServer={id:n,methods:{},instance:this.API.instance,wrapper:this.API.unwrappedInstance},this.servers[n]=this.myServer}return e.prototype.addServer=function(e,t){this.logger.debug("adding server "+t);var n=this.servers[t];if(n)return n.id;var r=new Jn(this.API,e),i={id:t,methods:{},instance:r.unwrap(),wrapper:r};return this.servers[t]=i,this.callbacks.execute("onServerAdded",i.instance),t},e.prototype.removeServerById=function(e,t){var n=this,r=this.servers[e];r?(this.logger.debug("removing server "+e),Object.keys(r.methods).forEach((function(t){n.removeServerMethod(e,t)})),delete this.servers[e],this.callbacks.execute("onServerRemoved",r.instance,t)):this.logger.warn("not aware of server "+e+", my state "+JSON.stringify(Object.keys(this.servers)))},e.prototype.addServerMethod=function(e,t){var n,r=this.servers[e];if(!r)throw new Error("server does not exists");if(!r.methods[t.id]){var i=this.createMethodIdentifier(t),o=this,a={identifier:i,gatewayId:t.id,name:t.name,displayName:t.display_name,description:t.description,version:t.version,objectTypes:t.object_types||[],accepts:t.input_signature,returns:t.result_signature,supportsStreaming:"undefined"!==typeof t.flags&&t.flags.streaming,flags:null!==(n=t.flags)&&void 0!==n?n:{},getServers:function(){return o.getServersByMethod(i)}};a.object_types=a.objectTypes,a.display_name=a.displayName,a.version=a.version,r.methods[t.id]=a;var s=Kn(a);return this.methodsCount[i]||(this.methodsCount[i]=0,this.callbacks.execute("onMethodAdded",s)),this.methodsCount[i]=this.methodsCount[i]+1,this.callbacks.execute("onServerMethodAdded",r.instance,s),a}},e.prototype.removeServerMethod=function(e,t){var n=this.servers[e];if(!n)throw new Error("server does not exists");var r=n.methods[t];delete n.methods[t];var i=Kn(r);this.methodsCount[r.identifier]=this.methodsCount[r.identifier]-1,0===this.methodsCount[r.identifier]&&this.callbacks.execute("onMethodRemoved",i),this.callbacks.execute("onServerMethodRemoved",n.instance,i)},e.prototype.getMethods=function(){return this.extractMethodsFromServers(Object.values(this.servers)).map(Kn)},e.prototype.getServers=function(){return Object.values(this.servers).map(this.hideServerMethodSystemFlags)},e.prototype.onServerAdded=function(e){var t=this.callbacks.add("onServerAdded",e),n=this.getServers().map((function(e){return e.instance}));return this.returnUnsubWithDelayedReplay(t,n,e)},e.prototype.onMethodAdded=function(e){var t=this.callbacks.add("onMethodAdded",e),n=this.getMethods();return this.returnUnsubWithDelayedReplay(t,n,e)},e.prototype.onServerMethodAdded=function(e){var t=this.callbacks.add("onServerMethodAdded",e),n=!1,r=this.getServers();return setTimeout((function(){r.forEach((function(t){var r=t.methods;Object.keys(r).forEach((function(i){n||e(t.instance,r[i])}))}))}),0),function(){n=!0,t()}},e.prototype.onMethodRemoved=function(e){return this.callbacks.add("onMethodRemoved",e)},e.prototype.onServerRemoved=function(e){return this.callbacks.add("onServerRemoved",e)},e.prototype.onServerMethodRemoved=function(e){return this.callbacks.add("onServerMethodRemoved",e)},e.prototype.getServerById=function(e){return this.hideServerMethodSystemFlags(this.servers[e])},e.prototype.reset=function(){var e,t=this;Object.keys(this.servers).forEach((function(e){t.removeServerById(e,"reset")})),this.servers=((e={})[this.myServer.id]=this.myServer,e),this.methodsCount={}},e.prototype.createMethodIdentifier=function(e){var t=void 0!==e.input_signature?e.input_signature:"",n=void 0!==e.result_signature?e.result_signature:"";return(e.name+t+n).toLowerCase()},e.prototype.getServersByMethod=function(e){var t=[];return Object.values(this.servers).forEach((function(n){Object.values(n.methods).forEach((function(r){r.identifier===e&&t.push(n.instance)}))})),t},e.prototype.returnUnsubWithDelayedReplay=function(e,t,n){var r=!1;return setTimeout((function(){t.forEach((function(e){r||n(e)}))}),0),function(){r=!0,e()}},e.prototype.hideServerMethodSystemFlags=function(e){var t={};return Object.entries(e.methods).forEach((function(e){var n=e[0],r=e[1];t[n]=Kn(r)})),_t(_t({},e),{methods:t})},e.prototype.extractMethodsFromServers=function(e){return Object.values(e).reduce((function(e,t){return St(e,Object.values(t.methods))}),[])},e}(),$n=function(){function e(){this.nextId=0,this.methods=[]}return e.prototype.add=function(e){return e.repoId=String(this.nextId),this.nextId+=1,this.methods.push(e),e},e.prototype.remove=function(e){if("string"!==typeof e)return new TypeError("Expecting a string");this.methods=this.methods.filter((function(t){return t.repoId!==e}))},e.prototype.getById=function(e){if("string"===typeof e)return this.methods.find((function(t){return t.repoId===e}))},e.prototype.getList=function(){return this.methods.map((function(e){return e}))},e.prototype.length=function(){return this.methods.length},e.prototype.reset=function(){this.methods=[]},e}(),Qn=function(){function e(e,t,n){var r=this;this.session=e,this.repository=t,this.serverRepository=n,this.ERR_URI_SUBSCRIPTION_FAILED="com.tick42.agm.errors.subscription.failure",this.callbacks=Gt(),this.nextStreamId=0,e.on("add-interest",(function(e){r.handleAddInterest(e)})),e.on("remove-interest",(function(e){r.handleRemoveInterest(e)}))}return e.prototype.acceptRequestOnBranch=function(e,t,n){if("string"!==typeof n&&(n=""),"object"!==typeof t.protocolState.subscriptionsMap)throw new TypeError("The streaming method is missing its subscriptions.");if(!Array.isArray(t.protocolState.branchKeyToStreamIdMap))throw new TypeError("The streaming method is missing its branches.");var r=this.getStreamId(t,n),i=e.msg.subscription_id,o={id:i,arguments:e.arguments,instance:e.instance,branchKey:n,streamId:r,subscribeMsg:e.msg};t.protocolState.subscriptionsMap[i]=o,this.session.sendFireAndForget({type:"accepted",subscription_id:i,stream_id:r}),this.callbacks.execute("onSubscriptionAdded",o,t)},e.prototype.rejectRequest=function(e,t,n){"string"!==typeof n&&(n=""),this.sendSubscriptionFailed("Subscription rejected by user. "+n,e.msg.subscription_id)},e.prototype.pushData=function(e,t,n){var r=this;if("object"===typeof e&&Array.isArray(e.protocolState.branchKeyToStreamIdMap)){if("object"!==typeof t)throw new Error("Invalid arguments. Data must be an object.");"string"===typeof n?n=[n]:(!Array.isArray(n)||n.length<=0)&&(n=[]),e.protocolState.branchKeyToStreamIdMap.filter((function(e){return!n||0===n.length||n.indexOf(e.key)>=0})).map((function(e){return e.streamId})).forEach((function(e){var n={type:"publish",stream_id:e,data:t};r.session.sendFireAndForget(n)}))}},e.prototype.pushDataToSingle=function(e,t,n){if("object"!==typeof n)throw new Error("Invalid arguments. Data must be an object.");var r={type:"post",subscription_id:t.id,data:n};this.session.sendFireAndForget(r)},e.prototype.closeSingleSubscription=function(e,t){e.protocolState.subscriptionsMap&&delete e.protocolState.subscriptionsMap[t.id];var n={type:"drop-subscription",subscription_id:t.id,reason:"Server dropping a single subscription"};this.session.sendFireAndForget(n);t.instance;this.callbacks.execute("onSubscriptionRemoved",t,e)},e.prototype.closeMultipleSubscriptions=function(e,t){var n=this;if("object"===typeof e&&"object"===typeof e.protocolState.subscriptionsMap&&e.protocolState.subscriptionsMap){var r=e.protocolState.subscriptionsMap,i=Object.keys(r).map((function(e){return r[e]}));"string"===typeof t&&(i=i.filter((function(e){return e.branchKey===t}))),i.forEach((function(e){delete r[e.id];var t={type:"drop-subscription",subscription_id:e.id,reason:"Server dropping all subscriptions on stream_id: "+e.streamId};n.session.sendFireAndForget(t)}))}},e.prototype.getSubscriptionList=function(e,t){if("object"!==typeof e)return[];if(!e.protocolState.subscriptionsMap)return[];var n=e.protocolState.subscriptionsMap,r=Object.keys(n).map((function(e){return n[e]}));return"string"!==typeof t?r:r.filter((function(e){return e.branchKey===t}))},e.prototype.getBranchList=function(e){if("object"!==typeof e)return[];if(!e.protocolState.subscriptionsMap)return[];var t=e.protocolState.subscriptionsMap,n=Object.keys(t).map((function(e){return t[e]})),r=[];return n.forEach((function(e){var t="";"object"===typeof e&&"string"===typeof e.branchKey&&(t=e.branchKey),-1===r.indexOf(t)&&r.push(t)})),r},e.prototype.onSubAdded=function(e){this.onSubscriptionLifetimeEvent("onSubscriptionAdded",e)},e.prototype.onSubRequest=function(e){this.onSubscriptionLifetimeEvent("onSubscriptionRequest",e)},e.prototype.onSubRemoved=function(e){this.onSubscriptionLifetimeEvent("onSubscriptionRemoved",e)},e.prototype.handleRemoveInterest=function(e){var t=this.serverRepository.getById(e.method_id);if("string"===typeof e.subscription_id&&"object"===typeof t&&t.protocolState.subscriptionsMap&&"object"===typeof t.protocolState.subscriptionsMap[e.subscription_id]){var n=t.protocolState.subscriptionsMap[e.subscription_id];delete t.protocolState.subscriptionsMap[e.subscription_id],this.callbacks.execute("onSubscriptionRemoved",n,t)}},e.prototype.onSubscriptionLifetimeEvent=function(e,t){this.callbacks.add(e,t)},e.prototype.getNextStreamId=function(){return this.nextStreamId+++""},e.prototype.handleAddInterest=function(e){var t=this.repository.getServerById(e.caller_id).instance,n={msg:e,arguments:e.arguments_kv||{},instance:t},r=this.serverRepository.getById(e.method_id);if(void 0!==r)r.protocolState.subscriptionsMap&&r.protocolState.subscriptionsMap[e.subscription_id]?this.sendSubscriptionFailed("A subscription with id "+e.subscription_id+" already exists.",e.subscription_id):this.callbacks.execute("onSubscriptionRequest",n,r);else{var i="No method with id "+e.method_id+" on this server.";this.sendSubscriptionFailed(i,e.subscription_id)}},e.prototype.sendSubscriptionFailed=function(e,t){var n={type:"error",reason_uri:this.ERR_URI_SUBSCRIPTION_FAILED,reason:e,request_id:t};this.session.sendFireAndForget(n)},e.prototype.getStreamId=function(e,t){if("string"!==typeof t&&(t=""),!e.protocolState.branchKeyToStreamIdMap)throw new Error("streaming "+e.definition.name+" method without protocol state");var n=e.protocolState.branchKeyToStreamIdMap.filter((function(e){return e.key===t}))[0],r=n?n.streamId:void 0;return"string"===typeof r&&""!==r||(r=this.getNextStreamId(),e.protocolState.branchKeyToStreamIdMap.push({key:t,streamId:r})),r},e}(),Xn=function(){function e(e,t,n,r){var i=this;this.session=e,this.clientRepository=t,this.serverRepository=n,this.logger=r,this.callbacks=Gt(),this.streaming=new Qn(e,t,n),this.session.on("invoke",(function(e){return i.handleInvokeMessage(e)}))}return e.prototype.createStream=function(e){return e.protocolState.subscriptionsMap={},e.protocolState.branchKeyToStreamIdMap=[],this.register(e,!0)},e.prototype.register=function(e,t){var n,r=this,i=e.definition,o=Object.assign({},{metadata:null!==(n=i.flags)&&void 0!==n?n:{}},{streaming:t||!1}),a={type:"register",methods:[{id:e.repoId,name:i.name,display_name:i.displayName,description:i.description,version:i.version,flags:o,object_types:i.objectTypes||i.object_types,input_signature:i.accepts,result_signature:i.returns,restrictions:void 0}]};return this.session.send(a,{methodId:e.repoId}).then((function(){r.logger.debug("registered method "+e.definition.name+" with id "+e.repoId)})).catch((function(t){throw r.logger.warn("failed to register method "+e.definition.name+" with id "+e.repoId+" - "+JSON.stringify(t)),t}))},e.prototype.onInvoked=function(e){this.callbacks.add("onInvoked",e)},e.prototype.methodInvocationResult=function(e,t,n,r){var i;i=n||""===n?{type:"error",request_id:t,reason_uri:"agm.errors.client_error",reason:n,context:r,peer_id:void 0}:{type:"yield",invocation_id:t,peer_id:this.session.peerId,result:r,request_id:void 0},this.session.sendFireAndForget(i)},e.prototype.unregister=function(e){return kt(this,void 0,void 0,(function(){var t;return xt(this,(function(n){switch(n.label){case 0:return t={type:"unregister",methods:[e.repoId]},[4,this.session.send(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.getBranchList=function(e){return this.streaming.getBranchList(e)},e.prototype.getSubscriptionList=function(e,t){return this.streaming.getSubscriptionList(e,t)},e.prototype.closeAllSubscriptions=function(e,t){this.streaming.closeMultipleSubscriptions(e,t)},e.prototype.pushData=function(e,t,n){this.streaming.pushData(e,t,n)},e.prototype.pushDataToSingle=function(e,t,n){this.streaming.pushDataToSingle(e,t,n)},e.prototype.closeSingleSubscription=function(e,t){this.streaming.closeSingleSubscription(e,t)},e.prototype.acceptRequestOnBranch=function(e,t,n){this.streaming.acceptRequestOnBranch(e,t,n)},e.prototype.rejectRequest=function(e,t,n){this.streaming.rejectRequest(e,t,n)},e.prototype.onSubRequest=function(e){this.streaming.onSubRequest(e)},e.prototype.onSubAdded=function(e){this.streaming.onSubAdded(e)},e.prototype.onSubRemoved=function(e){this.streaming.onSubRemoved(e)},e.prototype.handleInvokeMessage=function(e){var t=e.invocation_id,n=e.caller_id,r=e.method_id,i=e.arguments_kv,o=this.serverRepository.getList().filter((function(e){return e.repoId===r}))[0];if(void 0!==o){var a={args:i,instance:this.clientRepository.getServerById(n).instance};this.callbacks.execute("onInvoked",o,t,a)}},e}(),Zn=function(){function e(e,t){this.repository=e,this.subscriptionData=t}return Object.defineProperty(e.prototype,"requestArguments",{get:function(){return this.subscriptionData.params.arguments||{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"servers",{get:function(){var e=this;return this.subscriptionData.trackedServers.filter((function(e){return e.subscriptionId})).map((function(t){return e.repository.getServerById(t.serverId).instance}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverInstance",{get:function(){return this.servers[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stream",{get:function(){return this.subscriptionData.method},enumerable:!0,configurable:!0}),e.prototype.onData=function(e){if("function"!==typeof e)throw new TypeError("The data callback must be a function.");this.subscriptionData.handlers.onData.push(e),1===this.subscriptionData.handlers.onData.length&&this.subscriptionData.queued.data.length>0&&this.subscriptionData.queued.data.forEach((function(t){e(t)}))},e.prototype.onClosed=function(e){if("function"!==typeof e)throw new TypeError("The callback must be a function.");this.subscriptionData.handlers.onClosed.push(e)},e.prototype.onFailed=function(e){},e.prototype.onConnected=function(e){if("function"!==typeof e)throw new TypeError("The callback must be a function.");this.subscriptionData.handlers.onConnected.push(e)},e.prototype.close=function(){this.subscriptionData.close()},e.prototype.setNewSubscription=function(e){this.subscriptionData=e},e}(),er=function(){function e(e,t,n){var r=this;this.session=e,this.repository=t,this.logger=n,this.subscriptionsList={},this.subscriptionIdToLocalKeyMap={},this.nextSubLocalKey=0,this.handleErrorSubscribing=function(e){var t=e._tag,n=t.subLocalKey,i=r.subscriptionsList[n];if("object"===typeof i&&(i.trackedServers=i.trackedServers.filter((function(e){return e.serverId!==t.serverId})),i.trackedServers.length<=0)){if(clearTimeout(i.timeoutId),"awaitingAccept"===i.status){var o="string"===typeof e.reason&&""!==e.reason?' Publisher said "'+e.reason+'".':" No reason given.",a="object"===typeof i.params.arguments?JSON.stringify(i.params.arguments):"{}";i.error({message:"Subscription rejected."+o+" Called with:"+a,called_with:i.params.arguments,method:i.method})}else"subscribed"===i.status&&r.callOnClosedHandlers(i);delete r.subscriptionsList[n]}},this.handleSubscribed=function(e){var t=e._tag.subLocalKey,n=r.subscriptionsList[t];if("object"===typeof n){var i=e._tag.serverId,o=n.trackedServers.filter((function(e){return e.serverId===i}))[0];if("object"===typeof o){o.subscriptionId=e.subscription_id,r.subscriptionIdToLocalKeyMap[e.subscription_id]=t;var a="awaitingAccept"===n.status;if(n.status="subscribed",a){var s=!1,u=n.subscription;u?(u.setNewSubscription(n),n.success(u),s=!0):(u=new Zn(r.repository,n),n.subscription=u,n.success(u));for(var c=0,l=n.handlers.onConnected;c<l.length;c++){var d=l[c];try{d(u.serverInstance,s)}catch(f){}}}}}},this.handleEventData=function(e){var t=r.subscriptionIdToLocalKeyMap[e.subscription_id];if("undefined"!==typeof t){var n=r.subscriptionsList[t];if("object"===typeof n){var i=n.trackedServers.filter((function(t){return t.subscriptionId===e.subscription_id}));if(1===i.length){var o=e.oob,a=i[0].serverId,s=function(){return{data:e.data,server:r.repository.getServerById(a).instance,requestArguments:n.params.arguments,message:void 0,private:o}},u=n.handlers.onData,c=n.queued.data;u.length>0?u.forEach((function(e){"function"===typeof e&&e(s())})):c.push(s())}}}},this.handleSubscriptionCancelled=function(e){var t=r.subscriptionIdToLocalKeyMap[e.subscription_id];if("undefined"!==typeof t){var n=r.subscriptionsList[t];if("object"===typeof n){var i=n.trackedServers.length-1;n.trackedServers=n.trackedServers.filter((function(t){return t.subscriptionId!==e.subscription_id||(n.queued.closers.push(t.serverId),!1)})),n.trackedServers.length===i&&(n.trackedServers.length<=0&&(clearTimeout(n.timeoutId),r.callOnClosedHandlers(n),delete r.subscriptionsList[t]),delete r.subscriptionIdToLocalKeyMap[e.subscription_id])}}},e.on("subscribed",this.handleSubscribed),e.on("event",this.handleEventData),e.on("subscription-cancelled",this.handleSubscriptionCancelled)}return e.prototype.subscribe=function(e,t,n,r,i,o){var a=this;if(0!==n.length){var s=this.getNextSubscriptionLocalKey(),u=this.registerSubscription(s,e,t,r,i,t.methodResponseTimeout||1e4,o);"object"===typeof u?n.forEach((function(n){var r=n.server.id,i=n.methods.find((function(t){return t.name===e.name}));if(i){u.trackedServers.push({serverId:r,subscriptionId:void 0});var o={type:"subscribe",server_id:r,method_id:i.gatewayId,arguments_kv:t.arguments};a.session.send(o,{serverId:r,subLocalKey:s}).then((function(e){return a.handleSubscribed(e)})).catch((function(e){return a.handleErrorSubscribing(e)}))}else a.logger.error("can not find method "+e.name+" for target "+n.server.id)})):i({method:e,called_with:t.arguments,message:"Subscription failed. Unable to register the user callbacks."})}else i({method:e,called_with:t.arguments,message:"Subscription failed. No available servers matched the target params."})},e.prototype.drainSubscriptions=function(){var e=Object.values(this.subscriptionsList);return this.subscriptionsList={},this.subscriptionIdToLocalKeyMap={},e},e.prototype.getNextSubscriptionLocalKey=function(){var e=this.nextSubLocalKey;return this.nextSubLocalKey+=1,e},e.prototype.registerSubscription=function(e,t,n,r,i,o,a){var s=this,u={localKey:e,status:"awaitingAccept",method:t,params:n,success:r,error:i,trackedServers:[],handlers:{onData:(null===a||void 0===a?void 0:a.handlers.onData)||[],onClosed:(null===a||void 0===a?void 0:a.handlers.onClosed)||[],onConnected:(null===a||void 0===a?void 0:a.handlers.onConnected)||[]},queued:{data:[],closers:[]},timeoutId:void 0,close:function(){return s.closeSubscription(e)},subscription:null===a||void 0===a?void 0:a.subscription};return a||(n.onData&&u.handlers.onData.push(n.onData),n.onClosed&&u.handlers.onClosed.push(n.onClosed),n.onConnected&&u.handlers.onConnected.push(n.onConnected)),this.subscriptionsList[e]=u,u.timeoutId=setTimeout((function(){if(void 0!==s.subscriptionsList[e]){var r=s.subscriptionsList[e];"awaitingAccept"===r.status?(i({method:t,called_with:n.arguments,message:"Subscription failed. Subscription attempt timed out after "+o+" ms."}),delete s.subscriptionsList[e]):"subscribed"===r.status&&r.trackedServers.length>0&&(r.trackedServers=r.trackedServers.filter((function(e){return"undefined"!==typeof e.subscriptionId})),delete r.timeoutId,r.trackedServers.length<=0&&(s.callOnClosedHandlers(r),delete s.subscriptionsList[e]))}}),o),u},e.prototype.callOnClosedHandlers=function(e,t){var n,r=e.queued.closers.length,i=r>0?e.queued.closers[r-1]:null;void 0!==i&&"string"===typeof i&&(n=this.repository.getServerById(i).instance),e.handlers.onClosed.forEach((function(r){"function"===typeof r&&r({message:t||"ServerInitiated",requestArguments:e.params.arguments||{},server:n,stream:e.method})}))},e.prototype.closeSubscription=function(e){var t=this,n=this.subscriptionsList[e];"object"===typeof n&&(n.trackedServers.forEach((function(e){"undefined"!==typeof e.subscriptionId&&(n.queued.closers.push(e.serverId),t.session.sendFireAndForget({type:"unsubscribe",subscription_id:e.subscriptionId,reason_uri:"",reason:"ClientInitiated"}),delete t.subscriptionIdToLocalKeyMap[e.subscriptionId])})),n.trackedServers=[],this.callOnClosedHandlers(n,"ClientInitiated"),delete this.subscriptionsList[e])},e}(),tr=function(){function e(e,t,n){var r=this;this.session=e,this.repository=t,this.logger=n,e.on("peer-added",(function(e){return r.handlePeerAdded(e)})),e.on("peer-removed",(function(e){return r.handlePeerRemoved(e)})),e.on("methods-added",(function(e){return r.handleMethodsAddedMessage(e)})),e.on("methods-removed",(function(e){return r.handleMethodsRemovedMessage(e)})),this.streaming=new er(e,t,n)}return e.prototype.subscribe=function(e,t,n,r,i,o){this.streaming.subscribe(e,t,n,r,i,o)},e.prototype.invoke=function(e,t,n,r){var i=this,o=r.id,a={type:"call",server_id:o,method_id:t.gatewayId,arguments_kv:n};return this.session.send(a,{invocationId:e,serverId:o}).then((function(e){return i.handleResultMessage(e)})).catch((function(e){return i.handleInvocationError(e)}))},e.prototype.drainSubscriptions=function(){return this.streaming.drainSubscriptions()},e.prototype.handlePeerAdded=function(e){var t=e.new_peer_id,n=e.identity,r=!e.meta||e.meta.local,i=Number(n.process),o={machine:n.machine,pid:isNaN(i)?n.process:i,instance:n.instance,application:n.application,applicationName:n.applicationName,environment:n.environment,region:n.region,user:n.user,windowId:n.windowId,peerId:t,api:n.api,isLocal:r};this.repository.addServer(o,t)},e.prototype.handlePeerRemoved=function(e){var t=e.removed_id,n=e.reason;this.repository.removeServerById(t,n)},e.prototype.handleMethodsAddedMessage=function(e){var t=this,n=e.server_id;e.methods.forEach((function(e){t.repository.addServerMethod(n,e)}))},e.prototype.handleMethodsRemovedMessage=function(e){var t=this,n=e.server_id,r=e.methods,i=this.repository.getServerById(n);Object.keys(i.methods).forEach((function(e){var o=i.methods[e];r.indexOf(o.gatewayId)>-1&&t.repository.removeServerMethod(n,e)}))},e.prototype.handleResultMessage=function(e){var t=e._tag.invocationId,n=e.result,r=e._tag.serverId;return{invocationId:t,result:n,instance:this.repository.getServerById(r).instance,status:Nn.Success,message:""}},e.prototype.handleInvocationError=function(e){if(this.logger.debug("handle invocation error "+JSON.stringify(e)),"_tag"in e){var t=e._tag.invocationId,n=e._tag.serverId,r=this.repository.getServerById(n),i=e.reason;return{invocationId:t,result:e.context,instance:r.instance,status:Nn.Error,message:i}}return{invocationId:"",message:e.message,status:Nn.Error,error:e}},e}();function nr(e,t,n,r,i,o){var a,s=i.logger.subLogger("gw3-protocol"),u=new Promise((function(e){a=e})),c=t.domain("agm",["subscribed"]),l=new Xn(c,n,r,s.subLogger("server")),d=new tr(c,n,s.subLogger("client"));return c.onJoined((function(i){n.addServer(e,t.peerId),i?function(){s.info("reconnected - will replay registered methods and subscriptions");for(var e=0,t=d.drainSubscriptions();e<t.length;e++){var n=t[e],i=n.method,a=Object.assign({},n.params);s.info("trying to re-subscribe to method "+i.name),o.client.subscribe(i,a,void 0,void 0,n)}var u=r.getList();r.reset();for(var c=0,l=u;c<l.length;c++){var f=l[c],p=f.definition;s.info("re-publishing method "+p.name),f.stream?o.server.createStream(p,f.streamCallbacks,void 0,void 0,f.stream):f.theFunction&&f.theFunction.userCallback?o.register(p,f.theFunction.userCallback):f.theFunction&&f.theFunction.userCallbackAsync&&o.registerAsync(p,f.theFunction.userCallbackAsync)}}():a&&(a({client:d,server:l}),a=void 0)})),c.onLeft((function(){n.reset()})),c.join(),u}var rr=function(){function e(e){var t=this;if("undefined"===typeof e)throw new Error("configuration is required");if("undefined"===typeof e.connection)throw new Error("configuration.connections is required");var n,r=e.connection;if("number"!==typeof e.methodResponseTimeout&&(e.methodResponseTimeout=3e4),"number"!==typeof e.waitTimeoutMs&&(e.waitTimeoutMs=3e4),this.unwrappedInstance=new Jn(this,void 0,r),this.instance=this.unwrappedInstance.unwrap(),this.clientRepository=new Yn(e.logger.subLogger("cRep"),this),this.serverRepository=new $n,3!==r.protocolVersion)throw new Error("protocol "+r.protocolVersion+" not supported");n=nr(this.instance,r,this.clientRepository,this.serverRepository,e,this),this.readyPromise=n.then((function(n){return t.protocol=n,t.client=new Un(t.protocol,t.clientRepository,t.instance,e),t.server=new Gn(t.protocol,t.serverRepository),t}))}return e.prototype.ready=function(){return this.readyPromise},e.prototype.serverRemoved=function(e){return this.client.serverRemoved(e)},e.prototype.serverAdded=function(e){return this.client.serverAdded(e)},e.prototype.serverMethodRemoved=function(e){return this.client.serverMethodRemoved(e)},e.prototype.serverMethodAdded=function(e){return this.client.serverMethodAdded(e)},e.prototype.methodRemoved=function(e){return this.client.methodRemoved(e)},e.prototype.methodAdded=function(e){return this.client.methodAdded(e)},e.prototype.methodsForInstance=function(e){return this.client.methodsForInstance(e)},e.prototype.methods=function(e){return this.client.methods(e)},e.prototype.servers=function(e){return this.client.servers(e)},e.prototype.subscribe=function(e,t,n,r){return this.client.subscribe(e,t,n,r)},e.prototype.createStream=function(e,t,n,r){return this.server.createStream(e,t,n,r)},e.prototype.unregister=function(e){return this.server.unregister(e)},e.prototype.registerAsync=function(e,t){return this.server.registerAsync(e,t)},e.prototype.register=function(e,t){return this.server.register(e,t)},e.prototype.invoke=function(e,t,n,r,i,o){return this.client.invoke(e,t,n,r,i,o)},e.prototype.waitForMethod=function(e){var t=new $t,n=this.client.methodAdded((function(r){r.name===e&&(n(),t.resolve(r))}));return t.promise},e}(),ir=["subscribed","success"],or=function(){function e(e,t){var n=this;this.publish=function(e,t,r){var i=r||{},o=i.routingKey,a=i.target,s=n.removeEmptyValues({type:"publish",topic:e,data:t,peer_id:n.peerId,routing_key:o,target_identity:a});n.session.send(s)},this.subscribe=function(e,t,r){return new Promise((function(i,o){var a=r||{},s=a.routingKey,u=a.target,c=n.removeEmptyValues({type:"subscribe",topic:e,peer_id:n.peerId,routing_key:s,source:u});n.session.send(c).then((function(r){var o=r.subscription_id;n.subscriptions.push({subscription_id:o,topic:e,callback:t,source:u}),i({unsubscribe:function(){return n.session.send({type:"unsubscribe",subscription_id:o,peer_id:n.peerId}),n.subscriptions=n.subscriptions.filter((function(e){return e.subscription_id!==o})),Promise.resolve()}})})).catch((function(e){return o(e)}))}))},this.watchOnEvent=function(){n.session.on("event",(function(e){var t=e.data,r=e.subscription_id,i=e["publisher-identity"],o=n.subscriptions.find((function(e){return e.subscription_id===r}));o&&(o.source?n.keysMatch(o.source,i)&&o.callback(t,o.topic,i):o.callback(t,o.topic,i))}))},this.connection=e,this.logger=t,this.peerId=e.peerId,this.subscriptions=[],this.session=e.domain("bus",ir),this.readyPromise=this.session.join(),this.readyPromise.then((function(){n.watchOnEvent()}))}return e.prototype.ready=function(){return this.readyPromise},e.prototype.removeEmptyValues=function(e){var t={};return Object.keys(e).forEach((function(n){void 0!==e[n]&&null!==e[n]&&(t[n]=e[n])})),t},e.prototype.keysMatch=function(e,t){var n=Object.keys(e),r=!0;return n.forEach((function(n){e[n]!==t[n]&&(r=!1)})),r},e}(),ar=function e(t,n){var r,o=Yt.getGDMajorVersion(),a=Promise.resolve();if(o){if(o<3)throw new Error("GD v2 is not supported. Use v4 of the API to run in that context.");o>=3&&(r=window.glue42gd,a=window.gdPreloadPromise||a)}var s,u,c,l,d,f,p,h=Xt("glue"),g=function(e,t,n){var r,o,a,s,u,c;if(Yt.isNode()){var l=Object({NODE_ENV:"production",PUBLIC_URL:"/stocks",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0})._GD_STARTING_CONTEXT_;if(l)try{c=JSON.parse(l)}catch(v){}}function d(){if(e.application)return e.application;if(n)return n.applicationName;var t=mn();return Yt.isNode()?c?c.applicationConfig.name:"NodeJS"+t:"undefined"!==typeof window&&"undefined"!==typeof document?document.title+" ("+t+")":t}var f=function(){var r,o,a,s,u,l,f,p,h,g,v=e.gateway,y=null!==(r=null===v||void 0===v?void 0:v.protocolVersion)&&void 0!==r?r:3,m=null===v||void 0===v?void 0:v.reconnectInterval,b=null===v||void 0===v?void 0:v.reconnectAttempts,w=null===v||void 0===v?void 0:v.ws,_=null===v||void 0===v?void 0:v.sharedWorker,k=null===v||void 0===v?void 0:v.inproc,x=null!==(o=null===v||void 0===v?void 0:v.webPlatform)&&void 0!==o?o:void 0;n&&(w=n.gwURL),Yt.isNode()&&c&&c.gwURL&&(w=c.gwURL),w||_||k||(w="ws://localhost:8385");var S=d(),I=S;"undefined"!==typeof n?(f=n.windowId,p=n.pid,n.env&&(h=n.env.env,g=n.env.region),I=null!==(a=n.application)&&void 0!==a?a:"glue-app",l=n.appInstanceId):Yt.isNode()&&(p=i.pid,c&&(h=c.env,g=c.region,l=c.instanceId));var C=null!==(u=null===(s=e.gateway)||void 0===s?void 0:s.replaySpecs)&&void 0!==u?u:[];return C.push(Tn),{identity:{application:I,applicationName:S,windowId:f,instance:l,process:p,region:g,environment:h,api:t.version||"5.4.0"},reconnectInterval:m,ws:w,sharedWorker:_,webPlatform:x,inproc:k,protocolVersion:y,reconnectAttempts:b,replaySpecs:C}}(),p=d();if("undefined"!==typeof window){var h=window,g=h.htmlContainer?h.htmlContainer.containerName+"."+h.htmlContainer.application:null===(r=null===h||void 0===h?void 0:h.glue42gd)||void 0===r?void 0:r.application;g&&(p=g)}return{bus:null!==(o=e.bus)&&void 0!==o&&o,application:p,auth:function(){var t,n,r;return"string"===typeof e.auth?{token:e.auth}:e.auth?e.auth:Yt.isNode()&&c&&c.gwToken?{gatewayToken:c.gwToken}:(null===(t=e.gateway)||void 0===t?void 0:t.webPlatform)||(null===(n=e.gateway)||void 0===n?void 0:n.inproc)||(null===(r=e.gateway)||void 0===r?void 0:r.sharedWorker)?{username:"glue42",password:"glue42"}:void 0}(),logger:function(){var t,r,i,o=e.logger;return o||(o="warn"),n&&(i=n.consoleLogLevel),"string"===typeof o?{console:null!==i&&void 0!==i?i:o,publish:"warn"}:{console:null!==(t=null!==i&&void 0!==i?i:o.console)&&void 0!==t?t:"warn",publish:null!==(r=o.publish)&&void 0!==r?r:"warn"}}(),connection:f,metrics:null===(a=e.metrics)||void 0===a||a,contexts:null===(s=e.contexts)||void 0===s||s,version:t.version||"5.4.0",libs:null!==(u=t.libs)&&void 0!==u?u:[],customLogger:e.customLogger}}(t=t||{},n=n||{},r),v={};function y(t,n,r){(p=c.canPublish("trace"))&&c.trace("registering "+t+" module");var i=function(){n.initTime=r.stop(),n.initEndTime=r.endTime,n.marks=r.marks,p&&c.trace(t+" is ready - "+(r.endTime-r.startTime))};n.initStartTime=r.startTime,n.ready?n.ready().then((function(){i()})):i(),Array.isArray(t)||(t=[t]),t.forEach((function(t){v[t]=n,e[t]=n}))}function m(){var e,t,n,i,o=Xt("metrics"),a=g.metrics,u=null===r||void 0===r?void 0:r.getMetricsPublishingEnabled,d=g.connection.identity,f=u||function(){return!0},p=null!==(e="boolean"!==typeof a&&a.disableAutoAppSystem)&&void 0!==e&&e;return y("metrics",l=zt({connection:a?s:void 0,logger:c.subLogger("metrics"),canUpdateMetric:f,system:"Glue42",service:null!==(t=null===d||void 0===d?void 0:d.service)&&void 0!==t?t:"metrics-service",instance:null!==(i=null!==(n=null===d||void 0===d?void 0:d.instance)&&void 0!==n?n:null===d||void 0===d?void 0:d.windowId)&&void 0!==i?i:mn(),disableAutoAppSystem:p,pagePerformanceMetrics:"boolean"!==typeof a?null===a||void 0===a?void 0:a.pagePerformanceMetrics:void 0}),o),Promise.resolve()}function b(){var e=Xt("interop"),t={connection:s,logger:c.subLogger("interop")};return u=new rr(t),Cn.Interop=u,y(["interop","agm"],u,e),Promise.resolve()}function w(){var e=g.activities&&3===s.protocolVersion;if(g.contexts||e){var t=Xt("contexts");return y("contexts",d=new Dn({connection:s,logger:c.subLogger("contexts")}),t),d}var n=s.replayer;n&&n.drain(Tn.name)}function _(){return kt(this,void 0,void 0,(function(){var e;return xt(this,(function(t){return g.bus?(e=Xt("bus"),y("bus",f=new or(s,c.subLogger("bus")),e),[2,Promise.resolve()]):[2,Promise.resolve()]}))}))}function k(e){try{return e.forEach((function(e){!function(e,t){var n=Xt(e),r=t(v);r&&y(e,r,n)}(e.name,e.create)})),Promise.resolve()}catch(t){return Promise.reject(t)}}return a.then((function(){var e,t=Xt("logger");return(c=new Cn(""+(null===(e=g.connection.identity)||void 0===e?void 0:e.application),void 0,g.customLogger)).consoleLevel(g.logger.console),c.publishLevel(g.logger.publish),c.canPublish("debug")&&c.debug("initializing glue..."),y("logger",c,t),Promise.resolve(void 0)})).then((function(){var e=Xt("connection");s=new Sn(g.connection,c.subLogger("connection"));var t=Promise.resolve(g.auth);return g.connection&&!g.auth&&(t=r?r.getGWToken().then((function(e){return{gatewayToken:e}})):Promise.reject("You need to provide auth information")),t.then((function(t){var n;if(e.mark("auth-promise-resolved"),"[object Object]"!==Object.prototype.toString.call(t))throw new Error("Invalid auth object - "+JSON.stringify(t));return n=t,s.login(n)})).then((function(){return y("connection",s,e),g})).catch((function(e){throw s&&s.logout(),e}))})).then((function(){return Promise.all([m(),b(),w(),_()])})).then((function(){return u.readyPromise})).then((function(){return k(g.libs||[])})).then((function(){var e=Object.keys(v).map((function(e){var t=v[e];return t.ready?t.ready():Promise.resolve()}));return Promise.all(e)})).then((function(){var e={coreVersion:"5.4.0",version:g.version};h.stop();var i={feedback:function(e){u&&u.invoke("T42.ACS.Feedback",e,"best")},info:e,logger:c,interop:u,agm:u,connection:s,metrics:l,contexts:d,bus:f,version:g.version,userConfig:t,done:function(){return null===c||void 0===c||c.info("done called by user..."),s.logout()}};if(i.performance={get glueVer(){return g.version},get glueConfig(){return JSON.stringify(t)},get browser(){return window.performance.timing.toJSON()},get memory(){return window.performance.memory},get initTimes(){var e=Qt;return Object.keys(e).map((function(t){var n=e[t];return{name:t,duration:n.endTime-n.startTime,marks:n.marks}}))}},Object.keys(v).forEach((function(e){var t=v[e];i[e]=t})),i.config={},Object.keys(g).forEach((function(e){i.config[e]=g[e]})),n&&n.extOptions&&Object.keys(n.extOptions).forEach((function(e){i.config[e]=null===n||void 0===n?void 0:n.extOptions[e]})),(null===n||void 0===n?void 0:n.enrichGlue)&&n.enrichGlue(i),r&&r.updatePerfData&&r.updatePerfData(i.performance),i.agm){var o=function(e,t,n){return function(){return i.logger.warn("glue.js - 'glue.agm."+t+"' method is deprecated, use 'glue.interop."+n+"' instead."),e.apply(i.agm,arguments)}},a=i.agm;a.method_added=o(i.agm.methodAdded,"method_added","methodAdded"),a.method_removed=o(i.agm.methodRemoved,"method_removed","methodRemoved"),a.server_added=o(i.agm.serverAdded,"server_added","serverAdded"),a.server_method_aded=o(i.agm.serverMethodAdded,"server_method_aded","serverMethodAdded"),a.server_method_removed=o(i.agm.serverMethodRemoved,"server_method_removed","serverMethodRemoved")}return i})).catch((function(e){return Promise.reject({err:e,libs:v})}))};"undefined"!==typeof window&&(window.GlueCore=ar),ar.version="5.4.0",ar.default=ar;var sr,ur=(sr=ar,function(e){return f(void 0,void 0,void 0,c.a.mark((function t(){var n,r,i,o;return c.a.wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=h(e),!window.glue42gd){t.next=3;break}return t.abrupt("return",v(n));case 3:return g(),t.next=6,at((function(){return sr(n,{version:"2.0.5"})}),3e4,"Glue Web initialization timed out, because core didn't resolve");case 6:return r=t.sent,i=r.logger.subLogger("web.main.controller"),o=new mt(r),t.next=11,o.bridge.start(o.controllers);case 11:return i.trace("the bridge has been started, initializing all controllers"),t.next=14,Promise.all(Object.values(o.controllers).map((function(e){return e.start(r,o)})));case 14:return i.trace("all controllers reported started, starting all additional libraries"),t.next=17,Promise.all(n.libraries.map((function(e){return e(r,n)})));case 17:return i.trace("all libraries were started, glue is ready, returning it"),t.abrupt("return",r);case 19:case"end":return t.stop()}}),t)})))});if("undefined"!==typeof window){var cr=window;cr.GlueWeb=ur,delete cr.GlueCore}ur.version="2.0.5",t.a=ur}).call(this,n(13),n(18).Buffer,n(19))},function(e,t,n){e.exports=function(){"use strict";for(var e=function(e,t,n){return void 0===t&&(t=0),void 0===n&&(n=1),e<t?t:e>n?n:e},t={},n=0,r=["Boolean","Number","String","Function","Array","Date","RegExp","Undefined","Null"];n<r.length;n+=1){var i=r[n];t["[object "+i+"]"]=i.toLowerCase()}var o=function(e){return t[Object.prototype.toString.call(e)]||"object"},a=Math.PI,s={clip_rgb:function(t){t._clipped=!1,t._unclipped=t.slice(0);for(var n=0;n<=3;n++)n<3?((t[n]<0||t[n]>255)&&(t._clipped=!0),t[n]=e(t[n],0,255)):3===n&&(t[n]=e(t[n],0,1));return t},limit:e,type:o,unpack:function(e,t){return void 0===t&&(t=null),e.length>=3?Array.prototype.slice.call(e):"object"==o(e[0])&&t?t.split("").filter((function(t){return void 0!==e[0][t]})).map((function(t){return e[0][t]})):e[0]},last:function(e){if(e.length<2)return null;var t=e.length-1;return"string"==o(e[t])?e[t].toLowerCase():null},PI:a,TWOPI:2*a,PITHIRD:a/3,DEG2RAD:a/180,RAD2DEG:180/a},u={format:{},autodetect:[]},c=s.last,l=s.clip_rgb,d=s.type,f=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=this;if("object"===d(e[0])&&e[0].constructor&&e[0].constructor===this.constructor)return e[0];var r=c(e),i=!1;if(!r){i=!0,u.sorted||(u.autodetect=u.autodetect.sort((function(e,t){return t.p-e.p})),u.sorted=!0);for(var o=0,a=u.autodetect;o<a.length;o+=1){var s=a[o];if(r=s.test.apply(s,e))break}}if(!u.format[r])throw new Error("unknown format: "+e);var f=u.format[r].apply(null,i?e:e.slice(0,-1));n._rgb=l(f),3===n._rgb.length&&n._rgb.push(1)};f.prototype.toString=function(){return"function"==d(this.hex)?this.hex():"["+this._rgb.join(",")+"]"};var p=f,h=function e(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];return new(Function.prototype.bind.apply(e.Color,[null].concat(t)))};h.Color=p,h.version="2.1.0";var g=h,v=s.unpack,y=Math.max,m=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=v(e,"rgb"),r=n[0],i=n[1],o=n[2],a=1-y(r/=255,y(i/=255,o/=255)),s=a<1?1/(1-a):0,u=(1-r-a)*s,c=(1-i-a)*s,l=(1-o-a)*s;return[u,c,l,a]},b=s.unpack,w=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=b(e,"cmyk"))[0],r=e[1],i=e[2],o=e[3],a=e.length>4?e[4]:1;return 1===o?[0,0,0,a]:[n>=1?0:255*(1-n)*(1-o),r>=1?0:255*(1-r)*(1-o),i>=1?0:255*(1-i)*(1-o),a]},_=s.unpack,k=s.type;p.prototype.cmyk=function(){return m(this._rgb)},g.cmyk=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["cmyk"])))},u.format.cmyk=w,u.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=_(e,"cmyk"),"array"===k(e)&&4===e.length)return"cmyk"}});var x=s.unpack,S=s.last,I=function(e){return Math.round(100*e)/100},C=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=x(e,"hsla"),r=S(e)||"lsa";return n[0]=I(n[0]||0),n[1]=I(100*n[1])+"%",n[2]=I(100*n[2])+"%","hsla"===r||n.length>3&&n[3]<1?(n[3]=n.length>3?n[3]:1,r="hsla"):n.length=3,r+"("+n.join(",")+")"},T=s.unpack,P=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=T(e,"rgba"))[0],r=e[1],i=e[2];n/=255,r/=255,i/=255;var o,a,s=Math.min(n,r,i),u=Math.max(n,r,i),c=(u+s)/2;return u===s?(o=0,a=Number.NaN):o=c<.5?(u-s)/(u+s):(u-s)/(2-u-s),n==u?a=(r-i)/(u-s):r==u?a=2+(i-n)/(u-s):i==u&&(a=4+(n-r)/(u-s)),(a*=60)<0&&(a+=360),e.length>3&&void 0!==e[3]?[a,o,c,e[3]]:[a,o,c]},A=s.unpack,E=s.last,O=Math.round,M=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=A(e,"rgba"),r=E(e)||"rgb";return"hsl"==r.substr(0,3)?C(P(n),r):(n[0]=O(n[0]),n[1]=O(n[1]),n[2]=O(n[2]),("rgba"===r||n.length>3&&n[3]<1)&&(n[3]=n.length>3?n[3]:1,r="rgba"),r+"("+n.slice(0,"rgb"===r?3:4).join(",")+")")},j=s.unpack,R=Math.round,N=function(){for(var e,t=[],n=arguments.length;n--;)t[n]=arguments[n];var r,i,o,a=(t=j(t,"hsl"))[0],s=t[1],u=t[2];if(0===s)r=i=o=255*u;else{var c=[0,0,0],l=[0,0,0],d=u<.5?u*(1+s):u+s-u*s,f=2*u-d,p=a/360;c[0]=p+1/3,c[1]=p,c[2]=p-1/3;for(var h=0;h<3;h++)c[h]<0&&(c[h]+=1),c[h]>1&&(c[h]-=1),6*c[h]<1?l[h]=f+6*(d-f)*c[h]:2*c[h]<1?l[h]=d:3*c[h]<2?l[h]=f+(d-f)*(2/3-c[h])*6:l[h]=f;r=(e=[R(255*l[0]),R(255*l[1]),R(255*l[2])])[0],i=e[1],o=e[2]}return t.length>3?[r,i,o,t[3]]:[r,i,o,1]},L=/^rgb\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*\)$/,D=/^rgba\(\s*(-?\d+),\s*(-?\d+)\s*,\s*(-?\d+)\s*,\s*([01]|[01]?\.\d+)\)$/,W=/^rgb\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,F=/^rgba\(\s*(-?\d+(?:\.\d+)?)%,\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,U=/^hsl\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*\)$/,B=/^hsla\(\s*(-?\d+(?:\.\d+)?),\s*(-?\d+(?:\.\d+)?)%\s*,\s*(-?\d+(?:\.\d+)?)%\s*,\s*([01]|[01]?\.\d+)\)$/,V=Math.round,H=function(e){var t;if(e=e.toLowerCase().trim(),u.format.named)try{return u.format.named(e)}catch(g){}if(t=e.match(L)){for(var n=t.slice(1,4),r=0;r<3;r++)n[r]=+n[r];return n[3]=1,n}if(t=e.match(D)){for(var i=t.slice(1,5),o=0;o<4;o++)i[o]=+i[o];return i}if(t=e.match(W)){for(var a=t.slice(1,4),s=0;s<3;s++)a[s]=V(2.55*a[s]);return a[3]=1,a}if(t=e.match(F)){for(var c=t.slice(1,5),l=0;l<3;l++)c[l]=V(2.55*c[l]);return c[3]=+c[3],c}if(t=e.match(U)){var d=t.slice(1,4);d[1]*=.01,d[2]*=.01;var f=N(d);return f[3]=1,f}if(t=e.match(B)){var p=t.slice(1,4);p[1]*=.01,p[2]*=.01;var h=N(p);return h[3]=+t[4],h}};H.test=function(e){return L.test(e)||D.test(e)||W.test(e)||F.test(e)||U.test(e)||B.test(e)};var z=H,q=s.type;p.prototype.css=function(e){return M(this._rgb,e)},g.css=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["css"])))},u.format.css=z,u.autodetect.push({p:5,test:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(!t.length&&"string"===q(e)&&z.test(e))return"css"}});var G=s.unpack;u.format.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=G(e,"rgba");return n[0]*=255,n[1]*=255,n[2]*=255,n},g.gl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["gl"])))},p.prototype.gl=function(){var e=this._rgb;return[e[0]/255,e[1]/255,e[2]/255,e[3]]};var J=s.unpack,K=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,r=J(e,"rgb"),i=r[0],o=r[1],a=r[2],s=Math.min(i,o,a),u=Math.max(i,o,a),c=u-s,l=100*c/255,d=s/(255-c)*100;return 0===c?n=Number.NaN:(i===u&&(n=(o-a)/c),o===u&&(n=2+(a-i)/c),a===u&&(n=4+(i-o)/c),(n*=60)<0&&(n+=360)),[n,l,d]},Y=s.unpack,$=Math.floor,Q=function(){for(var e,t,n,r,i,o,a=[],s=arguments.length;s--;)a[s]=arguments[s];var u,c,l,d=(a=Y(a,"hcg"))[0],f=a[1],p=a[2];p*=255;var h=255*f;if(0===f)u=c=l=p;else{360===d&&(d=0),d>360&&(d-=360),d<0&&(d+=360);var g=$(d/=60),v=d-g,y=p*(1-f),m=y+h*(1-v),b=y+h*v,w=y+h;switch(g){case 0:u=(e=[w,b,y])[0],c=e[1],l=e[2];break;case 1:u=(t=[m,w,y])[0],c=t[1],l=t[2];break;case 2:u=(n=[y,w,b])[0],c=n[1],l=n[2];break;case 3:u=(r=[y,m,w])[0],c=r[1],l=r[2];break;case 4:u=(i=[b,y,w])[0],c=i[1],l=i[2];break;case 5:u=(o=[w,y,m])[0],c=o[1],l=o[2]}}return[u,c,l,a.length>3?a[3]:1]},X=s.unpack,Z=s.type;p.prototype.hcg=function(){return K(this._rgb)},g.hcg=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hcg"])))},u.format.hcg=Q,u.autodetect.push({p:1,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=X(e,"hcg"),"array"===Z(e)&&3===e.length)return"hcg"}});var ee=s.unpack,te=s.last,ne=Math.round,re=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=ee(e,"rgba"),r=n[0],i=n[1],o=n[2],a=n[3],s=te(e)||"auto";void 0===a&&(a=1),"auto"===s&&(s=a<1?"rgba":"rgb");var u=(r=ne(r))<<16|(i=ne(i))<<8|(o=ne(o)),c="000000"+u.toString(16);c=c.substr(c.length-6);var l="0"+ne(255*a).toString(16);switch(l=l.substr(l.length-2),s.toLowerCase()){case"rgba":return"#"+c+l;case"argb":return"#"+l+c;default:return"#"+c}},ie=/^#?([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,oe=/^#?([A-Fa-f0-9]{8}|[A-Fa-f0-9]{4})$/,ae=function(e){if(e.match(ie)){4!==e.length&&7!==e.length||(e=e.substr(1)),3===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]);var t=parseInt(e,16);return[t>>16,t>>8&255,255&t,1]}if(e.match(oe)){5!==e.length&&9!==e.length||(e=e.substr(1)),4===e.length&&(e=(e=e.split(""))[0]+e[0]+e[1]+e[1]+e[2]+e[2]+e[3]+e[3]);var n=parseInt(e,16);return[n>>24&255,n>>16&255,n>>8&255,Math.round((255&n)/255*100)/100]}throw new Error("unknown hex color: "+e)},se=s.type;p.prototype.hex=function(e){return re(this._rgb,e)},g.hex=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hex"])))},u.format.hex=ae,u.autodetect.push({p:4,test:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(!t.length&&"string"===se(e)&&[3,4,5,6,7,8,9].indexOf(e.length)>=0)return"hex"}});var ue=s.unpack,ce=s.TWOPI,le=Math.min,de=Math.sqrt,fe=Math.acos,pe=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,r=ue(e,"rgb"),i=r[0],o=r[1],a=r[2],s=le(i/=255,o/=255,a/=255),u=(i+o+a)/3,c=u>0?1-s/u:0;return 0===c?n=NaN:(n=(i-o+(i-a))/2,n/=de((i-o)*(i-o)+(i-a)*(o-a)),n=fe(n),a>o&&(n=ce-n),n/=ce),[360*n,c,u]},he=s.unpack,ge=s.limit,ve=s.TWOPI,ye=s.PITHIRD,me=Math.cos,be=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,r,i,o=(e=he(e,"hsi"))[0],a=e[1],s=e[2];return isNaN(o)&&(o=0),isNaN(a)&&(a=0),o>360&&(o-=360),o<0&&(o+=360),(o/=360)<1/3?r=1-((i=(1-a)/3)+(n=(1+a*me(ve*o)/me(ye-ve*o))/3)):o<2/3?i=1-((n=(1-a)/3)+(r=(1+a*me(ve*(o-=1/3))/me(ye-ve*o))/3)):n=1-((r=(1-a)/3)+(i=(1+a*me(ve*(o-=2/3))/me(ye-ve*o))/3)),[255*(n=ge(s*n*3)),255*(r=ge(s*r*3)),255*(i=ge(s*i*3)),e.length>3?e[3]:1]},we=s.unpack,_e=s.type;p.prototype.hsi=function(){return pe(this._rgb)},g.hsi=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hsi"])))},u.format.hsi=be,u.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=we(e,"hsi"),"array"===_e(e)&&3===e.length)return"hsi"}});var ke=s.unpack,xe=s.type;p.prototype.hsl=function(){return P(this._rgb)},g.hsl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hsl"])))},u.format.hsl=N,u.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=ke(e,"hsl"),"array"===xe(e)&&3===e.length)return"hsl"}});var Se=s.unpack,Ie=Math.min,Ce=Math.max,Te=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,r,i,o=(e=Se(e,"rgb"))[0],a=e[1],s=e[2],u=Ie(o,a,s),c=Ce(o,a,s),l=c-u;return i=c/255,0===c?(n=Number.NaN,r=0):(r=l/c,o===c&&(n=(a-s)/l),a===c&&(n=2+(s-o)/l),s===c&&(n=4+(o-a)/l),(n*=60)<0&&(n+=360)),[n,r,i]},Pe=s.unpack,Ae=Math.floor,Ee=function(){for(var e,t,n,r,i,o,a=[],s=arguments.length;s--;)a[s]=arguments[s];var u,c,l,d=(a=Pe(a,"hsv"))[0],f=a[1],p=a[2];if(p*=255,0===f)u=c=l=p;else{360===d&&(d=0),d>360&&(d-=360),d<0&&(d+=360);var h=Ae(d/=60),g=d-h,v=p*(1-f),y=p*(1-f*g),m=p*(1-f*(1-g));switch(h){case 0:u=(e=[p,m,v])[0],c=e[1],l=e[2];break;case 1:u=(t=[y,p,v])[0],c=t[1],l=t[2];break;case 2:u=(n=[v,p,m])[0],c=n[1],l=n[2];break;case 3:u=(r=[v,y,p])[0],c=r[1],l=r[2];break;case 4:u=(i=[m,v,p])[0],c=i[1],l=i[2];break;case 5:u=(o=[p,v,y])[0],c=o[1],l=o[2]}}return[u,c,l,a.length>3?a[3]:1]},Oe=s.unpack,Me=s.type;p.prototype.hsv=function(){return Te(this._rgb)},g.hsv=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hsv"])))},u.format.hsv=Ee,u.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Oe(e,"hsv"),"array"===Me(e)&&3===e.length)return"hsv"}});var je=18,Re=.95047,Ne=1,Le=1.08883,De=.137931034,We=.206896552,Fe=.12841855,Ue=.008856452,Be=s.unpack,Ve=Math.pow,He=function(e){return(e/=255)<=.04045?e/12.92:Ve((e+.055)/1.055,2.4)},ze=function(e){return e>Ue?Ve(e,1/3):e/Fe+De},qe=function(e,t,n){return e=He(e),t=He(t),n=He(n),[ze((.4124564*e+.3575761*t+.1804375*n)/Re),ze((.2126729*e+.7151522*t+.072175*n)/Ne),ze((.0193339*e+.119192*t+.9503041*n)/Le)]},Ge=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=Be(e,"rgb"),r=n[0],i=n[1],o=n[2],a=qe(r,i,o),s=a[0],u=a[1],c=a[2],l=116*u-16;return[l<0?0:l,500*(s-u),200*(u-c)]},Je=s.unpack,Ke=Math.pow,Ye=function(e){return 255*(e<=.00304?12.92*e:1.055*Ke(e,1/2.4)-.055)},$e=function(e){return e>We?e*e*e:Fe*(e-De)},Qe=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n,r,i,o=(e=Je(e,"lab"))[0],a=e[1],s=e[2];return r=(o+16)/116,n=isNaN(a)?r:r+a/500,i=isNaN(s)?r:r-s/200,r=Ne*$e(r),n=Re*$e(n),i=Le*$e(i),[Ye(3.2404542*n-1.5371385*r-.4985314*i),Ye(-.969266*n+1.8760108*r+.041556*i),Ye(.0556434*n-.2040259*r+1.0572252*i),e.length>3?e[3]:1]},Xe=s.unpack,Ze=s.type;p.prototype.lab=function(){return Ge(this._rgb)},g.lab=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["lab"])))},u.format.lab=Qe,u.autodetect.push({p:2,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Xe(e,"lab"),"array"===Ze(e)&&3===e.length)return"lab"}});var et=s.unpack,tt=s.RAD2DEG,nt=Math.sqrt,rt=Math.atan2,it=Math.round,ot=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=et(e,"lab"),r=n[0],i=n[1],o=n[2],a=nt(i*i+o*o),s=(rt(o,i)*tt+360)%360;return 0===it(1e4*a)&&(s=Number.NaN),[r,a,s]},at=s.unpack,st=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=at(e,"rgb"),r=n[0],i=n[1],o=n[2],a=Ge(r,i,o),s=a[0],u=a[1],c=a[2];return ot(s,u,c)},ut=s.unpack,ct=s.DEG2RAD,lt=Math.sin,dt=Math.cos,ft=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=ut(e,"lch"),r=n[0],i=n[1],o=n[2];return isNaN(o)&&(o=0),[r,dt(o*=ct)*i,lt(o)*i]},pt=s.unpack,ht=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=(e=pt(e,"lch"))[0],r=e[1],i=e[2],o=ft(n,r,i),a=o[0],s=o[1],u=o[2],c=Qe(a,s,u),l=c[0],d=c[1],f=c[2];return[l,d,f,e.length>3?e[3]:1]},gt=s.unpack,vt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=gt(e,"hcl").reverse();return ht.apply(void 0,n)},yt=s.unpack,mt=s.type;p.prototype.lch=function(){return st(this._rgb)},p.prototype.hcl=function(){return st(this._rgb).reverse()},g.lch=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["lch"])))},g.hcl=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["hcl"])))},u.format.lch=ht,u.format.hcl=vt,["lch","hcl"].forEach((function(e){return u.autodetect.push({p:2,test:function(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];if(t=yt(t,e),"array"===mt(t)&&3===t.length)return e}})}));var bt={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflower:"#6495ed",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkgrey:"#a9a9a9",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkslategrey:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",grey:"#808080",honeydew:"#f0fff0",hotpink:"#ff69b4",indianred:"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",laserlemon:"#ffff54",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrod:"#fafad2",lightgoldenrodyellow:"#fafad2",lightgray:"#d3d3d3",lightgreen:"#90ee90",lightgrey:"#d3d3d3",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",maroon2:"#7f0000",maroon3:"#b03060",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370db",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#db7093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",purple2:"#7f007f",purple3:"#a020f0",rebeccapurple:"#663399",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",slategrey:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},wt=s.type;p.prototype.name=function(){for(var e=re(this._rgb,"rgb"),t=0,n=Object.keys(bt);t<n.length;t+=1){var r=n[t];if(bt[r]===e)return r.toLowerCase()}return e},u.format.named=function(e){if(e=e.toLowerCase(),bt[e])return ae(bt[e]);throw new Error("unknown color name: "+e)},u.autodetect.push({p:5,test:function(e){for(var t=[],n=arguments.length-1;n-- >0;)t[n]=arguments[n+1];if(!t.length&&"string"===wt(e)&&bt[e.toLowerCase()])return"named"}});var _t=s.unpack,kt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=_t(e,"rgb"),r=n[0],i=n[1],o=n[2];return(r<<16)+(i<<8)+o},xt=s.type,St=function(e){if("number"==xt(e)&&e>=0&&e<=16777215)return[e>>16,e>>8&255,255&e,1];throw new Error("unknown num color: "+e)},It=s.type;p.prototype.num=function(){return kt(this._rgb)},g.num=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["num"])))},u.format.num=St,u.autodetect.push({p:5,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(1===e.length&&"number"===It(e[0])&&e[0]>=0&&e[0]<=16777215)return"num"}});var Ct=s.unpack,Tt=s.type,Pt=Math.round;p.prototype.rgb=function(e){return void 0===e&&(e=!0),!1===e?this._rgb.slice(0,3):this._rgb.slice(0,3).map(Pt)},p.prototype.rgba=function(e){return void 0===e&&(e=!0),this._rgb.slice(0,4).map((function(t,n){return n<3?!1===e?t:Pt(t):t}))},g.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["rgb"])))},u.format.rgb=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];var n=Ct(e,"rgba");return void 0===n[3]&&(n[3]=1),n},u.autodetect.push({p:3,test:function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];if(e=Ct(e,"rgba"),"array"===Tt(e)&&(3===e.length||4===e.length&&"number"==Tt(e[3])&&e[3]>=0&&e[3]<=1))return"rgb"}});var At=Math.log,Et=function(e){var t,n,r,i=e/100;return i<66?(t=255,n=-155.25485562709179-.44596950469579133*(n=i-2)+104.49216199393888*At(n),r=i<20?0:.8274096064007395*(r=i-10)-254.76935184120902+115.67994401066147*At(r)):(t=351.97690566805693+.114206453784165*(t=i-55)-40.25366309332127*At(t),n=325.4494125711974+.07943456536662342*(n=i-50)-28.0852963507957*At(n),r=255),[t,n,r,1]},Ot=s.unpack,Mt=Math.round,jt=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];for(var n,r=Ot(e,"rgb"),i=r[0],o=r[2],a=1e3,s=4e4,u=.4;s-a>u;){var c=Et(n=.5*(s+a));c[2]/c[0]>=o/i?s=n:a=n}return Mt(n)};p.prototype.temp=p.prototype.kelvin=p.prototype.temperature=function(){return jt(this._rgb)},g.temp=g.kelvin=g.temperature=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];return new(Function.prototype.bind.apply(p,[null].concat(e,["temp"])))},u.format.temp=u.format.kelvin=u.format.temperature=Et;var Rt=s.type;p.prototype.alpha=function(e,t){return void 0===t&&(t=!1),void 0!==e&&"number"===Rt(e)?t?(this._rgb[3]=e,this):new p([this._rgb[0],this._rgb[1],this._rgb[2],e],"rgb"):this._rgb[3]},p.prototype.clipped=function(){return this._rgb._clipped||!1},p.prototype.darken=function(e){void 0===e&&(e=1);var t=this.lab();return t[0]-=je*e,new p(t,"lab").alpha(this.alpha(),!0)},p.prototype.brighten=function(e){return void 0===e&&(e=1),this.darken(-e)},p.prototype.darker=p.prototype.darken,p.prototype.brighter=p.prototype.brighten,p.prototype.get=function(e){var t=e.split("."),n=t[0],r=t[1],i=this[n]();if(r){var o=n.indexOf(r);if(o>-1)return i[o];throw new Error("unknown channel "+r+" in mode "+n)}return i};var Nt=s.type,Lt=Math.pow;p.prototype.luminance=function(e){if(void 0!==e&&"number"===Nt(e)){if(0===e)return new p([0,0,0,this._rgb[3]],"rgb");if(1===e)return new p([255,255,255,this._rgb[3]],"rgb");var t=this.luminance(),n=20,r=function t(r,i){var o=r.interpolate(i,.5,"rgb"),a=o.luminance();return Math.abs(e-a)<1e-7||!n--?o:a>e?t(r,o):t(o,i)},i=(t>e?r(new p([0,0,0]),this):r(this,new p([255,255,255]))).rgb();return new p(i.concat([this._rgb[3]]))}return Dt.apply(void 0,this._rgb.slice(0,3))};var Dt=function(e,t,n){return.2126*(e=Wt(e))+.7152*(t=Wt(t))+.0722*(n=Wt(n))},Wt=function(e){return(e/=255)<=.03928?e/12.92:Lt((e+.055)/1.055,2.4)},Ft={},Ut=s.type,Bt=function(e,t,n){void 0===n&&(n=.5);for(var r=[],i=arguments.length-3;i-- >0;)r[i]=arguments[i+3];var o=r[0]||"lrgb";if(Ft[o]||r.length||(o=Object.keys(Ft)[0]),!Ft[o])throw new Error("interpolation mode "+o+" is not defined");return"object"!==Ut(e)&&(e=new p(e)),"object"!==Ut(t)&&(t=new p(t)),Ft[o](e,t,n).alpha(e.alpha()+n*(t.alpha()-e.alpha()))};p.prototype.mix=p.prototype.interpolate=function(e,t){void 0===t&&(t=.5);for(var n=[],r=arguments.length-2;r-- >0;)n[r]=arguments[r+2];return Bt.apply(void 0,[this,e,t].concat(n))},p.prototype.premultiply=function(e){void 0===e&&(e=!1);var t=this._rgb,n=t[3];return e?(this._rgb=[t[0]*n,t[1]*n,t[2]*n,n],this):new p([t[0]*n,t[1]*n,t[2]*n,n],"rgb")},p.prototype.saturate=function(e){void 0===e&&(e=1);var t=this.lch();return t[1]+=je*e,t[1]<0&&(t[1]=0),new p(t,"lch").alpha(this.alpha(),!0)},p.prototype.desaturate=function(e){return void 0===e&&(e=1),this.saturate(-e)};var Vt=s.type;p.prototype.set=function(e,t,n){void 0===n&&(n=!1);var r=e.split("."),i=r[0],o=r[1],a=this[i]();if(o){var s=i.indexOf(o);if(s>-1){if("string"==Vt(t))switch(t.charAt(0)){case"+":case"-":a[s]+=+t;break;case"*":a[s]*=+t.substr(1);break;case"/":a[s]/=+t.substr(1);break;default:a[s]=+t}else{if("number"!==Vt(t))throw new Error("unsupported value for Color.set");a[s]=t}var u=new p(a,i);return n?(this._rgb=u._rgb,this):u}throw new Error("unknown channel "+o+" in mode "+i)}return a},Ft.rgb=function(e,t,n){var r=e._rgb,i=t._rgb;return new p(r[0]+n*(i[0]-r[0]),r[1]+n*(i[1]-r[1]),r[2]+n*(i[2]-r[2]),"rgb")};var Ht=Math.sqrt,zt=Math.pow;Ft.lrgb=function(e,t,n){var r=e._rgb,i=r[0],o=r[1],a=r[2],s=t._rgb,u=s[0],c=s[1],l=s[2];return new p(Ht(zt(i,2)*(1-n)+zt(u,2)*n),Ht(zt(o,2)*(1-n)+zt(c,2)*n),Ht(zt(a,2)*(1-n)+zt(l,2)*n),"rgb")},Ft.lab=function(e,t,n){var r=e.lab(),i=t.lab();return new p(r[0]+n*(i[0]-r[0]),r[1]+n*(i[1]-r[1]),r[2]+n*(i[2]-r[2]),"lab")};var qt=function(e,t,n,r){var i,o,a,s,u,c,l,d,f,h,g,v;return"hsl"===r?(a=e.hsl(),s=t.hsl()):"hsv"===r?(a=e.hsv(),s=t.hsv()):"hcg"===r?(a=e.hcg(),s=t.hcg()):"hsi"===r?(a=e.hsi(),s=t.hsi()):"lch"!==r&&"hcl"!==r||(r="hcl",a=e.hcl(),s=t.hcl()),"h"===r.substr(0,1)&&(u=(i=a)[0],l=i[1],f=i[2],c=(o=s)[0],d=o[1],h=o[2]),isNaN(u)||isNaN(c)?isNaN(u)?isNaN(c)?v=Number.NaN:(v=c,1!=f&&0!=f||"hsv"==r||(g=d)):(v=u,1!=h&&0!=h||"hsv"==r||(g=l)):v=u+n*(c>u&&c-u>180?c-(u+360):c<u&&u-c>180?c+360-u:c-u),void 0===g&&(g=l+n*(d-l)),new p([v,g,f+n*(h-f)],r)},Gt=function(e,t,n){return qt(e,t,n,"lch")};Ft.lch=Gt,Ft.hcl=Gt,Ft.num=function(e,t,n){var r=e.num(),i=t.num();return new p(r+n*(i-r),"num")},Ft.hcg=function(e,t,n){return qt(e,t,n,"hcg")},Ft.hsi=function(e,t,n){return qt(e,t,n,"hsi")},Ft.hsl=function(e,t,n){return qt(e,t,n,"hsl")},Ft.hsv=function(e,t,n){return qt(e,t,n,"hsv")};var Jt=s.clip_rgb,Kt=Math.pow,Yt=Math.sqrt,$t=Math.PI,Qt=Math.cos,Xt=Math.sin,Zt=Math.atan2,en=function(e,t){for(var n=e.length,r=[0,0,0,0],i=0;i<e.length;i++){var o=e[i],a=t[i]/n,s=o._rgb;r[0]+=Kt(s[0],2)*a,r[1]+=Kt(s[1],2)*a,r[2]+=Kt(s[2],2)*a,r[3]+=s[3]*a}return r[0]=Yt(r[0]),r[1]=Yt(r[1]),r[2]=Yt(r[2]),r[3]>.9999999&&(r[3]=1),new p(Jt(r))},tn=s.type,nn=Math.pow,rn=function(e){var t="rgb",n=g("#ccc"),r=0,i=[0,1],o=[],a=[0,0],s=!1,u=[],c=!1,l=0,d=1,f=!1,p={},h=!0,v=1,y=function(e){if((e=e||["#fff","#000"])&&"string"===tn(e)&&g.brewer&&g.brewer[e.toLowerCase()]&&(e=g.brewer[e.toLowerCase()]),"array"===tn(e)){1===e.length&&(e=[e[0],e[0]]),e=e.slice(0);for(var t=0;t<e.length;t++)e[t]=g(e[t]);o.length=0;for(var n=0;n<e.length;n++)o.push(n/(e.length-1))}return _(),u=e},m=function(e){return e},b=function(e){return e},w=function(e,r){var i,c;if(null==r&&(r=!1),isNaN(e)||null===e)return n;c=r?e:s&&s.length>2?function(e){if(null!=s){for(var t=s.length-1,n=0;n<t&&e>=s[n];)n++;return n-1}return 0}(e)/(s.length-2):d!==l?(e-l)/(d-l):1,c=b(c),r||(c=m(c)),1!==v&&(c=nn(c,v)),c=a[0]+c*(1-a[0]-a[1]),c=Math.min(1,Math.max(0,c));var f=Math.floor(1e4*c);if(h&&p[f])i=p[f];else{if("array"===tn(u))for(var y=0;y<o.length;y++){var w=o[y];if(c<=w){i=u[y];break}if(c>=w&&y===o.length-1){i=u[y];break}if(c>w&&c<o[y+1]){c=(c-w)/(o[y+1]-w),i=g.interpolate(u[y],u[y+1],c,t);break}}else"function"===tn(u)&&(i=u(c));h&&(p[f]=i)}return i},_=function(){return p={}};y(e);var k=function(e){var t=g(w(e));return c&&t[c]?t[c]():t};return k.classes=function(e){if(null!=e){if("array"===tn(e))s=e,i=[e[0],e[e.length-1]];else{var t=g.analyze(i);s=0===e?[t.min,t.max]:g.limits(t,"e",e)}return k}return s},k.domain=function(e){if(!arguments.length)return i;l=e[0],d=e[e.length-1],o=[];var t=u.length;if(e.length===t&&l!==d)for(var n=0,r=Array.from(e);n<r.length;n+=1){var a=r[n];o.push((a-l)/(d-l))}else{for(var s=0;s<t;s++)o.push(s/(t-1));if(e.length>2){var c=e.map((function(t,n){return n/(e.length-1)})),f=e.map((function(e){return(e-l)/(d-l)}));f.every((function(e,t){return c[t]===e}))||(b=function(e){if(e<=0||e>=1)return e;for(var t=0;e>=f[t+1];)t++;var n=(e-f[t])/(f[t+1]-f[t]);return c[t]+n*(c[t+1]-c[t])})}}return i=[l,d],k},k.mode=function(e){return arguments.length?(t=e,_(),k):t},k.range=function(e,t){return y(e),k},k.out=function(e){return c=e,k},k.spread=function(e){return arguments.length?(r=e,k):r},k.correctLightness=function(e){return null==e&&(e=!0),f=e,_(),m=f?function(e){for(var t=w(0,!0).lab()[0],n=w(1,!0).lab()[0],r=t>n,i=w(e,!0).lab()[0],o=t+(n-t)*e,a=i-o,s=0,u=1,c=20;Math.abs(a)>.01&&c-- >0;)r&&(a*=-1),a<0?(s=e,e+=.5*(u-e)):(u=e,e+=.5*(s-e)),i=w(e,!0).lab()[0],a=i-o;return e}:function(e){return e},k},k.padding=function(e){return null!=e?("number"===tn(e)&&(e=[e,e]),a=e,k):a},k.colors=function(t,n){arguments.length<2&&(n="hex");var r=[];if(0===arguments.length)r=u.slice(0);else if(1===t)r=[k(.5)];else if(t>1){var o=i[0],a=i[1]-o;r=on(0,t,!1).map((function(e){return k(o+e/(t-1)*a)}))}else{e=[];var c=[];if(s&&s.length>2)for(var l=1,d=s.length,f=1<=d;f?l<d:l>d;f?l++:l--)c.push(.5*(s[l-1]+s[l]));else c=i;r=c.map((function(e){return k(e)}))}return g[n]&&(r=r.map((function(e){return e[n]()}))),r},k.cache=function(e){return null!=e?(h=e,k):h},k.gamma=function(e){return null!=e?(v=e,k):v},k.nodata=function(e){return null!=e?(n=g(e),k):n},k};function on(e,t,n){for(var r=[],i=e<t,o=n?i?t+1:t-1:t,a=e;i?a<o:a>o;i?a++:a--)r.push(a);return r}var an=function e(t){var n,r,i,o,a,s,u;if(2===(t=t.map((function(e){return new p(e)}))).length)n=t.map((function(e){return e.lab()})),a=n[0],s=n[1],o=function(e){var t=[0,1,2].map((function(t){return a[t]+e*(s[t]-a[t])}));return new p(t,"lab")};else if(3===t.length)r=t.map((function(e){return e.lab()})),a=r[0],s=r[1],u=r[2],o=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*a[t]+2*(1-e)*e*s[t]+e*e*u[t]}));return new p(t,"lab")};else if(4===t.length){var c;i=t.map((function(e){return e.lab()})),a=i[0],s=i[1],u=i[2],c=i[3],o=function(e){var t=[0,1,2].map((function(t){return(1-e)*(1-e)*(1-e)*a[t]+3*(1-e)*(1-e)*e*s[t]+3*(1-e)*e*e*u[t]+e*e*e*c[t]}));return new p(t,"lab")}}else if(5===t.length){var l=e(t.slice(0,3)),d=e(t.slice(2,5));o=function(e){return e<.5?l(2*e):d(2*(e-.5))}}return o},sn=function e(t,n,r){if(!e[r])throw new Error("unknown blend mode "+r);return e[r](t,n)},un=function(e){return function(t,n){var r=g(n).rgb(),i=g(t).rgb();return g.rgb(e(r,i))}},cn=function(e){return function(t,n){var r=[];return r[0]=e(t[0],n[0]),r[1]=e(t[1],n[1]),r[2]=e(t[2],n[2]),r}};sn.normal=un(cn((function(e){return e}))),sn.multiply=un(cn((function(e,t){return e*t/255}))),sn.screen=un(cn((function(e,t){return 255*(1-(1-e/255)*(1-t/255))}))),sn.overlay=un(cn((function(e,t){return t<128?2*e*t/255:255*(1-2*(1-e/255)*(1-t/255))}))),sn.darken=un(cn((function(e,t){return e>t?t:e}))),sn.lighten=un(cn((function(e,t){return e>t?e:t}))),sn.dodge=un(cn((function(e,t){return 255===e||(e=t/255*255/(1-e/255))>255?255:e}))),sn.burn=un(cn((function(e,t){return 255*(1-(1-t/255)/(e/255))})));for(var ln=sn,dn=s.type,fn=s.clip_rgb,pn=s.TWOPI,hn=Math.pow,gn=Math.sin,vn=Math.cos,yn=Math.floor,mn=Math.random,bn=Math.log,wn=Math.pow,_n=Math.floor,kn=Math.abs,xn=function(e,t){void 0===t&&(t=null);var n={min:Number.MAX_VALUE,max:-1*Number.MAX_VALUE,sum:0,values:[],count:0};return"object"===o(e)&&(e=Object.values(e)),e.forEach((function(e){t&&"object"===o(e)&&(e=e[t]),void 0===e||null===e||isNaN(e)||(n.values.push(e),n.sum+=e,e<n.min&&(n.min=e),e>n.max&&(n.max=e),n.count+=1)})),n.domain=[n.min,n.max],n.limits=function(e,t){return Sn(n,e,t)},n},Sn=function(e,t,n){void 0===t&&(t="equal"),void 0===n&&(n=7),"array"==o(e)&&(e=xn(e));var r=e.min,i=e.max,a=e.values.sort((function(e,t){return e-t}));if(1===n)return[r,i];var s=[];if("c"===t.substr(0,1)&&(s.push(r),s.push(i)),"e"===t.substr(0,1)){s.push(r);for(var u=1;u<n;u++)s.push(r+u/n*(i-r));s.push(i)}else if("l"===t.substr(0,1)){if(r<=0)throw new Error("Logarithmic scales are only possible for values > 0");var c=Math.LOG10E*bn(r),l=Math.LOG10E*bn(i);s.push(r);for(var d=1;d<n;d++)s.push(wn(10,c+d/n*(l-c)));s.push(i)}else if("q"===t.substr(0,1)){s.push(r);for(var f=1;f<n;f++){var p=(a.length-1)*f/n,h=_n(p);if(h===p)s.push(a[h]);else{var g=p-h;s.push(a[h]*(1-g)+a[h+1]*g)}}s.push(i)}else if("k"===t.substr(0,1)){var v,y=a.length,m=new Array(y),b=new Array(n),w=!0,_=0,k=null;(k=[]).push(r);for(var x=1;x<n;x++)k.push(r+x/n*(i-r));for(k.push(i);w;){for(var S=0;S<n;S++)b[S]=0;for(var I=0;I<y;I++)for(var C=a[I],T=Number.MAX_VALUE,P=void 0,A=0;A<n;A++){var E=kn(k[A]-C);E<T&&(T=E,P=A),b[P]++,m[I]=P}for(var O=new Array(n),M=0;M<n;M++)O[M]=null;for(var j=0;j<y;j++)null===O[v=m[j]]?O[v]=a[j]:O[v]+=a[j];for(var R=0;R<n;R++)O[R]*=1/b[R];w=!1;for(var N=0;N<n;N++)if(O[N]!==k[N]){w=!0;break}k=O,++_>200&&(w=!1)}for(var L={},D=0;D<n;D++)L[D]=[];for(var W=0;W<y;W++)L[v=m[W]].push(a[W]);for(var F=[],U=0;U<n;U++)F.push(L[U][0]),F.push(L[U][L[U].length-1]);F=F.sort((function(e,t){return e-t})),s.push(F[0]);for(var B=1;B<F.length;B+=2){var V=F[B];isNaN(V)||-1!==s.indexOf(V)||s.push(V)}}return s},In={analyze:xn,limits:Sn},Cn=Math.sqrt,Tn=Math.atan2,Pn=Math.abs,An=Math.cos,En=Math.PI,On={cool:function(){return rn([g.hsl(180,1,.9),g.hsl(250,.7,.4)])},hot:function(){return rn(["#000","#f00","#ff0","#fff"]).mode("rgb")}},Mn={OrRd:["#fff7ec","#fee8c8","#fdd49e","#fdbb84","#fc8d59","#ef6548","#d7301f","#b30000","#7f0000"],PuBu:["#fff7fb","#ece7f2","#d0d1e6","#a6bddb","#74a9cf","#3690c0","#0570b0","#045a8d","#023858"],BuPu:["#f7fcfd","#e0ecf4","#bfd3e6","#9ebcda","#8c96c6","#8c6bb1","#88419d","#810f7c","#4d004b"],Oranges:["#fff5eb","#fee6ce","#fdd0a2","#fdae6b","#fd8d3c","#f16913","#d94801","#a63603","#7f2704"],BuGn:["#f7fcfd","#e5f5f9","#ccece6","#99d8c9","#66c2a4","#41ae76","#238b45","#006d2c","#00441b"],YlOrBr:["#ffffe5","#fff7bc","#fee391","#fec44f","#fe9929","#ec7014","#cc4c02","#993404","#662506"],YlGn:["#ffffe5","#f7fcb9","#d9f0a3","#addd8e","#78c679","#41ab5d","#238443","#006837","#004529"],Reds:["#fff5f0","#fee0d2","#fcbba1","#fc9272","#fb6a4a","#ef3b2c","#cb181d","#a50f15","#67000d"],RdPu:["#fff7f3","#fde0dd","#fcc5c0","#fa9fb5","#f768a1","#dd3497","#ae017e","#7a0177","#49006a"],Greens:["#f7fcf5","#e5f5e0","#c7e9c0","#a1d99b","#74c476","#41ab5d","#238b45","#006d2c","#00441b"],YlGnBu:["#ffffd9","#edf8b1","#c7e9b4","#7fcdbb","#41b6c4","#1d91c0","#225ea8","#253494","#081d58"],Purples:["#fcfbfd","#efedf5","#dadaeb","#bcbddc","#9e9ac8","#807dba","#6a51a3","#54278f","#3f007d"],GnBu:["#f7fcf0","#e0f3db","#ccebc5","#a8ddb5","#7bccc4","#4eb3d3","#2b8cbe","#0868ac","#084081"],Greys:["#ffffff","#f0f0f0","#d9d9d9","#bdbdbd","#969696","#737373","#525252","#252525","#000000"],YlOrRd:["#ffffcc","#ffeda0","#fed976","#feb24c","#fd8d3c","#fc4e2a","#e31a1c","#bd0026","#800026"],PuRd:["#f7f4f9","#e7e1ef","#d4b9da","#c994c7","#df65b0","#e7298a","#ce1256","#980043","#67001f"],Blues:["#f7fbff","#deebf7","#c6dbef","#9ecae1","#6baed6","#4292c6","#2171b5","#08519c","#08306b"],PuBuGn:["#fff7fb","#ece2f0","#d0d1e6","#a6bddb","#67a9cf","#3690c0","#02818a","#016c59","#014636"],Viridis:["#440154","#482777","#3f4a8a","#31678e","#26838f","#1f9d8a","#6cce5a","#b6de2b","#fee825"],Spectral:["#9e0142","#d53e4f","#f46d43","#fdae61","#fee08b","#ffffbf","#e6f598","#abdda4","#66c2a5","#3288bd","#5e4fa2"],RdYlGn:["#a50026","#d73027","#f46d43","#fdae61","#fee08b","#ffffbf","#d9ef8b","#a6d96a","#66bd63","#1a9850","#006837"],RdBu:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#f7f7f7","#d1e5f0","#92c5de","#4393c3","#2166ac","#053061"],PiYG:["#8e0152","#c51b7d","#de77ae","#f1b6da","#fde0ef","#f7f7f7","#e6f5d0","#b8e186","#7fbc41","#4d9221","#276419"],PRGn:["#40004b","#762a83","#9970ab","#c2a5cf","#e7d4e8","#f7f7f7","#d9f0d3","#a6dba0","#5aae61","#1b7837","#00441b"],RdYlBu:["#a50026","#d73027","#f46d43","#fdae61","#fee090","#ffffbf","#e0f3f8","#abd9e9","#74add1","#4575b4","#313695"],BrBG:["#543005","#8c510a","#bf812d","#dfc27d","#f6e8c3","#f5f5f5","#c7eae5","#80cdc1","#35978f","#01665e","#003c30"],RdGy:["#67001f","#b2182b","#d6604d","#f4a582","#fddbc7","#ffffff","#e0e0e0","#bababa","#878787","#4d4d4d","#1a1a1a"],PuOr:["#7f3b08","#b35806","#e08214","#fdb863","#fee0b6","#f7f7f7","#d8daeb","#b2abd2","#8073ac","#542788","#2d004b"],Set2:["#66c2a5","#fc8d62","#8da0cb","#e78ac3","#a6d854","#ffd92f","#e5c494","#b3b3b3"],Accent:["#7fc97f","#beaed4","#fdc086","#ffff99","#386cb0","#f0027f","#bf5b17","#666666"],Set1:["#e41a1c","#377eb8","#4daf4a","#984ea3","#ff7f00","#ffff33","#a65628","#f781bf","#999999"],Set3:["#8dd3c7","#ffffb3","#bebada","#fb8072","#80b1d3","#fdb462","#b3de69","#fccde5","#d9d9d9","#bc80bd","#ccebc5","#ffed6f"],Dark2:["#1b9e77","#d95f02","#7570b3","#e7298a","#66a61e","#e6ab02","#a6761d","#666666"],Paired:["#a6cee3","#1f78b4","#b2df8a","#33a02c","#fb9a99","#e31a1c","#fdbf6f","#ff7f00","#cab2d6","#6a3d9a","#ffff99","#b15928"],Pastel2:["#b3e2cd","#fdcdac","#cbd5e8","#f4cae4","#e6f5c9","#fff2ae","#f1e2cc","#cccccc"],Pastel1:["#fbb4ae","#b3cde3","#ccebc5","#decbe4","#fed9a6","#ffffcc","#e5d8bd","#fddaec","#f2f2f2"]},jn=0,Rn=Object.keys(Mn);jn<Rn.length;jn+=1){var Nn=Rn[jn];Mn[Nn.toLowerCase()]=Mn[Nn]}var Ln=Mn;return g.average=function(e,t,n){void 0===t&&(t="lrgb"),void 0===n&&(n=null);var r=e.length;n||(n=Array.from(new Array(r)).map((function(){return 1})));var i=r/n.reduce((function(e,t){return e+t}));if(n.forEach((function(e,t){n[t]*=i})),e=e.map((function(e){return new p(e)})),"lrgb"===t)return en(e,n);for(var o=e.shift(),a=o.get(t),s=[],u=0,c=0,l=0;l<a.length;l++)if(a[l]=(a[l]||0)*n[0],s.push(isNaN(a[l])?0:n[0]),"h"===t.charAt(l)&&!isNaN(a[l])){var d=a[l]/180*$t;u+=Qt(d)*n[0],c+=Xt(d)*n[0]}var f=o.alpha()*n[0];e.forEach((function(e,r){var i=e.get(t);f+=e.alpha()*n[r+1];for(var o=0;o<a.length;o++)if(!isNaN(i[o]))if(s[o]+=n[r+1],"h"===t.charAt(o)){var l=i[o]/180*$t;u+=Qt(l)*n[r+1],c+=Xt(l)*n[r+1]}else a[o]+=i[o]*n[r+1]}));for(var h=0;h<a.length;h++)if("h"===t.charAt(h)){for(var g=Zt(c/s[h],u/s[h])/$t*180;g<0;)g+=360;for(;g>=360;)g-=360;a[h]=g}else a[h]=a[h]/s[h];return f/=r,new p(a,t).alpha(f>.99999?1:f,!0)},g.bezier=function(e){var t=an(e);return t.scale=function(){return rn(t)},t},g.blend=ln,g.cubehelix=function(e,t,n,r,i){void 0===e&&(e=300),void 0===t&&(t=-1.5),void 0===n&&(n=1),void 0===r&&(r=1),void 0===i&&(i=[0,1]);var o,a=0;"array"===dn(i)?o=i[1]-i[0]:(o=0,i=[i,i]);var s=function(s){var u=pn*((e+120)/360+t*s),c=hn(i[0]+o*s,r),l=(0!==a?n[0]+s*a:n)*c*(1-c)/2,d=vn(u),f=gn(u);return g(fn([255*(c+l*(-.14861*d+1.78277*f)),255*(c+l*(-.29227*d-.90649*f)),255*(c+l*(1.97294*d)),1]))};return s.start=function(t){return null==t?e:(e=t,s)},s.rotations=function(e){return null==e?t:(t=e,s)},s.gamma=function(e){return null==e?r:(r=e,s)},s.hue=function(e){return null==e?n:("array"===dn(n=e)?0===(a=n[1]-n[0])&&(n=n[1]):a=0,s)},s.lightness=function(e){return null==e?i:("array"===dn(e)?(i=e,o=e[1]-e[0]):(i=[e,e],o=0),s)},s.scale=function(){return g.scale(s)},s.hue(n),s},g.mix=g.interpolate=Bt,g.random=function(){for(var e="#",t=0;t<6;t++)e+="0123456789abcdef".charAt(yn(16*mn()));return new p(e,"hex")},g.scale=rn,g.analyze=In.analyze,g.contrast=function(e,t){e=new p(e),t=new p(t);var n=e.luminance(),r=t.luminance();return n>r?(n+.05)/(r+.05):(r+.05)/(n+.05)},g.deltaE=function(e,t,n,r){void 0===n&&(n=1),void 0===r&&(r=1),e=new p(e),t=new p(t);for(var i=Array.from(e.lab()),o=i[0],a=i[1],s=i[2],u=Array.from(t.lab()),c=u[0],l=u[1],d=u[2],f=Cn(a*a+s*s),h=Cn(l*l+d*d),g=o<16?.511:.040975*o/(1+.01765*o),v=.0638*f/(1+.0131*f)+.638,y=f<1e-6?0:180*Tn(s,a)/En;y<0;)y+=360;for(;y>=360;)y-=360;var m=y>=164&&y<=345?.56+Pn(.2*An(En*(y+168)/180)):.36+Pn(.4*An(En*(y+35)/180)),b=f*f*f*f,w=Cn(b/(b+1900)),_=v*(w*m+1-w),k=f-h,x=a-l,S=s-d,I=(o-c)/(n*g),C=k/(r*v);return Cn(I*I+C*C+(x*x+S*S-k*k)/(_*_))},g.distance=function(e,t,n){void 0===n&&(n="lab"),e=new p(e),t=new p(t);var r=e.get(n),i=t.get(n),o=0;for(var a in r){var s=(r[a]||0)-(i[a]||0);o+=s*s}return Math.sqrt(o)},g.limits=In.limits,g.valid=function(){for(var e=[],t=arguments.length;t--;)e[t]=arguments[t];try{return new(Function.prototype.bind.apply(p,[null].concat(e))),!0}catch(n){return!1}},g.scales=On,g.colors=bt,g.brewer=Ln,g}()},function(e,t,n){"use strict";var r=Object.getOwnPropertySymbols,i=Object.prototype.hasOwnProperty,o=Object.prototype.propertyIsEnumerable;function a(e){if(null===e||void 0===e)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(e)}e.exports=function(){try{if(!Object.assign)return!1;var e=new String("abc");if(e[5]="de","5"===Object.getOwnPropertyNames(e)[0])return!1;for(var t={},n=0;n<10;n++)t["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(t).map((function(e){return t[e]})).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach((function(e){r[e]=e})),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(i){return!1}}()?Object.assign:function(e,t){for(var n,s,u=a(e),c=1;c<arguments.length;c++){for(var l in n=Object(arguments[c]))i.call(n,l)&&(u[l]=n[l]);if(r){s=r(n);for(var d=0;d<s.length;d++)o.call(n,s[d])&&(u[s[d]]=n[s[d]])}}return u}},function(e,t,n){"use strict";(function(e){var r=n(30),i=n(31),o=n(32);function a(){return u.TYPED_ARRAY_SUPPORT?2147483647:1073741823}function s(e,t){if(a()<t)throw new RangeError("Invalid typed array length");return u.TYPED_ARRAY_SUPPORT?(e=new Uint8Array(t)).__proto__=u.prototype:(null===e&&(e=new u(t)),e.length=t),e}function u(e,t,n){if(!u.TYPED_ARRAY_SUPPORT&&!(this instanceof u))return new u(e,t,n);if("number"===typeof e){if("string"===typeof t)throw new Error("If encoding is specified then the first argument must be a string");return d(this,e)}return c(this,e,t,n)}function c(e,t,n,r){if("number"===typeof t)throw new TypeError('"value" argument must not be a number');return"undefined"!==typeof ArrayBuffer&&t instanceof ArrayBuffer?function(e,t,n,r){if(t.byteLength,n<0||t.byteLength<n)throw new RangeError("'offset' is out of bounds");if(t.byteLength<n+(r||0))throw new RangeError("'length' is out of bounds");t=void 0===n&&void 0===r?new Uint8Array(t):void 0===r?new Uint8Array(t,n):new Uint8Array(t,n,r);u.TYPED_ARRAY_SUPPORT?(e=t).__proto__=u.prototype:e=f(e,t);return e}(e,t,n,r):"string"===typeof t?function(e,t,n){"string"===typeof n&&""!==n||(n="utf8");if(!u.isEncoding(n))throw new TypeError('"encoding" must be a valid string encoding');var r=0|h(t,n),i=(e=s(e,r)).write(t,n);i!==r&&(e=e.slice(0,i));return e}(e,t,n):function(e,t){if(u.isBuffer(t)){var n=0|p(t.length);return 0===(e=s(e,n)).length||t.copy(e,0,0,n),e}if(t){if("undefined"!==typeof ArrayBuffer&&t.buffer instanceof ArrayBuffer||"length"in t)return"number"!==typeof t.length||(r=t.length)!==r?s(e,0):f(e,t);if("Buffer"===t.type&&o(t.data))return f(e,t.data)}var r;throw new TypeError("First argument must be a string, Buffer, ArrayBuffer, Array, or array-like object.")}(e,t)}function l(e){if("number"!==typeof e)throw new TypeError('"size" argument must be a number');if(e<0)throw new RangeError('"size" argument must not be negative')}function d(e,t){if(l(t),e=s(e,t<0?0:0|p(t)),!u.TYPED_ARRAY_SUPPORT)for(var n=0;n<t;++n)e[n]=0;return e}function f(e,t){var n=t.length<0?0:0|p(t.length);e=s(e,n);for(var r=0;r<n;r+=1)e[r]=255&t[r];return e}function p(e){if(e>=a())throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+a().toString(16)+" bytes");return 0|e}function h(e,t){if(u.isBuffer(e))return e.length;if("undefined"!==typeof ArrayBuffer&&"function"===typeof ArrayBuffer.isView&&(ArrayBuffer.isView(e)||e instanceof ArrayBuffer))return e.byteLength;"string"!==typeof e&&(e=""+e);var n=e.length;if(0===n)return 0;for(var r=!1;;)switch(t){case"ascii":case"latin1":case"binary":return n;case"utf8":case"utf-8":case void 0:return U(e).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return 2*n;case"hex":return n>>>1;case"base64":return B(e).length;default:if(r)return U(e).length;t=(""+t).toLowerCase(),r=!0}}function g(e,t,n){var r=!1;if((void 0===t||t<0)&&(t=0),t>this.length)return"";if((void 0===n||n>this.length)&&(n=this.length),n<=0)return"";if((n>>>=0)<=(t>>>=0))return"";for(e||(e="utf8");;)switch(e){case"hex":return A(this,t,n);case"utf8":case"utf-8":return C(this,t,n);case"ascii":return T(this,t,n);case"latin1":case"binary":return P(this,t,n);case"base64":return I(this,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return E(this,t,n);default:if(r)throw new TypeError("Unknown encoding: "+e);e=(e+"").toLowerCase(),r=!0}}function v(e,t,n){var r=e[t];e[t]=e[n],e[n]=r}function y(e,t,n,r,i){if(0===e.length)return-1;if("string"===typeof n?(r=n,n=0):n>2147483647?n=2147483647:n<-2147483648&&(n=-2147483648),n=+n,isNaN(n)&&(n=i?0:e.length-1),n<0&&(n=e.length+n),n>=e.length){if(i)return-1;n=e.length-1}else if(n<0){if(!i)return-1;n=0}if("string"===typeof t&&(t=u.from(t,r)),u.isBuffer(t))return 0===t.length?-1:m(e,t,n,r,i);if("number"===typeof t)return t&=255,u.TYPED_ARRAY_SUPPORT&&"function"===typeof Uint8Array.prototype.indexOf?i?Uint8Array.prototype.indexOf.call(e,t,n):Uint8Array.prototype.lastIndexOf.call(e,t,n):m(e,[t],n,r,i);throw new TypeError("val must be string, number or Buffer")}function m(e,t,n,r,i){var o,a=1,s=e.length,u=t.length;if(void 0!==r&&("ucs2"===(r=String(r).toLowerCase())||"ucs-2"===r||"utf16le"===r||"utf-16le"===r)){if(e.length<2||t.length<2)return-1;a=2,s/=2,u/=2,n/=2}function c(e,t){return 1===a?e[t]:e.readUInt16BE(t*a)}if(i){var l=-1;for(o=n;o<s;o++)if(c(e,o)===c(t,-1===l?0:o-l)){if(-1===l&&(l=o),o-l+1===u)return l*a}else-1!==l&&(o-=o-l),l=-1}else for(n+u>s&&(n=s-u),o=n;o>=0;o--){for(var d=!0,f=0;f<u;f++)if(c(e,o+f)!==c(t,f)){d=!1;break}if(d)return o}return-1}function b(e,t,n,r){n=Number(n)||0;var i=e.length-n;r?(r=Number(r))>i&&(r=i):r=i;var o=t.length;if(o%2!==0)throw new TypeError("Invalid hex string");r>o/2&&(r=o/2);for(var a=0;a<r;++a){var s=parseInt(t.substr(2*a,2),16);if(isNaN(s))return a;e[n+a]=s}return a}function w(e,t,n,r){return V(U(t,e.length-n),e,n,r)}function _(e,t,n,r){return V(function(e){for(var t=[],n=0;n<e.length;++n)t.push(255&e.charCodeAt(n));return t}(t),e,n,r)}function k(e,t,n,r){return _(e,t,n,r)}function x(e,t,n,r){return V(B(t),e,n,r)}function S(e,t,n,r){return V(function(e,t){for(var n,r,i,o=[],a=0;a<e.length&&!((t-=2)<0);++a)n=e.charCodeAt(a),r=n>>8,i=n%256,o.push(i),o.push(r);return o}(t,e.length-n),e,n,r)}function I(e,t,n){return 0===t&&n===e.length?r.fromByteArray(e):r.fromByteArray(e.slice(t,n))}function C(e,t,n){n=Math.min(e.length,n);for(var r=[],i=t;i<n;){var o,a,s,u,c=e[i],l=null,d=c>239?4:c>223?3:c>191?2:1;if(i+d<=n)switch(d){case 1:c<128&&(l=c);break;case 2:128===(192&(o=e[i+1]))&&(u=(31&c)<<6|63&o)>127&&(l=u);break;case 3:o=e[i+1],a=e[i+2],128===(192&o)&&128===(192&a)&&(u=(15&c)<<12|(63&o)<<6|63&a)>2047&&(u<55296||u>57343)&&(l=u);break;case 4:o=e[i+1],a=e[i+2],s=e[i+3],128===(192&o)&&128===(192&a)&&128===(192&s)&&(u=(15&c)<<18|(63&o)<<12|(63&a)<<6|63&s)>65535&&u<1114112&&(l=u)}null===l?(l=65533,d=1):l>65535&&(l-=65536,r.push(l>>>10&1023|55296),l=56320|1023&l),r.push(l),i+=d}return function(e){var t=e.length;if(t<=4096)return String.fromCharCode.apply(String,e);var n="",r=0;for(;r<t;)n+=String.fromCharCode.apply(String,e.slice(r,r+=4096));return n}(r)}t.Buffer=u,t.SlowBuffer=function(e){+e!=e&&(e=0);return u.alloc(+e)},t.INSPECT_MAX_BYTES=50,u.TYPED_ARRAY_SUPPORT=void 0!==e.TYPED_ARRAY_SUPPORT?e.TYPED_ARRAY_SUPPORT:function(){try{var e=new Uint8Array(1);return e.__proto__={__proto__:Uint8Array.prototype,foo:function(){return 42}},42===e.foo()&&"function"===typeof e.subarray&&0===e.subarray(1,1).byteLength}catch(t){return!1}}(),t.kMaxLength=a(),u.poolSize=8192,u._augment=function(e){return e.__proto__=u.prototype,e},u.from=function(e,t,n){return c(null,e,t,n)},u.TYPED_ARRAY_SUPPORT&&(u.prototype.__proto__=Uint8Array.prototype,u.__proto__=Uint8Array,"undefined"!==typeof Symbol&&Symbol.species&&u[Symbol.species]===u&&Object.defineProperty(u,Symbol.species,{value:null,configurable:!0})),u.alloc=function(e,t,n){return function(e,t,n,r){return l(t),t<=0?s(e,t):void 0!==n?"string"===typeof r?s(e,t).fill(n,r):s(e,t).fill(n):s(e,t)}(null,e,t,n)},u.allocUnsafe=function(e){return d(null,e)},u.allocUnsafeSlow=function(e){return d(null,e)},u.isBuffer=function(e){return!(null==e||!e._isBuffer)},u.compare=function(e,t){if(!u.isBuffer(e)||!u.isBuffer(t))throw new TypeError("Arguments must be Buffers");if(e===t)return 0;for(var n=e.length,r=t.length,i=0,o=Math.min(n,r);i<o;++i)if(e[i]!==t[i]){n=e[i],r=t[i];break}return n<r?-1:r<n?1:0},u.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},u.concat=function(e,t){if(!o(e))throw new TypeError('"list" argument must be an Array of Buffers');if(0===e.length)return u.alloc(0);var n;if(void 0===t)for(t=0,n=0;n<e.length;++n)t+=e[n].length;var r=u.allocUnsafe(t),i=0;for(n=0;n<e.length;++n){var a=e[n];if(!u.isBuffer(a))throw new TypeError('"list" argument must be an Array of Buffers');a.copy(r,i),i+=a.length}return r},u.byteLength=h,u.prototype._isBuffer=!0,u.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var t=0;t<e;t+=2)v(this,t,t+1);return this},u.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var t=0;t<e;t+=4)v(this,t,t+3),v(this,t+1,t+2);return this},u.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var t=0;t<e;t+=8)v(this,t,t+7),v(this,t+1,t+6),v(this,t+2,t+5),v(this,t+3,t+4);return this},u.prototype.toString=function(){var e=0|this.length;return 0===e?"":0===arguments.length?C(this,0,e):g.apply(this,arguments)},u.prototype.equals=function(e){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e||0===u.compare(this,e)},u.prototype.inspect=function(){var e="",n=t.INSPECT_MAX_BYTES;return this.length>0&&(e=this.toString("hex",0,n).match(/.{2}/g).join(" "),this.length>n&&(e+=" ... ")),"<Buffer "+e+">"},u.prototype.compare=function(e,t,n,r,i){if(!u.isBuffer(e))throw new TypeError("Argument must be a Buffer");if(void 0===t&&(t=0),void 0===n&&(n=e?e.length:0),void 0===r&&(r=0),void 0===i&&(i=this.length),t<0||n>e.length||r<0||i>this.length)throw new RangeError("out of range index");if(r>=i&&t>=n)return 0;if(r>=i)return-1;if(t>=n)return 1;if(this===e)return 0;for(var o=(i>>>=0)-(r>>>=0),a=(n>>>=0)-(t>>>=0),s=Math.min(o,a),c=this.slice(r,i),l=e.slice(t,n),d=0;d<s;++d)if(c[d]!==l[d]){o=c[d],a=l[d];break}return o<a?-1:a<o?1:0},u.prototype.includes=function(e,t,n){return-1!==this.indexOf(e,t,n)},u.prototype.indexOf=function(e,t,n){return y(this,e,t,n,!0)},u.prototype.lastIndexOf=function(e,t,n){return y(this,e,t,n,!1)},u.prototype.write=function(e,t,n,r){if(void 0===t)r="utf8",n=this.length,t=0;else if(void 0===n&&"string"===typeof t)r=t,n=this.length,t=0;else{if(!isFinite(t))throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");t|=0,isFinite(n)?(n|=0,void 0===r&&(r="utf8")):(r=n,n=void 0)}var i=this.length-t;if((void 0===n||n>i)&&(n=i),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");r||(r="utf8");for(var o=!1;;)switch(r){case"hex":return b(this,e,t,n);case"utf8":case"utf-8":return w(this,e,t,n);case"ascii":return _(this,e,t,n);case"latin1":case"binary":return k(this,e,t,n);case"base64":return x(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return S(this,e,t,n);default:if(o)throw new TypeError("Unknown encoding: "+r);r=(""+r).toLowerCase(),o=!0}},u.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function T(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(127&e[i]);return r}function P(e,t,n){var r="";n=Math.min(e.length,n);for(var i=t;i<n;++i)r+=String.fromCharCode(e[i]);return r}function A(e,t,n){var r=e.length;(!t||t<0)&&(t=0),(!n||n<0||n>r)&&(n=r);for(var i="",o=t;o<n;++o)i+=F(e[o]);return i}function E(e,t,n){for(var r=e.slice(t,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function O(e,t,n){if(e%1!==0||e<0)throw new RangeError("offset is not uint");if(e+t>n)throw new RangeError("Trying to access beyond buffer length")}function M(e,t,n,r,i,o){if(!u.isBuffer(e))throw new TypeError('"buffer" argument must be a Buffer instance');if(t>i||t<o)throw new RangeError('"value" argument is out of bounds');if(n+r>e.length)throw new RangeError("Index out of range")}function j(e,t,n,r){t<0&&(t=65535+t+1);for(var i=0,o=Math.min(e.length-n,2);i<o;++i)e[n+i]=(t&255<<8*(r?i:1-i))>>>8*(r?i:1-i)}function R(e,t,n,r){t<0&&(t=4294967295+t+1);for(var i=0,o=Math.min(e.length-n,4);i<o;++i)e[n+i]=t>>>8*(r?i:3-i)&255}function N(e,t,n,r,i,o){if(n+r>e.length)throw new RangeError("Index out of range");if(n<0)throw new RangeError("Index out of range")}function L(e,t,n,r,o){return o||N(e,0,n,4),i.write(e,t,n,r,23,4),n+4}function D(e,t,n,r,o){return o||N(e,0,n,8),i.write(e,t,n,r,52,8),n+8}u.prototype.slice=function(e,t){var n,r=this.length;if((e=~~e)<0?(e+=r)<0&&(e=0):e>r&&(e=r),(t=void 0===t?r:~~t)<0?(t+=r)<0&&(t=0):t>r&&(t=r),t<e&&(t=e),u.TYPED_ARRAY_SUPPORT)(n=this.subarray(e,t)).__proto__=u.prototype;else{var i=t-e;n=new u(i,void 0);for(var o=0;o<i;++o)n[o]=this[o+e]}return n},u.prototype.readUIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r},u.prototype.readUIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e+--t],i=1;t>0&&(i*=256);)r+=this[e+--t]*i;return r},u.prototype.readUInt8=function(e,t){return t||O(e,1,this.length),this[e]},u.prototype.readUInt16LE=function(e,t){return t||O(e,2,this.length),this[e]|this[e+1]<<8},u.prototype.readUInt16BE=function(e,t){return t||O(e,2,this.length),this[e]<<8|this[e+1]},u.prototype.readUInt32LE=function(e,t){return t||O(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+16777216*this[e+3]},u.prototype.readUInt32BE=function(e,t){return t||O(e,4,this.length),16777216*this[e]+(this[e+1]<<16|this[e+2]<<8|this[e+3])},u.prototype.readIntLE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=this[e],i=1,o=0;++o<t&&(i*=256);)r+=this[e+o]*i;return r>=(i*=128)&&(r-=Math.pow(2,8*t)),r},u.prototype.readIntBE=function(e,t,n){e|=0,t|=0,n||O(e,t,this.length);for(var r=t,i=1,o=this[e+--r];r>0&&(i*=256);)o+=this[e+--r]*i;return o>=(i*=128)&&(o-=Math.pow(2,8*t)),o},u.prototype.readInt8=function(e,t){return t||O(e,1,this.length),128&this[e]?-1*(255-this[e]+1):this[e]},u.prototype.readInt16LE=function(e,t){t||O(e,2,this.length);var n=this[e]|this[e+1]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt16BE=function(e,t){t||O(e,2,this.length);var n=this[e+1]|this[e]<<8;return 32768&n?4294901760|n:n},u.prototype.readInt32LE=function(e,t){return t||O(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24},u.prototype.readInt32BE=function(e,t){return t||O(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]},u.prototype.readFloatLE=function(e,t){return t||O(e,4,this.length),i.read(this,e,!0,23,4)},u.prototype.readFloatBE=function(e,t){return t||O(e,4,this.length),i.read(this,e,!1,23,4)},u.prototype.readDoubleLE=function(e,t){return t||O(e,8,this.length),i.read(this,e,!0,52,8)},u.prototype.readDoubleBE=function(e,t){return t||O(e,8,this.length),i.read(this,e,!1,52,8)},u.prototype.writeUIntLE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||M(this,e,t,n,Math.pow(2,8*n)-1,0);var i=1,o=0;for(this[t]=255&e;++o<n&&(i*=256);)this[t+o]=e/i&255;return t+n},u.prototype.writeUIntBE=function(e,t,n,r){(e=+e,t|=0,n|=0,r)||M(this,e,t,n,Math.pow(2,8*n)-1,0);var i=n-1,o=1;for(this[t+i]=255&e;--i>=0&&(o*=256);)this[t+i]=e/o&255;return t+n},u.prototype.writeUInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,255,0),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),this[t]=255&e,t+1},u.prototype.writeUInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},u.prototype.writeUInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,65535,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},u.prototype.writeUInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=255&e):R(this,e,t,!0),t+4},u.prototype.writeUInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,4294967295,0),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},u.prototype.writeIntLE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);M(this,e,t,n,i-1,-i)}var o=0,a=1,s=0;for(this[t]=255&e;++o<n&&(a*=256);)e<0&&0===s&&0!==this[t+o-1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},u.prototype.writeIntBE=function(e,t,n,r){if(e=+e,t|=0,!r){var i=Math.pow(2,8*n-1);M(this,e,t,n,i-1,-i)}var o=n-1,a=1,s=0;for(this[t+o]=255&e;--o>=0&&(a*=256);)e<0&&0===s&&0!==this[t+o+1]&&(s=1),this[t+o]=(e/a>>0)-s&255;return t+n},u.prototype.writeInt8=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,1,127,-128),u.TYPED_ARRAY_SUPPORT||(e=Math.floor(e)),e<0&&(e=255+e+1),this[t]=255&e,t+1},u.prototype.writeInt16LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8):j(this,e,t,!0),t+2},u.prototype.writeInt16BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,2,32767,-32768),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>8,this[t+1]=255&e):j(this,e,t,!1),t+2},u.prototype.writeInt32LE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),u.TYPED_ARRAY_SUPPORT?(this[t]=255&e,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24):R(this,e,t,!0),t+4},u.prototype.writeInt32BE=function(e,t,n){return e=+e,t|=0,n||M(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),u.TYPED_ARRAY_SUPPORT?(this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=255&e):R(this,e,t,!1),t+4},u.prototype.writeFloatLE=function(e,t,n){return L(this,e,t,!0,n)},u.prototype.writeFloatBE=function(e,t,n){return L(this,e,t,!1,n)},u.prototype.writeDoubleLE=function(e,t,n){return D(this,e,t,!0,n)},u.prototype.writeDoubleBE=function(e,t,n){return D(this,e,t,!1,n)},u.prototype.copy=function(e,t,n,r){if(n||(n=0),r||0===r||(r=this.length),t>=e.length&&(t=e.length),t||(t=0),r>0&&r<n&&(r=n),r===n)return 0;if(0===e.length||0===this.length)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("sourceStart out of bounds");if(r<0)throw new RangeError("sourceEnd out of bounds");r>this.length&&(r=this.length),e.length-t<r-n&&(r=e.length-t+n);var i,o=r-n;if(this===e&&n<t&&t<r)for(i=o-1;i>=0;--i)e[i+t]=this[i+n];else if(o<1e3||!u.TYPED_ARRAY_SUPPORT)for(i=0;i<o;++i)e[i+t]=this[i+n];else Uint8Array.prototype.set.call(e,this.subarray(n,n+o),t);return o},u.prototype.fill=function(e,t,n,r){if("string"===typeof e){if("string"===typeof t?(r=t,t=0,n=this.length):"string"===typeof n&&(r=n,n=this.length),1===e.length){var i=e.charCodeAt(0);i<256&&(e=i)}if(void 0!==r&&"string"!==typeof r)throw new TypeError("encoding must be a string");if("string"===typeof r&&!u.isEncoding(r))throw new TypeError("Unknown encoding: "+r)}else"number"===typeof e&&(e&=255);if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;var o;if(t>>>=0,n=void 0===n?this.length:n>>>0,e||(e=0),"number"===typeof e)for(o=t;o<n;++o)this[o]=e;else{var a=u.isBuffer(e)?e:U(new u(e,r).toString()),s=a.length;for(o=0;o<n-t;++o)this[o+t]=a[o%s]}return this};var W=/[^+\/0-9A-Za-z-_]/g;function F(e){return e<16?"0"+e.toString(16):e.toString(16)}function U(e,t){var n;t=t||1/0;for(var r=e.length,i=null,o=[],a=0;a<r;++a){if((n=e.charCodeAt(a))>55295&&n<57344){if(!i){if(n>56319){(t-=3)>-1&&o.push(239,191,189);continue}if(a+1===r){(t-=3)>-1&&o.push(239,191,189);continue}i=n;continue}if(n<56320){(t-=3)>-1&&o.push(239,191,189),i=n;continue}n=65536+(i-55296<<10|n-56320)}else i&&(t-=3)>-1&&o.push(239,191,189);if(i=null,n<128){if((t-=1)<0)break;o.push(n)}else if(n<2048){if((t-=2)<0)break;o.push(n>>6|192,63&n|128)}else if(n<65536){if((t-=3)<0)break;o.push(n>>12|224,n>>6&63|128,63&n|128)}else{if(!(n<1114112))throw new Error("Invalid code point");if((t-=4)<0)break;o.push(n>>18|240,n>>12&63|128,n>>6&63|128,63&n|128)}}return o}function B(e){return r.toByteArray(function(e){if((e=function(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")}(e).replace(W,"")).length<2)return"";for(;e.length%4!==0;)e+="=";return e}(e))}function V(e,t,n,r){for(var i=0;i<r&&!(i+n>=t.length||i>=e.length);++i)t[i+n]=e[i];return i}}).call(this,n(13))},function(e,t){var n,r,i=e.exports={};function o(){throw new Error("setTimeout has not been defined")}function a(){throw new Error("clearTimeout has not been defined")}function s(e){if(n===setTimeout)return setTimeout(e,0);if((n===o||!n)&&setTimeout)return n=setTimeout,setTimeout(e,0);try{return n(e,0)}catch(t){try{return n.call(null,e,0)}catch(t){return n.call(this,e,0)}}}!function(){try{n="function"===typeof setTimeout?setTimeout:o}catch(e){n=o}try{r="function"===typeof clearTimeout?clearTimeout:a}catch(e){r=a}}();var u,c=[],l=!1,d=-1;function f(){l&&u&&(l=!1,u.length?c=u.concat(c):d=-1,c.length&&p())}function p(){if(!l){var e=s(f);l=!0;for(var t=c.length;t;){for(u=c,c=[];++d<t;)u&&u[d].run();d=-1,t=c.length}u=null,l=!1,function(e){if(r===clearTimeout)return clearTimeout(e);if((r===a||!r)&&clearTimeout)return r=clearTimeout,clearTimeout(e);try{r(e)}catch(t){try{return r.call(null,e)}catch(t){return r.call(this,e)}}}(e)}}function h(e,t){this.fun=e,this.array=t}function g(){}i.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];c.push(new h(e,t)),1!==c.length||l||s(p)},h.prototype.run=function(){this.fun.apply(null,this.array)},i.title="browser",i.browser=!0,i.env={},i.argv=[],i.version="",i.versions={},i.on=g,i.addListener=g,i.once=g,i.off=g,i.removeListener=g,i.removeAllListeners=g,i.emit=g,i.prependListener=g,i.prependOnceListener=g,i.listeners=function(e){return[]},i.binding=function(e){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(e){throw new Error("process.chdir is not supported")},i.umask=function(){return 0}},function(e,t,n){var r=n(21);e.exports=function(e,t){if(e){if("string"===typeof e)return r(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?r(e,t):void 0}}},function(e,t){e.exports=function(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}},function(e,t,n){"use strict";n.d(t,"a",(function(){return i}));var r=n(8);function i(e){if("undefined"===typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(e=Object(r.a)(e))){var t=0,n=function(){};return{s:n,n:function(){return t>=e.length?{done:!0}:{done:!1,value:e[t++]}},e:function(e){throw e},f:n}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o,a=!0,s=!1;return{s:function(){i=e[Symbol.iterator]()},n:function(){var e=i.next();return a=e.done,e},e:function(e){s=!0,o=e},f:function(){try{a||null==i.return||i.return()}finally{if(s)throw o}}}}},function(e,t,n){(function(t,n,r){!function(t,n){e.exports=n()}(0,(function(){"use strict";var e=function(t,n){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(t,n)};function i(t,n){function r(){this.constructor=t}e(t,n),t.prototype=null===n?Object.create(n):(r.prototype=n.prototype,new r)}var o=function(){return(o=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function a(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function s(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}var u=function(e,t){return(u=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)};function c(e,t){function n(){this.constructor=e}u(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)}var l=function(){return(l=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var i in t=arguments[n])Object.prototype.hasOwnProperty.call(t,i)&&(e[i]=t[i]);return e}).apply(this,arguments)};function d(e,t,n,r){return new(n||(n=Promise))((function(i,o){function a(e){try{u(r.next(e))}catch(t){o(t)}}function s(e){try{u(r.throw(e))}catch(t){o(t)}}function u(e){e.done?i(e.value):new n((function(t){t(e.value)})).then(a,s)}u((r=r.apply(e,t||[])).next())}))}function f(e,t){var n,r,i,o,a={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:s(0),throw:s(1),return:s(2)},"function"===typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function s(o){return function(s){return function(o){if(n)throw new TypeError("Generator is already executing.");for(;a;)try{if(n=1,r&&(i=2&o[0]?r.return:o[0]?r.throw||((i=r.return)&&i.call(r),0):r.next)&&!(i=i.call(r,o[1])).done)return i;switch(r=0,i&&(o=[2&o[0],i.value]),o[0]){case 0:case 1:i=o;break;case 4:return a.label++,{value:o[1],done:!1};case 5:a.label++,r=o[1],o=[0];continue;case 7:o=a.ops.pop(),a.trys.pop();continue;default:if(!(i=(i=a.trys).length>0&&i[i.length-1])&&(6===o[0]||2===o[0])){a=0;continue}if(3===o[0]&&(!i||o[1]>i[0]&&o[1]<i[3])){a.label=o[1];break}if(6===o[0]&&a.label<i[1]){a.label=i[1],i=o;break}if(i&&a.label<i[2]){a.label=i[2],a.ops.push(o);break}i[2]&&a.ops.pop(),a.trys.pop();continue}o=t.call(e,a)}catch(s){o=[6,s],r=0}finally{n=i=0}if(5&o[0])throw o[1];return{value:o[0]?o[1]:void 0,done:!0}}([o,s])}}}function p(){for(var e=0,t=0,n=arguments.length;t<n;t++)e+=arguments[t].length;var r=Array(e),i=0;for(t=0;t<n;t++)for(var o=arguments[t],a=0,s=o.length;a<s;a++,i++)r[i]=o[a];return r}var h=1,g=2,v=3,y=4;function m(e){return e.type===v?"timestamp":e.type===g?"number":e.type===h?"string":e.type===y?"object":"unknown"}function b(e){return e.constructor===Date?"timestamp":"number"===typeof e?"number":"string"===typeof e?"string":"object"===typeof e?"object":"string"}function w(e){var t={},n=m(e);if("object"===n){var r=Object.keys(e.value).reduce((function(t,n){var r=b(e.value[n]);if("object"===r){var i=function e(t){return Object.keys(t).reduce((function(n,r){var i=b(t[r]);return n[r]="object"===i?{type:"object",description:"",context:{},composite:e(t[r])}:{type:i,description:"",context:{}},n}),{})}(e.value[n]);t[n]={type:"object",description:"",context:{},composite:i}}else t[n]={type:r,description:"",context:{}};return t}),{});t.composite=r}return t.name=_(e.path.join("/")+"/"+e.name),t.type=n,t.description=e.description,t.context={},t}function _(e){return"undefined"!==typeof e&&e.length>0&&"/"!==e[0]?"/"+e:e}function k(e){return"timestamp"===m(e)?Date.now():function e(t){if("object"!==typeof t)return t;return Object.keys(t).reduce((function(n,r){var i=t[r];return"object"===typeof i&&i.constructor!==Date?n[r]=e(i):i.constructor===Date?n[r]=new Date(i).getTime():i.constructor===Boolean?n[r]=i.toString():n[r]=i,n}),{})}(e.value)}function x(e){var t=function e(t){return t.reduce((function(t,n){return t.concat(Array.isArray(n)?e(n):n)}),[])}(e.root.getAggregateState()),n=t.sort((function(e,t){return e.state?t.state?t.state-e.state:-1:1}))[0];return{description:function(e){var t="";return e.forEach((function(e,n,r){var i=e.path.join(".");n===r.length-1?t+=i+"."+e.name+": "+e.description:t+=i+"."+e.name+": "+e.description+","})),t.length>100?t.slice(0,100)+"...":t}(t),value:n.state}}var S=function(e,t,n){if(null===e||"object"!==typeof e)throw new Error("Missing definition");if(null===t||"object"!==typeof t)throw new Error("Missing parent");if(null===n||"object"!==typeof n)throw new Error("Missing transport")},I=function(){function e(e,t,n,r,i){this.definition=e,this.system=t,this.transport=n,this.value=r,this.type=i,this.path=[],S(e,t,n),this.path=t.path.slice(0),this.path.push(t.name),this.name=e.name,this.description=e.description,n.createMetric(this)}return Object.defineProperty(e.prototype,"repo",{get:function(){var e;return null===(e=this.system)||void 0===e?void 0:e.repo},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"id",{get:function(){return this.system.path+"/"+name},enumerable:!0,configurable:!0}),e.prototype.update=function(e){return this.value=e,this.transport.updateMetric(this)},e}(),C=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i,g)||this}return c(t,e),t.prototype.incrementBy=function(e){this.update(this.value+e)},t.prototype.increment=function(){this.incrementBy(1)},t.prototype.decrement=function(){this.incrementBy(-1)},t.prototype.decrementBy=function(e){this.incrementBy(-1*e)},t}(I),T=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i,y)||this}return c(t,e),t.prototype.update=function(e){return this.mergeValues(e),this.transport.updateMetric(this)},t.prototype.mergeValues=function(e){var t=this;return Object.keys(this.value).forEach((function(n){"undefined"!==typeof e[n]&&(t.value[n]=e[n])}))},t}(I),P=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i,h)||this}return c(t,e),t}(I),A=function(e){function t(t,n,r,i){return e.call(this,t,n,r,i,v)||this}return c(t,e),t.prototype.now=function(){this.update(new Date)},t}(I);var E=function(){function e(e,t){t.init(this),this.root=function e(t,n,r,i,o){if(!n)throw new Error("Repository is required");if(!r)throw new Error("Transport is required");var a,s,u=r,c=t,l=o||"",d=n,f=i,p=function e(t){if(!t||!t.parent)return[];var n=e(t.parent);return n.push(t.name),n}(i),m={},b=(s="/",((a=p)&&a.length>0?a.join(s):"")+t),w=n.root,_=[],k=[];function x(e,t,n,r){var i={name:""};i="string"===typeof e?{name:e}:e;var o=k.filter((function(e){return e.name===i.name}));if(o.length>0){var a=o[0];if(a.type!==t)throw new Error("A metric named "+i.name+" is already defined with different type.");return"undefined"!==typeof n&&a.update(n).catch((function(){})),a}var s=r(i);return k.push(s),s}var S={get name(){return c},get description(){return l},get repo(){return d},get parent(){return f},path:p,id:b,root:w,get subSystems(){return _},get metrics(){return k},subSystem:function(t,n){if(!t||0===t.length)throw new Error("name is required");var r=_.filter((function(e){return e.name===t}));if(r.length>0)return r[0];var i=e(t,d,u,S,n);return _.push(i),i},getState:function(){return m},setState:function(e,t){m={state:e,description:t},u.updateSystem(S,m)},stringMetric:function(e,t){return x(e,h,t,(function(e){return new P(e,S,u,t)}))},timestampMetric:function(e,t){return x(e,v,t,(function(e){return new A(e,S,u,t)}))},objectMetric:function(e,t){return x(e,y,t,(function(e){return new T(e,S,u,t)}))},numberMetric:function(e,t){return x(e,g,t,(function(e){return new C(e,S,u,t)}))},getAggregateState:function(){var e=[];return Object.keys(m).length>0&&e.push({name:c,path:p,state:m.state,description:m.description}),_.forEach((function(t){var n=t.getAggregateState();n.length>0&&e.push.apply(e,n)})),e}};return u.createSystem(S),S}("",this,t),this.addSystemMetrics(this.root,e.clickStream||void 0===e.clickStream)}return e.prototype.addSystemMetrics=function(e,t){if("undefined"!==typeof navigator&&e.stringMetric("UserAgent",navigator.userAgent),t&&"undefined"!==typeof document){var n=e.subSystem("ClickStream"),r=function(e){if(e.target){var t=e.target;n.objectMetric("LastBrowserEvent",{type:"click",timestamp:new Date,target:{className:e.target?t.className:"",id:t.id,type:"<"+t.tagName.toLowerCase()+">",href:t.href||""}})}};n.objectMetric("Page",{title:document.title,page:window.location.href}),document.addEventListener?document.addEventListener("click",r):document.attachEvent("onclick",r)}e.stringMetric("StartTime",(new Date).toString());var i=e.stringMetric("StartURL",""),o=e.stringMetric("AppName","");if("undefined"!==typeof window){if("undefined"!==typeof window.location){var a=window.location.href;i.update(a)}"undefined"!==typeof window.glue42gd&&o.update(window.glue42gd.appName)}},e}(),O=function(){function e(){}return e.prototype.init=function(e){},e.prototype.createSystem=function(e){return Promise.resolve()},e.prototype.updateSystem=function(e,t){return Promise.resolve()},e.prototype.createMetric=function(e){return Promise.resolve()},e.prototype.updateMetric=function(e){return Promise.resolve()},e}(),M=function(){function e(e,t,n){this.api=e,this.lastCount=0,this.initialPublishTimeout=1e4,this.publishInterval=6e4,this.initialPublishTimeout=null!==t&&void 0!==t?t:this.initialPublishTimeout,this.publishInterval=null!==n&&void 0!==n?n:this.publishInterval,this.scheduleCollection(),this.system=this.api.subSystem("performance","Performance data published by the web application")}return e.prototype.scheduleCollection=function(){var e=this;setTimeout((function(){e.collect(),setInterval((function(){e.collect()}),e.publishInterval)}),this.initialPublishTimeout)},e.prototype.collect=function(){try{this.collectMemory(),this.collectEntries()}catch(e){}},e.prototype.collectMemory=function(){var e=window.performance.memory;this.system.stringMetric("memory",JSON.stringify({totalJSHeapSize:e.totalJSHeapSize,usedJSHeapSize:e.usedJSHeapSize}))},e.prototype.collectEntries=function(){var e=window.performance.getEntries();e.length<=this.lastCount||(this.lastCount=e.length,this.system.stringMetric("entries",JSON.stringify(e)))},e}(),j=function(e){var t;t=e.connection&&"object"===typeof e.connection?function(e,t){var n,r,i=this;if(!e||"object"!==typeof e)throw new Error("Connection is required parameter");var o=function(e){a(e.root)},a=function e(t){s(t),t.metrics.forEach((function(e){u(e)})),t.subSystems.forEach((function(t){e(t)}))},s=function(e){return d(i,void 0,void 0,(function(){var t,i;return f(this,(function(o){switch(o.label){case 0:return void 0===e.parent?[2]:[4,n];case 1:return o.sent(),t={name:_(e.path.join("/")+"/"+e.name+"/State"),type:"object",composite:{Description:{type:"string",description:""},Value:{type:"number",description:""}},description:"System state",context:{}},i={type:"define",metrics:[t]},r.send(i),[2]}}))}))},u=function(e){return d(i,void 0,void 0,(function(){var t,i,o;return f(this,(function(a){switch(a.label){case 0:return t=p(e),[4,n];case 1:return a.sent(),i=w(t),o={type:"define",metrics:[i]},r.send(o),"undefined"!==typeof t.value&&c(t),[2]}}))}))},c=function(e){if(h()){var t=k(e),n={type:"publish",values:[{name:_(e.path.join("/")+"/"+e.name),value:t,timestamp:Date.now()}]};return r.sendFireAndForget(n)}return Promise.resolve()},p=function(e){var t=l({},e);return"object"===typeof e.value&&null!==e.value&&(t.value=l({},e.value)),t},h=function(){var e;try{return(null!==(e=t.canUpdateMetric)&&void 0!==e?e:function(){return!0})()}catch(n){return!0}};return{init:function(i){var a;n=new Promise((function(e){a=e})),(r=e.domain("metrics")).onJoined((function(e){!e&&a&&(a(),a=void 0);var t={type:"define",metrics:[{name:"/State",type:"object",composite:{Description:{type:"string",description:""},Value:{type:"number",description:""}},description:"System state",context:{}}]};r.send(t),e&&o(i)})),r.join({system:t.system,service:t.service,instance:t.instance})},createSystem:s,updateSystem:function(t,o){return d(i,void 0,void 0,(function(){var i,a,s;return f(this,(function(u){switch(u.label){case 0:return[4,n];case 1:return u.sent(),i={type:"publish",values:[{name:_(t.path.join("/")+"/"+t.name+"/State"),value:{Description:o.description,Value:o.state},timestamp:Date.now()}]},r.send(i),a=x(t),s={type:"publish",peer_id:e.peerId,values:[{name:"/State",value:{Description:a.description,Value:a.value},timestamp:Date.now()}]},r.send(s),[2]}}))}))},createMetric:u,updateMetric:function(e){return d(i,void 0,void 0,(function(){var t;return f(this,(function(r){switch(r.label){case 0:return t=p(e),[4,n];case 1:return r.sent(),c(t),[2]}}))}))}}}(e.connection,e):new O;var n=new E(e,t).root;e.disableAutoAppSystem||(n=n.subSystem("App"));var r=function(e){var t,n=e.subSystem("reporting"),r={name:"features"};return e.featureMetric=function(e,i,o){if("undefined"===typeof e||""===e)throw new Error("name is mandatory");if("undefined"===typeof i||""===i)throw new Error("action is mandatory");if("undefined"===typeof o||""===o)throw new Error("payload is mandatory");t?t.update({name:e,action:i,payload:o}):t=n.objectMetric(r,{name:e,action:i,payload:o})},e}(n);return function(e,t){var n,r;if("undefined"===typeof window)return;var i=null===(r=null===(n=null===window||void 0===window?void 0:window.glue42gd)||void 0===n?void 0:n.metrics)||void 0===r?void 0:r.pagePerformanceMetrics;i&&(t=i);(null===t||void 0===t?void 0:t.enabled)&&new M(e,t.initialPublishTimeout,t.publishInterval)}(r,e.pagePerformanceMetrics),r};function R(e){if(e&&e.errorHandling&&"function"!==typeof e.errorHandling&&"log"!==e.errorHandling&&"silent"!==e.errorHandling&&"throw"!==e.errorHandling)throw new Error('Invalid options passed to createRegistry. Prop errorHandling should be ["log" | "silent" | "throw" | (err) => void], but '+typeof e.errorHandling+" was passed");var t=e&&"function"===typeof e.errorHandling&&e.errorHandling,n={};function r(n,r){var i=n instanceof Error?n:new Error(n);if(t)t(i);else{var o='[ERROR] callback-registry: User callback for key "'+r+'" failed: '+i.stack;if(e)switch(e.errorHandling){case"log":return console.error(o);case"silent":return;case"throw":throw new Error(o)}console.error(o)}}return{add:function(e,t,i){var o=n[e];return o||(o=[],n[e]=o),o.push(t),i&&setTimeout((function(){i.forEach((function(i){var o;if(null===(o=n[e])||void 0===o?void 0:o.includes(t))try{Array.isArray(i)?t.apply(void 0,i):t.apply(void 0,[i])}catch(a){r(a,e)}}))}),0),function(){var r=n[e];r&&(0===(r=r.reduce((function(e,n,r){return n===t&&e.length===r||e.push(n),e}),[])).length?delete n[e]:n[e]=r)}},execute:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=n[e];if(!o||0===o.length)return[];var a=[];return o.forEach((function(n){try{var i=n.apply(void 0,t);a.push(i)}catch(o){a.push(void 0),r(o,e)}})),a},clear:function(){n={}},clearKey:function(e){n[e]&&delete n[e]}}}R.default=R;var N=R,L=function(){function e(e,t){var n=this;this.registry=N(),this.gw=e.facade,this.gw.connect((function(e,t){n.messageHandler(t)})).then((function(e){n.client=e}))}return Object.defineProperty(e.prototype,"isObjectBasedTransport",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.sendObject=function(e){return this.client?(this.client.send(e),Promise.resolve(void 0)):Promise.reject("not connected")},e.prototype.send=function(e){return Promise.reject("not supported")},e.prototype.onMessage=function(e){return this.registry.add("onMessage",e)},e.prototype.onConnectedChanged=function(e){e(!0)},e.prototype.close=function(){return Promise.resolve()},e.prototype.open=function(){return Promise.resolve()},e.prototype.name=function(){return"in-memory"},e.prototype.reconnect=function(){return Promise.resolve()},e.prototype.messageHandler=function(e){this.registry.execute("onMessage",e)},e}(),D=function(){function e(e,t){var n=this;this.logger=t,this.registry=N(),this.worker=new SharedWorker(e),this.worker.port.onmessage=function(e){n.messageHandler(e.data)}}return Object.defineProperty(e.prototype,"isObjectBasedTransport",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.sendObject=function(e){return this.worker.port.postMessage(e),Promise.resolve()},e.prototype.send=function(e){return Promise.reject("not supported")},e.prototype.onMessage=function(e){return this.registry.add("onMessage",e)},e.prototype.onConnectedChanged=function(e){e(!0)},e.prototype.close=function(){return Promise.resolve()},e.prototype.open=function(){return Promise.resolve()},e.prototype.name=function(){return"shared-worker"},e.prototype.reconnect=function(){return Promise.resolve()},e.prototype.messageHandler=function(e){this.registry.execute("onMessage",e)},e}(),W=function(){function e(){}return e.getGDMajorVersion=function(){if("undefined"!==typeof window&&window.glueDesktop&&window.glueDesktop.version){var e=Number(window.glueDesktop.version.substr(0,1));return isNaN(e)?void 0:e}},e.isNode=function(){if("undefined"!==typeof e._isNode)return e._isNode;if("undefined"!==typeof window)return e._isNode=!1,!1;try{e._isNode="[object process]"===Object.prototype.toString.call(t.process)}catch(n){e._isNode=!1}return e._isNode},e}(),F=function(){function e(){var e=this;this.rejected=!1,this.resolved=!1,this.promise=new Promise((function(t,n){e.resolve=function(n){e.resolved=!0,t(n)},e.reject=function(t){e.rejected=!0,n(t)}}))}return e.delay=function(e){return new Promise((function(t){return setTimeout(t,e)}))},Object.defineProperty(e.prototype,"ended",{get:function(){return this.rejected||this.resolved},enumerable:!0,configurable:!0}),e}(),U={};function B(e){var t=U[e];if(t)return t;var n=[];function r(){return(new Date).getTime()}var i,o,a=r();function s(e,t){var i=null!==t&&void 0!==t?t:r(),o=0;n.length>0&&(o=i-n[n.length-1].time),n.push({name:e,time:i,diff:o})}s("start",a);var u={get startTime(){return a},get endTime(){return i},get period(){return o},stop:function(){return s("end",i=r()),o=i-a},mark:s,marks:n};return U[e]=u,u}var V=W.isNode()?null:window.WebSocket,H=function(){function e(e,t){if(this.startupTimer=B("connection"),this._running=!0,this._registry=N(),this.wsRequests=[],this.settings=e,this.logger=t,!this.settings.ws)throw new Error("ws is missing")}return e.prototype.onMessage=function(e){return this._registry.add("onMessage",e)},e.prototype.send=function(e,t){var n=this;return new Promise((function(t,r){n.waitForSocketConnection((function(){var i;try{null===(i=n.ws)||void 0===i||i.send(e),t()}catch(o){r(o)}}),r)}))},e.prototype.open=function(){var e=this;return this.logger.info("opening ws..."),this._running=!0,new Promise((function(t,n){e.waitForSocketConnection(t,n)}))},e.prototype.close=function(){return this._running=!1,this.ws&&this.ws.close(),Promise.resolve()},e.prototype.onConnectedChanged=function(e){return this._registry.add("onConnectedChanged",e)},e.prototype.name=function(){return"ws "+this.settings.ws},e.prototype.reconnect=function(){var e;null===(e=this.ws)||void 0===e||e.close();var t=new F;return this.waitForSocketConnection((function(){t.resolve()})),t.promise},e.prototype.waitForSocketConnection=function(e,t){var n;t=null!==t&&void 0!==t?t:function(){},this._running?1!==(null===(n=this.ws)||void 0===n?void 0:n.readyState)?(this.wsRequests.push({callback:e,failed:t}),this.wsRequests.length>1||this.openSocket()):e():t("wait for socket on "+this.settings.ws+" failed - socket closed by user")},e.prototype.openSocket=function(e,t){return d(this,void 0,void 0,(function(){var n=this;return f(this,(function(r){switch(r.label){case 0:if(this.startupTimer.mark("opening-socket"),void 0===e&&(e=this.settings.reconnectInterval),void 0!==t){if(0===t)return this.notifyForSocketState("wait for socket on "+this.settings.ws+" failed - no more retries left"),[2];this.logger.debug("will retry "+t+" more times (every "+e+" ms)")}r.label=1;case 1:return r.trys.push([1,3,,4]),[4,this.initiateSocket()];case 2:return r.sent(),this.startupTimer.mark("socket-initiated"),this.notifyForSocketState(),[3,4];case 3:return r.sent(),setTimeout((function(){var r=void 0===t?void 0:t-1;n.openSocket(e,r)}),e),[3,4];case 4:return[2]}}))}))},e.prototype.initiateSocket=function(){var e=this,t=new F;return this.logger.debug("initiating ws to "+this.settings.ws+"..."),this.ws=new V(this.settings.ws||""),this.ws.onerror=function(n){var r="";try{r=JSON.stringify(n)}catch(o){var i=new WeakSet;r=JSON.stringify(n,(function(e,t){if("object"===typeof t&&null!==t){if(i.has(t))return;i.add(t)}return t}))}t.reject("error"),e.notifyStatusChanged(!1,r)},this.ws.onclose=function(n){e.logger.info("ws closed "+n),t.reject("closed"),e.notifyStatusChanged(!1)},this.ws.onopen=function(){var n;e.startupTimer.mark("ws-opened"),e.logger.info("ws opened "+(null===(n=e.settings.identity)||void 0===n?void 0:n.application)),t.resolve(),e.notifyStatusChanged(!0)},this.ws.onmessage=function(t){e._registry.execute("onMessage",t.data)},t.promise},e.prototype.notifyForSocketState=function(e){this.wsRequests.forEach((function(t){e?t.failed&&t.failed(e):t.callback()})),this.wsRequests=[]},e.prototype.notifyStatusChanged=function(e,t){this._registry.execute("onConnectedChanged",e,t)},e}();var z=1;var q,G,J,K={nextValue:function(){return(z=(9301*z+49297)%233280)/233280},seed:function(e){z=e}},Y="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function $(){J=!1}function Q(e){if(e){if(e!==q){if(e.length!==Y.length)throw new Error("Custom alphabet for shortid must be "+Y.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter((function(e,t,n){return t!==n.lastIndexOf(e)}));if(t.length)throw new Error("Custom alphabet for shortid must be "+Y.length+" unique characters. These characters were not unique: "+t.join(", "));q=e,$()}}else q!==Y&&(q=Y,$())}function X(){return J||(J=function(){q||Q(Y);for(var e,t=q.split(""),n=[],r=K.nextValue();t.length>0;)r=K.nextValue(),e=Math.floor(r*t.length),n.push(t.splice(e,1)[0]);return n.join("")}())}var Z={characters:function(e){return Q(e),q},seed:function(e){K.seed(e),G!==e&&($(),G=e)},lookup:function(e){return X()[e]},shuffled:X},ee="object"===typeof window&&(window.crypto||window.msCrypto);var te=function(){if(!ee||!ee.getRandomValues)return 48&Math.floor(256*Math.random());var e=new Uint8Array(1);return ee.getRandomValues(e),48&e[0]};var ne=function(e,t){for(var n,r=0,i="";!n;)i+=e(t>>4*r&15|te()),n=t<Math.pow(16,r+1),r++;return i};var re=function(e){var t=Z.shuffled();return{version:15&t.indexOf(e.substr(0,1)),worker:15&t.indexOf(e.substr(1,1))}};var ie=function(e){if(!e||"string"!==typeof e||e.length<6)return!1;for(var t=Z.characters(),n=e.length,r=0;r<n;r++)if(-1===t.indexOf(e[r]))return!1;return!0},oe=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t,n,r=0;function i(){var e="",i=Math.floor(.001*(Date.now()-1459707606518));return i===n?t++:(t=0,n=i),e+=ne(Z.lookup,6),e+=ne(Z.lookup,r),t>0&&(e+=ne(Z.lookup,t)),e+=ne(Z.lookup,i)}e.exports=i,e.exports.generate=i,e.exports.seed=function(t){return Z.seed(t),e.exports},e.exports.worker=function(t){return r=t,e.exports},e.exports.characters=function(e){return void 0!==e&&Z.characters(e),Z.shuffled()},e.exports.decode=re,e.exports.isValid=ie})),ae=(oe.generate,oe.seed,oe.worker,oe.characters,oe.decode,oe.isValid,oe);function se(e,t,n,r,i){null==e&&(e="global"),r=r||["success"],i=i||["error"];var o,a=!1,s=!1,u=!1,c=N();t.disconnected((function(){u=!1,n.debug("connection is down"),a=!1,s=!0,c.execute("onLeft",{disconnected:!0})})),t.loggedIn((function(){u=!0,s&&(n.debug("connection is now up - trying to reconnect..."),d(o))})),t.on("success",(function(e){return p(e)})),t.on("error",(function(e){return f(e)})),t.on("result",(function(e){return p(e)})),r&&r.forEach((function(e){t.on(e,(function(e){return p(e)}))})),i&&i.forEach((function(e){t.on(e,(function(e){return f(e)}))}));var l={};function d(t){return o=t,new Promise((function(r,i){if(a)r();else{var o;if("global"===e)o=u?Promise.resolve({}):Promise.reject("not connected to gateway");else n.debug("joining domain "+e),o=g({type:"join",destination:e,domain:"global",options:t});o.then((function(){!function(){n.debug("did join "+e),a=!0;var t=s;s=!1,c.execute("onJoined",t)}(),r()})).catch((function(t){n.debug("error joining "+e+" domain: "+JSON.stringify(t)),i(t)}))}}))}function f(t){if(e===t.domain){var n=t.request_id;if(n){var r=l[n];r&&r.error(t)}}}function p(t){if(t.domain===e){var n=t.request_id;if(n){var r=l[n];r&&r.success(t)}}}function h(){return ae()}function g(r,i,o){o=o||{},r.request_id=r.request_id||h(),r.domain=r.domain||e,o.skipPeerId||(r.peer_id=t.peerId);var a=r.request_id;return new Promise((function(e,s){l[a]={success:function(t){delete l[a],t._tag=i,e(t)},error:function(e){n.warn("GW error - "+JSON.stringify(e)+" for request "+JSON.stringify(r)),delete l[a],e._tag=i,s(e)}},t.send(r,o).catch((function(e){l[a].error({err:e})}))}))}return{join:d,leave:function(){return"global"===e?Promise.resolve():(n.debug("stopping session "+e+"..."),s=!1,g({type:"leave",destination:e,domain:"global"}).then((function(){a=!1,c.execute("onLeft")})))},onJoined:function(e){return a&&e(!1),c.add("onJoined",e)},onLeft:function(e){return a||e(),c.add("onLeft",e)},send:g,sendFireAndForget:function(n){return n.request_id=n.request_id?n.request_id:h(),n.domain=n.domain||e,n.peer_id=t.peerId,t.send(n)},on:function(r,i){t.on(r,(function(t){if(t.domain===e)try{i(t)}catch(r){n.error("Callback  failed: "+r+" \n "+r.stack+" \n msg was: "+JSON.stringify(t),r)}}))},loggedIn:function(e){return t.loggedIn(e)},connected:function(e){return t.connected(e)},disconnected:function(e){return t.disconnected(e)},get peerId(){return t.peerId},get domain(){return e}}}var ue=function(){function e(e,t,n){var r=this;this.connection=e,this.settings=t,this.logger=n,this.protocolVersion=3,this.datePrefix="#T42_DATE#",this.datePrefixLen=this.datePrefix.length,this.dateMinLen=this.datePrefixLen+1,this.datePrefixFirstChar=this.datePrefix[0],this.registry=N(),this._isLoggedIn=!1,this.shouldTryLogin=!0,this.initialLogin=!0,this.initialLoginAttempts=3,this.sessions=[],e.disconnected((function(){r.handleDisconnected()})),this.ping()}return Object.defineProperty(e.prototype,"isLoggedIn",{get:function(){return this._isLoggedIn},enumerable:!0,configurable:!0}),e.prototype.processStringMessage=function(e){var t=this,n=JSON.parse(e,(function(e,n){if("string"!==typeof n)return n;if(n.length<t.dateMinLen)return n;if(n[0]!==t.datePrefixFirstChar)return n;if(n.substring(0,t.datePrefixLen)!==t.datePrefix)return n;try{var r=parseInt(n.substring(t.datePrefixLen,n.length),10);return isNaN(r)?n:new Date(r)}catch(i){return n}}));return{msg:n,msgType:n.type}},e.prototype.createStringMessage=function(e){var t=Date.prototype.toJSON;try{var n=this.datePrefix;return Date.prototype.toJSON=function(){return n+this.getTime()},JSON.stringify(e)}finally{Date.prototype.toJSON=t}},e.prototype.processObjectMessage=function(e){if(!e.type)throw new Error("Object should have type property");return{msg:e,msgType:e.type}},e.prototype.createObjectMessage=function(e){return e},e.prototype.login=function(e,t){return d(this,void 0,void 0,(function(){var r,i,o,a,s,u,c,l,d,p;return f(this,(function(f){switch(f.label){case 0:if(this.logger.debug("logging in..."),this.loginConfig=e,this.loginConfig||(this.loginConfig={username:"",password:""}),this.shouldTryLogin=!0,r={},this.connection.gatewayToken=e.gatewayToken,!e.gatewayToken)return[3,5];if(!t)return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this.getNewGWToken()];case 2:return l=f.sent(),e.gatewayToken=l,[3,4];case 3:return i=f.sent(),this.logger.warn("failed to get GW token when reconnecting "+((null===i||void 0===i?void 0:i.message)||i)),[3,4];case 4:return r.method="gateway-token",r.token=e.gatewayToken,this.connection.gatewayToken=e.gatewayToken,[3,10];case 5:return"sspi"!==e.flowName?[3,9]:(r.provider="win",r.method="access-token",e.flowCallback&&e.sessionId?(o=r,[4,e.flowCallback(e.sessionId,null)]):[3,7]);case 6:return o.token=f.sent().data.toString("base64"),[3,8];case 7:throw new Error("Invalid SSPI config");case 8:return[3,10];case 9:if(e.token)r.method="access-token",r.token=e.token;else{if(!e.username)throw new Error("invalid auth message"+JSON.stringify(e));r.method="secret",r.login=e.username,r.secret=e.password}f.label=10;case 10:a={type:"hello",identity:this.settings.identity,authentication:r},e.sessionId&&(a.request_id=e.sessionId),this.globalDomain=se("global",this.connection,this.logger.subLogger("global-domain"),["welcome","token","authentication-request"]),s={skipPeerId:!0},this.initialLogin&&(s.retryInterval=this.settings.reconnectInterval,s.maxRetries=this.settings.reconnectAttempts),f.label=11;case 11:f.trys.push([11,19,20,21]),u=void 0,f.label=12;case 12:return[4,this.globalDomain.send(a,void 0,s)];case 13:return"authentication-request"!==(c=f.sent()).type?[3,16]:(l=n.from(c.authentication.token,"base64"),e.flowCallback&&e.sessionId?(d=a.authentication,[4,e.flowCallback(e.sessionId,l)]):[3,15]);case 14:d.token=f.sent().data.toString("base64"),f.label=15;case 15:return a.request_id=e.sessionId,[3,12];case 16:if("welcome"===c.type)return u=c,[3,18];throw"error"===c.type?new Error("Authentication failed: "+c.reason):new Error("Unexpected message type during authentication: "+c.type);case 17:return[3,12];case 18:return this.initialLogin=!1,this.logger.debug("login successful with peerId "+u.peer_id),this.connection.peerId=u.peer_id,this.connection.resolvedIdentity=u.resolved_identity,this.connection.availableDomains=u.available_domains,u.options&&(this.connection.token=u.options.access_token,this.connection.info=u.options.info),this.setLoggedIn(!0),[2,u.resolved_identity];case 19:throw p=f.sent(),this.logger.error("error sending hello message - "+(p.message||p.msg||p.reason||p),p),p;case 20:return e&&e.flowCallback&&e.sessionId&&e.flowCallback(e.sessionId,null),[7];case 21:return[2]}}))}))},e.prototype.logout=function(){return d(this,void 0,void 0,(function(){var e;return f(this,(function(t){switch(t.label){case 0:return this.logger.debug("logging out..."),this.shouldTryLogin=!1,this.pingTimer&&clearTimeout(this.pingTimer),e=this.sessions.map((function(e){e.leave()})),[4,Promise.all(e)];case 1:return t.sent(),[2]}}))}))},e.prototype.loggedIn=function(e){return this._isLoggedIn&&e(),this.registry.add("onLoggedIn",e)},e.prototype.domain=function(e,t,n,r){var i=this.sessions.filter((function(t){return t.domain===e}))[0];return i||(i=se(e,this.connection,t,n,r),this.sessions.push(i)),i},e.prototype.handleDisconnected=function(){var e=this;if(this.setLoggedIn(!1),this.shouldTryLogin&&this.initialLogin){if(this.initialLoginAttempts<=0)return;this.initialLoginAttempts--}if(this.logger.debug("disconnected - will try new login?"+this.shouldTryLogin),this.shouldTryLogin){if(!this.loginConfig)throw new Error("no login info");this.connection.login(this.loginConfig,!0).catch((function(){setTimeout(e.handleDisconnected.bind(e),e.settings.reconnectInterval||1e3)}))}},e.prototype.setLoggedIn=function(e){this._isLoggedIn=e,this._isLoggedIn&&this.registry.execute("onLoggedIn")},e.prototype.ping=function(){var e=this;this.shouldTryLogin&&(this._isLoggedIn&&this.connection.send({type:"ping"}),this.pingTimer=setTimeout((function(){e.ping()}),3e4))},e.prototype.authToken=function(){return this.globalDomain?this.globalDomain.send({type:"create-token"}).then((function(e){return e.token})):Promise.reject(new Error("no global domain session"))},e.prototype.getNewGWToken=function(){if(void 0!==typeof window){var e=window.glue42gd;if(e)return e.getGWToken()}return Promise.reject(new Error("not running in GD"))},e}(),ce=function(){function e(e){this.specsNames=[],this.messages={},this.subs={},this.subsRefCount={},this.specs={};for(var t=0,n=e;t<n.length;t++){var r=n[t];this.specs[r.name]=r,this.specsNames.push(r.name)}}return e.prototype.init=function(e){var t=this;this.connection=e;for(var n=0,r=this.specsNames;n<r.length;n++)for(var i=r[n],o=function(n){var r=a.subsRefCount[n];if(r||(r=0),r+=1,a.subsRefCount[n]=r,r>1)return"continue";var i=e.on(n,(function(e){return t.processMessage(n,e)}));a.subs[n]=i},a=this,s=0,u=this.specs[i].types;s<u.length;s++){o(u[s])}},e.prototype.processMessage=function(e,t){if(!this.isDone&&t)for(var n=0,r=this.specsNames;n<r.length;n++){var i=r[n];if(-1!==this.specs[i].types.indexOf(e)){var o=this.messages[i]||[];this.messages[i]=o,o.push(t)}}},e.prototype.drain=function(e,t){var n;t&&(this.messages[e]||[]).forEach(t),delete this.messages[e];for(var r=0,i=this.specs[e].types;r<i.length;r++){var o=i[r];this.subsRefCount[o]-=1,this.subsRefCount[o]<=0&&(null===(n=this.connection)||void 0===n||n.off(this.subs[o]),delete this.subs[o],delete this.subsRefCount[o])}delete this.specs[e],this.specs.length||(this.isDone=!0)},e}(),le=function(e,t,n){return new Promise((function(r,i){var o=setTimeout((function(){i(n||"Promise timeout hit: "+t)}),t);new Promise(e).then((function(e){clearTimeout(o),r(e)})).catch((function(e){clearTimeout(o),i(e)}))}))},de=function(){function e(e,t,n){this.settings=e,this.logger=t,this.identity=n,this.parentReady=!1,this.iAmConnected=!1,this.rejected=!1,this.children=[],this.parentPingTimeout=3e3,this.connectionRequestTimeout=5e3,this.defaultTargetString="*",this.registry=N(),this.messages={connectionAccepted:{name:"connectionAccepted",handle:this.handleConnectionAccepted.bind(this)},connectionRejected:{name:"connectionRejected",handle:this.handleConnectionRejected.bind(this)},connectionRequest:{name:"connectionRequest",handle:this.handleConnectionRequest.bind(this)},parentReady:{name:"parentReady",handle:this.handleParentReady.bind(this)},parentPing:{name:"parentPing",handle:this.handleParentPing.bind(this)},platformPing:{name:"platformPing",handle:this.handlePlatformPing.bind(this)},platformUnload:{name:"platformUnload",handle:this.handlePlatformUnload.bind(this)},platformReady:{name:"platformReady",handle:this.handlePlatformReady.bind(this)},clientUnload:{name:"clientUnload",handle:this.handleClientUnload.bind(this)}},this.setUpMessageListener(),this.setUpUnload(),this.settings.port||(this.parent=window.opener||window.top,this.parentType=window.opener?"opener":-1!==window.name.indexOf("#wsp")?"workspace":"top")}return Object.defineProperty(e.prototype,"transportWindowId",{get:function(){return this.publicWindowId},enumerable:!0,configurable:!0}),e.prototype.sendObject=function(e){return d(this,void 0,void 0,(function(){return f(this,(function(t){if(!this.port)throw new Error("Cannot send message, because the port was not opened yet");return this.port.postMessage(e),[2]}))}))},Object.defineProperty(e.prototype,"isObjectBasedTransport",{get:function(){return!0},enumerable:!0,configurable:!0}),e.prototype.onMessage=function(e){return this.registry.add("onMessage",e)},e.prototype.send=function(){return Promise.reject("not supported")},e.prototype.onConnectedChanged=function(e){return this.registry.add("onConnectedChanged",e)},e.prototype.open=function(){return d(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return this.logger.debug("opening a connection to the web platform gateway."),[4,this.connect()];case 1:return e.sent(),this.notifyStatusChanged(!0),[2]}}))}))},e.prototype.close=function(){return Promise.resolve()},e.prototype.name=function(){return"web-platform"},e.prototype.reconnect=function(){return Promise.resolve()},e.prototype.connect=function(){return d(this,void 0,void 0,(function(){var e=this;return f(this,(function(t){switch(t.label){case 0:if(this.parentReady)return this.logger.debug("cancelling connection attempt, because this client's parent has already given a ready signal"),[2];if(this.settings.port)return this.logger.debug("opening an internal web platform connection"),this.port=this.settings.port,this.publicWindowId=this.settings.windowId,this.identity&&(this.identity.windowId=this.publicWindowId),this.port.onmessage=function(t){return e.registry.execute("onMessage",t.data)},this.logger.debug("internal web platform connection completed"),[2];if(!this.parentType||!this.parent)throw new Error("Cannot initiate a connection, because there is no opener, no top and no port.");return this.logger.debug("opening a "+("opener"===this.parentType?"child":"grandchild")+" client web platform connection"),[4,this.waitParent(this.parent,this.parentType)];case 1:return t.sent(),[4,this.initiateRemoteConnection(this.parent,this.parentType)];case 2:return t.sent(),this.logger.debug("the "+("opener"===this.parentType?"child":"grandchild")+" client is connected"),[2]}}))}))},e.prototype.initiateRemoteConnection=function(e,t){var n=this;return le((function(r,i){n.connectionResolve=r,n.connectionReject=i,n.myClientId=ae();var o="workspace"===n.parentType?window.name.substring(0,window.name.indexOf("#wsp")):window.name,a={glue42core:{type:n.messages.connectionRequest.name,clientId:n.myClientId,clientType:"top"===t||"workspace"===t?"grandChild":"child",bridgeInstanceId:o}};n.logger.debug("sending connection request to "+t),e.postMessage(a,n.defaultTargetString)}),this.connectionRequestTimeout,"The connection to the opener/top window timed out")},e.prototype.waitParent=function(e,t){var n=this;return le((function(r){n.parentPingResolve=r;var i={glue42core:{type:"opener"===t?n.messages.platformPing.name:n.messages.parentPing.name}};n.logger.debug("checking for "+t+" window availability"),e.postMessage(i,n.defaultTargetString)}),this.parentPingTimeout,"Cannot initiate glue, because this window was not opened or created by a glue client")},e.prototype.setUpMessageListener=function(){var e=this;this.settings.port?this.logger.debug("skipping generic message listener, because this is an internal client"):window.addEventListener("message",(function(t){var n,r=null===(n=t.data)||void 0===n?void 0:n.glue42core;if(r&&!e.rejected)if(e.checkMessageTypeValid(r.type)){var i=r.type;e.logger.debug("received valid glue42core message of type: "+i),e.messages[i].handle(t)}else e.logger.error("cannot handle the incoming glue42 core message, because the type is invalid: "+r.type)}))},e.prototype.setUpUnload=function(){var e=this;this.settings.port?this.logger.debug("skipping unload event listener, because this is an internal client"):window.addEventListener("beforeunload",(function(){var t,n,r={glue42core:{type:e.messages.clientUnload.name,data:{clientId:e.myClientId,ownWindowId:null===(t=e.identity)||void 0===t?void 0:t.windowId}}};e.parent&&e.parent.postMessage(r,e.defaultTargetString),null===(n=e.port)||void 0===n||n.postMessage(r)}))},e.prototype.handleParentReady=function(){if(this.logger.debug("handling the ready signal from the parent, by resoling the pending promise."),this.parentReady=!0,this.parentPingResolve)return this.parentPingResolve(),void delete this.parentPingResolve;this.logger.debug("silently handling the ready signal from the top parent, because there is no defined promise")},e.prototype.handlePlatformReady=function(){if(this.logger.debug("the web platform gave the ready signal"),this.parentReady=!0,this.parentPingResolve)return this.parentPingResolve(),void delete this.parentPingResolve;this.logger.debug("silently handling the ready signal from the top parent, because there is no defined promise")},e.prototype.handleConnectionAccepted=function(e){var t,n=null===(t=e.data)||void 0===t?void 0:t.glue42core;return this.myClientId===n.clientId?this.handleAcceptanceOfMyRequest(n):this.handleAcceptanceOfGrandChildRequest(n,e)},e.prototype.handleAcceptanceOfMyRequest=function(e){var t=this;if(this.logger.debug("handling a connection accepted signal targeted at me."),e.port){if(this.publicWindowId="opener"===this.parentType?window.name:"top"===this.parentType?e.parentWindowId:window.name.substring(0,window.name.indexOf("#wsp")),this.identity&&"top"!==this.parentType&&(this.identity.windowId=this.publicWindowId),this.identity&&e.appName&&(this.identity.application=e.appName,this.identity.applicationName=e.appName),this.port=e.port,this.port.onmessage=function(e){return t.registry.execute("onMessage",e.data)},this.connectionResolve)return this.logger.debug("my connection is set up, calling the connection resolve."),this.connectionResolve(),void delete this.connectionResolve;this.logger.error("unable to call the connection resolve, because no connection promise was found")}else this.logger.error("cannot set up my connection, because I was not provided with a port")},e.prototype.handleAcceptanceOfGrandChildRequest=function(e,t){this.logger.debug("handling a connection accepted signal targeted at a grandchild: "+e.clientId);var n=this.children.find((function(t){return t.grandChildId===e.clientId}));n?(n.connected=!0,this.logger.debug("the grandchild connection for "+e.clientId+" is set up, forwarding the success message and the gateway port"),e.parentWindowId=this.publicWindowId,n.source.postMessage(t.data,n.origin,[e.port])):this.logger.error("cannot handle connection accepted for grandchild: "+e.clientId+", because there is no grandchild with this id")},e.prototype.handleConnectionRejected=function(){this.logger.debug("handling a connection rejection. Most likely the reason is that this window was not created by a glue API call"),this.connectionReject&&(this.connectionReject("The platform connection was rejected. Most likely because this window was not created by a glue API call"),delete this.connectionReject)},e.prototype.handleConnectionRequest=function(e){var t=e.source,n=e.data.glue42core;return n.clientType&&"grandChild"===n.clientType?n.clientId?"opener"===this.parentType&&this.parent?(this.logger.debug("handling a connection request for a grandchild: "+n.clientId),this.children.push({grandChildId:n.clientId,source:t,connected:!1,origin:e.origin}),this.logger.debug("grandchild: "+n.clientId+" is prepared, forwarding connection request to the platform"),void this.parent.postMessage(e.data,this.defaultTargetString)):this.rejectConnectionRequest(t,e.origin,"Cannot forward the connection request, because no direct connection to the platform was found"):this.rejectConnectionRequest(t,e.origin,"rejecting a connection request, because the source did not provide a valid id"):this.rejectConnectionRequest(t,e.origin,"rejecting a connection request, because the source was not opened by a glue API call")},e.prototype.handleParentPing=function(e){if(this.parentReady)if(this.iAmConnected){var t={glue42core:{type:this.messages.parentReady.name}},n=e.source;this.logger.debug("responding to a parent ping with a ready message"),n.postMessage(t,e.origin)}else this.logger.debug("i am not fully connected yet, I am ignoring the parent ping");else this.logger.debug("my parent is not ready, I am ignoring the parent ping")},e.prototype.handlePlatformUnload=function(e){this.logger.debug("detected a web platform unload"),this.parentReady=!1,this.children.length&&(this.logger.debug("forwarding the platform unload to all known children and starting platform discovery polling"),this.children.forEach((function(t){return t.source.postMessage(e.data,t.origin)}))),this.notifyStatusChanged(!1,"Gateway unloaded")},e.prototype.handleClientUnload=function(e){var t=e.data.glue42core;t.clientId?this.children.find((function(e){return e.grandChildId===t.clientId}))?(this.logger.debug("handling grandchild unload for id: "+t.clientId),this.children=this.children.filter((function(e){return e.grandChildId!==t.clientId}))):this.logger.warn("cannot process grand child unload, because this client is unaware of this grandchild"):this.logger.warn("cannot process grand child unload, because the provided id was not valid")},e.prototype.handlePlatformPing=function(){this.logger.error("cannot handle platform ping, because this is not a platform calls handling component")},e.prototype.notifyStatusChanged=function(e,t){this.iAmConnected=e,this.registry.execute("onConnectedChanged",e,t)},e.prototype.checkMessageTypeValid=function(e){return"string"===typeof e&&!!this.messages[e]},e.prototype.rejectConnectionRequest=function(e,t,n){this.rejected=!0,this.logger.error(n);var r={glue42core:{type:this.messages.connectionRejected.name}};e.postMessage(r,t)},e}(),fe=function(){function e(e,t){if(this.settings=e,this.logger=t,this.messageHandlers={},this.ids=1,this.registry=N(),this._connected=!1,this.isTrace=!1,(e=e||{}).reconnectAttempts=e.reconnectAttempts||10,e.reconnectInterval=e.reconnectInterval||1e3,e.inproc)this.transport=new L(e.inproc,t.subLogger("inMemory"));else if(e.sharedWorker)this.transport=new D(e.sharedWorker,t.subLogger("shared-worker"));else if(e.webPlatform)this.transport=new de(e.webPlatform,t.subLogger("web-platform"),e.identity);else{if(void 0===e.ws)throw new Error("No connection information specified");this.transport=new H(e,t.subLogger("ws"))}this.isTrace=t.canPublish("trace"),t.debug("starting with "+this.transport.name()+" transport"),this.protocol=new ue(this,e,t.subLogger("protocol")),this.transport.onConnectedChanged(this.handleConnectionChanged.bind(this)),this.transport.onMessage(this.handleTransportMessage.bind(this)),e.replaySpecs&&e.replaySpecs.length&&(this.replayer=new ce(e.replaySpecs),this.replayer.init(this))}return Object.defineProperty(e.prototype,"protocolVersion",{get:function(){var e;return null===(e=this.protocol)||void 0===e?void 0:e.protocolVersion},enumerable:!0,configurable:!0}),e.prototype.send=function(e,t){if(this.transport.sendObject&&this.transport.isObjectBasedTransport){var n=this.protocol.createObjectMessage(e);return this.isTrace&&this.logger.trace(">> "+JSON.stringify(n)),this.transport.sendObject(n,t)}var r=this.protocol.createStringMessage(e);return this.isTrace&&this.logger.trace(">> "+r),this.transport.send(r,t)},e.prototype.on=function(e,t){e=e.toLowerCase(),void 0===this.messageHandlers[e]&&(this.messageHandlers[e]={});var n=this.ids++;return this.messageHandlers[e][n]=t,{type:e,id:n}},e.prototype.off=function(e){delete this.messageHandlers[e.type.toLowerCase()][e.id]},Object.defineProperty(e.prototype,"isConnected",{get:function(){return this.protocol.isLoggedIn},enumerable:!0,configurable:!0}),e.prototype.connected=function(e){var t=this;return this.protocol.loggedIn((function(){e(t.settings.ws||t.settings.sharedWorker||"")}))},e.prototype.disconnected=function(e){return this.registry.add("disconnected",e)},e.prototype.login=function(e,t){return d(this,void 0,void 0,(function(){var n;return f(this,(function(r){switch(r.label){case 0:return[4,this.transport.open()];case 1:return r.sent(),B("connection").mark("transport-opened"),n=this.protocol.login(e,t),B("connection").mark("protocol-logged-in"),[2,n]}}))}))},e.prototype.logout=function(){return d(this,void 0,void 0,(function(){return f(this,(function(e){switch(e.label){case 0:return[4,this.protocol.logout()];case 1:return e.sent(),[4,this.transport.close()];case 2:return e.sent(),[2]}}))}))},e.prototype.loggedIn=function(e){return this.protocol.loggedIn(e)},e.prototype.domain=function(e,t,n){return this.protocol.domain(e,this.logger.subLogger("domain="+e),t,n)},e.prototype.authToken=function(){return this.protocol.authToken()},e.prototype.reconnect=function(){return this.transport.reconnect()},e.prototype.distributeMessage=function(e,t){var n=this,r=this.messageHandlers[t.toLowerCase()];void 0!==r&&Object.keys(r).forEach((function(t){var i=r[t];if(void 0!==i)try{i(e)}catch(o){try{n.logger.error("Message handler failed with "+o.stack,o)}catch(a){console.log("Message handler failed",o)}}}))},e.prototype.handleConnectionChanged=function(e){this._connected!==e&&(this._connected=e,e?this.registry.execute("connected"):this.registry.execute("disconnected"))},e.prototype.handleTransportMessage=function(e){var t;t="string"===typeof e?this.protocol.processStringMessage(e):this.protocol.processObjectMessage(e),this.isTrace&&this.logger.trace("<< "+JSON.stringify(t)),this.distributeMessage(t.msg,t.msgType)},e}(),pe=["trace","debug","info","warn","error","off"],he=function(){function e(e,t,n){this.name=e,this.parent=t,this.subLoggers=[],this.logFn=console,this.customLogFn=!1,this.name=e,this.path=t?t.path+"."+e:e,this.loggerFullName="["+this.path+"]",this.includeTimeAndLevel=!n,n&&(this.logFn=n,this.customLogFn=!0)}return e.prototype.subLogger=function(t){var n=this.subLoggers.filter((function(e){return e.name===t}))[0];if(void 0!==n)return n;Object.keys(this).forEach((function(e){if(e===t)throw new Error("This sub logger name is not allowed.")}));var r=new e(t,this,this.customLogFn?this.logFn:void 0);return this.subLoggers.push(r),r},e.prototype.publishLevel=function(e){var t;return e&&(this._publishLevel=e),this._publishLevel||(null===(t=this.parent)||void 0===t?void 0:t.publishLevel())},e.prototype.consoleLevel=function(e){var t;return e&&(this._consoleLevel=e),this._consoleLevel||(null===(t=this.parent)||void 0===t?void 0:t.consoleLevel())},e.prototype.log=function(e,t,n){this.publishMessage(t||"info",e,n)},e.prototype.trace=function(e){this.log(e,"trace")},e.prototype.debug=function(e){this.log(e,"debug")},e.prototype.info=function(e){this.log(e,"info")},e.prototype.warn=function(e){this.log(e,"warn")},e.prototype.error=function(e,t){this.log(e,"error")},e.prototype.canPublish=function(e,t){return pe.indexOf(e)>=pe.indexOf(t||this.consoleLevel()||"trace")},e.prototype.publishMessage=function(t,n,r){var i=this.loggerFullName;if("error"===t&&!r){var o=new Error;o.stack&&(n=n+"\n"+o.stack.split("\n").slice(3).join("\n"))}if(this.canPublish(t,this.publishLevel())){var a=e.Interop;if(a)try{a.methods({name:e.InteropMethodName}).length>0&&a.invoke(e.InteropMethodName,{msg:""+n,logger:i,level:t})}catch(l){}}if(this.canPublish(t)){var s="";if(this.includeTimeAndLevel){var u=new Date;s="["+(u.getHours()+":"+u.getMinutes()+":"+u.getSeconds()+":"+u.getMilliseconds())+"] ["+t+"] "}var c=""+s+i+": "+n;switch(t){case"trace":this.logFn.debug(c);break;case"debug":this.logFn.debug?this.logFn.debug(c):this.logFn.log(c);break;case"info":this.logFn.info(c);break;case"warn":this.logFn.warn(c);break;case"error":this.logFn.error(c,r)}}},e.InteropMethodName="T42.AppLogger.Log",e}(),ge={get name(){return"context"},get types(){return["create-context","created","destroyed","context-created","context-added","subscribe-context","subscribed-context","unsubscribe-context","destroy-context","context-destroyed","update-context","context-updated","joined"]}};var ve=function(){function e(e,t,n,r){this.updateCallbacks={},this.contextId=e,this.name=t,this.isAnnounced=n,this.activityId=r,this.context={}}return e.prototype.hasCallbacks=function(){return Object.keys(this.updateCallbacks).length>0},e.prototype.getState=function(){return this.isAnnounced&&this.hasCallbacks()?3:this.isAnnounced?2:this.hasCallbacks()?1:0},e}();function ye(e,t,n){try{if((null===n||void 0===n?void 0:n.canPublish("trace"))&&(null===n||void 0===n||n.trace("applying context delta "+JSON.stringify(t)+" on context "+JSON.stringify(e))),!t)return e;if(t.reset)return e=l({},t.reset);if(e=me(e,void 0),t.commands){for(var r=0,i=t.commands;r<i.length;r++){var o=i[r];"remove"===o.type?ke(e,o.path):"set"===o.type&&_e(e,o.value,o.path)}return e}var a=t.added,s=t.updated,u=t.removed;return a&&Object.keys(a).forEach((function(t){e[t]=a[t]})),s&&Object.keys(s).forEach((function(t){be(t,e,s)})),u&&u.forEach((function(t){delete e[t]})),e}catch(c){return null===n||void 0===n||n.error("error applying context delta "+JSON.stringify(t)+" on context "+JSON.stringify(e),c),e}}function me(e,t){if(t=t||new WeakMap,Object(e)!==e)return e;if(e instanceof Set)return new Set(e);if(t.has(e))return t.get(e);var n=e instanceof Date?new Date(e):e instanceof RegExp?new RegExp(e.source,e.flags):e.constructor?new e.constructor:Object.create(null);return t.set(e,n),e instanceof Map&&Array.from(e,(function(e){var r=e[0],i=e[1];return n.set(r,me(i,t))})),Object.assign.apply(Object,p([n],Object.keys(e).map((function(n){var r;return(r={})[n]=me(e[n],t),r}))))}var be=function(e,t,n){var r=n[e];if(void 0===r)return t;var i=t[e];return i&&r?"string"===typeof i||"number"===typeof i||"boolean"===typeof i||"string"===typeof r||"number"===typeof r||"boolean"===typeof r||Array.isArray(i)||Array.isArray(r)?(t[e]=r,t):(t[e]=Object.assign({},i,r),t):(t[e]=r,t)};function we(e,t){if(e===t)return!0;if(!(e instanceof Object)||!(t instanceof Object))return!1;if(e.constructor!==t.constructor)return!1;for(var n in e)if(e.hasOwnProperty(n)){if(!t.hasOwnProperty(n))return!1;if(e[n]!==t[n]){if("object"!==typeof e[n])return!1;if(!we(e[n],t[n]))return!1}}for(var n in t)if(t.hasOwnProperty(n)&&!e.hasOwnProperty(n))return!1;return!0}function _e(e,t,n){var r,i=n.split(".");for(r=0;r<i.length-1;r++)e[i[r]]||(e[i[r]]={}),"object"!==typeof e[i[r]]&&(e[i[r]]={}),e=e[i[r]];e[i[r]]=t}function ke(e,t){var n,r=t.split(".");for(n=0;n<r.length-1;n++){if(!e[r[n]])return;e=e[r[n]]}delete e[r[n]]}var xe,Se=function(){function e(e){var t,n=this;this._contextNameToData={},this._gw3Subscriptions=[],this._nextCallbackSubscriptionNumber=0,this._contextNameToId={},this._contextIdToName={},this._protocolVersion=void 0,this._connection=e.connection,this._logger=e.logger,this._gw3Session=this._connection.domain("global",["context-created","subscribed-context","context-destroyed","context-updated"]),this.subscribeToContextCreatedMessages(),this.subscribeToContextUpdatedMessages(),this.subscribeToContextDestroyedMessages(),null===(t=this._connection.replayer)||void 0===t||t.drain(ge.name,(function(e){var t=e.type;t&&("context-created"===t||"context-added"===t||"created"===t?n.handleContextCreatedMessage(e):"subscribed-context"===t||"context-updated"===t||"joined"===t?n.handleContextUpdatedMessage(e):"context-destroyed"!==t&&"destroyed"!==t||n.handleContextDestroyedMessage(e))}))}return Object.defineProperty(e.prototype,"protocolVersion",{get:function(){var e;if(!this._protocolVersion){var t=this._connection.availableDomains.find((function(e){return"context"===e.uri}));this._protocolVersion=null!==(e=null===t||void 0===t?void 0:t.version)&&void 0!==e?e:1}return this._protocolVersion},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"setPathSupported",{get:function(){return this.protocolVersion>=2},enumerable:!0,configurable:!0}),e.prototype.dispose=function(){for(var e=0,t=this._gw3Subscriptions;e<t.length;e++){var n=t[e];this._connection.off(n)}for(var r in this._gw3Subscriptions.length=0,this._contextNameToData)this._contextNameToId.hasOwnProperty(r)&&delete this._contextNameToData[r]},e.prototype.createContext=function(e,t){var n=this;return this._gw3Session.send({type:"create-context",domain:"global",name:e,data:t,lifetime:"retained"}).then((function(r){n._contextNameToId[e]=r.context_id,n._contextIdToName[r.context_id]=e;var i=n._contextNameToData[e]||new ve(r.context_id,e,!0,void 0);return i.isAnnounced=!0,i.name=e,i.contextId=r.context_id,i.context=t,n._contextNameToData[e]=i,r.context_id}))},e.prototype.all=function(){var e=this;return Object.keys(this._contextNameToData).filter((function(t){return e._contextNameToData[t].isAnnounced}))},e.prototype.update=function(e,t){var n;return d(this,void 0,void 0,(function(){var r,i,o,a=this;return f(this,(function(s){switch(s.label){case 0:return(r=this._contextNameToData[e])&&r.isAnnounced?(i=r.context,r.hasCallbacks()?[3,2]:[4,this.get(r.name)]):[2,this.createContext(e,t)];case 1:i=s.sent(),s.label=2;case 2:return o=2===this.protocolVersion?this.calculateContextDeltaV2(i,t):this.calculateContextDeltaV1(i,t),Object.keys(o.added).length||Object.keys(o.updated).length||o.removed.length||(null===(n=o.commands)||void 0===n?void 0:n.length)?[2,this._gw3Session.send({type:"update-context",domain:"global",context_id:r.contextId,delta:o},{},{skipPeerId:!1}).then((function(e){a.handleUpdated(r,o,{updaterId:e.peer_id})}))]:[2,Promise.resolve()]}}))}))},e.prototype.set=function(e,t){var n=this,r=this._contextNameToData[e];return r&&r.isAnnounced?this._gw3Session.send({type:"update-context",domain:"global",context_id:r.contextId,delta:{reset:t}},{},{skipPeerId:!1}).then((function(e){n.handleUpdated(r,{reset:t,added:{},removed:[],updated:{}},{updaterId:e.peer_id})})):this.createContext(e,t)},e.prototype.setPath=function(e,t,n){return this.setPathSupported?this.setPaths(e,[{path:t,value:n}]):Promise.reject("glue.contexts.setPath operation is not supported, use Glue42 3.10 or later")},e.prototype.setPaths=function(e,t){var n=this;if(!this.setPathSupported)return Promise.reject("glue.contexts.setPaths operation is not supported, use Glue42 3.10 or later");var r=this._contextNameToData[e];if(!r||!r.isAnnounced){for(var i={},o=0,a=t;o<a.length;o++){_e(i,(l=a[o]).value,l.path)}return this.createContext(e,i)}for(var s=[],u=0,c=t;u<c.length;u++){var l;null===(l=c[u]).value?s.push({type:"remove",path:l.path}):s.push({type:"set",path:l.path,value:l.value})}return this._gw3Session.send({type:"update-context",domain:"global",context_id:r.contextId,delta:{commands:s}},{},{skipPeerId:!1}).then((function(e){n.handleUpdated(r,{added:{},removed:[],updated:{},commands:s},{updaterId:e.peer_id})}))},e.prototype.get=function(e){var t,n=this,r=this._contextNameToData[e];if(!r||!r.isAnnounced)return Promise.resolve({});if(r&&!r.hasCallbacks())return new Promise((function(t,r){return d(n,void 0,void 0,(function(){var n=this;return f(this,(function(r){return this.subscribe(e,(function(e,r,i,o){n.unsubscribe(o),t(e)})),[2]}))}))}));var i=null!==(t=null===r||void 0===r?void 0:r.context)&&void 0!==t?t:{};return Promise.resolve(i)},e.prototype.subscribe=function(e,t){var n=this._nextCallbackSubscriptionNumber;this._nextCallbackSubscriptionNumber+=1;var r=this._contextNameToData[e];if(!r||!r.isAnnounced)return r=r||new ve(void 0,e,!1,void 0),this._contextNameToData[e]=r,r.updateCallbacks[n]=t,Promise.resolve(n);var i,o=r.hasCallbacks();return r.updateCallbacks[n]=t,o||r.joinedActivity||r.context&&r.sentExplicitSubscription?(t(i=me(r.context),i,[],n),Promise.resolve(n)):this.sendSubscribe(r).then((function(){return n}))},e.prototype.unsubscribe=function(e){for(var t=0,n=Object.keys(this._contextNameToData);t<n.length;t++){var r=n[t],i=(this._contextNameToId[r],this._contextNameToData[r]);if(!i)return;var o=i.hasCallbacks();delete i.updateCallbacks[e],i.isAnnounced&&o&&!i.hasCallbacks()&&i.sentExplicitSubscription&&this.sendUnsubscribe(i),i.isAnnounced||i.hasCallbacks()||delete this._contextNameToData[r]}},e.prototype.destroy=function(e){var t=this._contextNameToData[e];return t?this._gw3Session.send({type:"destroy-context",domain:"global",context_id:t.contextId}).then((function(e){})):Promise.reject("context with "+e+" does not exist")},e.prototype.handleUpdated=function(e,t,n){var r=e.context;e.context=ye(e.context,t,this._logger),this._contextNameToData[e.name]!==e||we(r,e.context)||this.invokeUpdateCallbacks(e,t,n)},e.prototype.subscribeToContextCreatedMessages=function(){for(var e=0,t=["context-added","context-created","created"];e<t.length;e++){var n=t[e],r=this._connection.on(n,this.handleContextCreatedMessage.bind(this));this._gw3Subscriptions.push(r)}},e.prototype.handleContextCreatedMessage=function(e){var t=e.type;"created"===t?(this._contextNameToId[e.activity_id]=e.context_id,this._contextIdToName[e.context_id]=e.activity_id):"context-added"===t&&(this._contextNameToId[e.name]=e.context_id,this._contextIdToName[e.context_id]=e.name);var n=this._contextIdToName[e.context_id];if(!n)throw new Error("Received created event for context with unknown name: "+e.context_id);if(!this._contextNameToId[n])throw new Error("Received created event for context with unknown id: "+e.context_id);var r=this._contextNameToData[n];if(r){if(r.isAnnounced)return;if(!r.hasCallbacks())throw new Error("Assertion failure: contextData.hasCallbacks()");r.isAnnounced=!0,r.contextId=e.context_id,r.activityId=e.activity_id,r.sentExplicitSubscription||this.sendSubscribe(r)}else this._contextNameToData[n]=r=new ve(e.context_id,n,!0,e.activity_id)},e.prototype.subscribeToContextUpdatedMessages=function(){for(var e=0,t=["context-updated","subscribed-context","joined"];e<t.length;e++){var n=t[e],r=this._connection.on(n,this.handleContextUpdatedMessage.bind(this));this._gw3Subscriptions.push(r)}},e.prototype.handleContextUpdatedMessage=function(e){var t=e.type,n=e.context_id,r=this._contextNameToData[this._contextIdToName[n]],i=!r||!r.isAnnounced;if("joined"===t)r?(r.contextId=n,r.isAnnounced=!0,r.activityId=e.activity_id):(r=new ve(n,e.activity_id,!0,e.activity_id),this._contextNameToData[e.activity_id]=r,this._contextIdToName[n]=e.activity_id,this._contextNameToId[e.activity_id]=n),r.joinedActivity=!0;else if(!r||!r.isAnnounced)return void("subscribed-context"===t?((r=r||new ve(n,e.name,!0,void 0)).sentExplicitSubscription=!0,this._contextNameToData[e.name]=r,this._contextIdToName[n]=e.name,this._contextNameToId[e.name]=n):this._logger.error("Received 'update' for unknown context: "+n));var o=r.context;if("subscribed-context"===t)r.context=e.data||{};else if("joined"===t)r.context=e.context_snapshot||{};else{if("context-updated"!==t)throw new Error("Unrecognized context update message "+t);r.context=ye(r.context,e.delta,this._logger)}!i&&we(r.context,o)&&"subscribed-context"!==t||this.invokeUpdateCallbacks(r,e.delta,{updaterId:e.updater_id})},e.prototype.invokeUpdateCallbacks=function(e,t,n){if((t=t||{added:{},updated:{},reset:{},removed:[]}).commands){t.added=t.updated=t.reset={},t.removed=[];for(var r=0,i=t.commands;r<i.length;r++){var o=i[r];"remove"===o.type?(-1===o.path.indexOf(".")&&t.removed.push(o.path),_e(t.updated,null,o.path)):"set"===o.type&&_e(t.updated,o.value,o.path)}}for(var a in e.updateCallbacks)if(e.updateCallbacks.hasOwnProperty(a))try{(0,e.updateCallbacks[a])(me(e.context),Object.assign({},t.added||{},t.updated||{},t.reset||{}),t.removed,parseInt(a,10),n)}catch(s){this._logger.debug("callback error: "+JSON.stringify(s))}},e.prototype.subscribeToContextDestroyedMessages=function(){for(var e=0,t=["context-destroyed","destroyed"];e<t.length;e++){var n=t[e],r=this._connection.on(n,this.handleContextDestroyedMessage.bind(this));this._gw3Subscriptions.push(r)}},e.prototype.handleContextDestroyedMessage=function(e){var t,n;if("destroyed"===e.type){if(n=e.activity_id,!(t=this._contextNameToId[n]))return void this._logger.error("Received 'destroyed' for unknown activity: "+e.activity_id)}else if(t=e.context_id,!(n=this._contextIdToName[t]))return void this._logger.error("Received 'destroyed' for unknown context: "+e.context_id);delete this._contextIdToName[t],delete this._contextNameToId[n];var r=this._contextNameToData[n];delete this._contextNameToData[n],r&&r.isAnnounced||this._logger.error("Received 'destroyed' for unknown context: "+t)},e.prototype.sendSubscribe=function(e){return e.sentExplicitSubscription=!0,this._gw3Session.send({type:"subscribe-context",domain:"global",context_id:e.contextId}).then((function(e){}))},e.prototype.sendUnsubscribe=function(e){return e.sentExplicitSubscription=!1,this._gw3Session.send({type:"unsubscribe-context",domain:"global",context_id:e.contextId}).then((function(e){}))},e.prototype.calculateContextDeltaV1=function(e,t){var n={added:{},updated:{},removed:[],reset:void 0};if(e)for(var r=0,i=Object.keys(e);r<i.length;r++){var o=i[r];-1===Object.keys(t).indexOf(o)||null===t[o]||we(e[o],t[o])||(n.updated[o]=t[o])}for(var a=0,s=Object.keys(t);a<s.length;a++){o=s[a];e&&-1!==Object.keys(e).indexOf(o)?null===t[o]&&n.removed.push(o):null!==t[o]&&(n.added[o]=t[o])}return n},e.prototype.calculateContextDeltaV2=function(e,t){for(var n,r,i={added:{},updated:{},removed:[],reset:void 0,commands:[]},o=0,a=Object.keys(t);o<a.length;o++){var s=a[o];if(null!==t[s])we(e?e[s]:null,t[s])||null===(n=i.commands)||void 0===n||n.push({type:"set",path:s,value:t[s]});else null===(r=i.commands)||void 0===r||r.push({type:"remove",path:s})}return i},e}(),Ie=function(){function e(e){this._bridge=new Se(e)}return e.prototype.all=function(){return this._bridge.all()},e.prototype.update=function(e,t){return this.checkName(e),this.checkData(t),this._bridge.update(e,t)},e.prototype.set=function(e,t){return this.checkName(e),this.checkData(t),this._bridge.set(e,t)},e.prototype.setPath=function(e,t,n){return this.checkName(e),this.checkPath(t),""===t?(this.checkData(n),this.set(e,n)):this._bridge.setPath(e,t,n)},e.prototype.setPaths=function(e,t){if(this.checkName(e),!Array.isArray(t))throw new Error("Please provide the paths as an array of PathValues!");for(var n=0,r=t;n<r.length;n++){var i=r[n],o=i.path,a=i.value;this.checkPath(o),""===o&&this.checkData(a)}return this._bridge.setPaths(e,t)},e.prototype.subscribe=function(e,t){var n=this;if(this.checkName(e),"function"!==typeof t)throw new Error("Please provide the callback as a function!");return this._bridge.subscribe(e,(function(e,r,i,o,a){return t(e,r,i,(function(){return n._bridge.unsubscribe(o)}),a)})).then((function(e){return function(){n._bridge.unsubscribe(e)}}))},e.prototype.get=function(e){return this.checkName(e),this._bridge.get(e)},e.prototype.ready=function(){return Promise.resolve(this)},e.prototype.destroy=function(e){return this.checkName(e),this._bridge.destroy(e)},Object.defineProperty(e.prototype,"setPathSupported",{get:function(){return this._bridge.setPathSupported},enumerable:!0,configurable:!0}),e.prototype.checkName=function(e){if("string"!==typeof e||""===e)throw new Error("Please provide the name as a non-empty string!")},e.prototype.checkPath=function(e){if("string"!==typeof e)throw new Error("Please provide the path as a dot delimited string!")},e.prototype.checkData=function(e){if("object"!==typeof e)throw new Error("Please provide the data as an object!")},e}();function Ce(e,t,n){return"function"!==typeof t&&"function"!==typeof n?e:("function"!==typeof t?t=function(){}:"function"!==typeof n&&(n=function(){}),e.then(t,n))}function Te(e,t,n){var r;return void 0===e&&(e=0),t.finally((function(){r&&clearTimeout(r)})),new Promise((function(t,i){r=setTimeout((function(){return i(n)}),e)}))}!function(e){e[e.Success=0]="Success",e[e.Error=1]="Error"}(xe||(xe={}));var Pe=function(){function e(e,t,n,r){this.protocol=e,this.repo=t,this.instance=n,this.configuration=r}return e.prototype.subscribe=function(e,t,n,r,i){var o=this,a=function(e,n,r,a){var s;t.methodResponseTimeout=null!==(s=t.methodResponseTimeout)&&void 0!==s?s:t.waitTimeoutMs,o.protocol.client.subscribe(n,t,e,r,a,i)};return Ce(new Promise((function(n,r){var i,s=function(e){n(e)},u=function(e){r(e)};if(e)if((i="string"===typeof e?{name:e}:e).name){void 0===t&&(t={});var c=t.target;if(void 0===c&&(c="best"),"string"!==typeof c||"all"===c||"best"===c){void 0===t.methodResponseTimeout&&(t.methodResponseTimeout=t.method_response_timeout,void 0===t.methodResponseTimeout&&(t.methodResponseTimeout=o.configuration.methodResponseTimeout)),void 0===t.waitTimeoutMs&&(t.waitTimeoutMs=t.wait_for_method_timeout,void 0===t.waitTimeoutMs&&(t.waitTimeoutMs=o.configuration.waitTimeoutMs));var l=0,d=o.getServerMethodsByFilterAndTarget(i,c);if(d.length>0)a(d,d[0].methods[0],s,u);else{setTimeout((function n(){if(c&&t.waitTimeoutMs)if(l+=500,(d=o.getServerMethodsByFilterAndTarget(i,c)).length>0){var r=d[0].methods[0];a(d,r,s,u)}else if(l>=t.waitTimeoutMs){a(d,"string"===typeof e?{name:e}:e,s,u)}else setTimeout(n,500)}),500)}}else r(new Error('"'+c+'" is not a valid target. Valid targets are "all", "best", or an instance.'))}else r("Method definition is required. Please, provide either a unique string for a method name or a \u201cmethodDefinition\u201d object with a required \u201cname\u201d property.");else r("Method definition is required. Please, provide either a unique string for a method name or a \u201cmethodDefinition\u201d object with a required \u201cname\u201d property.")})),n,r)},e.prototype.servers=function(e){var t=void 0===e?void 0:l({},e);return this.getServers(t).map((function(e){return e.server.instance}))},e.prototype.methods=function(e){return e="string"===typeof e?{name:e}:l({},e),this.getMethods(e)},e.prototype.methodsForInstance=function(e){return this.getMethodsForInstance(e)},e.prototype.methodAdded=function(e){return this.repo.onMethodAdded(e)},e.prototype.methodRemoved=function(e){return this.repo.onMethodRemoved(e)},e.prototype.serverAdded=function(e){return this.repo.onServerAdded(e)},e.prototype.serverRemoved=function(e){return this.repo.onServerRemoved((function(t,n){e(t,n)}))},e.prototype.serverMethodAdded=function(e){return this.repo.onServerMethodAdded((function(t,n){e({server:t,method:n})}))},e.prototype.serverMethodRemoved=function(e){return this.repo.onServerMethodRemoved((function(t,n){e({server:t,method:n})}))},e.prototype.invoke=function(e,t,n,r,i,o){return d(this,void 0,void 0,(function(){var a=this;return f(this,(function(s){return[2,Ce(function(){return d(a,void 0,void 0,(function(){var i,o,a,s,u,c,d,p,h,g,v,y,m=this;return f(this,(function(f){switch(f.label){case 0:if(!(i="string"===typeof e?{name:e}:l({},e)).name)return[2,Promise.reject("Method definition is required. Please, provide either a unique string for a method name or a \u201cmethodDefinition\u201d object with a required \u201cname\u201d property.")];if(t||(t={}),n||(n="best"),"string"===typeof n&&"all"!==n&&"best"!==n&&"skipMine"!==n)return[2,Promise.reject(new Error('"'+n+'" is not a valid target. Valid targets are "all" and "best".'))];if(r||(r={}),void 0===r.methodResponseTimeoutMs&&(r.methodResponseTimeoutMs=r.method_response_timeout,void 0===r.methodResponseTimeoutMs&&(r.methodResponseTimeoutMs=this.configuration.methodResponseTimeout)),void 0===r.waitTimeoutMs&&(r.waitTimeoutMs=r.wait_for_method_timeout,void 0===r.waitTimeoutMs&&(r.waitTimeoutMs=this.configuration.waitTimeoutMs)),void 0!==r.waitTimeoutMs&&"number"!==typeof r.waitTimeoutMs)return[2,Promise.reject(new Error('"'+r.waitTimeoutMs+'" is not a valid number for "waitTimeoutMs" '))];if("object"!==typeof t)return[2,Promise.reject(new Error("The method arguments must be an object. method: "+i.name))];if(0!==(o=this.getServerMethodsByFilterAndTarget(i,n)).length)return[3,4];f.label=1;case 1:return f.trys.push([1,3,,4]),[4,this.tryToAwaitForMethods(i,n,r)];case 2:return o=f.sent(),[3,4];case 3:return f.sent(),a=l(l({},i),{getServers:function(){return[]},supportsStreaming:!1,objectTypes:null!==(g=i.objectTypes)&&void 0!==g?g:[],flags:null!==(y=null===(v=i.flags)||void 0===v?void 0:v.metadata)&&void 0!==y?y:{}}),s={method:a,called_with:t,message:"Can not find a method matching "+JSON.stringify(e)+" with server filter "+JSON.stringify(n),executed_by:void 0,returned:void 0,status:void 0},[2,Promise.reject(s)];case 4:return u=r.methodResponseTimeoutMs,c=r,d=o.map((function(e){var n=ae(),r=e.methods[0],i=e.server,o=m.protocol.client.invoke(n,r,t,i,c);return Promise.race([o,Te(u,o,{invocationId:n,message:"Invocation timeout ("+u+" ms) reached for method name: "+(null===r||void 0===r?void 0:r.name)+", target instance: "+JSON.stringify(i.instance)+", options: "+JSON.stringify(c),status:xe.Error})])})),[4,Promise.all(d)];case 5:return p=f.sent(),h=this.getInvocationResultObj(p,i,t),p.every((function(e){return e.status===xe.Error}))?[2,Promise.reject(h)]:[2,h]}}))}))}(),i,o)]}))}))},e.prototype.getInvocationResultObj=function(e,t,n){var r=e.filter((function(e){return e.status===xe.Success})).reduce((function(e,r){return e=p(e,[{executed_by:r.instance,returned:r.result,called_with:n,method:t,message:r.message,status:r.status}])}),[]),i=e.filter((function(e){return e.status===xe.Error})).reduce((function(e,r){return e=p(e,[{executed_by:r.instance,called_with:n,name:t.name,message:r.message}])}),[]),o=e[0];return{method:t,called_with:n,returned:o.result,executed_by:o.instance,all_return_values:r,all_errors:i,message:o.message,status:o.status}},e.prototype.tryToAwaitForMethods=function(e,t,n){var r=this;return new Promise((function(i,o){if(0!==n.waitTimeoutMs)var a=0,s=setInterval((function(){a+=500;var u=r.getServerMethodsByFilterAndTarget(e,t);if(u.length>0)clearInterval(s),i(u);else if(a>=(n.waitTimeoutMs||1e4))return clearInterval(s),void o()}),500);else o()}))},e.prototype.filterByTarget=function(e,t){var n=this;if("string"!==typeof e){return(Array.isArray(e)?e:[e]).reduce((function(e,r){var i=t.filter((function(e){return n.instanceMatch(r,e.server.instance)}));return e.concat(i)}),[])}if("all"===e)return p(t);if("best"===e){var r=t.find((function(e){return e.server.instance.isLocal}));if(r)return[r];if(void 0!==t[0])return[t[0]]}else if("skipMine"===e)return t.filter((function(e){return e.server.instance.peerId!==n.instance.peerId}));return[]},e.prototype.instanceMatch=function(e,t){return this.containsProps(e,t)},e.prototype.methodMatch=function(e,t){return this.containsProps(e,t)},e.prototype.containsProps=function(e,t){return Object.keys(e).filter((function(t){return void 0!==e[t]&&"function"!==typeof e[t]&&"object_types"!==t&&"display_name"!==t&&"id"!==t&&"gatewayId"!==t&&"identifier"!==t&&"_"!==t[0]})).every((function(n){var r,i=e[n],o=t[n];switch(n){case"objectTypes":r=(i||[]).every((function(e){return(o||[]).includes(e)}));break;case"flags":r=function e(t,n){return Object.keys(n).every((function(r){return"object"===typeof n[r]?e((null===t||void 0===t?void 0:t[r])||{},n[r]||{}):n[r]===(null===t||void 0===t?void 0:t[r])}))}(o||{},i||{});break;default:r=String(i).toLowerCase()===String(o).toLowerCase()}return r}))},e.prototype.getMethods=function(e){var t=this;return void 0===e?this.repo.getMethods():this.repo.getMethods().filter((function(n){return t.methodMatch(e,n)}))},e.prototype.getMethodsForInstance=function(e){var t=this,n=this.repo.getServers().filter((function(n){return t.instanceMatch(e,n.instance)}));if(0===n.length)return[];var r={};return 1===n.length?r=n[0].methods:n.forEach((function(e){Object.keys(e.methods).forEach((function(t){var n=e.methods[t];r[n.identifier]=n}))})),Object.keys(r).map((function(e){return r[e]}))},e.prototype.getServers=function(e){var t=this,n=this.repo.getServers();return void 0===e?n.map((function(e){return{server:e,methods:[]}})):n.reduce((function(n,r){var i=Object.values(r.methods).filter((function(n){return t.methodMatch(e,n)}));return i.length>0&&n.push({server:r,methods:i}),n}),[])},e.prototype.getServerMethodsByFilterAndTarget=function(e,t){var n=this.getServers(e);return this.filterByTarget(t,n)},e}(),Ae=function(){function e(e,t,n){this.protocol=e,this.repoMethod=t,this.subscription=n}return Object.defineProperty(e.prototype,"stream",{get:function(){if(!this.repoMethod.stream)throw new Error("no stream");return this.repoMethod.stream},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"arguments",{get:function(){return this.subscription.arguments||{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"branchKey",{get:function(){return this.subscription.branchKey},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instance",{get:function(){if(!this.subscription.instance)throw new Error("no instance");return this.subscription.instance},enumerable:!0,configurable:!0}),e.prototype.close=function(){this.protocol.server.closeSingleSubscription(this.repoMethod,this.subscription)},e.prototype.push=function(e){this.protocol.server.pushDataToSingle(this.repoMethod,this.subscription,e)},e}(),Ee=function(){function e(e,t,n){this.protocol=e,this.repoMethod=t,this.requestContext=n,this.arguments=n.arguments,this.instance=n.instance}return e.prototype.accept=function(){this.protocol.server.acceptRequestOnBranch(this.requestContext,this.repoMethod,"")},e.prototype.acceptOnBranch=function(e){this.protocol.server.acceptRequestOnBranch(this.requestContext,this.repoMethod,e)},e.prototype.reject=function(e){this.protocol.server.rejectRequest(this.requestContext,this.repoMethod,e)},e}(),Oe=function(){function e(e,t){var n=this;this.protocol=e,this.server=t,e.server.onSubRequest((function(e,t){return n.handleSubRequest(e,t)})),e.server.onSubAdded((function(e,t){return n.handleSubAdded(e,t)})),e.server.onSubRemoved((function(e,t){return n.handleSubRemoved(e,t)}))}return e.prototype.handleSubRequest=function(e,t){if(t&&t.streamCallbacks&&"function"===typeof t.streamCallbacks.subscriptionRequestHandler){var n=new Ee(this.protocol,t,e);t.streamCallbacks.subscriptionRequestHandler(n)}},e.prototype.handleSubAdded=function(e,t){if(t&&t.streamCallbacks&&"function"===typeof t.streamCallbacks.subscriptionAddedHandler){var n=new Ae(this.protocol,t,e);t.streamCallbacks.subscriptionAddedHandler(n)}},e.prototype.handleSubRemoved=function(e,t){if(t&&t.streamCallbacks&&"function"===typeof t.streamCallbacks.subscriptionRemovedHandler){var n=new Ae(this.protocol,t,e);t.streamCallbacks.subscriptionRemovedHandler(n)}},e}(),Me=function(){function e(e,t,n){this.key=e,this.protocol=t,this.repoMethod=n}return e.prototype.subscriptions=function(){var e=this;return this.protocol.server.getSubscriptionList(this.repoMethod,this.key).map((function(t){return new Ae(e.protocol,e.repoMethod,t)}))},e.prototype.close=function(){this.protocol.server.closeAllSubscriptions(this.repoMethod,this.key)},e.prototype.push=function(e){this.protocol.server.pushData(this.repoMethod,e,[this.key])},e}(),je=function(){function e(e,t,n){this._protocol=e,this._repoMethod=t,this._server=n,this.name=this._repoMethod.definition.name}return e.prototype.branches=function(e){var t=this,n=this._protocol.server.getBranchList(this._repoMethod);return e?n.indexOf(e)>-1?new Me(e,this._protocol,this._repoMethod):void 0:n.map((function(e){return new Me(e,t._protocol,t._repoMethod)}))},e.prototype.branch=function(e){return this.branches(e)},e.prototype.subscriptions=function(){var e=this;return this._protocol.server.getSubscriptionList(this._repoMethod).map((function(t){return new Ae(e._protocol,e._repoMethod,t)}))},Object.defineProperty(e.prototype,"definition",{get:function(){var e,t=this._repoMethod.definition;return{accepts:t.accepts,description:t.description,displayName:t.displayName,name:t.name,objectTypes:t.objectTypes,returns:t.returns,supportsStreaming:t.supportsStreaming,flags:null===(e=t.flags)||void 0===e?void 0:e.metadata}},enumerable:!0,configurable:!0}),e.prototype.close=function(){this._protocol.server.closeAllSubscriptions(this._repoMethod),this._server.unregister(this._repoMethod.definition,!0)},e.prototype.push=function(e,t){if("string"!==typeof t&&!Array.isArray(t)&&void 0!==t)throw new Error("invalid branches should be string or string array");if("object"!==typeof e)throw new Error("Invalid arguments. Data must be an object.");this._protocol.server.pushData(this._repoMethod,e,t)},e.prototype.updateRepoMethod=function(e){this._repoMethod=e},e}(),Re=function(){function e(e,t){this.protocol=e,this.serverRepository=t,this.invocations=0,this.currentlyUnregistering={},this.streaming=new Oe(e,this),this.protocol.server.onInvoked(this.onMethodInvoked.bind(this))}return e.prototype.createStream=function(e,t,n,r,i){var o=this;return Ce(new Promise((function(n,r){if(e){var a;if(!(a="string"===typeof e?{name:""+e}:l({},e)).name)return r("The \u201cname\u201d property is required for the \u201cstreamDefinition\u201d object and must be unique. Stream definition: "+JSON.stringify(a));if(o.serverRepository.getList().some((function(e){return e.definition.name===a.name})))return r('A stream with the name "'+a.name+'" already exists! Please, provide a unique name for the stream.');a.supportsStreaming=!0,t||(t={}),"function"!==typeof t.subscriptionRequestHandler&&(t.subscriptionRequestHandler=function(e){e.accept()});var s=o.serverRepository.add({definition:a,streamCallbacks:t,protocolState:{}});o.protocol.server.createStream(s).then((function(){var e;i?(e=i,i.updateRepoMethod(s)):e=new je(o.protocol,s,o),s.stream=e,n(e)})).catch((function(e){s.repoId&&o.serverRepository.remove(s.repoId),r(e)}))}else r("The stream name must be unique! Please, provide either a unique string for a stream name to \u201cglue.interop.createStream()\u201d or a \u201cmethodDefinition\u201d object with a unique \u201cname\u201d property for the stream.")})),n,r)},e.prototype.register=function(e,t){var n=this;if(!e)return Promise.reject("Method definition is required. Please, provide either a unique string for a method name or a \u201cmethodDefinition\u201d object with a required \u201cname\u201d property.");if("function"!==typeof t)return Promise.reject("The second parameter must be a callback function. Method: "+("string"===typeof e?e:e.name));var r=function(e,r){return d(n,void 0,void 0,(function(){var n,i,o;return f(this,(function(a){switch(a.label){case 0:return a.trys.push([0,4,,5]),(n=t(e.args,e.instance))&&"function"===typeof n.then?[4,n]:[3,2];case 1:return i=a.sent(),r(void 0,i),[3,3];case 2:r(void 0,n),a.label=3;case 3:return[3,5];case 4:return(o=a.sent())||(o=""),r(o,o),[3,5];case 5:return[2]}}))}))};return r.userCallback=t,this.registerCore(e,r)},e.prototype.registerAsync=function(e,t){if(!e)return Promise.reject("Method definition is required. Please, provide either a unique string for a method name or a \u201cmethodDefinition\u201d object with a required \u201cname\u201d property.");if("function"!==typeof t)return Promise.reject("The second parameter must be a callback function. Method: "+("string"===typeof e?e:e.name));var n=function(e,n){try{var r=!1,i=function(e){r||n(void 0,e),r=!0},o=function(e){r||(e||(e=""),n(e,e)),r=!0},a=t(e.args,e.instance,i,o);a&&"function"===typeof a.then&&a.then(i).catch(o)}catch(s){n(s,void 0)}};return n.userCallbackAsync=t,this.registerCore(e,n)},e.prototype.unregister=function(e,t){return void 0===t&&(t=!1),d(this,void 0,void 0,(function(){var n,r;return f(this,(function(i){switch(i.label){case 0:return void 0===e?[2,Promise.reject("Please, provide either a unique string for a name or an object containing a \u201cname\u201d property.")]:"function"!==typeof e?[3,2]:[4,this.unregisterWithPredicate(e,t)];case 1:return i.sent(),[2];case 2:return void 0===(n="string"===typeof e?{name:e}:e).name?[2,Promise.reject("Method name is required. Cannot find a method if the method name is undefined!")]:(r=this.serverRepository.getList().find((function(e){return e.definition.name===n.name&&(e.definition.supportsStreaming||!1)===t})))?[4,this.removeMethodsOrStreams([r])]:[2,Promise.reject('Method with a name "'+n.name+'" does not exist or is not registered by your application!')];case 3:return i.sent(),[2]}}))}))},e.prototype.unregisterWithPredicate=function(e,t){return d(this,void 0,void 0,(function(){var n;return f(this,(function(r){switch(r.label){case 0:return(n=this.serverRepository.getList().filter((function(t){return e(t.definition)})).filter((function(e){return(e.definition.supportsStreaming||!1)===t})))&&0!==n.length?[4,this.removeMethodsOrStreams(n)]:[2,Promise.reject("Could not find a "+(t?"stream":"method")+" matching the specified condition!")];case 1:return r.sent(),[2]}}))}))},e.prototype.removeMethodsOrStreams=function(e){var t=this,n=[];return e.forEach((function(e){var r=t.protocol.server.unregister(e).then((function(){e.repoId&&t.serverRepository.remove(e.repoId)}));n.push(r),t.addAsCurrentlyUnregistering(e.definition.name,r)})),Promise.all(n)},e.prototype.addAsCurrentlyUnregistering=function(e,t){return d(this,void 0,void 0,(function(){var n,r=this;return f(this,(function(i){return n=new Promise((function(e){return setTimeout(e,5e3)})),this.currentlyUnregistering[e]=Promise.race([t,n]).then((function(){delete r.currentlyUnregistering[e]})),[2]}))}))},e.prototype.registerCore=function(e,t){return d(this,void 0,void 0,(function(){var n,r,i,o=this;return f(this,(function(a){switch(a.label){case 0:return(n="string"===typeof e?{name:""+e}:l({},e)).name?(r=this.currentlyUnregistering[n.name])?[4,r]:[3,2]:[2,Promise.reject("Please, provide a (unique) string value for the \u201cname\u201d property in the \u201cmethodDefinition\u201d object: "+JSON.stringify(e))];case 1:a.sent(),a.label=2;case 2:return this.serverRepository.getList().some((function(e){return e.definition.name===n.name}))?[2,Promise.reject('A method with the name "'+n.name+'" already exists! Please, provide a unique name for the method.')]:n.supportsStreaming?[2,Promise.reject("When you create methods with \u201cglue.interop.register()\u201d or \u201cglue.interop.registerAsync()\u201d the property \u201csupportsStreaming\u201d cannot be \u201ctrue\u201d. If you want \u201c"+n.name+"\u201d to be a stream, please use the \u201cglue.interop.createStream()\u201d method.")]:(i=this.serverRepository.add({definition:n,theFunction:t,protocolState:{}}),[2,this.protocol.server.register(i).catch((function(e){throw(null===i||void 0===i?void 0:i.repoId)&&o.serverRepository.remove(i.repoId),e}))])}}))}))},e.prototype.onMethodInvoked=function(e,t,n){var r=this;e&&e.theFunction&&e.theFunction(n,(function(n,i){if(void 0!==n&&null!==n)if(n.message&&"string"===typeof n.message)n=n.message;else if("string"!==typeof n)try{n=JSON.stringify(n)}catch(o){n="un-stringifyable error in onMethodInvoked! Top level prop names: "+Object.keys(n)}i?("object"!==typeof i||Array.isArray(i))&&(i={_value:i}):i={},r.protocol.server.methodInvocationResult(e,t,n,i)}))},e}(),Ne=function(){function e(e,t,n){var r=this;this.wrapped={},this.wrapped.getMethods=function(){return e.methodsForInstance(this)},this.wrapped.getStreams=function(){return e.methodsForInstance(this).filter((function(e){return e.supportsStreaming}))},t&&this.refreshWrappedObject(t),n&&(n.loggedIn((function(){r.refresh(n)})),this.refresh(n))}return e.prototype.unwrap=function(){return this.wrapped},e.prototype.refresh=function(e){if(e){var t=null===e||void 0===e?void 0:e.resolvedIdentity,n=Object.assign({},null!==t&&void 0!==t?t:{},{peerId:null===e||void 0===e?void 0:e.peerId});this.refreshWrappedObject(n)}},e.prototype.refreshWrappedObject=function(e){var t,n,r;this.wrapped.user=e.user,this.wrapped.instance=e.instance,this.wrapped.application=null!==(t=e.application)&&void 0!==t?t:ae(),this.wrapped.applicationName=e.applicationName,this.wrapped.pid=null!==(r=null!==(n=e.pid)&&void 0!==n?n:e.process)&&void 0!==r?r:Math.floor(1e10*Math.random()),this.wrapped.machine=e.machine,this.wrapped.environment=e.environment,this.wrapped.region=e.region,this.wrapped.windowId=e.windowId,this.wrapped.isLocal=!0,this.wrapped.api=e.api,this.wrapped.service=e.service,this.wrapped.peerId=e.peerId},e}(),Le=function(e){return l(l({},e),{flags:e.flags.metadata||{}})},De=function(){function e(e,t){this.logger=e,this.API=t,this.servers={},this.methodsCount={},this.callbacks=N();var n=this.API.instance.peerId;this.myServer={id:n,methods:{},instance:this.API.instance,wrapper:this.API.unwrappedInstance},this.servers[n]=this.myServer}return e.prototype.addServer=function(e,t){this.logger.debug("adding server "+t);var n=this.servers[t];if(n)return n.id;var r=new Ne(this.API,e),i={id:t,methods:{},instance:r.unwrap(),wrapper:r};return this.servers[t]=i,this.callbacks.execute("onServerAdded",i.instance),t},e.prototype.removeServerById=function(e,t){var n=this,r=this.servers[e];r?(this.logger.debug("removing server "+e),Object.keys(r.methods).forEach((function(t){n.removeServerMethod(e,t)})),delete this.servers[e],this.callbacks.execute("onServerRemoved",r.instance,t)):this.logger.warn("not aware of server "+e+", my state "+JSON.stringify(Object.keys(this.servers)))},e.prototype.addServerMethod=function(e,t){var n,r=this.servers[e];if(!r)throw new Error("server does not exists");if(!r.methods[t.id]){var i=this.createMethodIdentifier(t),o=this,a={identifier:i,gatewayId:t.id,name:t.name,displayName:t.display_name,description:t.description,version:t.version,objectTypes:t.object_types||[],accepts:t.input_signature,returns:t.result_signature,supportsStreaming:"undefined"!==typeof t.flags&&t.flags.streaming,flags:null!==(n=t.flags)&&void 0!==n?n:{},getServers:function(){return o.getServersByMethod(i)}};a.object_types=a.objectTypes,a.display_name=a.displayName,a.version=a.version,r.methods[t.id]=a;var s=Le(a);return this.methodsCount[i]||(this.methodsCount[i]=0,this.callbacks.execute("onMethodAdded",s)),this.methodsCount[i]=this.methodsCount[i]+1,this.callbacks.execute("onServerMethodAdded",r.instance,s),a}},e.prototype.removeServerMethod=function(e,t){var n=this.servers[e];if(!n)throw new Error("server does not exists");var r=n.methods[t];delete n.methods[t];var i=Le(r);this.methodsCount[r.identifier]=this.methodsCount[r.identifier]-1,0===this.methodsCount[r.identifier]&&this.callbacks.execute("onMethodRemoved",i),this.callbacks.execute("onServerMethodRemoved",n.instance,i)},e.prototype.getMethods=function(){return this.extractMethodsFromServers(Object.values(this.servers)).map(Le)},e.prototype.getServers=function(){return Object.values(this.servers).map(this.hideServerMethodSystemFlags)},e.prototype.onServerAdded=function(e){var t=this.callbacks.add("onServerAdded",e),n=this.getServers().map((function(e){return e.instance}));return this.returnUnsubWithDelayedReplay(t,n,e)},e.prototype.onMethodAdded=function(e){var t=this.callbacks.add("onMethodAdded",e),n=this.getMethods();return this.returnUnsubWithDelayedReplay(t,n,e)},e.prototype.onServerMethodAdded=function(e){var t=this.callbacks.add("onServerMethodAdded",e),n=!1,r=this.getServers();return setTimeout((function(){r.forEach((function(t){var r=t.methods;Object.keys(r).forEach((function(i){n||e(t.instance,r[i])}))}))}),0),function(){n=!0,t()}},e.prototype.onMethodRemoved=function(e){return this.callbacks.add("onMethodRemoved",e)},e.prototype.onServerRemoved=function(e){return this.callbacks.add("onServerRemoved",e)},e.prototype.onServerMethodRemoved=function(e){return this.callbacks.add("onServerMethodRemoved",e)},e.prototype.getServerById=function(e){return this.hideServerMethodSystemFlags(this.servers[e])},e.prototype.reset=function(){var e,t=this;Object.keys(this.servers).forEach((function(e){t.removeServerById(e,"reset")})),this.servers=((e={})[this.myServer.id]=this.myServer,e),this.methodsCount={}},e.prototype.createMethodIdentifier=function(e){var t=void 0!==e.input_signature?e.input_signature:"",n=void 0!==e.result_signature?e.result_signature:"";return(e.name+t+n).toLowerCase()},e.prototype.getServersByMethod=function(e){var t=[];return Object.values(this.servers).forEach((function(n){Object.values(n.methods).forEach((function(r){r.identifier===e&&t.push(n.instance)}))})),t},e.prototype.returnUnsubWithDelayedReplay=function(e,t,n){var r=!1;return setTimeout((function(){t.forEach((function(e){r||n(e)}))}),0),function(){r=!0,e()}},e.prototype.hideServerMethodSystemFlags=function(e){var t={};return Object.entries(e.methods).forEach((function(e){var n=e[0],r=e[1];t[n]=Le(r)})),l(l({},e),{methods:t})},e.prototype.extractMethodsFromServers=function(e){return Object.values(e).reduce((function(e,t){return p(e,Object.values(t.methods))}),[])},e}(),We=function(){function e(){this.nextId=0,this.methods=[]}return e.prototype.add=function(e){return e.repoId=String(this.nextId),this.nextId+=1,this.methods.push(e),e},e.prototype.remove=function(e){if("string"!==typeof e)return new TypeError("Expecting a string");this.methods=this.methods.filter((function(t){return t.repoId!==e}))},e.prototype.getById=function(e){if("string"===typeof e)return this.methods.find((function(t){return t.repoId===e}))},e.prototype.getList=function(){return this.methods.map((function(e){return e}))},e.prototype.length=function(){return this.methods.length},e.prototype.reset=function(){this.methods=[]},e}(),Fe=function(){function e(e,t,n){var r=this;this.session=e,this.repository=t,this.serverRepository=n,this.ERR_URI_SUBSCRIPTION_FAILED="com.tick42.agm.errors.subscription.failure",this.callbacks=N(),this.nextStreamId=0,e.on("add-interest",(function(e){r.handleAddInterest(e)})),e.on("remove-interest",(function(e){r.handleRemoveInterest(e)}))}return e.prototype.acceptRequestOnBranch=function(e,t,n){if("string"!==typeof n&&(n=""),"object"!==typeof t.protocolState.subscriptionsMap)throw new TypeError("The streaming method is missing its subscriptions.");if(!Array.isArray(t.protocolState.branchKeyToStreamIdMap))throw new TypeError("The streaming method is missing its branches.");var r=this.getStreamId(t,n),i=e.msg.subscription_id,o={id:i,arguments:e.arguments,instance:e.instance,branchKey:n,streamId:r,subscribeMsg:e.msg};t.protocolState.subscriptionsMap[i]=o,this.session.sendFireAndForget({type:"accepted",subscription_id:i,stream_id:r}),this.callbacks.execute("onSubscriptionAdded",o,t)},e.prototype.rejectRequest=function(e,t,n){"string"!==typeof n&&(n=""),this.sendSubscriptionFailed("Subscription rejected by user. "+n,e.msg.subscription_id)},e.prototype.pushData=function(e,t,n){var r=this;if("object"===typeof e&&Array.isArray(e.protocolState.branchKeyToStreamIdMap)){if("object"!==typeof t)throw new Error("Invalid arguments. Data must be an object.");"string"===typeof n?n=[n]:(!Array.isArray(n)||n.length<=0)&&(n=[]),e.protocolState.branchKeyToStreamIdMap.filter((function(e){return!n||0===n.length||n.indexOf(e.key)>=0})).map((function(e){return e.streamId})).forEach((function(e){var n={type:"publish",stream_id:e,data:t};r.session.sendFireAndForget(n)}))}},e.prototype.pushDataToSingle=function(e,t,n){if("object"!==typeof n)throw new Error("Invalid arguments. Data must be an object.");var r={type:"post",subscription_id:t.id,data:n};this.session.sendFireAndForget(r)},e.prototype.closeSingleSubscription=function(e,t){e.protocolState.subscriptionsMap&&delete e.protocolState.subscriptionsMap[t.id];var n={type:"drop-subscription",subscription_id:t.id,reason:"Server dropping a single subscription"};this.session.sendFireAndForget(n);t.instance;this.callbacks.execute("onSubscriptionRemoved",t,e)},e.prototype.closeMultipleSubscriptions=function(e,t){var n=this;if("object"===typeof e&&"object"===typeof e.protocolState.subscriptionsMap&&e.protocolState.subscriptionsMap){var r=e.protocolState.subscriptionsMap,i=Object.keys(r).map((function(e){return r[e]}));"string"===typeof t&&(i=i.filter((function(e){return e.branchKey===t}))),i.forEach((function(e){delete r[e.id];var t={type:"drop-subscription",subscription_id:e.id,reason:"Server dropping all subscriptions on stream_id: "+e.streamId};n.session.sendFireAndForget(t)}))}},e.prototype.getSubscriptionList=function(e,t){if("object"!==typeof e)return[];if(!e.protocolState.subscriptionsMap)return[];var n=e.protocolState.subscriptionsMap,r=Object.keys(n).map((function(e){return n[e]}));return"string"!==typeof t?r:r.filter((function(e){return e.branchKey===t}))},e.prototype.getBranchList=function(e){if("object"!==typeof e)return[];if(!e.protocolState.subscriptionsMap)return[];var t=e.protocolState.subscriptionsMap,n=Object.keys(t).map((function(e){return t[e]})),r=[];return n.forEach((function(e){var t="";"object"===typeof e&&"string"===typeof e.branchKey&&(t=e.branchKey),-1===r.indexOf(t)&&r.push(t)})),r},e.prototype.onSubAdded=function(e){this.onSubscriptionLifetimeEvent("onSubscriptionAdded",e)},e.prototype.onSubRequest=function(e){this.onSubscriptionLifetimeEvent("onSubscriptionRequest",e)},e.prototype.onSubRemoved=function(e){this.onSubscriptionLifetimeEvent("onSubscriptionRemoved",e)},e.prototype.handleRemoveInterest=function(e){var t=this.serverRepository.getById(e.method_id);if("string"===typeof e.subscription_id&&"object"===typeof t&&t.protocolState.subscriptionsMap&&"object"===typeof t.protocolState.subscriptionsMap[e.subscription_id]){var n=t.protocolState.subscriptionsMap[e.subscription_id];delete t.protocolState.subscriptionsMap[e.subscription_id],this.callbacks.execute("onSubscriptionRemoved",n,t)}},e.prototype.onSubscriptionLifetimeEvent=function(e,t){this.callbacks.add(e,t)},e.prototype.getNextStreamId=function(){return this.nextStreamId+++""},e.prototype.handleAddInterest=function(e){var t=this.repository.getServerById(e.caller_id).instance,n={msg:e,arguments:e.arguments_kv||{},instance:t},r=this.serverRepository.getById(e.method_id);if(void 0!==r)r.protocolState.subscriptionsMap&&r.protocolState.subscriptionsMap[e.subscription_id]?this.sendSubscriptionFailed("A subscription with id "+e.subscription_id+" already exists.",e.subscription_id):this.callbacks.execute("onSubscriptionRequest",n,r);else{var i="No method with id "+e.method_id+" on this server.";this.sendSubscriptionFailed(i,e.subscription_id)}},e.prototype.sendSubscriptionFailed=function(e,t){var n={type:"error",reason_uri:this.ERR_URI_SUBSCRIPTION_FAILED,reason:e,request_id:t};this.session.sendFireAndForget(n)},e.prototype.getStreamId=function(e,t){if("string"!==typeof t&&(t=""),!e.protocolState.branchKeyToStreamIdMap)throw new Error("streaming "+e.definition.name+" method without protocol state");var n=e.protocolState.branchKeyToStreamIdMap.filter((function(e){return e.key===t}))[0],r=n?n.streamId:void 0;return"string"===typeof r&&""!==r||(r=this.getNextStreamId(),e.protocolState.branchKeyToStreamIdMap.push({key:t,streamId:r})),r},e}(),Ue=function(){function e(e,t,n,r){var i=this;this.session=e,this.clientRepository=t,this.serverRepository=n,this.logger=r,this.callbacks=N(),this.streaming=new Fe(e,t,n),this.session.on("invoke",(function(e){return i.handleInvokeMessage(e)}))}return e.prototype.createStream=function(e){return e.protocolState.subscriptionsMap={},e.protocolState.branchKeyToStreamIdMap=[],this.register(e,!0)},e.prototype.register=function(e,t){var n,r=this,i=e.definition,o=Object.assign({},{metadata:null!==(n=i.flags)&&void 0!==n?n:{}},{streaming:t||!1}),a={type:"register",methods:[{id:e.repoId,name:i.name,display_name:i.displayName,description:i.description,version:i.version,flags:o,object_types:i.objectTypes||i.object_types,input_signature:i.accepts,result_signature:i.returns,restrictions:void 0}]};return this.session.send(a,{methodId:e.repoId}).then((function(){r.logger.debug("registered method "+e.definition.name+" with id "+e.repoId)})).catch((function(t){throw r.logger.warn("failed to register method "+e.definition.name+" with id "+e.repoId+" - "+JSON.stringify(t)),t}))},e.prototype.onInvoked=function(e){this.callbacks.add("onInvoked",e)},e.prototype.methodInvocationResult=function(e,t,n,r){var i;i=n||""===n?{type:"error",request_id:t,reason_uri:"agm.errors.client_error",reason:n,context:r,peer_id:void 0}:{type:"yield",invocation_id:t,peer_id:this.session.peerId,result:r,request_id:void 0},this.session.sendFireAndForget(i)},e.prototype.unregister=function(e){return d(this,void 0,void 0,(function(){var t;return f(this,(function(n){switch(n.label){case 0:return t={type:"unregister",methods:[e.repoId]},[4,this.session.send(t)];case 1:return n.sent(),[2]}}))}))},e.prototype.getBranchList=function(e){return this.streaming.getBranchList(e)},e.prototype.getSubscriptionList=function(e,t){return this.streaming.getSubscriptionList(e,t)},e.prototype.closeAllSubscriptions=function(e,t){this.streaming.closeMultipleSubscriptions(e,t)},e.prototype.pushData=function(e,t,n){this.streaming.pushData(e,t,n)},e.prototype.pushDataToSingle=function(e,t,n){this.streaming.pushDataToSingle(e,t,n)},e.prototype.closeSingleSubscription=function(e,t){this.streaming.closeSingleSubscription(e,t)},e.prototype.acceptRequestOnBranch=function(e,t,n){this.streaming.acceptRequestOnBranch(e,t,n)},e.prototype.rejectRequest=function(e,t,n){this.streaming.rejectRequest(e,t,n)},e.prototype.onSubRequest=function(e){this.streaming.onSubRequest(e)},e.prototype.onSubAdded=function(e){this.streaming.onSubAdded(e)},e.prototype.onSubRemoved=function(e){this.streaming.onSubRemoved(e)},e.prototype.handleInvokeMessage=function(e){var t=e.invocation_id,n=e.caller_id,r=e.method_id,i=e.arguments_kv,o=this.serverRepository.getList().filter((function(e){return e.repoId===r}))[0];if(void 0!==o){var a={args:i,instance:this.clientRepository.getServerById(n).instance};this.callbacks.execute("onInvoked",o,t,a)}},e}(),Be=function(){function e(e,t){this.repository=e,this.subscriptionData=t}return Object.defineProperty(e.prototype,"requestArguments",{get:function(){return this.subscriptionData.params.arguments||{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"servers",{get:function(){var e=this;return this.subscriptionData.trackedServers.filter((function(e){return e.subscriptionId})).map((function(t){return e.repository.getServerById(t.serverId).instance}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"serverInstance",{get:function(){return this.servers[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"stream",{get:function(){return this.subscriptionData.method},enumerable:!0,configurable:!0}),e.prototype.onData=function(e){if("function"!==typeof e)throw new TypeError("The data callback must be a function.");this.subscriptionData.handlers.onData.push(e),1===this.subscriptionData.handlers.onData.length&&this.subscriptionData.queued.data.length>0&&this.subscriptionData.queued.data.forEach((function(t){e(t)}))},e.prototype.onClosed=function(e){if("function"!==typeof e)throw new TypeError("The callback must be a function.");this.subscriptionData.handlers.onClosed.push(e)},e.prototype.onFailed=function(e){},e.prototype.onConnected=function(e){if("function"!==typeof e)throw new TypeError("The callback must be a function.");this.subscriptionData.handlers.onConnected.push(e)},e.prototype.close=function(){this.subscriptionData.close()},e.prototype.setNewSubscription=function(e){this.subscriptionData=e},e}(),Ve=function(){function e(e,t,n){var r=this;this.session=e,this.repository=t,this.logger=n,this.subscriptionsList={},this.subscriptionIdToLocalKeyMap={},this.nextSubLocalKey=0,this.handleErrorSubscribing=function(e){var t=e._tag,n=t.subLocalKey,i=r.subscriptionsList[n];if("object"===typeof i&&(i.trackedServers=i.trackedServers.filter((function(e){return e.serverId!==t.serverId})),i.trackedServers.length<=0)){if(clearTimeout(i.timeoutId),"awaitingAccept"===i.status){var o="string"===typeof e.reason&&""!==e.reason?' Publisher said "'+e.reason+'".':" No reason given.",a="object"===typeof i.params.arguments?JSON.stringify(i.params.arguments):"{}";i.error({message:"Subscription rejected."+o+" Called with:"+a,called_with:i.params.arguments,method:i.method})}else"subscribed"===i.status&&r.callOnClosedHandlers(i);delete r.subscriptionsList[n]}},this.handleSubscribed=function(e){var t=e._tag.subLocalKey,n=r.subscriptionsList[t];if("object"===typeof n){var i=e._tag.serverId,o=n.trackedServers.filter((function(e){return e.serverId===i}))[0];if("object"===typeof o){o.subscriptionId=e.subscription_id,r.subscriptionIdToLocalKeyMap[e.subscription_id]=t;var a="awaitingAccept"===n.status;if(n.status="subscribed",a){var s=!1,u=n.subscription;u?(u.setNewSubscription(n),n.success(u),s=!0):(u=new Be(r.repository,n),n.subscription=u,n.success(u));for(var c=0,l=n.handlers.onConnected;c<l.length;c++){var d=l[c];try{d(u.serverInstance,s)}catch(f){}}}}}},this.handleEventData=function(e){var t=r.subscriptionIdToLocalKeyMap[e.subscription_id];if("undefined"!==typeof t){var n=r.subscriptionsList[t];if("object"===typeof n){var i=n.trackedServers.filter((function(t){return t.subscriptionId===e.subscription_id}));if(1===i.length){var o=e.oob,a=i[0].serverId,s=function(){return{data:e.data,server:r.repository.getServerById(a).instance,requestArguments:n.params.arguments,message:void 0,private:o}},u=n.handlers.onData,c=n.queued.data;u.length>0?u.forEach((function(e){"function"===typeof e&&e(s())})):c.push(s())}}}},this.handleSubscriptionCancelled=function(e){var t=r.subscriptionIdToLocalKeyMap[e.subscription_id];if("undefined"!==typeof t){var n=r.subscriptionsList[t];if("object"===typeof n){var i=n.trackedServers.length-1;n.trackedServers=n.trackedServers.filter((function(t){return t.subscriptionId!==e.subscription_id||(n.queued.closers.push(t.serverId),!1)})),n.trackedServers.length===i&&(n.trackedServers.length<=0&&(clearTimeout(n.timeoutId),r.callOnClosedHandlers(n),delete r.subscriptionsList[t]),delete r.subscriptionIdToLocalKeyMap[e.subscription_id])}}},e.on("subscribed",this.handleSubscribed),e.on("event",this.handleEventData),e.on("subscription-cancelled",this.handleSubscriptionCancelled)}return e.prototype.subscribe=function(e,t,n,r,i,o){var a=this;if(0!==n.length){var s=this.getNextSubscriptionLocalKey(),u=this.registerSubscription(s,e,t,r,i,t.methodResponseTimeout||1e4,o);"object"===typeof u?n.forEach((function(n){var r=n.server.id,i=n.methods.find((function(t){return t.name===e.name}));if(i){u.trackedServers.push({serverId:r,subscriptionId:void 0});var o={type:"subscribe",server_id:r,method_id:i.gatewayId,arguments_kv:t.arguments};a.session.send(o,{serverId:r,subLocalKey:s}).then((function(e){return a.handleSubscribed(e)})).catch((function(e){return a.handleErrorSubscribing(e)}))}else a.logger.error("can not find method "+e.name+" for target "+n.server.id)})):i({method:e,called_with:t.arguments,message:"Subscription failed. Unable to register the user callbacks."})}else i({method:e,called_with:t.arguments,message:"Subscription failed. No available servers matched the target params."})},e.prototype.drainSubscriptions=function(){var e=Object.values(this.subscriptionsList);return this.subscriptionsList={},this.subscriptionIdToLocalKeyMap={},e},e.prototype.getNextSubscriptionLocalKey=function(){var e=this.nextSubLocalKey;return this.nextSubLocalKey+=1,e},e.prototype.registerSubscription=function(e,t,n,r,i,o,a){var s=this,u={localKey:e,status:"awaitingAccept",method:t,params:n,success:r,error:i,trackedServers:[],handlers:{onData:(null===a||void 0===a?void 0:a.handlers.onData)||[],onClosed:(null===a||void 0===a?void 0:a.handlers.onClosed)||[],onConnected:(null===a||void 0===a?void 0:a.handlers.onConnected)||[]},queued:{data:[],closers:[]},timeoutId:void 0,close:function(){return s.closeSubscription(e)},subscription:null===a||void 0===a?void 0:a.subscription};return a||(n.onData&&u.handlers.onData.push(n.onData),n.onClosed&&u.handlers.onClosed.push(n.onClosed),n.onConnected&&u.handlers.onConnected.push(n.onConnected)),this.subscriptionsList[e]=u,u.timeoutId=setTimeout((function(){if(void 0!==s.subscriptionsList[e]){var r=s.subscriptionsList[e];"awaitingAccept"===r.status?(i({method:t,called_with:n.arguments,message:"Subscription failed. Subscription attempt timed out after "+o+" ms."}),delete s.subscriptionsList[e]):"subscribed"===r.status&&r.trackedServers.length>0&&(r.trackedServers=r.trackedServers.filter((function(e){return"undefined"!==typeof e.subscriptionId})),delete r.timeoutId,r.trackedServers.length<=0&&(s.callOnClosedHandlers(r),delete s.subscriptionsList[e]))}}),o),u},e.prototype.callOnClosedHandlers=function(e,t){var n,r=e.queued.closers.length,i=r>0?e.queued.closers[r-1]:null;void 0!==i&&"string"===typeof i&&(n=this.repository.getServerById(i).instance),e.handlers.onClosed.forEach((function(r){"function"===typeof r&&r({message:t||"ServerInitiated",requestArguments:e.params.arguments||{},server:n,stream:e.method})}))},e.prototype.closeSubscription=function(e){var t=this,n=this.subscriptionsList[e];"object"===typeof n&&(n.trackedServers.forEach((function(e){"undefined"!==typeof e.subscriptionId&&(n.queued.closers.push(e.serverId),t.session.sendFireAndForget({type:"unsubscribe",subscription_id:e.subscriptionId,reason_uri:"",reason:"ClientInitiated"}),delete t.subscriptionIdToLocalKeyMap[e.subscriptionId])})),n.trackedServers=[],this.callOnClosedHandlers(n,"ClientInitiated"),delete this.subscriptionsList[e])},e}(),He=function(){function e(e,t,n){var r=this;this.session=e,this.repository=t,this.logger=n,e.on("peer-added",(function(e){return r.handlePeerAdded(e)})),e.on("peer-removed",(function(e){return r.handlePeerRemoved(e)})),e.on("methods-added",(function(e){return r.handleMethodsAddedMessage(e)})),e.on("methods-removed",(function(e){return r.handleMethodsRemovedMessage(e)})),this.streaming=new Ve(e,t,n)}return e.prototype.subscribe=function(e,t,n,r,i,o){this.streaming.subscribe(e,t,n,r,i,o)},e.prototype.invoke=function(e,t,n,r){var i=this,o=r.id,a={type:"call",server_id:o,method_id:t.gatewayId,arguments_kv:n};return this.session.send(a,{invocationId:e,serverId:o}).then((function(e){return i.handleResultMessage(e)})).catch((function(e){return i.handleInvocationError(e)}))},e.prototype.drainSubscriptions=function(){return this.streaming.drainSubscriptions()},e.prototype.handlePeerAdded=function(e){var t=e.new_peer_id,n=e.identity,r=!e.meta||e.meta.local,i=Number(n.process),o={machine:n.machine,pid:isNaN(i)?n.process:i,instance:n.instance,application:n.application,applicationName:n.applicationName,environment:n.environment,region:n.region,user:n.user,windowId:n.windowId,peerId:t,api:n.api,isLocal:r};this.repository.addServer(o,t)},e.prototype.handlePeerRemoved=function(e){var t=e.removed_id,n=e.reason;this.repository.removeServerById(t,n)},e.prototype.handleMethodsAddedMessage=function(e){var t=this,n=e.server_id;e.methods.forEach((function(e){t.repository.addServerMethod(n,e)}))},e.prototype.handleMethodsRemovedMessage=function(e){var t=this,n=e.server_id,r=e.methods,i=this.repository.getServerById(n);Object.keys(i.methods).forEach((function(e){var o=i.methods[e];r.indexOf(o.gatewayId)>-1&&t.repository.removeServerMethod(n,e)}))},e.prototype.handleResultMessage=function(e){var t=e._tag.invocationId,n=e.result,r=e._tag.serverId;return{invocationId:t,result:n,instance:this.repository.getServerById(r).instance,status:xe.Success,message:""}},e.prototype.handleInvocationError=function(e){if(this.logger.debug("handle invocation error "+JSON.stringify(e)),"_tag"in e){var t=e._tag.invocationId,n=e._tag.serverId,r=this.repository.getServerById(n),i=e.reason;return{invocationId:t,result:e.context,instance:r.instance,status:xe.Error,message:i}}return{invocationId:"",message:e.message,status:xe.Error,error:e}},e}();function ze(e,t,n,r,i,o){var a,s=i.logger.subLogger("gw3-protocol"),u=new Promise((function(e){a=e})),c=t.domain("agm",["subscribed"]),l=new Ue(c,n,r,s.subLogger("server")),d=new He(c,n,s.subLogger("client"));return c.onJoined((function(i){n.addServer(e,t.peerId),i?function(){s.info("reconnected - will replay registered methods and subscriptions");for(var e=0,t=d.drainSubscriptions();e<t.length;e++){var n=t[e],i=n.method,a=Object.assign({},n.params);s.info("trying to re-subscribe to method "+i.name),o.client.subscribe(i,a,void 0,void 0,n)}var u=r.getList();r.reset();for(var c=0,l=u;c<l.length;c++){var f=l[c],p=f.definition;s.info("re-publishing method "+p.name),f.stream?o.server.createStream(p,f.streamCallbacks,void 0,void 0,f.stream):f.theFunction&&f.theFunction.userCallback?o.register(p,f.theFunction.userCallback):f.theFunction&&f.theFunction.userCallbackAsync&&o.registerAsync(p,f.theFunction.userCallbackAsync)}}():a&&(a({client:d,server:l}),a=void 0)})),c.onLeft((function(){n.reset()})),c.join(),u}var qe=function(){function e(e){var t=this;if("undefined"===typeof e)throw new Error("configuration is required");if("undefined"===typeof e.connection)throw new Error("configuration.connections is required");var n,r=e.connection;if("number"!==typeof e.methodResponseTimeout&&(e.methodResponseTimeout=3e4),"number"!==typeof e.waitTimeoutMs&&(e.waitTimeoutMs=3e4),this.unwrappedInstance=new Ne(this,void 0,r),this.instance=this.unwrappedInstance.unwrap(),this.clientRepository=new De(e.logger.subLogger("cRep"),this),this.serverRepository=new We,3!==r.protocolVersion)throw new Error("protocol "+r.protocolVersion+" not supported");n=ze(this.instance,r,this.clientRepository,this.serverRepository,e,this),this.readyPromise=n.then((function(n){return t.protocol=n,t.client=new Pe(t.protocol,t.clientRepository,t.instance,e),t.server=new Re(t.protocol,t.serverRepository),t}))}return e.prototype.ready=function(){return this.readyPromise},e.prototype.serverRemoved=function(e){return this.client.serverRemoved(e)},e.prototype.serverAdded=function(e){return this.client.serverAdded(e)},e.prototype.serverMethodRemoved=function(e){return this.client.serverMethodRemoved(e)},e.prototype.serverMethodAdded=function(e){return this.client.serverMethodAdded(e)},e.prototype.methodRemoved=function(e){return this.client.methodRemoved(e)},e.prototype.methodAdded=function(e){return this.client.methodAdded(e)},e.prototype.methodsForInstance=function(e){return this.client.methodsForInstance(e)},e.prototype.methods=function(e){return this.client.methods(e)},e.prototype.servers=function(e){return this.client.servers(e)},e.prototype.subscribe=function(e,t,n,r){return this.client.subscribe(e,t,n,r)},e.prototype.createStream=function(e,t,n,r){return this.server.createStream(e,t,n,r)},e.prototype.unregister=function(e){return this.server.unregister(e)},e.prototype.registerAsync=function(e,t){return this.server.registerAsync(e,t)},e.prototype.register=function(e,t){return this.server.register(e,t)},e.prototype.invoke=function(e,t,n,r,i,o){return this.client.invoke(e,t,n,r,i,o)},e.prototype.waitForMethod=function(e){var t=new F,n=this.client.methodAdded((function(r){r.name===e&&(n(),t.resolve(r))}));return t.promise},e}(),Ge=["subscribed","success"],Je=function(){function e(e,t){var n=this;this.publish=function(e,t,r){var i=r||{},o=i.routingKey,a=i.target,s=n.removeEmptyValues({type:"publish",topic:e,data:t,peer_id:n.peerId,routing_key:o,target_identity:a});n.session.send(s)},this.subscribe=function(e,t,r){return new Promise((function(i,o){var a=r||{},s=a.routingKey,u=a.target,c=n.removeEmptyValues({type:"subscribe",topic:e,peer_id:n.peerId,routing_key:s,source:u});n.session.send(c).then((function(r){var o=r.subscription_id;n.subscriptions.push({subscription_id:o,topic:e,callback:t,source:u}),i({unsubscribe:function(){return n.session.send({type:"unsubscribe",subscription_id:o,peer_id:n.peerId}),n.subscriptions=n.subscriptions.filter((function(e){return e.subscription_id!==o})),Promise.resolve()}})})).catch((function(e){return o(e)}))}))},this.watchOnEvent=function(){n.session.on("event",(function(e){var t=e.data,r=e.subscription_id,i=e["publisher-identity"],o=n.subscriptions.find((function(e){return e.subscription_id===r}));o&&(o.source?n.keysMatch(o.source,i)&&o.callback(t,o.topic,i):o.callback(t,o.topic,i))}))},this.connection=e,this.logger=t,this.peerId=e.peerId,this.subscriptions=[],this.session=e.domain("bus",Ge),this.readyPromise=this.session.join(),this.readyPromise.then((function(){n.watchOnEvent()}))}return e.prototype.ready=function(){return this.readyPromise},e.prototype.removeEmptyValues=function(e){var t={};return Object.keys(e).forEach((function(n){void 0!==e[n]&&null!==e[n]&&(t[n]=e[n])})),t},e.prototype.keysMatch=function(e,t){var n=Object.keys(e),r=!0;return n.forEach((function(n){e[n]!==t[n]&&(r=!1)})),r},e}(),Ke=function e(t,n){var i,o=W.getGDMajorVersion(),a=Promise.resolve();if(o){if(o<3)throw new Error("GD v2 is not supported. Use v4 of the API to run in that context.");o>=3&&(i=window.glue42gd,a=window.gdPreloadPromise||a)}var s,u,c,l,p,h,g,v=B("glue"),y=function(e,t,n){var i,o,a,s,u,c;if(W.isNode()){var l=Object({NODE_ENV:"production",PUBLIC_URL:"/stocks",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0})._GD_STARTING_CONTEXT_;if(l)try{c=JSON.parse(l)}catch(v){}}function d(){if(e.application)return e.application;if(n)return n.applicationName;var t=ae();return W.isNode()?c?c.applicationConfig.name:"NodeJS"+t:"undefined"!==typeof window&&"undefined"!==typeof document?document.title+" ("+t+")":t}var f=function(){var i,o,a,s,u,l,f,p,h,g,v=e.gateway,y=null!==(i=null===v||void 0===v?void 0:v.protocolVersion)&&void 0!==i?i:3,m=null===v||void 0===v?void 0:v.reconnectInterval,b=null===v||void 0===v?void 0:v.reconnectAttempts,w=null===v||void 0===v?void 0:v.ws,_=null===v||void 0===v?void 0:v.sharedWorker,k=null===v||void 0===v?void 0:v.inproc,x=null!==(o=null===v||void 0===v?void 0:v.webPlatform)&&void 0!==o?o:void 0;n&&(w=n.gwURL),W.isNode()&&c&&c.gwURL&&(w=c.gwURL),w||_||k||(w="ws://localhost:8385");var S=d(),I=S;"undefined"!==typeof n?(f=n.windowId,p=n.pid,n.env&&(h=n.env.env,g=n.env.region),I=null!==(a=n.application)&&void 0!==a?a:"glue-app",l=n.appInstanceId):W.isNode()&&(p=r.pid,c&&(h=c.env,g=c.region,l=c.instanceId));var C=null!==(u=null===(s=e.gateway)||void 0===s?void 0:s.replaySpecs)&&void 0!==u?u:[];return C.push(ge),{identity:{application:I,applicationName:S,windowId:f,instance:l,process:p,region:g,environment:h,api:t.version||"5.4.0"},reconnectInterval:m,ws:w,sharedWorker:_,webPlatform:x,inproc:k,protocolVersion:y,reconnectAttempts:b,replaySpecs:C}}(),p=d();if("undefined"!==typeof window){var h=window,g=h.htmlContainer?h.htmlContainer.containerName+"."+h.htmlContainer.application:null===(i=null===h||void 0===h?void 0:h.glue42gd)||void 0===i?void 0:i.application;g&&(p=g)}return{bus:null!==(o=e.bus)&&void 0!==o&&o,application:p,auth:function(){var t,n,r;return"string"===typeof e.auth?{token:e.auth}:e.auth?e.auth:W.isNode()&&c&&c.gwToken?{gatewayToken:c.gwToken}:(null===(t=e.gateway)||void 0===t?void 0:t.webPlatform)||(null===(n=e.gateway)||void 0===n?void 0:n.inproc)||(null===(r=e.gateway)||void 0===r?void 0:r.sharedWorker)?{username:"glue42",password:"glue42"}:void 0}(),logger:function(){var t,r,i,o=e.logger;return o||(o="warn"),n&&(i=n.consoleLogLevel),"string"===typeof o?{console:null!==i&&void 0!==i?i:o,publish:"warn"}:{console:null!==(t=null!==i&&void 0!==i?i:o.console)&&void 0!==t?t:"warn",publish:null!==(r=o.publish)&&void 0!==r?r:"warn"}}(),connection:f,metrics:null===(a=e.metrics)||void 0===a||a,contexts:null===(s=e.contexts)||void 0===s||s,version:t.version||"5.4.0",libs:null!==(u=t.libs)&&void 0!==u?u:[],customLogger:e.customLogger}}(t=t||{},n=n||{},i),m={};function b(t,n,r){(g=c.canPublish("trace"))&&c.trace("registering "+t+" module");var i=function(){n.initTime=r.stop(),n.initEndTime=r.endTime,n.marks=r.marks,g&&c.trace(t+" is ready - "+(r.endTime-r.startTime))};n.initStartTime=r.startTime,n.ready?n.ready().then((function(){i()})):i(),Array.isArray(t)||(t=[t]),t.forEach((function(t){m[t]=n,e[t]=n}))}function w(){var e,t,n,r,o=B("metrics"),a=y.metrics,u=null===i||void 0===i?void 0:i.getMetricsPublishingEnabled,d=y.connection.identity,f=u||function(){return!0},p=null!==(e="boolean"!==typeof a&&a.disableAutoAppSystem)&&void 0!==e&&e;return b("metrics",l=j({connection:a?s:void 0,logger:c.subLogger("metrics"),canUpdateMetric:f,system:"Glue42",service:null!==(t=null===d||void 0===d?void 0:d.service)&&void 0!==t?t:"metrics-service",instance:null!==(r=null!==(n=null===d||void 0===d?void 0:d.instance)&&void 0!==n?n:null===d||void 0===d?void 0:d.windowId)&&void 0!==r?r:ae(),disableAutoAppSystem:p,pagePerformanceMetrics:"boolean"!==typeof a?null===a||void 0===a?void 0:a.pagePerformanceMetrics:void 0}),o),Promise.resolve()}function _(){var e=B("interop"),t={connection:s,logger:c.subLogger("interop")};return u=new qe(t),he.Interop=u,b(["interop","agm"],u,e),Promise.resolve()}function k(){var e=y.activities&&3===s.protocolVersion;if(y.contexts||e){var t=B("contexts");return b("contexts",p=new Ie({connection:s,logger:c.subLogger("contexts")}),t),p}var n=s.replayer;n&&n.drain(ge.name)}function x(){return d(this,void 0,void 0,(function(){var e;return f(this,(function(t){return y.bus?(e=B("bus"),b("bus",h=new Je(s,c.subLogger("bus")),e),[2,Promise.resolve()]):[2,Promise.resolve()]}))}))}function S(e){try{return e.forEach((function(e){!function(e,t){var n=B(e),r=t(m);r&&b(e,r,n)}(e.name,e.create)})),Promise.resolve()}catch(t){return Promise.reject(t)}}return a.then((function(){var e,t=B("logger");return(c=new he(""+(null===(e=y.connection.identity)||void 0===e?void 0:e.application),void 0,y.customLogger)).consoleLevel(y.logger.console),c.publishLevel(y.logger.publish),c.canPublish("debug")&&c.debug("initializing glue..."),b("logger",c,t),Promise.resolve(void 0)})).then((function(){var e=B("connection");s=new fe(y.connection,c.subLogger("connection"));var t=Promise.resolve(y.auth);return y.connection&&!y.auth&&(t=i?i.getGWToken().then((function(e){return{gatewayToken:e}})):Promise.reject("You need to provide auth information")),t.then((function(t){var n;if(e.mark("auth-promise-resolved"),"[object Object]"!==Object.prototype.toString.call(t))throw new Error("Invalid auth object - "+JSON.stringify(t));return n=t,s.login(n)})).then((function(){return b("connection",s,e),y})).catch((function(e){throw s&&s.logout(),e}))})).then((function(){return Promise.all([w(),_(),k(),x()])})).then((function(){return u.readyPromise})).then((function(){return S(y.libs||[])})).then((function(){var e=Object.keys(m).map((function(e){var t=m[e];return t.ready?t.ready():Promise.resolve()}));return Promise.all(e)})).then((function(){var e={coreVersion:"5.4.0",version:y.version};v.stop();var r={feedback:function(e){u&&u.invoke("T42.ACS.Feedback",e,"best")},info:e,logger:c,interop:u,agm:u,connection:s,metrics:l,contexts:p,bus:h,version:y.version,userConfig:t,done:function(){return null===c||void 0===c||c.info("done called by user..."),s.logout()}};if(r.performance={get glueVer(){return y.version},get glueConfig(){return JSON.stringify(t)},get browser(){return window.performance.timing.toJSON()},get memory(){return window.performance.memory},get initTimes(){var e=U;return Object.keys(e).map((function(t){var n=e[t];return{name:t,duration:n.endTime-n.startTime,marks:n.marks}}))}},Object.keys(m).forEach((function(e){var t=m[e];r[e]=t})),r.config={},Object.keys(y).forEach((function(e){r.config[e]=y[e]})),n&&n.extOptions&&Object.keys(n.extOptions).forEach((function(e){r.config[e]=null===n||void 0===n?void 0:n.extOptions[e]})),(null===n||void 0===n?void 0:n.enrichGlue)&&n.enrichGlue(r),i&&i.updatePerfData&&i.updatePerfData(r.performance),r.agm){var o=function(e,t,n){return function(){return r.logger.warn("glue.js - 'glue.agm."+t+"' method is deprecated, use 'glue.interop."+n+"' instead."),e.apply(r.agm,arguments)}},a=r.agm;a.method_added=o(r.agm.methodAdded,"method_added","methodAdded"),a.method_removed=o(r.agm.methodRemoved,"method_removed","methodRemoved"),a.server_added=o(r.agm.serverAdded,"server_added","serverAdded"),a.server_method_aded=o(r.agm.serverMethodAdded,"server_method_aded","serverMethodAdded"),a.server_method_removed=o(r.agm.serverMethodRemoved,"server_method_removed","serverMethodRemoved")}return r})).catch((function(e){return Promise.reject({err:e,libs:m})}))};"undefined"!==typeof window&&(window.GlueCore=Ke),Ke.version="5.4.0",Ke.default=Ke;var Ye=function(){function e(e){this._id=e}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),e.prototype._update=function(e){if(e._id!==this._id)throw Error("Can not update from entity with different id.");this._updateCore(e)},e.prototype._updateCore=function(e){},e.prototype._beforeDelete=function(e){},e}();function $e(e){return"string"===typeof e}function Qe(e){return Array.isArray?Array.isArray(e):"[object Array]"===toString.call(e)}function Xe(e){return"undefined"===typeof e}function Ze(e){return!e||"undefined"===typeof e}function et(e){return!!(e&&e.constructor&&e.call&&e.apply)}function tt(e,t){"undefined"!==typeof e&&t(e)}var nt=function(e){function t(t,n,r,i){var o=e.call(this,t)||this;return o._name=t,o._description=i,o._ownerWindow=n,o._helperWindows=r||[],o}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"description",{get:function(){return this._description},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"helperWindows",{get:function(){var e=this;return this._helperWindows.map((function(t){return e.covertToWindowDef(t)}))},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ownerWindow",{get:function(){return this.covertToWindowDef(this._ownerWindow)},enumerable:!0,configurable:!0}),t.prototype.initiate=function(e,t,n){return this._manager.initiate(this._name,e,t,n)},t.prototype._updateCore=function(t){var n=this;e.prototype._updateCore.call(this,t),tt(t._description,(function(e){return n._description=e})),tt(t._ownerWindow,(function(e){return n._ownerWindow=e})),tt(t._helperWindows,(function(e){return n._helperWindows=e}))},t.prototype.covertToWindowDef=function(e){var t,n,r,i;return{type:null===(n=null===(t=e)||void 0===t?void 0:t.id)||void 0===n?void 0:n.type,name:null===(i=null===(r=e)||void 0===r?void 0:r.id)||void 0===i?void 0:i.name}},t}(Ye),rt=function(e){function t(t,n){var r=e.call(this,t)||this;return r._name=t,r._appByWindowTypeGetter=n,r}return i(t,e),Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"config",{get:function(){return this._appByWindowTypeGetter(this._name)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"windows",{get:function(){return this._manager.getWindows({type:this._name})},enumerable:!0,configurable:!0}),t.prototype.create=function(e,t){var n=Object.assign({type:this.name,name:this.name,isIndependent:!1},t);return this._manager.createWindow(e,n)},t}(Ye),it=function(e,t){this.entity=e,this.context=t},ot=function(e){this.type=e},at=function(e){function t(t,n){var r=e.call(this,ut.StatusChange)||this;return r.newStatus=t,r.oldStatus=n,r}return i(t,e),t}(ot),st=function(e){function t(t,n,r){var i=e.call(this,ut.ActivityContextChange)||this;return i.context="string"===typeof t?JSON.parse(t):t,i.updated=n,i.removed=r,i}return i(t,e),t}(ot),ut=function(){function e(){}return e.Added="added",e.Removed="removed",e.Updated="updated",e.Closed="closed",e.StatusChange="statusChange",e.ActivityContextChange="activityContextUpdate",e.ActivityWindowEvent="activityWindowEvent",e.ActivityWindowJoinedActivity="joined",e.ActivityWindowLeftActivity="left",e}(),ct=function(){function e(){}return e.Created="created",e.Started="started",e.Destroyed="destroyed",e}(),lt=function(){function e(e){this._activity=e}return e.prototype.register=function(t,n){this._ensureHasAgm(),e.AGM.register(t,n)},e.prototype.servers=function(){return this._ensureHasAgm(),Ze(this._activity)?[]:this._activity.windows.map((function(e){return e.instance}))},e.prototype.methods=function(){var e=this;if(this._ensureHasAgm(),Ze(this._activity))return[];var t=this._activity.windows,n=[],r=[];return t.forEach((function(t){e.methodsForWindow(t).forEach((function(e){-1===n.indexOf(e.name)&&(n.push(e.name),r.push(e))}))})),r},e.prototype.methodsForWindow=function(t){return this._ensureHasAgm(),t.instance?e.AGM.methodsForInstance(t.instance):[]},e.prototype.invoke=function(t,n,r,i,o,a){this._ensureHasAgm();var s=this.servers();if(Ze(r)&&(r="activity.all"),$e(r))if("activity.all"===r)s;else{if("activity.best"!==r){if("all"===r||"best"===r)return function(e,t,n){if("function"!==typeof t&&"function"!==typeof n)return e;"function"!==typeof t?t=function(){}:"function"!==typeof n&&(n=function(){}),e.then(t,n)}(e.AGM.invoke(t,n,r,i),o,a);throw new Error("Invalid invoke target "+r)}var u=s.filter((function(n){return e.AGM.methodsForInstance(n).filter((function(e){return e.name===t})).length>0}));u.length>0&&[u[0]]}else if(Qe(r)){if(r.length>=0){var c=r[0];if(this._isInstance(c))r.map((function(e){return e}));else{if(!this._isActivityWindow(c))throw new Error("Unknown target object");r.map((function(e){return e.instance}))}}}else if(this._isInstance(r))[r];else{if(!this._isActivityWindow(r))throw new Error("Unknown target object");[r.instance]}throw new Error("Not implemented")},e.prototype.unregister=function(t){return this._ensureHasAgm(),e.AGM.unregister(t)},e.prototype.createStream=function(t,n,r){this._ensureHasAgm(),e.AGM.createStream(t,{subscriptionAddedHandler:n,subscriptionRemovedHandler:r,subscriptionRequestHandler:void 0})},e.prototype.subscribe=function(t,n,r){return this._ensureHasAgm(),e.AGM.subscribe(t,n)},e.prototype._ensureHasAgm=function(){if(Ze(e.AGM))throw new Error("Agm should be configured to be used in activity")},e.prototype._isInstance=function(e){return void 0!==e.application},e.prototype._isActivityWindow=function(e){return void 0!==e.instance},e}(),dt=function(){function e(e,t,n){this._manager=e,this._ownerActivityId=t,this._state=n}return Object.defineProperty(e.prototype,"ownerId",{get:function(){return this._state.ownerId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"windowIds",{get:function(){return this._state.windowIds},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"frameColor",{get:function(){return this._state.frameColor},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){return this._state.context},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"tag",{get:function(){return this._state.tag},enumerable:!0,configurable:!0}),e.prototype.detach=function(e){var t=this;e=e||{};var n={};return Object.keys(this._state).forEach((function(e){n[e]=t._state[e]})),n.context=e.context||n.context,n.frameColor=e.frameColor||n.frameColor,this._manager.detachActivities(this._ownerActivityId,n)},e}(),ft=function(e){setTimeout(e,0)};function pt(e,t){if(!et(t))return e;e.then((function(e){ft((function(){t(null,e)}))}),(function(e){ft((function(){t(e,null)}))}))}var ht=function(e){function t(t,n,r,i,o){var a=e.call(this,t)||this;return a._id=t,a._actType=n,a._status=r,a._context=i,a._ownerId=o,a._agm=new lt(a),a}return i(t,e),Object.defineProperty(t.prototype,"type",{get:function(){if(this._manager)return this._manager.getActivityType(this._actType)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"context",{get:function(){return this._context},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"status",{get:function(){return this._status},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"owner",{get:function(){return this._ownerId?this._manager.getWindows({id:this._ownerId})[0]:null},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"windows",{get:function(){return this._manager.getWindows({activityId:this._id})},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"agm",{get:function(){return this._agm},enumerable:!0,configurable:!0}),t.prototype.addWindow=function(e,t){return this._manager.addWindowToActivity(this,e,t)},t.prototype.createWindow=function(e,t){return this._manager.createWindow(this,e,t)},t.prototype.createStackedWindows=function(e,t,n){return this._manager.createStackedWindows(this,e,t,n)},t.prototype.leave=function(e,t){return this._manager.leaveWindowFromActivity(this,e,t)},t.prototype.getWindowsByType=function(e){var t={activityId:this._id,type:e};return this._manager.getWindows(t)},t.prototype.setContext=function(e,t){return this._manager.setActivityContext(this,e,t)},t.prototype.updateContext=function(e,t){return this._manager.updateActivityContext(this,e,t)},t.prototype.onStatusChange=function(e){var t=this;return this._manager.subscribeActivityEvents((function(n,r,i){n.id===t.id&&e(n,r,i)}))},t.prototype.onWindowEvent=function(e){var t=this;return this._manager.subscribeWindowEvents((function(n,r,i){n.id===t.id&&e(n,r,i)}))},t.prototype.onContextChanged=function(e){var t=this;this._manager.subscribeActivityContextChanged((function(n,r,i,o){n.id===t.id&&e(r,i,o,n)}));try{e(this.context,this.context,[],this)}catch(n){return}},t.prototype.stop=function(){this._manager.stopActivity(this)},t.prototype.clone=function(e){return this._manager.clone(this,e)},t.prototype.attach=function(e,t){var n;return n="string"===typeof e?e:e.id,this._manager.attachActivities(n,this.id,t)},t.prototype.onActivityAttached=function(e){var t=this;this._manager.subscribeActivitiesAttached((function(n,r,i){n===t._id&&e(i)}))},t.prototype.onDetached=function(e){var t=this;this._manager.subscribeActivitiesDetached((function(n,r,i){r.id===t._id&&e(n,i)}))},t.prototype._updateCore=function(t){var n=this;e.prototype._updateCore.call(this,t),tt(t._actType,(function(e){return n._actType=e})),tt(t._context,(function(e){return n._context=e})),tt(t._ownerId,(function(e){return n._ownerId=e})),!t._status||this._status&&this._status.state===t._status.state||(this._status=t._status)},t.prototype._updateDescriptors=function(e){var t=this;this._attached=e.map((function(e){return new dt(t._manager,t._id,e)}))},Object.defineProperty(t.prototype,"attached",{get:function(){return this._attached},enumerable:!0,configurable:!0}),t.prototype.setFrameColor=function(e,t){var n=this;return pt(new Promise((function(t,r){var i=n.windows.length;0===i&&t(n),n.windows.forEach((function(r){r.underlyingWindow.setFrameColor(e,(function(){--i<=0&&t(n)}))})),setTimeout((function(){i>0&&r(n.id+" - timed out waiting for setFrameColor with"+e)}),5e3)})),t)},t.prototype.getFrameColor=function(){return this.windows&&0!==this.windows.length?this.windows[0].underlyingWindow.frameColor:""},t}(Ye),gt=function(){function e(){}return e.Trace="trace",e.Debug="debug",e.Info="info",e.Warn="warn",e.Error="error",e}(),vt=function(){function e(t){this._name=t,Ze(e.GlueLogger)||(this._glueLogger=e.GlueLogger.subLogger(t))}return e.GetNamed=function(t){return new e(t)},e.Get=function(t){return new e(e.GetTypeName(t))},e.prototype.trace=function(t){Ze(this._glueLogger)?e.Level===gt.Trace&&console.info(this._getMessage(t,gt.Trace)):this._glueLogger.trace(t)},e.prototype.debug=function(t){Ze(this._glueLogger)?e.Level!==gt.Debug&&e.Level!==gt.Trace||console.info(this._getMessage(t,gt.Debug)):this._glueLogger.debug(t)},e.prototype.info=function(t){Ze(this._glueLogger)?e.Level!==gt.Debug&&e.Level!==gt.Trace&&e.Level!==gt.Info||console.info(this._getMessage(t,gt.Info)):this._glueLogger.info(t)},e.prototype.warn=function(t){Ze(this._glueLogger)?e.Level!==gt.Debug&&e.Level!==gt.Trace&&e.Level!==gt.Info&&e.Level!==gt.Warn||console.info(this._getMessage(t,gt.Info)):this._glueLogger.warn(t)},e.prototype.error=function(e){Ze(this._glueLogger)?(console.error(this._getMessage(e,gt.Error)),console.trace()):this._glueLogger.error(e)},e.prototype._getMessage=function(e,t){return"["+t+"] "+this._name+" - "+e},e.GetTypeName=function(e){var t=/function (.{1,})\(/.exec(e.constructor.toString());return t&&t.length>1?t[1]:""},e.Level=gt.Info,e}(),yt=function(e){function t(t,n,r,i,o,a,s,u){var c=e.call(this,t)||this;return c._logger=vt.Get("window"),c._type=r,c._activityId=i,c._name=n,c._instance=o,c._isIndependent=a,c._windowGetter=s,c._hcWindowId=u,c}return i(t,e),t.prototype.getBounds=function(){return this._manager.getWindowBounds(this.id)},Object.defineProperty(t.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isIndependent",{get:function(){return this._isIndependent},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"type",{get:function(){if(this._manager)return this._manager.getWindowType(this._type)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"activity",{get:function(){if(!Xe(this._activityId))return this._manager.getActivityById(this._activityId)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"isOwner",{get:function(){var e=this.activity;return!Xe(e)&&e.owner.id===this.id},enumerable:!0,configurable:!0}),t.prototype.setVisible=function(e,t){return this._manager.setWindowVisibility(this.id,e)},t.prototype.activate=function(e){return this._manager.activateWindow(this.id,e)},t.prototype.setBounds=function(e,t){return this._manager.setWindowBounds(this.id,e,t)},t.prototype.close=function(){return this._manager.closeWindow(this.id)},Object.defineProperty(t.prototype,"instance",{get:function(){return this._instance},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"underlyingWindow",{get:function(){var e=this._windowGetter();return e||{id:this._hcWindowId}},enumerable:!0,configurable:!0}),t.prototype.onActivityJoined=function(e){this._subscribeForActivityWindowEvent(ut.ActivityWindowJoinedActivity,e)},t.prototype.onActivityRemoved=function(e){this._subscribeForActivityWindowEvent(ut.ActivityWindowLeftActivity,e)},t.prototype._updateCore=function(e){var t=this;tt(e._activityId,(function(e){return t._activityId=e})),tt(e._isIndependent,(function(e){return t._isIndependent=e})),tt(e._hcWindowId,(function(e){return t._hcWindowId=e})),tt(e._type,(function(e){return t._type=e})),tt(e._name,(function(e){return t._name=e})),Ze(e._instance)||(this._instance=e._instance)},t.prototype._subscribeForActivityWindowEvent=function(e,t){var n=this;this._manager.subscribeWindowEvents((function(r,i,o){i.id===n.id&&o===e&&t(r)}))},t.prototype._beforeDelete=function(e){this._hcWindowId=e._hcWindowId},t}(Ye),mt=function(){function e(e,t,n){this.state=e,this.message=t,this.time=n}return e.prototype.getState=function(){return this.state},e.prototype.getMessage=function(){return this.message},e.prototype.getTime=function(){return this.time},e}(),bt=function(){function e(e){var t=this;if(this._activityChangeCallbacks=[],this._activityTypeStatusChangeCallbacks=[],this._activityWindowChangeCallbacks=[],this._windowTypeStatusChangeCallbacks=[],this._peerIdAndFactoryIdToPeerType={},this._peerFactoriesRegisteredByUs={},this._gw3Subscriptions=[],this._contextSubscriptions={},this._activityTypesInitiatedFromMe={},this._config=e,this._connection=e.connection,this._logger=e.logger,this._contexts=e.contexts,this._windows=e.windows,this._sessionJoinedPromise=new Promise((function(e){t._sessionJoinedPromiseResolve=e})),this._activityJoinedPromise=new Promise((function(e){t._activityJoinedPromiseResolve=e})),this._config.activityId||this._activityJoinedPromiseResolve({}),this._gw3Session=this._connection.domain("activity",["joined","initiated","peer-created","token"]),"undefined"!==typeof window){var n=window.glue42gd;n&&"function"===typeof n.addRefreshHandler&&n.addRefreshHandler((function(e,r){t._gw3Session.send({type:"reload"}).then((function(t){if(t.token){try{n.setGWToken(t.token)}catch(i){return void r(i.message||i)}e()}else r("Expected gateway token for refreshing.")}),r)}))}}return e.activityTypeGwMessageEntityToActivityType=function(e,t){var n=function(e){return new rt(e,void 0)};return new nt(e.name,e.owner_type&&n(e.owner_type),e.helper_types&&e.helper_types.map(n),t)},e.peerFactoryGwMessageEntityToWindowType=function(e){return new rt(e.peer_type,(function(e){}))},e.activityGwMessageToActivity=function(e,t){var n=void 0!==e.owner?e.owner.peer_id:e.owner_id;return new ht(e.activity_id,e.activity_type,t,e.context_snapshot,n)},e.activityToActivityStatusChangeEvent=function(e){return new it(e,new at(e.status,void 0))},Object.defineProperty(e.prototype,"bridgeType",{get:function(){return"GW3"},enumerable:!0,configurable:!0}),e.prototype.init=function(){var e=this;this.forwardActivityTypeMessagesToStatusEventHandlers(),this.subscribe("created",this.handleActivityCreatedMessage),this.subscribe("destroyed",this.handleActivityDestroyedMessage),this.forwardActivityMessagesToStatusEventHandlers(),this.forwardActivityCreatedAndJoinedActivityToActivityWindowEventHandlers(),this.forwardPeerFactoryMessagesToStatusEventHandlers(),this.forwardPeerFactoryMessagesToPeerFactoryRequests(),this.subscribe("peer-factories-added",this.handlePeerFactoriesAdded),this.subscribe("peer-factories-removed",this.handlePeerFactoriesRemoved),this.forwardActivityWindowMessagesToEventHandlers(),this.subscribe("dispose-peer",(function(){if("dispose"!==e._config.disposeRequestHandling){if("exit"===e._config.disposeRequestHandling){if(e._windows&&"undefined"!==typeof e._windows.my())return void e._windows.my().close();if("undefined"!==typeof window&&"function"===typeof window.close)return void window.close();if("undefined"!==typeof r&&"function"===typeof r.exit)return void r.exit()}}else e.dispose()})),this._gw3Session.onJoined((function(){"trackMyOnly"===e._config.mode||"trackMyTypeAndInitiatedFromMe"===e._config.mode?e._sessionJoinedPromiseResolve(e):e._gw3Session.send({type:"subscribe",activity_types:"trackAll"===e._config.mode?[]:"trackTypes"===e._config.mode?e._config.typesToTrack:[]}).then((function(){e._sessionJoinedPromiseResolve(e)}))})),this._gw3Session.join()},e.prototype.dispose=function(){var e=this;this._gw3Subscriptions.forEach((function(t){return t&&e._connection.off(t)})),this._gw3Subscriptions.length=0},e.prototype.ready=function(){return Promise.all([this._sessionJoinedPromise,this._activityJoinedPromise])},e.prototype.initReady=function(){return this._sessionJoinedPromise},e.prototype.onActivityTypeStatusChange=function(e){this._activityTypeStatusChangeCallbacks.push(e)},e.prototype.registerActivityType=function(t,n,r,i,o){var a=this,s={};s.name=t;var u=function(e){return{type:e.type,name:e.name,configuration:e}};return s.owner_type=u(n),s.helper_types=r.map(u),this._gw3Session.send({type:"add-types",types:[s]}).then((function(){var t=e.activityTypeGwMessageEntityToActivityType(s,o);return a.invokeCallbacks(a._activityTypeStatusChangeCallbacks,new it(t,new ot(ut.Added)),"add-types"),t}))},e.prototype.unregisterActivityType=function(e){var t=this;return this._gw3Session.send({type:"remove-types",types:[e]}).then((function(){var n=new nt(e,void 0,void 0,void 0);t.invokeCallbacks(t._activityTypeStatusChangeCallbacks,new it(n,new ot(ut.Removed)),"add-types")}))},e.prototype.onWindowTypeStatusChange=function(e){this._windowTypeStatusChangeCallbacks.push(e)},e.prototype.registerWindowFactory=function(t,n,r){var i=this;if(this._peerFactoriesRegisteredByUs[t])return Promise.reject(new Error("Factory for windowType "+t+" already registered."));this._peerFactoriesRegisteredByUs[t]=n;var o={id:t,peer_type:t,configuration:r};return this._gw3Session.send({type:"add-peer-factories",factories:[o]}).then((function(){i.invokeCallbacks(i._windowTypeStatusChangeCallbacks,new it(e.peerFactoryGwMessageEntityToWindowType(o),new ot(ut.Added)),"add-peer-factories")})).catch((function(){delete i._peerFactoriesRegisteredByUs[t]}))},e.prototype.unregisterWindowFactory=function(e){var t=this;return this._peerFactoriesRegisteredByUs[e]?(delete this._peerFactoriesRegisteredByUs[e],this._gw3Session.send({type:"remove-peer-factories",factory_ids:[e]}).then((function(){t.invokeCallbacks(t._windowTypeStatusChangeCallbacks,new it(new rt(e,void 0),new ot(ut.Removed)),"add-peer-factories")}))):Promise.reject(new Error("Factory for windowType "+e+" not registered."))},e.prototype.onActivityStatusChange=function(e){this._activityChangeCallbacks.push(e)},e.prototype.initiateActivity=function(e,t,n){var r=this,i={type:"create",activity_type:e,initial_context:t};return this.isOverrideTypeDefinition(n)?i.types_override={owner_type:{type:n.owner.type,name:n.owner.name,configuration:n.owner},helper_types:n.helpers&&n.helpers.map((function(e){return{type:e.type,name:e.name,configuration:e}}))}:i.configuration=n&&n.map((function(e){return{type:e.type,name:e.name,configuration:e}})),this.sendCreateAndMapResultingMessagesToPromise(i,"initiated",(function(e,t){return e.request_id===t}),"created",(function(e,t,n){return e.activity_id===n.activity_id}),"destroyed",(function(e,t,n){return e.activity_id===n.activity_id}),(function(e){return e.activity_id})).then((function(t){return"trackMyTypeAndInitiatedFromMe"!==r._config.mode||r._activityTypesInitiatedFromMe[e]?t:(r._activityTypesInitiatedFromMe[e]=!0,r._gw3Session.send({type:"subscribe",activity_types:[e]}).then((function(){return t})))}))},e.prototype.stopActivity=function(e){return this._gw3Session.send({type:"destroy",activity_id:e.id,reason_uri:"com.tick42.glue.activity.constants.destroyReason.general",reason:"Destroying activity"}).then((function(e){return!0}))},e.prototype.updateActivityContext=function(e,t,n,r){if(n)return this._contexts.set(e.id,t);for(var i=0,o=r=r||[];i<o.length;i++){t[o[i]]=null}return this._contexts.update(e.id,t)},e.prototype.announceWindow=function(e,t){throw new Error("Invalid operation 'announceWindow' for GW3 protocol")},e.prototype.registerWindow=function(e,t,n){var r="undefined"!==typeof this._connection.gatewayToken,i=this._connection.peerId;if("undefined"!==typeof window){var o=window.glue42gd;o&&(r="undefined"!==typeof o.activityInfo)}return r&&this._gw3Session.send({type:"ready"}),this.invokeCallbacks(this._activityWindowChangeCallbacks,new it(new yt(i,t,e,void 0,this.getAgmInstance(i),n,this.generateWindowGetter(i),void 0),new ot(ut.Added)),"register window"),Promise.resolve(i)},e.prototype.onActivityWindowChange=function(e){this._activityWindowChangeCallbacks.push(e)},e.prototype.createWindow=function(e,t){var n=this;return t.layout||(t.left||t.width||t.height||t.top)&&(t.layout={mode:"pixels",cellSize:1}),this.sendCreateAndMapResultingMessagesToPromise({type:"create-peer",peer_type:t.type,peer_name:t.name||t.type,configuration:t,activity_id:e},void 0,void 0,"peer-created",(function(e,t){return e.request_id===t}),void 0,void 0,(function(e){return e.created_id})).then((function(r){if(e)return n.joinActivity(e,r,t.name).then((function(){return r}))}))},e.prototype.closeWindow=function(e){return this._gw3Session.send({type:"destroy-peer",destroy_peer_id:e}).then((function(e){}))},e.prototype.getAnnouncementInfo=function(){var e=this._config.activityId||this._config.announcementInfo&&this._config.announcementInfo.activityId,t=this._config.announcementInfo&&this._config.announcementInfo.activityWindowType,n=this._config.announcementInfo&&this._config.announcementInfo.activityWindowIndependent,r=this._config.announcementInfo&&this._config.announcementInfo.activityWindowName;if("undefined"!==typeof window&&"undefined"!==typeof window.location&&window.location.search&&"function"===typeof URLSearchParams){var i=new URLSearchParams(location.search.slice(1));t=(t=t||i.get("t42PeerType"))||i.get("t42ActivityWindowType"),"undefined"===typeof n&&(n=i.get("t42ActivityWindowIndependent")),r=r||i.get("t42ActivityWindowName"),e=e||i.get("t42ActivityId")}return{activityWindowId:void 0,activityId:e,activityWindowType:t=t||"unknown",activityWindowIndependent:n=n||!1,activityWindowName:r=r||this._connection.peerId}},e.prototype.joinActivity=function(e,t,n){var r=this,i=n&&{name:n}||{};return this._gw3Session.send(o({type:"join-activity",target_id:t,activity_id:e},i)).then((function(){r.invokeCallbacks(r._activityWindowChangeCallbacks,new it(new yt(t,void 0,void 0,e,r.getAgmInstance(t),void 0,r.generateWindowGetter(t),void 0),new ot(ut.ActivityWindowJoinedActivity)),"activity joined - ActivityWindow"),r.invokeCallbacks(r._activityChangeCallbacks,new it(new ht(e,void 0,new mt("created",void 0,void 0),void 0,void 0),new ot(ut.Updated)),"activity joined - Activity")}))},e.prototype.leaveActivity=function(e,t){var n=this;return this._gw3Session.send({type:"leave-activity",target_id:t,activity_id:e}).then((function(){n.invokeCallbacks(n._activityWindowChangeCallbacks,new it(new yt(t,void 0,void 0,null,n.getAgmInstance(t),void 0,n.generateWindowGetter(t),void 0),new ot(ut.ActivityWindowLeftActivity)),"activity left - ActivityWindow"),n.invokeCallbacks(n._activityChangeCallbacks,new it(new ht(e,void 0,new mt("created",void 0,void 0),void 0,void 0),new ot(ut.Updated)),"activity left - Activity")}))},e.prototype.getActivityTypes=function(){return Promise.resolve([])},e.prototype.getWindowTypes=function(){return Promise.resolve([])},e.prototype.getActivities=function(){return Promise.resolve([])},e.prototype.getActivityWindows=function(){return Promise.resolve([])},e.prototype.createStackedWindows=function(e,t,n){},e.prototype.getWindowBounds=function(e){},e.prototype.setWindowBounds=function(e,t){},e.prototype.activateWindow=function(e,t){},e.prototype.setWindowVisibility=function(e,t){},e.prototype.cloneActivity=function(e,t){},e.prototype.attachActivities=function(e,t,n){return this._gw3Session.send({type:"merge",into:t,merge:e})},e.prototype.detachActivities=function(e,t){return this._gw3Session.send({type:"split",from:e}).then((function(){return""}))},e.prototype.onActivitiesAttached=function(e){},e.prototype.onActivitiesDetached=function(e){},e.prototype.onActivityAttachedDescriptorsRefreshed=function(e){},e.prototype.getAttachedDescriptors=function(){return Promise.resolve([])},e.prototype.getRandomRequestId=function(){return this._connection.peerId+":"+Math.floor(1e9*Math.random())},e.prototype.forwardAddedAndRemovedMessagesToEventHandler=function(e,t,n,r){var i=function(e){return function(t){return new it(t,new ot(e?ut.Added:ut.Removed))}};return[e&&this.forwardMessageToEventHandler(e,(function(e){return n(e,!0)}),i(!0),r),t&&this.forwardMessageToEventHandler(t,(function(e){return n(e,!1)}),i(!1),r)].filter((function(e){return e}))},e.prototype.forwardMessageToEventHandler=function(e,t,n,r){return this.subscribe(e,(function(e){t(e).forEach((function(t){return r.forEach((function(r){return r(n(t,e))}))}))}))},e.prototype.sendCreateAndMapResultingMessagesToPromise=function(e,t,n,r,i,o,a,s){var u,c,l,d,f,p,h=this,g=this.getRandomRequestId(),v=new Promise((function(e,t){u=e,c=t})),y=null,m=function(){h.dropSubscription(l),h.dropSubscription(d),h.dropSubscription(f),h.dropSubscription(p)};l=t&&this.subscribe(t,(function(e){n(e,g)&&(y=e,h.dropSubscription(l))})),d=this.subscribe(r,(function(e){i(e,g,y)&&u(s(e))})),f=o&&this.subscribe(o,(function(e){a(e,g,y)&&c(e)})),p=o&&this.subscribe("error",(function(e){e.request_id===g&&c(e)})),e.request_id=g;var b=this._gw3Session.send(e).then((function(){return v}));return b.then(m,m),b},e.prototype.peerFactoryIdAndOwnerIdToWindowType=function(e,t){var n=this._peerIdAndFactoryIdToPeerType[t+":"+e];return n?new rt(n,void 0):null},e.prototype.subscribe=function(e,t){var n=this,r=this._connection.on(e,(function(e){return t.bind(n)(e)}));return this._gw3Subscriptions.push(r),r},e.prototype.dropSubscription=function(e){e&&(this._connection.off(e),delete this._gw3Subscriptions[this._gw3Subscriptions.indexOf(e)])},e.prototype.invokeCallbacks=function(e,t,n){var r=this;e.forEach((function(e){try{e(t)}catch(i){r._logger.error("Error in "+(n||t.context.type)+" callback: "+JSON.stringify(i))}}))},e.prototype.handleActivityCreatedMessage=function(e){e.context_id?this._contextSubscriptions[e.activity_id]||this.subscribeToContext(e):this._logger.error("Activity created with unknown context_id: "+e.activity_id)},e.prototype.subscribeToContext=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i=this;return s(this,(function(o){switch(o.label){case 0:return t=e.activity_id,n=this._contextSubscriptions,r=t,[4,this._contexts.subscribe(t,(function(e,n,r){var o=new it(new ht(t,void 0,void 0,e,void 0),new st(e,n,r));i.invokeCallbacks(i._activityChangeCallbacks,o,"context updated")}))];case 1:return n[r]=o.sent(),[2]}}))}))},e.prototype.handleActivityDestroyedMessage=function(e){var t=this._contextSubscriptions[e.activity_id];"function"===typeof t&&t(),delete this._contextSubscriptions[e.activity_id]},e.prototype.handlePeerFactoriesAdded=function(e){var t=this;e.factories.forEach((function(n){t._peerIdAndFactoryIdToPeerType[e.owner_id+":"+n.id]=n.peer_type}))},e.prototype.handlePeerFactoriesRemoved=function(e){var t=this;e.factory_ids.forEach((function(n){delete t._peerIdAndFactoryIdToPeerType[e.owner_id+":"+n]}))},e.prototype.forwardActivityTypeMessagesToStatusEventHandlers=function(){this.forwardAddedAndRemovedMessagesToEventHandler("types-added","types-removed",(function(t,n){return n?t.types.map((function(t){return e.activityTypeGwMessageEntityToActivityType(t,void 0)})):t.types.map((function(e){return new nt(e.name,void 0,void 0,void 0)}))}),this._activityTypeStatusChangeCallbacks)},e.prototype.forwardActivityCreatedAndJoinedActivityToActivityWindowEventHandlers=function(){for(var e=this,t=0,n=["created","joined","owner-changed"];t<n.length;t++){var r=n[t];this.forwardMessageToEventHandler(r,(function(t){return[t.owner||o(o({},t),{type:t.peer_type,name:t.peer_name,peer_id:t.owner_id})].concat(t.participants||[]).map((function(n){return new yt(n.peer_id,n.name,n.type,t.activity_id,e.getAgmInstance(n.peer_id),void 0,e.generateWindowGetter(n.peer_id),void 0)}))}),(function(e,t){return new it(e,new ot(ut.ActivityWindowJoinedActivity))}),this._activityWindowChangeCallbacks)}},e.prototype.forwardActivityMessagesToStatusEventHandlers=function(){for(var t=0,n=["created","joined"];t<n.length;t++){var r=n[t];this.forwardMessageToEventHandler(r,(function(t){return[e.activityGwMessageToActivity(t,new mt("started","",new Date))]}),(function(t,n){return e.activityToActivityStatusChangeEvent(t)}),this._activityChangeCallbacks)}this.forwardMessageToEventHandler("destroyed",(function(t){return[e.activityGwMessageToActivity(t,new mt("destroyed",t.reason,new Date))]}),(function(t,n){return e.activityToActivityStatusChangeEvent(t)}),this._activityChangeCallbacks),this.forwardMessageToEventHandler("initiated",(function(t){return[e.activityGwMessageToActivity(t,new mt("created","",new Date))]}),(function(t,n){return e.activityToActivityStatusChangeEvent(t)}),this._activityChangeCallbacks),this.forwardMessageToEventHandler("owner-changed",(function(t){return[e.activityGwMessageToActivity(t,new mt("created","",new Date))]}),(function(t,n){return e.activityToActivityStatusChangeEvent(t)}),this._activityChangeCallbacks)},e.prototype.forwardPeerFactoryMessagesToStatusEventHandlers=function(){var t=this;this.forwardAddedAndRemovedMessagesToEventHandler("peer-factories-added","peer-factories-removed",(function(n,r){return r?n.factories.map(e.peerFactoryGwMessageEntityToWindowType):n.factory_ids.map((function(e){return t.peerFactoryIdAndOwnerIdToWindowType(e,n.owner_id)})).filter((function(e){return null!=e}))}),this._windowTypeStatusChangeCallbacks)},e.prototype.forwardPeerFactoryMessagesToPeerFactoryRequests=function(){var e=this;this.subscribe("peer-requested",(function(t){var n=e._peerFactoriesRegisteredByUs[t.peer_factory];if(n)try{var r=t.configuration||{};r.gateway_token=r.gateway_token||t.gateway_token,r.peer_factory=r.peer_factory||t.peer_factory;var i=n({activityId:t.activity&&t.activity.id,activityType:t.activity&&t.activity.type,type:t.configuration&&t.configuration.type,gwToken:r.gateway_token,configuration:r});i&&i.then&&i.catch&&i.catch((function(n){return e._gw3Session.send({type:"error",request_id:t.request_id,reason:n&&(n.message||JSON.stringify(n))})}))}catch(o){e._gw3Session.send({type:"error",request_id:t.request_id,reason:o&&(o.message||JSON.stringify(o))})}else e._gw3Session.send({type:"error",request_id:t.request_id,reason:"Unknown peer factory "+t.peer_factory})}))},e.prototype.forwardActivityWindowMessagesToEventHandlers=function(){for(var e=this,t=function(t){n.subscribe(t,(function(n){var r="activity-joined"===t?n.joined_id:n.peer_id,i="activity-joined"===t?n.joined_type:n.peer_type,o="activity-joined"===t?n.joined_name:n.peer_name,a=new yt(r,o,i,n.activity_id,e.getAgmInstance(r),void 0,e.generateWindowGetter(r),void 0);e._contextSubscriptions[n.activity_id]?"joined"===t&&e._activityJoinedPromiseResolve({}):e.subscribeToContext(n).then((function(){"joined"===t&&e._activityJoinedPromiseResolve({})})),e.invokeCallbacks(e._activityWindowChangeCallbacks,new it(a,new ot(ut.ActivityWindowJoinedActivity)),t)}))},n=this,r=0,i=["activity-joined","joined"];r<i.length;r++){t(i[r])}this.subscribe("left",(function(t){var n=new yt(t.left_id,void 0,void 0,null,e.getAgmInstance(t.left_id),void 0,e.generateWindowGetter(t.left_id),void 0);e.invokeCallbacks(e._activityWindowChangeCallbacks,new it(n,new ot(ut.ActivityWindowLeftActivity)),"left")})),this.forwardAddedAndRemovedMessagesToEventHandler("peer-created",void 0,(function(t){return[new yt(t.created_id,void 0,void 0,void 0,void 0,void 0,e.generateWindowGetter(t.created_id),void 0)]}),this._activityWindowChangeCallbacks)},e.prototype.getAgmInstance=function(e){return this._config.agm.servers().find((function(t){return t.peerId===e||t.windowId===e}))},e.prototype.generateWindowGetter=function(e){var t=this;return function(){var n=t.getAgmInstance(e);if(n){var r=n.windowId;return t._config.windows.list().filter((function(e){return e.id===r}))[0]}}},e.prototype.isOverrideTypeDefinition=function(e){return"undefined"!==typeof e&&!!e.owner},e}(),wt=function(){function e(e,t){var n=this;this._myAttached=[],this._myDetached=[],this._myAttachedTo=[],this._myDetachedFrom=[],this._myActivityFrameColorChanged=[],this._myActivityJoinedCallbacks=[],this._myActivityRemovedCallbacks=[],this._myContextUpdateCallbacks=[],this._logger=vt.Get(this),this._m=e,e.ready().then((function(e){e.subscribeActivityContextChanged(n._subscribeMyContextChanged.bind(n)),e.subscribeWindowEvents(n._subscribeMyWindowEvent.bind(n)),e.subscribeActivitiesAttached(n._subscribeActivitiesAttached.bind(n)),e.subscribeActivitiesDetached(n._subscribeActivitiesDetached.bind(n)),t&&t.onWindowFrameColorChanged(n._subscribeWindowFrameColorChanged.bind(n))}))}return Object.defineProperty(e.prototype,"window",{get:function(){if(Ze(this._w)){var e=this._m.announcedWindows;e.length>0&&(this._w=e[0])}return this._w},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activity",{get:function(){var e=this.window;if(!Ze(e))return e.activity},enumerable:!0,configurable:!0}),e.prototype.createWindow=function(e){return this._m.createWindow(this.activity,e)},e.prototype.createStackedWindows=function(e,t){return this._m.createStackedWindows(this.activity,e,t)},Object.defineProperty(e.prototype,"context",{get:function(){var e=this.activity;return Xe(e)?{}:e.context},enumerable:!0,configurable:!0}),e.prototype.updateContext=function(e,t){var n=this.activity;return Xe(n)?new Promise((function(e,t){t("Not in activity")})):n.updateContext(e,t)},e.prototype.setContext=function(e,t){var n=this.activity;return Xe(n)?new Promise((function(e,t){t("Not in activity")})):n.setContext(e,t)},e.prototype.onActivityJoined=function(e){this._myActivityJoinedCallbacks.push(e);var t=this.window;Ze(t)||Ze(t.activity)||e(t.activity)},e.prototype.onActivityLeft=function(e){this._myActivityRemovedCallbacks.push(e)},e.prototype.onContextChanged=function(e){this._myContextUpdateCallbacks.push(e);var t=this.window;if(!Ze(t)){var n=t.activity;Ze(n)||e(n.context,n.context,[],n)}},e.prototype.clone=function(e,t){var n=this.activity;return this._m.clone(n,e,t)},e.prototype.attach=function(e,t){var n;return n="string"===typeof e?e:e.id,this._m.attachActivities(n,this.activity.id,t)},e.prototype.onActivityAttached=function(e){this._myAttached.push(e)},e.prototype.onActivityDetached=function(e){this._myDetached.push(e)},e.prototype.onAttachedToActivity=function(e){this._myAttachedTo.push(e)},e.prototype.onDetachedFromActivity=function(e){this._myDetachedFrom.push(e)},Object.defineProperty(e.prototype,"attached",{get:function(){return this.activity?this.activity.attached:[]},enumerable:!0,configurable:!0}),e.prototype.setFrameColor=function(e,t){return this.activity?this.activity.setFrameColor(e,t):Promise.resolve(null)},e.prototype.getFrameColor=function(){return this.activity?this.activity.getFrameColor():""},e.prototype.onFrameColorChanged=function(e){this._myActivityFrameColorChanged.push(e)},e.prototype._subscribeMyContextChanged=function(e,t,n,r){var i=this.window;if(!Ze(i)){var o=i.activity;Ze(o)||e.id===o.id&&this._notifyMyContextChanged(e,t,n,r)}},e.prototype._subscribeMyWindowEvent=function(e,t,n){Ze(this.window)||this.window.id===t.id&&(n===ut.ActivityWindowJoinedActivity?(this._notifyMyWindowEvent(e,this._myActivityJoinedCallbacks),this._notifyMyContextChanged(e,e.context,null,null)):n===ut.ActivityWindowLeftActivity&&this._notifyMyWindowEvent(e,this._myActivityRemovedCallbacks))},e.prototype._notifyMyWindowEvent=function(e,t){var n=this;t.forEach((function(t){try{t(e,event)}catch(r){n._logger.warn("error in user callback "+r)}}))},e.prototype._notifyMyContextChanged=function(e,t,n,r){var i=this;n=n||{},r=r||[],this._myContextUpdateCallbacks.forEach((function(o){try{o(t,n,r,e)}catch(a){i._logger.warn("error in user callback "+a)}}))},e.prototype._notifyAttached=function(e){var t=this;this._myAttached.forEach((function(n){try{n(e)}catch(r){t._logger.warn("error in user callback "+r)}}))},e.prototype._notifyDetached=function(e){var t=this;this._myDetached.forEach((function(n){try{n(e)}catch(r){t._logger.warn("error in user callback "+r)}}))},e.prototype._notifyAttachedTo=function(e){var t=this;this._myAttachedTo.forEach((function(n){try{n(t.activity,e)}catch(r){t._logger.warn("error in user callback "+r)}}))},e.prototype._notifyDetachedFrom=function(e,t,n){var r=this;this._myDetachedFrom.forEach((function(i){try{i(e,t,n)}catch(o){r._logger.warn("error in user callback "+o)}}))},e.prototype._subscribeActivitiesAttached=function(e,t){var n=this.window;if(!Ze(n)){var r=n.activity;Ze(r)||e.id===r.id&&(t.windowIds.indexOf(n.id)>=0?this._notifyAttachedTo(t):this._notifyAttached(t))}},e.prototype._subscribeActivitiesDetached=function(e,t,n){var r=this.window;if(!Ze(r)){var i=r.activity;Ze(i)||(t.id===i.id&&this._notifyDetached(n),e.id===i.id&&this._notifyDetachedFrom(e,t,n))}},e.prototype._subscribeWindowFrameColorChanged=function(e){var t=this.activity;t&&t.owner&&t.owner.underlyingWindow.id===e.id&&this._myActivityFrameColorChanged.forEach((function(t){t(e.frameColor)}))},e}(),_t=function(){function e(e,t){if(this._logger=vt.Get("ReadyMarker ["+e+"]"),this._logger.debug("Initializing ready marker for '"+e+"' with "+t+" signals to wait"),t<=0)throw new Error("Invalid signal number. Should be > 0");this._signals=t,this._callbacks=[],this._name=e}return e.prototype.setCallback=function(e){this.isSet()?e(void 0):this.isError()?e(this._error):this._callbacks.push(e)},e.prototype.signal=function(e){if(this._logger.debug("Signaled - "+e+" - signals left "+(this._signals-1)),this._signals--,this._signals<0)throw new Error("Error in ready marker '"+this._name+" - signals are "+this._signals);this.isSet()&&this._callbacks.forEach((function(e){e(void 0)}))},e.prototype.error=function(e){this._error=e,this._callbacks.forEach((function(t){t(e)}))},e.prototype.isSet=function(){return!this.isError()&&0===this._signals},e.prototype.isError=function(){return!Xe(this._error)},e.prototype.getError=function(){return this._error},e}(),kt=function(){function e(e){this._items={},this._listeners=[],this._processNew=e}return e.prototype.addOne=function(e){this.add([e])},e.prototype.add=function(e){var t=this;e.forEach((function(e){t.process(new it(e,new ot(ut.Added)))}))},e.prototype.process=function(e){var t=e.context,n=t.type,r=e.entity;if(n===ut.StatusChange&&!t.oldStatus){var i=this._items[r.id];i&&(t.oldStatus=i.status)}n===ut.StatusChange&&t.oldStatus&&t.newStatus&&t.oldStatus.state===t.newStatus.state&&(t.type=ut.Updated),"undefined"===typeof htmlContainer&&(n===ut.ActivityWindowJoinedActivity&&this._items[r.id]&&this._items[r.id].activity&&(t.type=ut.Updated),n===ut.ActivityWindowLeftActivity&&this._items[r.id]&&!this._items[r.id].activity&&(t.type=ut.Updated));var o=this._updateInternalCollections(r,n,t);return this._notifyListeners(o,t),o},e.prototype.get=function(){var e=[];for(var t in this._items)if(this._items.hasOwnProperty(t)){var n=this._items[t];e.push(n)}return e},e.prototype.getByName=function(e){for(var t in this._items)if(t===e)return this._items[t]},e.prototype.getOrWait=function(e){var t=this;return new Promise((function(n){var r=function r(i){i.id===e&&(n(i),t.unsubscribe(r))};t.subscribe(r);var i=t.getByName(e);if(i)return t.unsubscribe(r),void n(i)}))},e.prototype.subscribe=function(e){var t=this;return this._listeners.push(e),Object.keys(this._items).forEach((function(n){var r=t._items[n];e(r,new ot(ut.Added.toString()))})),function(){t.unsubscribe(e)}},e.prototype.unsubscribe=function(e){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)},e.prototype._notifyListeners=function(e,t){this._listeners.forEach((function(n){try{n(e,t)}catch(r){return}}))},e.prototype._updateInternalCollections=function(e,t,n){var r=e,i=t===ut.StatusChange&&r.status&&r.status.state===ct.Destroyed||t===ut.StatusChange&&n&&n.newStatus&&n.newStatus.state===ct.Destroyed,o=t===ut.Closed;if(t===ut.Removed&&"undefined"===typeof r.isIndependent||o||i){var a=this._items[e.id];return delete this._items[e.id],this._processNew(e),a&&e._beforeDelete(a),e}var s=e.id;return this._items.hasOwnProperty(s)?this._items[e.id]._update(e):(this._processNew(e),this._items[e.id]=e),this._items[e.id]},e}(),xt=function(){function e(e,t,n){var r=this;this._logger=vt.Get("activityManager"),this._announcedWindows=[],this._attachedCallbacks=[],this._detachedCallbacks=[],this._frameColorChangesCallbacks=[],this._windowHandlers=[],this._bridge=e,this._activityTypes=new kt((function(e){return r._grabEntity(e)})),this._windowTypes=new kt((function(e){return r._grabEntity(e)})),this._activities=new kt((function(e){return r._grabEntity(e)})),this._windows=new kt((function(e){return r._grabEntity(e)})),this._dataReadyMarker=new _t("Activity Manager Data",["GetActivityTypes","GetWindowTypes","GetActivities","GetWindows"].length),this._descriptorsMarker=new _t("Attached Activities Descriptors",["GetDescriptors"].length),t?(this._readyMarker=new _t("Activity Manager Announce",["Announcement"].length),this._dataReadyMarker.setCallback((function(e){e&&r._readyMarker.error(e),r._descriptorsMarker.setCallback((function(e){e&&r._readyMarker.error(e),r._logger.debug("Auto announcing window"),r.announceWindow().then((function(e){r._announcedWindows.push(e),r._readyMarker.signal("Successfully announced window with id '"+e.id+"'")})).catch((function(e){r._logger.debug("Will not announce window - "+e),r._readyMarker.signal()}))})),r.refreshDescriptors()}))):this._readyMarker=this._dataReadyMarker,this._bridge.onActivitiesAttached((function(e){r._handleActivitiesAttached(e)})),this._bridge.onActivitiesDetached((function(e){r._handleActivitiesDetached(e)})),this._bridge.onActivityAttachedDescriptorsRefreshed((function(e){r._handleActivityDescriptorsRefreshed(e)})),n&&n.onWindowFrameColorChanged(this._handleWindowFrameColorChanged.bind(this)),this._bridge.init(),this._subscribeForData(),this._bridge.initReady().then((function(e){r._getInitialData()})).catch((function(e){console.log(e)}))}return Object.defineProperty(e.prototype,"usingHc",{get:function(){return"HC"===this._bridge.bridgeType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"announcedWindows",{get:function(){return this._announcedWindows},set:function(e){throw new Error("not allowed")},enumerable:!0,configurable:!0}),e.prototype.ready=function(e){var t=this,n=new Promise((function(e,n){t._readyMarker.setCallback((function(r){r?n(t._readyMarker.getError()):e(t)}))}));return pt(Promise.all([this._bridge.ready(),n]).then((function(){return t})),e)},e.prototype.getActivityTypes=function(){return this._activityTypes.get()},e.prototype.getActivityType=function(e){return this._activityTypes.getByName(e)},e.prototype.registerActivityType=function(e,t,n,r,i,o){var a=this;return pt(new Promise((function(o,s){var u;if(Ze(e))s("activityTypeName argument can not be undefined");else if($e(e))if(Ze(a.getActivityType(e)))if(Xe(t))s("Owner window type can not be undefined");else{u=$e(t)?{type:t,name:"",isIndependent:!1,arguments:{}}:t;var c=[];if(!Xe(n)&&Qe(n))for(var l in n){var d=n[l];if($e(d)){var f={type:d,name:"",isIndependent:!1,arguments:{},relativeTo:"",relativeDirection:"",windowStyleAttributes:{}};c.push(f)}else c.push(d)}a._bridge.registerActivityType(e,u,c,r,i).then((function(e){a._grabEntity(e),o(e)})).catch((function(e){s(e)}))}else s("Activity type '"+e+"' already exists");else s("activityTypeName should be string")})),o)},e.prototype.unregisterActivityType=function(e,t){var n=this;return pt(new Promise((function(t,r){var i=n.getActivityType(e);Xe(i)?r("Activity type '"+e+"' does not exists"):n._bridge.unregisterActivityType(e).then((function(){return t(i)}),r)})),t)},e.prototype.initiate=function(e,t,n,r){var i=this;return pt(new Promise((function(n,o){Xe(i.getActivityType(e))?o("Activity type '"+e+"' does not exists"):i._bridge.initiateActivity(e,t,r).then((function(e){i._activities.getOrWait(e).then((function(e){n(e)})).catch((function(e){return o(e)}))})).catch((function(e){o(e)}))})),n)},e.prototype.subscribeActivityTypeEvents=function(e){this._activityTypes.subscribe((function(t,n){e(t,n.type)}))},e.prototype.getWindowTypes=function(){return this._windowTypes.get()},e.prototype.getWindowType=function(e){return this._windowTypes.getByName(e)},e.prototype.registerWindowFactory=function(e,t,n){var r=this;return pt(new Promise((function(n,i){if(Ze(e))i("no windowType specified");else{if("object"===typeof(o=e)&&null!==o)e=e.getName();else if(!$e(e))return void i("windowType should be string or object that has getName method");var o;r._bridge.registerWindowFactory(e,t).then((function(e){n(e)})).catch((function(e){i(e)}))}})),n)},e.prototype.unregisterWindowFactory=function(e,t){var n=this;return pt(new Promise((function(t,r){Ze(e)?r("no windowType specified"):$e(e)?n._bridge.unregisterWindowFactory(e).then((function(e){t(e)})).catch((function(e){r(e)})):r("windowType should be a string")})),t)},e.prototype.getActivities=function(e){var t=this._activities.get();if(t=t.filter((function(e){return e._ownerId})),!e)return t;var n=e;if($e(e))n=[e];else if(e instanceof nt)n=[e.name];else if(!(e instanceof Array))throw new Error("Invalid input argument 'activityType' = "+e);return t.filter((function(e){var t=e.type;return function(e,t){for(var n=0;n<e.length;n++)if(t(e[n],n))return!0;return!1}(n,(function(e){return t.id===e.id}))}))},e.prototype.getActivityById=function(e){return this._activities.getByName(e)},e.prototype.announceWindow=function(e,t){var n=this;return new Promise((function(r,i){var o=n._bridge.getAnnouncementInfo();if(Xe(e)&&(e=o.activityWindowId),Xe(t)&&(t=o.activityWindowType),Ze(t))throw new Error("Can not announce - unknown windowType");var a=o&&o.activityId;if(Ze(e))n._logger.debug("Registering window with type:'"+t+"', name:'"+o.activityWindowName+"', ind.:'"+o.activityWindowIndependent+"'"),n._bridge.registerWindow(t,o.activityWindowName,o.activityWindowIndependent).then(n._windows.getOrWait.bind(n._windows)).then((function(e){return a?n._activities.getOrWait(a).then((function(t){return e})):e})).then((function(e){r(e)})).catch((function(e){n._logger.error(e)}));else{n._logger.debug("Announcing window with id '"+e+"' and type '"+t+"'");var s=n._windows.getByName(e);if(!Ze(s))return n._logger.debug("Window with id '"+e+"' already announced - reusing the window"),void r(s);n.subscribeWindowEvents((function t(o,a,s){e===a.id&&(s===ut.ActivityWindowJoinedActivity&&(Xe(a.activity)&&i("UNDEFINED ACTIVITY"),n._logger.trace("Got joined event for id '"+e+"'"),r(a),n.unsubscribeWindowEvents(t)))})),n._logger.trace("Waiting for joined event for id '"+e+"'"),n._bridge.announceWindow(t,e)}}))},e.prototype.subscribeWindowTypeEvents=function(e){this._windowTypes.subscribe((function(t,n){e(t,n.type)}))},e.prototype.subscribeActivityEvents=function(e){var t=this;return this._activities.subscribe((function(n,r){if(r.type===ut.StatusChange){var i=r;e(n,i.newStatus,i.oldStatus)}if(r.type===ut.Removed||r.type===ut.StatusChange&&r.newStatus.getState()===ct.Destroyed)for(var o=0,a=t._windows.get();o<a.length;o++){var s=a[o];s.activity&&s.activity.id===n.id&&t._windows.process(new it(s,new ot(ut.ActivityWindowLeftActivity)))}}))},e.prototype.subscribeWindowEvents=function(e){var t=function(t,n){var r=n.type;r===ut.Added&&(r="opened"),e(t.activity,t,r)};return this._windowHandlers.push([e,t]),this._windows.subscribe(t)},e.prototype.unsubscribeWindowEvents=function(e){var t=this._windowHandlers.find((function(t){return t[0]===e}));t&&(this._windowHandlers.splice(this._windowHandlers.indexOf(t),1),this._windows.unsubscribe(t[1]))},e.prototype.createWindow=function(e,t,n){var r=this;return pt(new Promise((function(n,i){var o,a;if(Ze(t)&&i("windowType is undefined"),$e(t))o={type:t,name:"",isIndependent:!1,arguments:{}};else if(t instanceof rt)o={type:t.type||t.id,name:t.name||t.type||t.id,isIndependent:!1};else{var s=["url"],u={};Object.keys(t).forEach((function(e){-1===s.indexOf(e)&&(u[e]=t[e])})),o=u}if(!Ze(o.relativeTo))if("string"===typeof(a=o.relativeTo))!Ze(c=r.getWindows({type:a}))&&c.length>0&&(o.relativeTo=c[0].id);else if(Ze(a.type))Ze(a.windowId)||(o.relativeTo=a.windowId);else{var c;!Ze(c=r.getWindows({type:a.type}))&&c.length>0&&(o.relativeTo=c[0].id)}r._bridge.createWindow(e&&e.id,o).then((function(t){r._logger.debug("Window created, waiting for window entity with id "+t);r._windows.subscribe((function i(o,a){o.id!==t||e&&!o.activity||(r._logger.debug("Got entity window with id "+t),n(o),r._windows.unsubscribe(i))}))})).catch((function(e){i(e)}))})),n)},e.prototype.createStackedWindows=function(e,t,n,r){var i=this;return pt(new Promise((function(r,o){Ze(e)&&o("activity is undefined"),Ze(t)&&o("relativeWindowTypes is undefined"),Array.isArray(t)||o("relativeWindowTypes has to be an array"),Ze(n)&&(n=2e4);var a=[];t.forEach((function(e){var t,r;if((t=$e(e)?{type:e,name:"",isIndependent:!1,arguments:{}}:e).stackedWindow=!0,t.timeout=n,!Ze(t.relativeTo))if(Ze((r=t.relativeTo).type)){if(!Ze(r.windowId)){var o=i.getWindows({id:r.windowId});!Ze(o)&&o.length>0&&(t.relativeTo=o[0].type.name)}}else t.relativeTo=r.type;a.push(t)}));var s=[];a.forEach((function(t){return s.push(i.createWindow(e,t))})),Promise.all(s).then(r).catch(o)})),r)},e.prototype.addWindowToActivity=function(e,t,n){var r=this._bridge.joinActivity(e.id,t.id).then((function(){return t}));return pt(r,n),r},e.prototype.leaveWindowFromActivity=function(e,t,n){var r=this._bridge.leaveActivity(e.id,t.id).then((function(){return t}));return pt(r,n),r},e.prototype.setActivityContext=function(e,t,n){var r=this;return pt(new Promise((function(n,i){Ze(e)&&i("activity can not be null"),r._bridge.updateActivityContext(e,t,!0).then((function(t){n(e)})).catch((function(e){i(e)}))})),n)},e.prototype.updateActivityContext=function(e,t,n){var r=this;return pt(new Promise((function(n,i){Ze(e)&&i("activity can not be null");var o=[];for(var a in t)t.hasOwnProperty(a)&&null===t[a]&&o.push(a);for(var s=0,u=o;s<u.length;s++){var c=u[s];delete t[c]}r._bridge.updateActivityContext(e,t,!1,o).then((function(t){n(e)})).catch((function(e){i(e)}))})),n)},e.prototype.subscribeActivityContextChanged=function(e){this._activities.subscribe((function(t,n){if(n.type===ut.ActivityContextChange){var r=n;e(t,r.context,r.updated,r.removed)}}))},e.prototype.stopActivity=function(e,t){return pt(this._bridge.stopActivity(e),t)},e.prototype.getWindows=function(e){return Xe(e)?this._windows.get():Xe(e.id)?this._windows.get().filter((function(t){if(!Xe(e.type)&&t.type.id!==e.type)return!1;if(!Xe(e.name)&&t.name!==e.name)return!1;if(!Xe(e.activityId)){if(Ze(t.activity))return!1;if(t.activity.id!==e.activityId)return!1}return!0})):[this._windows.getByName(e.id)]},e.prototype.getWindowBounds=function(e){return this._bridge.getWindowBounds(e)},e.prototype.setWindowBounds=function(e,t,n){var r=this;return pt(new Promise((function(n,i){r._bridge.setWindowBounds(e,t).then((function(){return n()})).catch((function(e){return i(e)}))})),n)},e.prototype.closeWindow=function(e){return this._bridge.closeWindow(e)},e.prototype.activateWindow=function(e,t){return this._bridge.activateWindow(e,t)},e.prototype.setWindowVisibility=function(e,t){return this._bridge.setWindowVisibility(e,t)},e.prototype.clone=function(e,t,n){var r=this;return pt(new Promise((function(n,i){e||i("activity can not be null"),r._bridge.cloneActivity(e.id,t).then((function(e){r._activities.getOrWait(e).then((function(e){n(e)})).catch((function(e){return i(e)}))})).catch((function(e){return i(e)}))})),n)},e.prototype.attachActivities=function(e,t,n,r){var i=this;return n=n||{},pt(new Promise((function(r,o){if(i._activities.getByName(e)){if(i._activities.getByName(t))return i._bridge.attachActivities(e,t,n).then((function(e){var t=e.to,n=e.descriptor,o=e.descriptors;i._activities.getOrWait(t).then((function(e){e._updateDescriptors(o);var t=e.attached.filter((function(e){return e.ownerId===n.ownerId}))[0];r(t)}))})).catch((function(e){o(e)}));o("can not find activity with id "+t)}else o("can not find activity with id "+e)})),r)},e.prototype.detachActivities=function(e,t,n){var r=this;return pt(new Promise((function(n,i){return r._bridge.detachActivities(e,t).then((function(){r._activities.getOrWait(void 0).then((function(e){e._updateDescriptors(void 0),r._activities.getOrWait(void 0).then((function(e){n(e)}))})).catch((function(e){return i(e)}))})).catch((function(e){i(e)}))})),n)},e.prototype.subscribeActivitiesAttached=function(e){this._attachedCallbacks.push(e)},e.prototype.subscribeActivitiesDetached=function(e){this._detachedCallbacks.push(e)},e.prototype.subscribeActivityFrameColorChanged=function(e){this._frameColorChangesCallbacks.push(e)},e.prototype._grabEntity=function(e){e._manager=this},e.prototype._getInitialData=function(){var e=this;this._logger.debug("Request initial data..."),this._bridge.getActivityTypes().then((function(t){e._activityTypes.add(t),e._dataReadyMarker.signal("Got act types")})).catch((function(t){e._logger.error(t),e._dataReadyMarker.error("Can not initialize ActivityManager - error getting activity types -"+t)})),this._bridge.getWindowTypes().then((function(t){e._windowTypes.add(t),e._dataReadyMarker.signal("Got window types")})).catch((function(t){e._logger.error(t),e._dataReadyMarker.error("Can not initialize ActivityManager - error getting window types  "+t)})),this._bridge.getActivities().then((function(t){e._activities.add(t),e._dataReadyMarker.signal("Got activities")})).catch((function(t){e._logger.error(t),e._dataReadyMarker.error("Can not initialize ActivityManager - error getting activity instances -"+t)})),this._bridge.getActivityWindows().then((function(t){e._windows.add(t),e._dataReadyMarker.signal("Got windows")})).catch((function(t){e._logger.error(t),e._dataReadyMarker.error("Can not initialize ActivityManager - error getting activity windows -"+t)}))},e.prototype._subscribeForData=function(){var e=this;this._logger.debug("Subscribe for data..."),this._bridge.onActivityTypeStatusChange((function(t){e._activityTypes.process(t)})),this._bridge.onWindowTypeStatusChange((function(t){e._windowTypes.process(t)})),this._bridge.onActivityWindowChange((function(t){e._windows.process(t)})),this._bridge.onActivityStatusChange((function(t){e._activities.process(t)}))},e.prototype._handleActivitiesAttached=function(e){var t=this,n=e.to,r=e.descriptor,i=e.descriptors;this._activities.getOrWait(n).then((function(e){e._updateDescriptors(i);var n=e.attached.filter((function(e){return e.ownerId===r.ownerId}))[0];t._attachedCallbacks.forEach((function(t){try{t(e,n)}catch(r){return}}))}))},e.prototype._handleActivitiesDetached=function(e){var t=this,n=e.oldActivityId,r=e.newActivityId,i=e.descriptors,o=e.descriptor;this._activities.getOrWait(n).then((function(e){e._updateDescriptors(i),t._activities.getOrWait(r).then((function(n){t._detachedCallbacks.forEach((function(t){try{t(n,e,o)}catch(r){return}}))}))}))},e.prototype._handleActivityDescriptorsRefreshed=function(e){var t=e.id,n=e.descriptors,r=this._activities.getByName(t);r&&r._updateDescriptors(n)},e.prototype.refreshDescriptors=function(){var e=this;this._bridge.getAttachedDescriptors().then((function(t){t&&Object.keys(t).forEach((function(n){var r=n,i=t[n],o=e._activities.getByName(r);o&&o._updateDescriptors(i)})),e._descriptorsMarker.signal("Successfully got descriptors")})).catch((function(t){e._descriptorsMarker.error("failed to get descriptors - "+t)}))},e.prototype._handleWindowFrameColorChanged=function(e){if(e.activityId){var t=this._activities.getByName(e.activityId);t&&t.owner&&t.owner.underlyingWindow.id===e.id&&this._frameColorChangesCallbacks.forEach((function(n){try{n(t,e.frameColor)}catch(r){return}}))}},e}(),St=function(){function e(e,t){this._m=e,this._my=t,this.activityTypes={get:this._getActivityTypesWrapper.bind(this),register:this._m.registerActivityType.bind(this._m),unregister:this._m.unregisterActivityType.bind(this._m),subscribe:this._m.subscribeActivityTypeEvents.bind(this._m),unsubscribe:void 0,initiate:this._m.initiate.bind(this._m)},this.windowTypes={get:this._getWindowTypesWrapper.bind(this),registerFactory:this._m.registerWindowFactory.bind(this._m),unregisterFactory:this._m.unregisterWindowFactory.bind(this._m),subscribe:this._m.subscribeWindowTypeEvents.bind(this._m),unsubscribe:void 0},this.windows={get:this._m.getWindows.bind(this._m),subscribe:this._m.subscribeWindowEvents.bind(this._m),announce:this._m.announceWindow.bind(this._m),unsubscribe:void 0,create:this._m.createWindow.bind(this._m)},this.instances={get:this._m.getActivities.bind(this._m),subscribe:this._m.subscribeActivityEvents.bind(this._m),unsubscribe:void 0}}return e.prototype.onAttached=function(e){this._m.subscribeActivitiesAttached(e)},e.prototype.onDetached=function(e){this._m.subscribeActivitiesDetached(e)},e.prototype.onActivityFrameColorChanged=function(e){this._m.subscribeActivityFrameColorChanged(e)},e.prototype._getActivityTypesWrapper=function(e){return Xe(e)?this._m.getActivityTypes():this._m.getActivityType(e)},e.prototype._getWindowTypesWrapper=function(e){return Xe(e)?this._m.getWindowTypes():this._m.getWindowType(e)},e}(),It=function(){function e(e,t){this._mgr=e,this._my=t,this.all=new St(e,t)}return e.prototype.ready=function(e){var t=this;return pt(new Promise((function(e,n){t._mgr.ready().then((function(){e(t)})).catch((function(e){n(e)}))})),e)},Object.defineProperty(e.prototype,"my",{get:function(){return this._my},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"aware",{get:function(){return void 0!==this._my.window},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inActivity",{get:function(){return this.aware&&void 0!==this._my.activity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"agm",{get:function(){if(this.aware)return this.inActivity?this._my.activity.agm:new lt(null)},enumerable:!0,configurable:!0}),e.prototype.getAvailableFrameColors=function(){return[]},e}(),Ct=function(){function e(t){var n,r=this;if(!t)throw new Error("config can not be null");if(Xe(t.logLevel)||(vt.Level=t.logLevel),Ze(t.logger)||(vt.GlueLogger=t.logger),this._isUsingHCImplementation=2===t.gdMajorVersion,this._isUsingGW3Implementation=e.checkIsUsingGW3Implementation(t.connection),this._isUsingHCImplementation)throw new Error("GD2 not supported");if(!this._isUsingGW3Implementation)throw new Error("Unable to instantiate activity bridge implementation");if(!(n=new bt(t)))throw new Error("A bridge to native activity is needed to create activity lib.");lt.AGM=t.agm;var i=new xt(n,!t.disableAutoAnnounce,t.windows),o=new wt(i,t.windows);this._api=new It(i,o),this._readyPromise=i.ready().then((function(e){return r}))}return e.checkIsUsingGW3Implementation=function(e){return 3===e.protocolVersion},Object.defineProperty(e.prototype,"api",{get:function(){return this._api},set:function(e){this._api=e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUsingHCImplementation",{get:function(){return this._isUsingHCImplementation},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isUsingGW3Implementation",{get:function(){return this._isUsingGW3Implementation},enumerable:!0,configurable:!0}),e.prototype.ready=function(e){return pt(this._readyPromise,e)},e}();function Tt(e){if(e&&e.errorHandling&&"function"!==typeof e.errorHandling&&"log"!==e.errorHandling&&"silent"!==e.errorHandling&&"throw"!==e.errorHandling)throw new Error('Invalid options passed to createRegistry. Prop errorHandling should be ["log" | "silent" | "throw" | (err) => void], but '+typeof e.errorHandling+" was passed");var t=e&&"function"===typeof e.errorHandling&&e.errorHandling,n={};function r(n,r){var i=n instanceof Error?n:new Error(n);if(t)t(i);else{var o='[ERROR] callback-registry: User callback for key "'+r+'" failed: '+i.stack;if(e)switch(e.errorHandling){case"log":return console.error(o);case"silent":return;case"throw":throw new Error(o)}console.error(o)}}return{add:function(e,t,i){var o=n[e];return o||(o=[],n[e]=o),o.push(t),i&&setTimeout((function(){i.forEach((function(i){var o;if(null===(o=n[e])||void 0===o?void 0:o.includes(t))try{Array.isArray(i)?t.apply(void 0,i):t.apply(void 0,[i])}catch(a){r(a,e)}}))}),0),function(){var r=n[e];r&&(0===(r=r.reduce((function(e,n,r){return n===t&&e.length===r||e.push(n),e}),[])).length?delete n[e]:n[e]=r)}},execute:function(e){for(var t=[],i=1;i<arguments.length;i++)t[i-1]=arguments[i];var o=n[e];if(!o||0===o.length)return[];var a=[];return o.forEach((function(n){try{var i=n.apply(void 0,t);a.push(i)}catch(o){a.push(void 0),r(o,e)}})),a},clear:function(){n={}},clearKey:function(e){n[e]&&delete n[e]}}}Tt.default=Tt;var Pt=Tt;function At(e){return e?Object.keys(e).map((function(t){return e[t]})):[]}function Et(e){var t;try{t=JSON.parse(JSON.stringify(e||{}))}catch(n){t={}}return t}var Ot=function(){function e(e,t,n){var r=this;this._appManager=e,this._name=t,this._agm=n,this._registry=Pt(),e.onInstanceStarted((function(e){e.application&&e.application.name!==r._name||r._registry.execute("instanceStarted",e)})),e.onInstanceStopped((function(e){e.application&&e.application.name!==r._name||r._registry.execute("instanceStopped",e)})),e.onAppRemoved((function(e){e.name===r._name&&r._registry.execute("appRemoved",e)})),e.onAppChanged((function(e){e.name===r._name&&r._registry.execute("appChanged",e)})),e.onAppAvailable((function(e){e.name===r._name&&r._registry.execute("appAvailable",e)})),e.onAppUnavailable((function(e){e.name===r._name&&r._registry.execute("appUnavailable",e)}))}return Object.defineProperty(e.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._props.Title},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"version",{get:function(){return this._props.Version},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"autoStart",{get:function(){return this._props.AutoStart},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isShell",{get:function(){return this._props.IsShell},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"caption",{get:function(){return this._props.Caption},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"hidden",{get:function(){return this._props.IsHidden},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"container",{get:function(){return this._props.ApplicationName},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activityType",{get:function(){return this._props.ActivityType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activityWindowType",{get:function(){return this._props.ActivityWindowType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"windowSettings",{get:function(){return this._props.Arguments?Et(this._props.Arguments):{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"allowMultiple",{get:function(){return this._props.AllowMultiple},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"available",{get:function(){return this._props.IsReady||!0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"icon",{get:function(){return this._props.Icon},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"iconURL",{get:function(){return this._props.IconUrl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sortOrder",{get:function(){return this._props.SortOrder},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userProperties",{get:function(){return this._props.UserProperties?Et(this._props.UserProperties):{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isActivity",{get:function(){return void 0!==this._props.ActivityType&&""!==this._props.ActivityType},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"configuration",{get:function(){return{autoStart:this._props.AutoStart,caption:this._props.Caption,hidden:this._props.IsHidden,container:this._props.ApplicationName,activityType:this._props.ActivityType,allowMultiple:this._props.AllowMultiple}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"instances",{get:function(){var e=this;return this._appManager.instances().filter((function(t){return t.application.name===e._name}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"type",{get:function(){return this._props.Type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"mode",{get:function(){if(!this._props)return"unknown";if(this._props.Mode&&"string"===typeof this._props.Mode)return this._props.Mode.toLowerCase();if(this.isActivity)return"unknown";if(this._props.Arguments&&this._props.Arguments.mode&&"string"===typeof this._props.Arguments.mode)return this._props.Arguments.mode.toLowerCase();var e=this._props.WindowStyleAttributes;if(e){var t=(e=e.split(" ").join("")).indexOf('mode:"');if(-1!==t){var n=t+'mode:"'.length,r=e.indexOf('"',n),i=e.substr(n,r-n);if(i&&"string"===typeof i)return i.toLowerCase()}}return"flat"},enumerable:!0,configurable:!0}),e.prototype.updateFromProps=function(e){var t=this;this._props||(this._props={Name:e.Name}),Object.keys(e).forEach((function(n){t._props[n]=e[n]}))},e.prototype.start=function(e,t){var n=this,r=this._name;return new Promise((function(i,o){t=t||{},e=e||{};n._agm.invoke("T42.ACS.StartApplication",{Name:r,Context:e,Options:t},"best",{methodResponseTimeoutMs:1e4},(function(e){var t=e.returned&&e.returned.Instance_0?e.returned.Instance_0:e.returned;if(t&&t.Id)if("startOnly"===n._appManager.mode){var r=n._appManager.handleInstanceStarted(t);i(r)}else!function(e){var t,r=function(){var t,r=n._appManager.instances().filter((function(t){return t.id===e}));return(t=2===r.length?r[0].isActivityInstance?r[0]:r[1]:r[0])?t.agm?t:void 0:t},a=setTimeout((function(){t&&t(),o("timeout")}),1e4);t=n._appManager.onInstanceAgmServerReady((function(n){n.id===e&&(t&&(t(),t=void 0),clearTimeout(a),setTimeout((function(){i(r())}),1))}));var s=r();s&&(t&&(t(),t=void 0),clearTimeout(a),i(s))}(t.Id);else i(void 0)}),(function(e){o(e)}))}))},e.prototype.onInstanceStarted=function(e){this._registry.add("instanceStarted",e)},e.prototype.onInstanceStopped=function(e){this._registry.add("instanceStopped",e)},e.prototype.onAvailable=function(e){this._registry.add("appAvailable",e)},e.prototype.onUnavailable=function(e){this._registry.add("appUnavailable",e)},e.prototype.onChanged=function(e){this._registry.add("appChanged",e)},e.prototype.onRemoved=function(e){this._registry.add("appRemoved",e)},e}(),Mt=function(){function e(e,t,n,r,i,o,a){var s=this;this._id=e,this._appName=t,this._appManager=n,this._agm=r,this._activities=i,this._windows=o,this.onAgmReady=this._addToRegistry("agmReady"),this.onStopped=this._addToRegistry("stopped"),this._registry=Pt(),a||(this._unsubscribeInstanceStopped=this._appManager.onInstanceStopped((function(e){e.id===s._id&&s._registry.execute("stopped",e)})),this._unsubscribeInstanceAgmServerReady=this._appManager.onInstanceAgmServerReady((function(e){e.id===s._id&&s._registry.execute("agmReady",e)})))}return Object.defineProperty(e.prototype,"id",{get:function(){return this._id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"application",{get:function(){return this._appManager.application(this._appName)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activity",{get:function(){var e=this;if(!this._activities)throw new Error("This method requires glue.activities library to be enabled.");return this._activities.all.instances.get().filter((function(t){return t.id===e._activityId}))[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isActivityOwner",{get:function(){return this._isActivityOwner},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activityInstances",{get:function(){var e=this;return this._appManager.instances().filter((function(t){return"activity"!==t.application.type&&t.activityId&&t.activityId===e._activityId}))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activityOwnerInstance",{get:function(){if(this._activityId)return this.activityInstances.filter((function(e){var t;return null===(t=e)||void 0===t?void 0:t.isActivityOwner}))[0]},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"window",{get:function(){var e=this;if(!this._windows)throw new Error("This method requires glue.windows library to be enabled.");var t=this._windows.list().filter((function(t){return t.id===e._id}))[0];return!t&&this.activity&&this.activityOwnerInstance&&(t=this.activityOwnerInstance.window),t},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"context",{get:function(){var e,t,n;return null!==(n=null!==(e=this._startUpContext)&&void 0!==e?e:null===(t=this.window)||void 0===t?void 0:t.context)&&void 0!==n?n:{}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"title",{get:function(){return this._title},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isActivityInstance",{get:function(){return this._isActivityInstance},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"activityId",{get:function(){return this._activityId},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inActivity",{get:function(){return this._inActivity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isSingleWindowApp",{get:function(){return!this._inActivity},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"agm",{get:function(){return this._agmInstance},enumerable:!0,configurable:!0}),e.prototype.updateFromProps=function(e){this._startUpContext=e.Context,this._title=e.Title,this._isActivityInstance=!1,e.ActivityId&&""!==e.ActivityId&&(this._activityId=e.ActivityId,this._isActivityInstance=!0),this._isActivityOwner=e.IsActivityOwner,!this._activityId&&this._startUpContext&&this._startUpContext.activityId&&(this._activityId=this._startUpContext.activityId),this._inActivity=Boolean(this._activityId),this.updateAgmInstanceFromProps(e)},e.prototype.updateAgmInstanceFromProps=function(e){if(e.AgmServers)if(e.GD3){var t=e.AgmServers;t&&(this._agmInstance=t[0])}else{var n=e.AgmServers,r=Object.keys(n)[0];if(!r)return;var i=n[r];this._agmInstance={machine:i.machineName,user:i.userName,environment:i.environment,application:i.applicationName}}},e.prototype.stop=function(){var e=this;return new Promise((function(t,n){var r=e._appManager.onInstanceStopped((function(n){n.id===e._id&&(r(),t())}));e._agm.invoke("T42.ACS.StopApplication",{Name:e._appName,Id:e._id}).then((function(){"startOnly"===e._appManager.mode&&(e._appManager.handleInstanceStopped({Name:e._appName,Id:e.id,Context:void 0,Title:void 0,ActivityId:void 0,IsActivityOwner:void 0,AgmServers:void 0}),t())})).catch((function(e){return n(e)}))}))},e.prototype.activate=function(){return this._agm.invoke("T42.ACS.ActivateApplication",{Name:this._appName,Id:this._id})},e.prototype.done=function(){this._registry.clear(),this._unsubscribeInstanceAgmServerReady(),this._unsubscribeInstanceStopped()},e.prototype.getContext=function(){return Promise.resolve(this.context)},e.prototype._addToRegistry=function(e){var t=this;return function(n){t._registry.add(e,n)}},e}(),jt=function(){function e(e,t,n,r,i,o){var a=this;this.mode=e,this._agm=t,this._activities=n,this._windows=r,this._logger=i,this._gdMajorVersion=o,this._apps={},this._instances=[],this._registry=Pt(),this.application=function(e){return a._apps[e]},this.applications=function(){return Object.keys(a._apps).map((function(e){return a._apps[e]}))},this.instances=function(){return a._instances},this.getMyInstance=function(){if(a._gdMajorVersion>=3){var e=window.glue42gd.appInstanceId;return a._instances.filter((function(t){return t.id===e}))[0]}},this.handleAppAdded=function(e){var t=a._getAppId(e);a._logger.trace("adding app "+t),a._apps[t]=new Ot(a,t,a._agm);var n=a._updateAppFromProps(e);a._registry.execute("appAdded",n)},this.handleAppUpdated=function(e){var t=a._updateAppFromProps(e);a._registry.execute("appChanged",t)},this.handleAppRemoved=function(e){var t=a._getAppId(e);a._logger.trace("removing app "+t);var n=a.application(t);a._instances=a._instances.filter((function(e){return e.application.name!==n.name})),delete a._apps[t],a._registry.execute("appRemoved",n)},this.handleAppReady=function(e){var t=a._getAppId(e),n=a._getAppOrThrow(t);n.updateFromProps(e),n.available?a._registry.execute("appAvailable",n):a._registry.execute("appUnavailable",n)},this.handleInstanceStarted=function(e){a._logger.trace("started app "+e.Name+" "+e.Id);var t=a._getInstanceId(e),n=a._getInstanceAppName(e),r=new Mt(t,n,a,a._agm,a._activities,a._windows);return a._updateInstanceFromProps(r,e),a._instances.push(r),a._registry.execute("instanceStarted",r),r},this.handleInstanceStopped=function(e){a._logger.trace("failed to start app "+e.Name+" "+e.Id);var t=a._getInstanceId(e),n=a._getInstanceAppName(e),r=a._getInstanceOrThrow(t,n);a._instances=a._instances.filter((function(e){return!a._matchInstance(e,t,n)})),a._registry.execute("instanceStopped",r),r.done()},this.handleInstanceAgmServerReady=function(e){var t=a._getInstanceId(e),n=a._getInstanceAppName(e),r=a._getInstanceOrThrow(t,n);r.updateAgmInstanceFromProps(e),a._registry.execute("instanceAgmServerReady",r)},this.handleInstanceStartFailed=function(e){var t=a._getInstanceId(e),n=a._getInstanceAppName(e),r=new Mt(t,n,void 0,void 0,void 0,void 0,!0);a._updateInstanceFromProps(r,e),a._registry.execute("instanceStartFailed",r)},this.handleInstanceUpdated=function(e){var t=a._getInstanceId(e),n=a._getInstanceAppName(e),r=a._getInstanceOrThrow(t,n);a._updateInstanceFromProps(r,e)},this.onInstanceStarted=function(e){return a._registry.add("instanceStarted",e,a._instances)},this.onInstanceStartFailed=function(e){return a._registry.add("instanceStartFailed",e)},this.onInstanceStopped=function(e){return a._registry.add("instanceStopped",e)},this.onInstanceUpdated=function(e){return a._registry.add("instanceChanged",e)},this.onInstanceAgmServerReady=function(e){return a._registry.add("instanceAgmServerReady",e)},this.onAppAdded=function(e){return a._registry.add("appAdded",e,Object.values(a._apps))},this.onAppRemoved=function(e){return a._registry.add("appRemoved",e)},this.onAppAvailable=function(e){return a._registry.add("appAvailable",e)},this.onAppUnavailable=function(e){return a._registry.add("appUnavailable",e)},this.onAppChanged=function(e){return a._registry.add("appChanged",e)}}return e.prototype._getAppOrThrow=function(e){var t=this.application(e);if(!t)throw Error("app with id "+e+" not found");return t},e.prototype._getAppId=function(e){return e.Name},e.prototype._matchInstance=function(e,t,n){return e.id===t&&e.application.name===n},e.prototype._getInstanceByIdAndName=function(e,t){var n=this;return this._instances.filter((function(r){return n._matchInstance(r,e,t)}))[0]},e.prototype._getInstanceOrThrow=function(e,t){var n=this._getInstanceByIdAndName(e,t);if(!n)throw Error("instance with id "+e+" not found");return n},e.prototype._getInstanceId=function(e){return e.Id},e.prototype._getInstanceAppName=function(e){return e.Name},e.prototype._updateAppFromProps=function(e){var t=this._getAppId(e);this._logger.trace("updating app with  + "+t+", "+e);var n=this._getAppOrThrow(t);return n.updateFromProps(e),n},e.prototype._updateInstanceFromProps=function(e,t){this._logger.trace("updating instance with "+this._getInstanceId(t)+" for app "+this._getInstanceAppName(t)),e.updateFromProps(t)},e}();function Rt(e,t,n){var r=function(e){return!!(e&&e.constructor&&e.call&&e.apply)};if(!r(t)&&!r(n))return e;r(t)?r(n)||(n=function(){}):t=function(){},e.then(t,n)}var Nt=function(){function e(e){var t=this;this._agm=e,this._registry=Pt(),this._isMethodRegistered=!1,this.handleBranchModified=function(e){t._registry.execute("branchChanged",e)},this.handleBranchesModified=function(e){t._registry.execute("branchesChanged",e)},this.getRegion=function(e,n){return Rt(t._agmInvoke("T42.ACS.GetConfigurationRegion",(function(e){return e.returned.Region})),e,n)},this.getBranches=function(e,n){return Rt(t._agmInvoke("T42.ACS.GetBranches",(function(e){var t=e.returned.Branches;return Object.keys(t).map((function(e){return t[e]}))})),e,n)},this.getCurrentBranch=function(e,n){return Rt(t._agmInvoke("T42.ACS.GetCurrentBranch",(function(e){return e.returned.Branch}),void 0),e,n)},this.setRegion=function(e,n,r){return Rt(t._agmInvoke("T42.ACS.SetConfigurationRegion",(function(e){return e.returned.ResultMessage}),{Region:e}),n,r)},this.setCurrentBranch=function(e,n,r){return Rt(t._agmInvoke("T42.ACS.SetCurrentBranch",(function(e){return e.returned.ResultMessage}),{Branch:e}),n,r)},this.currentUser=function(e,n){return Rt(t._agmInvoke("T42.ACS.GetUser"),e,n)},this.getFunctionalEntitlement=function(e,n,r){return Rt(t._agmInvoke("T42.ACS.GetFunctionalEntitlement",(function(e){return e.returned.Entitlement}),{Function:e}),n,r)},this.getFunctionalEntitlementBranch=function(e,n,r,i){return Rt(t._agmInvoke("T42.ACS.GetFunctionalEntitlement",(function(e){return e.returned.Entitlement}),{Function:e,Branch:n}),r,i)},this.canI=function(e,n,r){return Rt(t._agmInvoke("T42.ACS.CanI",(function(e){return e.returned.Result}),{Function:e}),n,r)},this.canIBranch=function(e,n,r,i){return Rt(t._agmInvoke("T42.ACS.CanI",(function(e){return e.returned.Result}),{Function:e,Branch:n}),r,i)},this.onBranchesChanged=function(e){return t._registry.add("branchesChanged",e)},this.onBranchChanged=function(e){return t._registry.add("branchChanged",e)},this.exit=function(e){return t._agmInvoke("T42.ACS.Shutdown",null,e)},this.onShuttingDown=function(e){return t.registerMethod(),t._registry.add("onShuttingDown",e)},this.restart=function(e){return t._agmInvoke("T42.ACS.Restart",null,e)},this._agmInvoke=function(e,n,r){return r=r||{},new Promise((function(i,o){t._agm.invoke(e,r).then((function(e){n||(n=function(e){return e.returned}),i(n(e))})).catch((function(e){return o(e)}))}))}}return e.prototype.registerMethod=function(){var e=this;this._isMethodRegistered||(this._agm.register("T42.ACS.OnGDShutdown",(function(t){return a(e,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return e.trys.push([0,2,,3]),[4,Promise.all(this._registry.execute("onShuttingDown",t))];case 1:return e.sent(),[3,3];case 2:return e.sent(),[3,3];case 3:return[2]}}))}))})),this._isMethodRegistered=!0)},e}();var Lt=function(){function e(e){this.interop=e}return e.prototype.import=function(e,t){if(!e||!Array.isArray(e))return Promise.reject("invalid apps argument - should be an array of application definitions");if(t&&"replace"!==t&&"merge"!==t)return Promise.reject("invalid mode argument - should be 'replace' or 'merge'");var n={command:"import",args:{apps:e,mode:t=null!==t&&void 0!==t?t:"replace"}};return this.interop.invoke("T42.ACS.InMemoryStoreCommand",n).then((function(e){return e.returned}))},e.prototype.export=function(){return this.interop.invoke("T42.ACS.InMemoryStoreCommand",{command:"export"}).then((function(e){return e.returned.apps}))},e.prototype.remove=function(e){if(!e||"string"!==typeof e)return Promise.reject("invalid app name, should be a string value");var t={command:"remove",args:{apps:[e]}};return this.interop.invoke("T42.ACS.InMemoryStoreCommand",t).then((function(e){return e.returned}))},e.prototype.clear=function(){return this.interop.invoke("T42.ACS.InMemoryStoreCommand",{command:"clear"}).then((function(e){return e.returned}))},e.prototype.createAppDef=function(e,t){return t||(t="https://google.com"),{name:e,type:"window",title:e,details:{url:t}}},e}(),Dt=function(e){if(!e)throw Error("config not set");if(!e.agm)throw Error("config.agm is missing");var t=e.mode||"startOnly";if("startOnly"!==t&&"skipIcons"!==t&&"full"!==t)throw new Error("Invalid mode for appManager lib - "+t+" is not supported");var n,r=e.activities,i=e.agm,o=e.logger,a=e.windows,s=new jt(t,i,r,a,o.subLogger("applications"),e.gdMajorVersion),u=new Nt(i);if("startOnly"===t)n=function(e,t){return new Promise((function(n,r){e.invoke("T42.ACS.GetApplications",{skipIcon:!0}).then((function(e){var r=e.returned;r||n();var i=r.applications;i||n(),At(i).map((function(e){return t.handleAppAdded(e)})),n()})).catch((function(e){return r("Error getting application snapshot: "+e.message)}))}))}(i,s);else{var c=function(e,t,n,r){var i;return{start:function(){var o,a,s=new Promise((function(e,t){o=e,a=t}));return e.subscribe("T42.ACS.OnEvent",{arguments:{skipIcon:r},waitTimeoutMs:1e4}).then((function(e){(i=e).onData((function(e){var r=e.data;At(r.OnApplicationAdded).map((function(e){return t.handleAppAdded(e)})),At(r.OnApplicationChanged).map((function(e){return t.handleAppUpdated(e)})),At(r.OnApplicationRemoved).map((function(e){return t.handleAppRemoved(e)})),At(r.OnApplicationReady).map((function(e){return t.handleAppReady(e)})),At(r.OnApplicationStarted).map((function(e){return t.handleInstanceStarted(e)})),At(r.OnApplicationStartFailed).map((function(e){return t.handleInstanceStartFailed(e)})),At(r.OnApplicationStopped).map((function(e){return t.handleInstanceStopped(e)})),At(r.OnApplicationUpdated).map((function(e){return t.handleInstanceUpdated(e)})),At(r.OnApplicationAgmServerReady).map((function(e){return t.handleInstanceAgmServerReady(e)})),At(r.OnBranchChanged).map((function(e){return n.handleBranchModified(e)})),At(r.OnBranchesModified).map((function(e){return n.handleBranchesModified(e)})),o()})),i.onFailed((function(e){return a(e)}))})).catch((function(e){return a("Error subscribing for T42.ACS.OnEvent stream. Err: "+e)})),s},stop:function(){i&&i.close()}}}(i,s,u,"skipIcons"===t);n=c.start()}return{ready:function(){return n},applications:s.applications,application:s.application,onAppAdded:s.onAppAdded,onAppRemoved:s.onAppRemoved,onAppChanged:s.onAppChanged,onAppAvailable:s.onAppAvailable,onAppUnavailable:s.onAppUnavailable,instances:s.instances,get myInstance(){return s.getMyInstance()},onInstanceStarted:s.onInstanceStarted,onInstanceStopped:s.onInstanceStopped,onInstanceUpdated:s.onInstanceUpdated,onInstanceStartFailed:s.onInstanceStartFailed,getRegion:u.getRegion,getBranches:u.getBranches,getCurrentBranch:u.getCurrentBranch,getFunctionalEntitlement:u.getFunctionalEntitlement,getFunctionalEntitlementBranch:u.getFunctionalEntitlementBranch,setCurrentBranch:u.setCurrentBranch,setRegion:u.setRegion,currentUser:u.currentUser,canI:u.canI,canIBranch:u.canIBranch,onBranchesChanged:u.onBranchesChanged,exit:u.exit,restart:u.restart,onShuttingDown:u.onShuttingDown,inMemory:new Lt(i)}},Wt=new(function(){function e(){this.waitForTimeoutInMilliseconds=6e4,this._windows={},this._pendingWindows={},this._pendingWindowsStates={},this._registry=Pt()}return e.prototype.init=function(e){this._logger=e},e.prototype.get=function(e){return this._windows[e]||this._pendingWindows[e]},e.prototype.getIfReady=function(e){return this._windows[e]},Object.defineProperty(e.prototype,"list",{get:function(){return this._windows},enumerable:!0,configurable:!0}),e.prototype.add=function(e){if(!!this._pendingWindows[e.API.id])this._logger.error("trying to add window with id "+e.API.id+" from windowStore, which already exists");else{var t="remote"===e.API.windowType;this._pendingWindows[e.API.id]=e,this._pendingWindowsStates[e.API.id]={ready:!1,urlChanged:t},this._registry.execute("on-added",e)}},e.prototype.remove=function(e){delete this._windows[e.API.id],delete this._pendingWindows[e.API.id],delete this._pendingWindowsStates[e.API.id],this._registry.execute("on-removed",e)},e.prototype.setReadyState=function(e){var t=this._pendingWindowsStates[e];"undefined"!==typeof t&&(t.ready=!0,t.urlChanged&&this.markReadyToShow(e))},e.prototype.setUrlChangedState=function(e){var t=this._pendingWindowsStates[e];"undefined"!==typeof t&&(t.urlChanged=!0,t.ready&&this.markReadyToShow(e))},e.prototype.waitFor=function(e){var t=this;return new Promise((function(n,r){var i,o=setTimeout((function(){i(),r("waitFor timed out.")}),t.waitForTimeoutInMilliseconds),a=t._windows[e];a?(clearTimeout(o),n(a)):i=t.onReadyWindow((function(t){t.API.id===e&&(clearTimeout(o),i(),n(t))}))}))},e.prototype.onReadyWindow=function(e){return this._registry.add("on-ready",e)},e.prototype.onAdded=function(e){return this._registry.add("on-added",e)},e.prototype.onRemoved=function(e){return this._registry.add("on-removed",e)},e.prototype.markReadyToShow=function(e){this._pendingWindows[e]&&(this._windows[e]=this._pendingWindows[e],delete this._pendingWindows[e],delete this._pendingWindowsStates[e]),this._registry.execute("on-ready",this._windows[e])},e}()),Ft=function(){function e(){}return e.getGDMajorVersion=function(){if("undefined"===typeof window)return-1;if(!window.glueDesktop)return-1;if(!window.glueDesktop.version)return-1;var e=Number(window.glueDesktop.version.substr(0,1));return isNaN(e)?-1:e},e.callbackifyPromise=function(e,t,n){var r=function(e){var t=e;if(e instanceof Error&&(t=e.message),"function"!==typeof n)return Promise.reject(t);n(t)};try{return e().then((function(e){return"function"===typeof t&&t(e),e})).catch((function(e){return r(e)}))}catch(i){return r(i)}},e.getMonitor=function(e,t){var n=this;return t.map((function(t){var r=t.left,i=t.top,o=t.workingAreaWidth,a=t.workingAreaHeight;return{monitor:t,totalOverlap:n.calculateTotalOverlap({left:r,top:i,width:o,height:a},e)}})).sort((function(e,t){return t.totalOverlap-e.totalOverlap}))[0].monitor},e.getDisplayCenterOfScreen=function(e,t){var n=Math.floor(Math.max(t.left,t.left+(t.workingAreaWidth-e.width)/2));return{top:Math.floor(Math.max(t.top,t.top+(t.workingAreaHeight-e.height)/2)),left:n}},e.calculateTotalOverlap=function(e,t){var n=e.left,r=e.top,i=n+e.width,o=r+e.height,a=t.left,s=t.top,u=a+t.width,c=s+t.height;return Math.max(0,Math.min(i,u)-Math.max(n,a))*Math.max(0,Math.min(o,c)-Math.max(r,s))},e}(),Ut=function(e,t,n,r,i,o,u,c){var l,d,f=null!==c&&void 0!==c?c:Pt(),p=r.subLogger("window "+e),h=t.name,g=t.mode,v=t.url,y=t.title,m=t.context||{},b=t.bounds,w=t.frameColor,_=t.focus,k=t.neighbours||{},x=t.groupId,S=t.isGroupHeaderVisible,I=t.isTabHeaderVisible,C=t.isTabSelected,T=t.settings,P=t.isVisible,A=t.isSticky,E=t.isCollapsed,O=t.state,M=t.tabGroupId,j=t.isLocked,R=[],N=t.zoomFactor,L=t.placementSettings;function D(e,t,r){return new Promise((function(i,o){var a,s,u=ce(e,b),c=!1,l=function(){c||(c=!0,"function"===typeof t&&t(d),i(d),s&&(s(),s=void 0),a&&(clearTimeout(a),a=void 0))};u||(s=te((function(t){ce(e,t.bounds)&&l()}))),n.moveResize(d,e).then((function(){u?l():a=setTimeout((function(){l()}),1e3)})).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))}function W(e,t,r){return new Promise((function(i,o){if(e===P)return"function"===typeof t&&t(d),i(d);var a=X((function(e){"function"===typeof t&&t(d),a(),i(d)}));n.setVisible(d,e).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))}function F(e,t,r){return new Promise((function(i,o){var a=Z((function(){a(),"function"===typeof t&&t(d),i(d)}));n.updateContext(d,e).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))}function U(){return new Promise((function(e){var t=ee((function(n){n.id===d.id&&(t(),e())}))}))}function B(e){return e(d.title,d),f.add("onTitleChanged",e)}function V(e){return f.add("onClose",e)}function H(e){return f.add("onUrlChanged",e)}function z(e){return f.add("onFrameButtonAdded",e)}function q(e){return f.add("onFrameButtonRemoved",e)}function G(e){return E&&e(d),f.add("collapsed",e)}function J(e){return E||e(d),f.add("expanded",e)}function K(e){return"maximized"===O&&e(d),f.add("maximized",e)}function Y(e){return"minimized"===O&&e(d),f.add("minimized",e)}function $(e){return"normal"===O&&e(d),f.add("normal",e)}function Q(e){return f.add("detached",e)}function X(e){return f.add("visibility-changed",e)}function Z(e){return f.add("context-updated",e)}function ee(e){return f.add("lock-changed",e)}function te(e){return f.add("bounds-changed",e)}function ne(e){return f.add("focus-changed",e)}function re(e){return f.add("frame-color-changed",e)}function ie(e){return f.add("tab-header-visibility-changed",e)}function oe(e){return f.add("group-changed",e)}function ae(e){var t=k[e];if("undefined"!==typeof t)return t.reduce((function(e,t){var n=Wt.get(t);return n&&e.push(n.API),e}),[])}function se(){if(m._APPLICATION_NAME)return m._APPLICATION_NAME;if(m&&m._t42&&m._t42.application)return m._t42.application;var e=ue();return e?e.applicationName:void 0}function ue(){if("undefined"!==typeof window&&window.glue42gd&&window.glue42gd.getWindowInfo){var t=window.glue42gd.getWindowInfo(e);return t||void 0}}function ce(e,t){var n=e.height,r=e.width;e.height<T.minHeight&&(n=T.minHeight),e.height>T.maxHeight&&(n=T.maxHeight),e.width<T.minWidth&&(r=T.minWidth),e.width>T.maxWidth&&(r=T.maxWidth);var i=!n||t.height===n,o=!r||t.width===r,a=!e.left||t.left===e.left,s=!e.top||t.top===e.top;return i&&o&&a&&s}var le={handleWindowClose:function(){void 0!==d.id&&(f.execute("onClose",d),d.id=void 0)},handleWindowChangeState:function(e){"collapsed"===e?E=!0:"expanded"===e?E=!1:O=e,f.execute(e,d)},handleTitleChanged:function(e){y=e,f.execute("onTitleChanged",e,d)},handleVisibilityChanged:function(e){e!==P&&(P=e,f.execute("visibility-changed",d))},handleUrlChanged:function(e){v=e,f.execute("onUrlChanged",e,d)},handleWindowSettingsChanged:function(e){T=e,f.execute("settings-changed",d)},handleContextUpdated:function(e){m=e,f.execute("context-updated",m,d)},handleFrameIsLockedChanged:function(e){j=e,f.execute("lock-changed",d)},handleBoundsChanged:function(e){b.top===e.top&&b.left===e.left&&b.width===e.width&&b.height===e.height||(b.top=e.top,b.left=e.left,b.width=e.width,b.height=e.height,f.execute("bounds-changed",d))},handleFocusChanged:function(e){_=e,f.execute("focus-changed",d)},handleFrameButtonAdded:function(e){var t=["buttonId","imageBase64","order","tooltip"].reduce((function(t,n){return t[n]=e[n],t}),{});-1===R.map((function(e){return e.buttonId})).indexOf(e.buttonId)&&R.push(t),f.execute("onFrameButtonAdded",t,d)},handleFrameButtonRemoved:function(e){var t;R=R.reduce((function(n,r){return r.buttonId===e?t=r:n.push(r),n}),[]),void 0!==t&&f.execute("onFrameButtonRemoved",t,d)},handleFrameButtonClicked:function(e){var t=R.filter((function(t){return t.buttonId===e.buttonId}));t.length>0&&f.execute("onFrameButtonClicked",t[0],d)},handleFrameColorChanged:function(e){w=e,f.execute("frame-color-changed",d)},handleFrameAttached:function(e,t){M=e,I=t,f.execute("frame-attached",d)},handleFrameSelectionChanged:function(t,n){var r;"undefined"!==typeof t&&t===e?(C=!0,r=d):(C=!1,r=Wt.get(t)?Wt.get(t).API:void 0);var i=Wt.get(n)?Wt.get(n).API:void 0;if(C&&i)var o=i.onTabSelectionChanged((function(e,t){(t&&t.id)===i.id&&(o(),f.execute("tab-selection-changed",r,i,d))}));else f.execute("tab-selection-changed",r,i,d)},handleCompositionChanged:function(e,t){k=e||{},f.execute("neighbours-changed",e,d),x=t,d.groupId!==t&&f.execute("group-changed",d)},handleGroupHeaderVisibilityChanged:function(e){S=e},handleTabHeaderVisibilityChanged:function(e){I!==e&&(I=e,f.execute("tab-header-visibility-changed",d))},handleGroupChanged:function(t,n){p.trace("handle group changed to win: "+e+" with group id: "+t.id),l=t,x=t.id,f.execute("group-changed",d,t,n)},handleGroupAssociation:function(t){t&&p.trace("setting group to win: "+e+" with group id: "+t.id),l=t},handleAttached:function(e,t){M=e,I=t,f.execute("attached",d)},handleDetached:function(t){M=t;var n=f.add("frame-attached",(function(t){t.id===e&&(n(),f.execute("detached",d))}))},handleWindowAttached:function(e){f.execute("window-attached",e)},handleWindowDetached:function(e){f.execute("window-detached",e)},handleZoomFactorChanged:function(e){N=e,f.execute("zoom-factor-changed",d)},handleIsStickyChanged:function(e){A=e,f.execute("sticky-changed",e,d)},handlePlacementSettingsChanged:function(e){var t,n=e;if(n.display){var r=o();if(r){var i=n.display-1;t=new Promise((function(e,t){r.all().then((function(t){var n=t.find((function(e){return e.index===i}));e(n)})).catch(t)}))}else t=Promise.resolve(void 0)}else t=Promise.resolve(void 0);t.then((function(e){n.display=e,L=n,f.execute("placementSettingsChanged",d)}))}};return{API:d={get name(){return h},get application(){var e=i();return e?e.application(se()):void 0},get hostInstance(){return n.hostInstance},get agmInstance(){var e=this;if("undefined"!==typeof window&&window.glue42gd)return u.servers().find((function(t){return t.windowId===e.id}));var t=se();return t?{application:t}:void 0},get url(){return v},id:e,get title(){return y},get windowStyleAttributes(){return T},get settings(){return T},get tabGroupId(){return"tab"===g.toLowerCase()?M:void 0},get frameButtons(){return R},get mode(){return g},get state(){return O},get isCollapsed(){return E},get isVisible(){return P},get isLocked(){return j},get context(){return m},get bounds(){return b},get minHeight(){return T.minHeight},get maxHeight(){return T.maxHeight},get minWidth(){return T.minWidth},get maxWidth(){return T.maxWidth},get isFocused(){return _},get frameColor(){return w},get opened(){return void 0!==d.id},get group(){return l},get groupId(){return x},get isSticky(){return A},get topNeighbours(){return ae("top")},get leftNeighbours(){return ae("left")},get rightNeighbours(){return ae("right")},get bottomNeighbours(){return ae("bottom")},get isGroupHeaderVisible(){return S},get activityId(){if(m._t42)return m._t42.activityId;var e=ue();return e?e.activityId:void 0},get activityWindowId(){if(m._t42)return m._t42.activityWindowId;var e=ue();return e?e.activityWindowId:void 0},get windowType(){return t.windowType||"electron"},get zoomFactor(){return N},get screen(){if("undefined"!==typeof window&&window.glue42gd)return Ft.getMonitor(d.bounds,window.glue42gd.monitors)},get placementSettings(){return Object.assign({},L)},maximize:function(e,t){return new Promise((function(r,i){if("maximized"===O)return"function"===typeof e&&e(d),r(d);var o=K((function(t){"function"===typeof e&&e(d),o(),r(d)}));n.maximize(d).catch((function(e){"function"===typeof t&&t(e),i(e)}))}))},restore:function(e,t){return new Promise((function(r,i){if("normal"===O)return"function"===typeof e&&e(d),r(d);var o=$((function(t){o(),"function"===typeof e&&e(d),r(d)}));n.restore(d).catch((function(e){"function"===typeof t&&t(e),i(e)}))}))},minimize:function(e,t){return new Promise((function(r,i){if("minimized"===O)return"function"===typeof e&&e(d),r(d);var o=Y((function(t){return o(),"function"===typeof e&&e(d),r(d)}));n.minimize(d).catch((function(e){"function"===typeof t&&t(e),i(e)}))}))},maximizeRestore:function(e,t){return new Promise((function(r,i){var o=("normal"===O?K:$)((function(){o(),"function"===typeof e&&e(d),r(d)}));n.maximizeRestore(d).catch((function(e){"function"===typeof t&&t(e),i(e)}))}))},collapse:function(e,t){return new Promise((function(r,i){if(E)return"function"===typeof e&&e(d),r(d);var o=G((function(t){o(),"function"===typeof e&&e(d),r(d)}));n.collapse(d).catch((function(e){"function"===typeof t&&t(e),i(e)}))}))},expand:function(e,t){return new Promise((function(r,i){if(!E)return"function"===typeof e&&e(d),r(d);var o=J((function(){o(),"function"===typeof e&&e(d),r(d)}));n.expand(d).catch((function(e){"function"===typeof t&&t(e),i(e)}))}))},toggleCollapse:function(e,t){return new Promise((function(r,i){var o=(E?J:G)((function(){o(),"function"===typeof e&&e(d),r(d)}));n.toggleCollapse(d).catch((function(e){"function"===typeof t&&t(e),i(e)}))}))},focus:function(t,r){return new Promise((function(i,o){if(_)return"function"===typeof t&&t(d),void i(d);var a=ne((function(n){if(e===n.id&&n.isFocused)return a(),"function"===typeof t&&t(d),i(d)}));n.focus(d).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))},activate:function(t,r){return new Promise((function(i,o){if(_)return"function"===typeof t&&t(d),void i(d);var a=ne((function(n){if(e===n.id&&n.isFocused)return a(),"function"===typeof t&&t(d),void i(d)}));n.activate(d).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))},moveResize:D,setTitle:function(e,t,r){return new Promise((function(i,o){if(e===y)return"function"===typeof t&&t(d),void i(d);var a=B((function(n){n===e&&(a(),"function"===typeof t&&t(d),i(d))}));n.setTitle(d,e).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))},setStyle:function(e,t,r){if(!e||0===Object.keys(e).length||Object.keys(e).every((function(e){return!e}))){var i="Invalid style arguments: "+JSON.stringify(e);return"function"===typeof r?void r(i):Promise.reject(new Error(i))}if(e&&void 0!==e.focus){if("boolean"!==typeof e.focus){i="Focus must be boolean. Currently only focus true is supported ! "+JSON.stringify(e);return"function"===typeof r?void r(i):Promise.reject(new Error(i))}!1===e.focus&&p.warn("Focus false is not supported!")}if(e&&void 0!==e.hidden&&"boolean"!==typeof e.hidden){i="hidden should be boolean";return"function"===typeof r?void r(i):Promise.reject(new Error(i))}for(var o=0,a=["minHeight","maxHeight","minWidth","maxWidth"];o<a.length;o++){var s=a[o];if(s in e&&"number"!==typeof e[s]){i=s+" should be number";return"function"===typeof r?void r(i):Promise.reject(new Error(i))}}return Ft.callbackifyPromise((function(){return n.setStyle(d,e)}),t,r)},setOnTop:function(e,t,r){if(this.onTop===e){var i="OnTop setting is already set to '"+e+"'";return r(i),Promise.reject(new Error(i))}return Ft.callbackifyPromise((function(){return n.setOnTop(d,e)}),t,r)},resetButtons:function(e,t,r){return Ft.callbackifyPromise((function(){return n.resetButtons(d,e)}),t,r)},setSizeConstraints:function(e,t,r){if(!e||Object.keys(e).every((function(e){return void 0===e}))){var i="Invalid Constraints: "+JSON.stringify(e);return r(i),Promise.reject(new Error(i))}return Ft.callbackifyPromise((function(){return n.setSizeConstraints(d,e)}),t,r)},navigate:function(e,t,r){return new Promise((function(i,o){var a=H((function(e,n){e===n.url&&(a(),"function"===typeof t&&t(d),i(d))}));n.navigate(d,e).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))},addFrameButton:function(e,t,r){return new Promise((function(i,o){if("undefined"===typeof e)return"function"===typeof r?void r("No button info"):void o("No button info");if(void 0===e.buttonId)return"function"===typeof r?void r("No buttonId"):void o("No buttonId");if(void 0===e.imageBase64)return"function"===typeof r?void r("No imageBase64"):void o("No imageBase64");var a=z((function(){a(),"function"===typeof t&&t(d),i(d)}));n.addFrameButton(d,e).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))},removeFrameButton:function(e,t,r){return new Promise((function(i,o){if(void 0===e||""===e)return"function"===typeof r?void r("No buttonId"):void o("No buttonId");var a=q((function(){a(),"function"===typeof t&&t(d),i(d)}));n.removeFrameButton(d,e).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))},setVisible:W,show:function(){return W(!0)},hide:function(){return W(!1)},center:function(e){return D(Ft.getDisplayCenterOfScreen(d.bounds,e||d.screen))},close:function(t,r){return new Promise((function(i,o){if(!e){var a=new Error("The window is already closed.");return"function"===typeof r&&r(a.message),void o(a)}var s=V((function(){s(),"function"===typeof t&&t(d),i(d)}));n.close(d).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))},snap:function(e,t,r,i){return a(this,void 0,void 0,(function(){var o,a,u;return s(this,(function(s){if(!e){if(u=new Error("Please specify a target window - "+e),"function"===typeof i)return i(u.message),[2];throw u}if("string"===typeof e){if(!(a=Wt.get(e))){if(u=new Error("Invalid target parameter or no such window. Invoked with:  "+e),"function"===typeof i)return i(u.message),[2];throw u}o=a.API.group}else o=e.group;return[2,Promise.all([(c=o,new Promise((function(e,t){var n=c.onWindowAdded((function(t,r){d.id===r.id&&(n(),e())}))}))),n.snap(d,e,t)]).then((function(){return"function"===typeof r&&r(d),d})).catch((function(e){return"function"===typeof i&&i(e),e}))];var c}))}))},showLoader:function(e){return new Promise((function(t,r){n.showLoader(d,e).then((function(){t(d)})).catch((function(e){r(e)}))}))},hideLoader:function(){return new Promise((function(e,t){n.hideLoader(d).then((function(){e(d)})).catch((function(e){t(e)}))}))},updateContext:F,lock:function(e,t){return d.isLocked?("function"===typeof e&&e(d),Promise.resolve(d)):new Promise((function(r,i){n.lock(d).then((function(){return U()})).then((function(){"function"===typeof e&&e(d),r(d)})).catch((function(e){"function"===typeof t&&t(e),i(e)}))}))},unlock:function(e,t){return d.isLocked?new Promise((function(r,i){n.unlock(d).then((function(){return U()})).then((function(){"function"===typeof e&&e(d),r(d)})).catch((function(e){"function"===typeof t&&t(e),i(e)}))})):("function"===typeof e&&e(d),Promise.resolve(d))},getIcon:function(e,t){return new Promise((function(r,i){n.getIcon(d).then((function(t){"function"===typeof e&&e(t),r(t)})).catch((function(e){"function"===typeof t&&t(e),i(e)}))}))},setIcon:function(e,t,r){return new Promise((function(i,o){n.setIcon(d,e).then((function(){"function"===typeof t&&t(d),i(d)})).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))},setFrameColor:function(e,t,r){return new Promise((function(i,o){var a=re((function(){a(),"function"===typeof t&&t(d),i(d)}));n.setFrameColor(d,e).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))},setTabTooltip:function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){if(!e)throw new Error(e+" is null or undefined");return[2,n.setTabTooltip(d,e)]}))}))},attachTab:function(e,t,r,i){return new Promise((function(o,a){var s,u=d.id,c="Invalid tab parameter - should be an object with property id or a string. Invoked for source window id:"+d.id;if(e){if("string"===typeof e)s=e;else{if("undefined"===typeof e.id)return void a(c);s=e.id}var l={sourceWindowId:s,targetWindowId:u};t&&(l.index=t);var f=Wt.get(l.sourceWindowId).API.onAttached((function(e){f(),"function"===typeof r&&r(d),o(d)}));n.attachTab(d,l).catch((function(e){"function"===typeof i&&i(e),f(),a(e)}))}else a(c)}))},detachTab:function(t,r,i){return new Promise((function(o,a){var s={windowId:d.id},u=t||{};"undefined"!==typeof u.relativeTo&&("string"===typeof u.relativeTo?s.relativeTo=u.relativeTo:"undefined"!==typeof u.relativeTo.id&&(s.relativeTo=u.relativeTo.id),"undefined"!==typeof u.relativeDirection&&(s.relativeDirection=u.relativeDirection),"undefined"!==typeof u.width&&(s.width=u.width),"undefined"!==typeof u.height&&(s.height=u.height)),"undefined"!==typeof u.bounds&&(s.bounds=u.bounds),"undefined"!==typeof u.hideTabHeader&&(s.hideTabHeader=u.hideTabHeader);var c=!1,l=!1,p=f.add("frame-attached",(function(t){var n=void 0===u.hideTabHeader||u.hideTabHeader!==t.isTabHeaderVisible;e===t.id&&n&&(c=!0,p(),l&&("function"===typeof r&&r(d),o(d),"function"===typeof h&&h()))})),h=Q((function(t){e===t.id&&(l=!0,h(),c&&("function"===typeof r&&r(d),o(d),"function"===typeof p&&p()))}));n.detachTab(d,s).catch((function(e){"function"===typeof i&&i(e),h(),p(),a(e)}))}))},setTabHeaderVisible:function(t,r,i){return new Promise((function(o,a){if(I===t)return"function"===typeof r&&r(d),o(d);var s=ie((function(n){n.id===e&&n.isTabHeaderVisible===t&&("function"===typeof r&&r(d),s(),o(d))}));n.setTabHeaderVisible(d,t).catch((function(e){"function"===typeof i&&i(e),a(e)}))}))},showPopup:function(e){return n.showPopup(d,e)},createFlydown:function(e){return n.createFlydown(d.id,e)},setModalState:function(e){return n.setModalState(d.id,e||!1)},setZoomFactor:function(e,t,r){return Ft.callbackifyPromise((function(){if(isNaN(e))throw new Error("zoomFactor is not a number");return n.setZoomFactor(d,e)}),t,r)},zoomIn:function(e,t){return Ft.callbackifyPromise((function(){return n.zoomIn(d)}),e,t)},zoomOut:function(e,t){return Ft.callbackifyPromise((function(){return n.zoomOut(d)}),e,t)},showDevTools:function(){return n.showDevTools(d)},capture:function(e){return n.capture(d,e)},flash:function(e,t){var r={shouldFlash:!0,mode:"auto"};return"boolean"===typeof e&&(r.shouldFlash=e),"undefined"!==typeof t&&(r.mode=t),n.flash(d,r)},setSticky:function(e,t,r){return new Promise((function(i,o){n.setSticky(d,e).then((function(){"function"===typeof t&&t(d),i(d)})).catch((function(e){"function"===typeof r&&r(e),o(e)}))}))},print:function(e){return n.print(d,e)},printToPDF:function(e){return n.printToPDF(d,e)},place:function(e){return n.place(d,e)},ungroup:function(t){return new Promise((function(r,i){var o=oe((function(t,n,i){e===t.id&&(o(),r(d))}));n.ungroup(d,t).catch((function(e){o(),i(e)}))}))},onClose:V,onUrlChanged:H,onTitleChanged:B,onFrameButtonAdded:z,onFrameButtonRemoved:q,onFrameButtonClicked:function(e){return f.add("onFrameButtonClicked",e)},onCollapsed:G,onExpanded:J,onMinimized:Y,onMaximized:K,onNormal:$,onAttached:function(e){return f.add("attached",e)},onDetached:Q,onVisibilityChanged:X,onContextUpdated:Z,onLockingChanged:ee,onBoundsChanged:te,onFrameColorChanged:re,onFocusChanged:ne,onStickyChanged:function(e){return f.add("sticky-changed",e)},onGroupChanged:oe,onWindowAttached:function(e){return f.add("window-attached",e)},onWindowDetached:function(e){return f.add("window-detached",e)},onTabSelectionChanged:function(e){return f.add("tab-selection-changed",e)},onTabHeaderVisibilityChanged:ie,onClosing:function(t){if(!et(t))throw new Error("callback should be a function");return n.onClosing((function(e,n){var r=t();r&&r.then?r.then(e).catch(n):e()}),e)},onRefreshing:function(t){if(!et(t))throw new Error("callback should be a function");return n.onRefreshing((function(e,n,r){var i=t(r);i&&i.then?i.then(e).catch(n):e()}),e)},onZoomFactorChanged:function(e){if(!et(e))throw new Error("callback should be a function");return f.add("zoom-factor-changed",e)},onPlacementSettingsChanged:function(e){if(!et(e))throw new Error("callback should be a function");return f.add("placementSettingsChanged",e)},onNeighboursChanged:function(e){if(!et(e))throw new Error("callback should be a function");return f.add("neighbours-changed",e)},get tabs(){return function(){var e=Wt.list;return"tab"!==g.toLowerCase()?[]:Object.keys(e).reduce((function(t,n){var r=e[n];return r&&r.API.tabGroupId&&"undefined"!==typeof r.API.tabGroupId&&"undefined"!==typeof d.tabGroupId&&r.API.tabGroupId===d.tabGroupId&&t.push(r.API),t}),[])}()},get isTabHeaderVisible(){return I},get isTabSelected(){return C},getURL:function(){return Promise.resolve(v)},getTitle:function(){return Promise.resolve(y)},getBounds:function(){return Promise.resolve(b)},getContext:function(){return Promise.resolve(m)},setContext:function(e){return F(e)},resizeTo:function(e,t){return D({width:e,height:t})},moveTo:function(e,t){return D({top:e,left:t})},getParentWindow:function(){var e;return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){return(t=T.parentInstanceId)?[2,null===(e=Wt.list[t])||void 0===e?void 0:e.API]:[2,void 0]}))}))},getChildWindows:function(){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,Object.keys(Wt.list).map((function(e){return Wt.list[e].API})).filter((function(t){return t.settings.parentInstanceId===e}))]}))}))}},Events:le,Registry:f}},Bt=new(function(){function e(){this._registry=Pt()}return Object.defineProperty(e.prototype,"hostInstance",{get:function(){return this.agmTarget},enumerable:!0,configurable:!0}),e.prototype.init=function(e,t){this.agm=e,this.agmTarget=t},e.prototype.close=function(e){var t=this;return new Promise((function(n,r){t.execute("close",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.navigate=function(e,t){var n=this;return new Promise((function(r,i){n.execute("navigate",{windowId:e.id,options:{url:t}}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.setStyle=function(e,t){var n;return a(this,void 0,void 0,(function(){var r,i,o,a,u,c,l,d,f,p,h,g,v;return s(this,(function(s){switch(s.label){case 0:return r=[],i=function(e){return r.push(e)},void 0===t.focus||e.isFocused||i(e.focus()),void 0!==t.hidden&&(o=!t.hidden,i(e.setVisible(o))),void 0!==t.onTop&&i(e.setOnTop(t.onTop)),void 0===t.tabTooltip&&void 0===t.tabToolTip||(n=t.tabTooltip,a=null!==n&&void 0!==n?n:t.tabToolTip,i(e.setTabTooltip(a))),u=t.maxWidth,c=t.maxHeight,l=t.minWidth,d=t.minHeight,f=t.allowClose,p=t.allowCollapse,h=t.allowLockUnlock,g=t.allowMaximize,v=t.allowMinimize,i(e.setSizeConstraints({maxWidth:u,maxHeight:c,minWidth:l,minHeight:d})),i(e.resetButtons({allowClose:f,allowCollapse:p,allowLockUnlock:h,allowMaximize:g,allowMinimize:v})),[4,Promise.all(r)];case 1:return s.sent(),[2,e]}}))}))},e.prototype.setSizeConstraints=function(e,t){var n=this;return new Promise((function(r,i){n.execute("setSizeConstraints",{windowId:e.id,options:t}).then((function(){r(e)})).catch(i)}))},e.prototype.setTabTooltip=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.execute("setTabTooltip",{windowId:e.id,options:{tabToolTip:t}})];case 1:return n.sent(),[2,e]}}))}))},e.prototype.resetButtons=function(e,t){var n=this;return new Promise((function(r,i){n.execute("resetButtons",{windowId:e.id,options:t}).then((function(){r(e)})).catch(i)}))},e.prototype.setOnTop=function(e,t){var n=this;return new Promise((function(r,i){n.execute("setOnTop",{windowId:e.id,options:{onTop:t}}).then((function(){r(e)})).catch(i)}))},e.prototype.setTitle=function(e,t){var n=this;return new Promise((function(r,i){var o={windowId:e.id,options:{title:t}};n.execute("setTitle",o).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.setSticky=function(e,t){var n=this;return new Promise((function(r,i){var o={windowId:e.id,options:{isSticky:t}};n.execute("setSticky",o).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.moveResize=function(e,t){var n=this;return new Promise((function(r,i){n.execute("moveResize",{windowId:e.id,options:{bounds:t}}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.addFrameButton=function(e,t){var n=this;return new Promise((function(r,i){n.execute("addButton",{windowId:e.id,options:t}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.removeFrameButton=function(e,t){var n=this;return new Promise((function(r,i){n.execute("removeButton",{windowId:e.id,options:t}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.activate=function(e){var t=this;return new Promise((function(n,r){t.execute("activate",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.focus=function(e){var t=this;return new Promise((function(n,r){t.execute("focus",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.maximizeRestore=function(e){var t=this;return new Promise((function(n,r){t.execute("maximizeRestore",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.maximize=function(e){var t=this;return new Promise((function(n,r){t.execute("maximize",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.restore=function(e){var t=this;return new Promise((function(n,r){t.execute("restore",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.minimize=function(e){var t=this;return new Promise((function(n,r){t.execute("minimize",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.collapse=function(e){var t=this;return new Promise((function(n,r){t.execute("collapse",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.expand=function(e){var t=this;return new Promise((function(n,r){t.execute("expand",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.toggleCollapse=function(e){var t=this;return new Promise((function(n,r){t.execute("toggleCollapse",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.snap=function(e,t,n){var r=this;return new Promise((function(i,o){e.id;var a,s="Invalid target parameter - should be an object with property id or a string. Invoked for source window id:"+e.id;if(t){if("string"===typeof t)a=t;else{if("undefined"===typeof t.id)return void o(s);a=t.id}var u={targetWindowId:a};n&&(u.snappingEdge=n),r.execute("snap",{windowId:e.id,options:u}).then((function(){i(e)})).catch((function(e){o(e)}))}else o(s)}))},e.prototype.attachTab=function(e,t){var n=this;return new Promise((function(r,i){n.execute("attachTab",{windowId:e.id,options:t}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.detachTab=function(e,t){var n=this;return new Promise((function(r,i){n.execute("detachTab",{windowId:e.id,options:t}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.setVisible=function(e,t){var n=this;return void 0===t&&(t=!0),new Promise((function(r,i){var o;o=t?"show":"hide",n.execute(o,{windowId:e.id}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.showLoader=function(e,t){var n=this;return new Promise((function(r,i){n.execute("showLoadingAnimation",{windowId:e.id,options:t}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.hideLoader=function(e){var t=this;return new Promise((function(n,r){t.execute("hideLoadingAnimation",{windowId:e.id}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.updateContext=function(e,t){var n=this;return new Promise((function(r,i){n.execute("updateContext",{windowId:e.id,context:t,replace:!(Object.keys(e.context).length>0)}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.lock=function(e){var t=this;return new Promise((function(n,r){t.execute("lockUnlock",{windowId:e.id,options:{lock:!0}}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.unlock=function(e){var t=this;return new Promise((function(n,r){t.execute("lockUnlock",{windowId:e.id,options:{lock:!1}}).then((function(){n(e)})).catch((function(e){r(e)}))}))},e.prototype.getIcon=function(e){var t=this;return new Promise((function(n,r){t.execute("getIcon",{windowId:e.id,options:{}}).then((function(e){n(e.icon)})).catch((function(e){r(e)}))}))},e.prototype.setIcon=function(e,t){var n=this;return new Promise((function(r,i){n.execute("setIcon",{windowId:e.id,options:{dataURL:t}}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.setFrameColor=function(e,t){var n=this;return new Promise((function(r,i){n.execute("setFrameColor",{windowId:e.id,options:{frameColor:t}}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.setTabHeaderVisible=function(e,t){var n=this;return new Promise((function(r,i){n.execute("setTabHeaderVisible",{windowId:e.id,options:{toShow:t}}).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.showPopup=function(e,t){return a(this,void 0,void 0,(function(){var n,r;return s(this,(function(i){switch(i.label){case 0:return t?((n=o({},t)).targetLocation||(n.targetLocation="bottom"),r=o(o({},n),{popupBounds:n.size,targetId:e.id,popupId:n.windowId}),[4,this.execute("showPopupWindow",{windowId:e.id,options:r})]):[2,Promise.reject("The options object is not valid!")];case 1:return i.sent(),[2,e]}}))}))},e.prototype.createFlydown=function(e,t){return a(this,void 0,void 0,(function(){var n,r,i=this;return s(this,(function(u){return t?((n=o({},t)).horizontalOffset||(n.horizontalOffset=0),n.verticalOffset||(n.verticalOffset=0),r=this.reformatFlydownOptions(e,n),[2,this.execute("setFlydownArea",{windowId:e,options:r}).then((function(){var e=r.zones.map((function(e){return e.id}));return r.zones.forEach((function(e){var n="function"===typeof e.flydownSize?e.flydownSize:function(){return e.flydownSize};t.size instanceof Function&&e.flydownSize&&(n=function(n,r){return a(i,void 0,void 0,(function(){var i;return s(this,(function(o){switch(o.label){case 0:return t.size instanceof Function?[4,t.size(n,r)]:[3,2];case 1:i=o.sent(),o.label=2;case 2:return e.flydownSize instanceof Function&&e.flydownSize!==t.size?[4,e.flydownSize(n,r)]:[3,4];case 3:return[2,o.sent()||i];case 4:return[2,i||e.flydownSize]}}))}))}),i._registry.clearKey(r.targetId+"_"+e.id),i._registry.add(r.targetId+"_"+e.id,n)})),{destroy:function(){return i.clearFlydownArea(r.targetId,e)},options:n}}))]):[2,Promise.reject("The options object is not valid!")]}))}))},e.prototype.setModalState=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.execute("setModalState",{windowId:e,options:{isModal:t}})]}))}))},e.prototype.handleFlydownBoundsRequested=function(e,t){return a(this,void 0,void 0,(function(){var n,r,i,a,u;return s(this,(function(s){switch(s.label){case 0:return n=function(){return t.cancel=!0},r={zoneId:t.flydownId,flydownWindowBounds:t.flydownWindowBounds,flydownWindowId:t.flydownWindowId},[4,Promise.all(this._registry.execute(e+"_"+t.flydownId,r,n))];case 1:return 1===(i=s.sent()).length?(a={height:0,width:0,top:0,left:0},u="object"!==typeof i[0]||Array.isArray(i[0])?a:i[0],[2,o(o({},t),{flydownWindowBounds:u})]):[2]}}))}))},e.prototype.zoomIn=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.execute("zoomIn",{windowId:e.id})];case 1:return t.sent(),[2,e]}}))}))},e.prototype.zoomOut=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.execute("zoomOut",{windowId:e.id})];case 1:return t.sent(),[2,e]}}))}))},e.prototype.setZoomFactor=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.execute("setZoomFactor",{windowId:e.id,options:{zoomFactor:t}})];case 1:return n.sent(),[2,e]}}))}))},e.prototype.showDevTools=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.execute("showDevTools",{windowId:e.id})];case 1:return t.sent(),[2,e]}}))}))},e.prototype.capture=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.execute("captureScreenshot",{windowId:e.id,options:o({},t)})];case 1:return[2,n.sent().data]}}))}))},e.prototype.captureGroup=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.execute("captureGroupScreenshot",{windowId:e[0],options:o({groupWindowIds:e},t)})];case 1:return[2,n.sent().data]}}))}))},e.prototype.flash=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.execute("flash",{windowId:e.id,options:o({},t)})];case 1:return n.sent(),[2,e]}}))}))},e.prototype.configure=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return[2,this.execute("configure",{windowId:e,options:o({},t)})]}))}))},e.prototype.print=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.execute("print",{windowId:e.id,options:o({},t)})];case 1:return n.sent(),[2,e]}}))}))},e.prototype.printToPDF=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.execute("printToPDF",{windowId:e.id,options:o({},t)})];case 1:return[2,n.sent().filePath]}}))}))},e.prototype.place=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){return(n=o({},t)).display&&(n.display=n.display.index+1),[2,this.execute("place",{windowId:e.id,options:o({},n)})]}))}))},e.prototype.execute=function(e,t){var n=this;return new Promise((function(r,i){var a=o(o({},t),{command:e});n.agm.invoke("T42.Wnd.Execute",a,n.agmTarget).then((function(e){e.returned&&e.returned.errorMsg?i(e):r(e.returned)})).catch((function(e){i(e)}))}))},e.prototype.setGroupHeaderVisible=function(e,t){return this.execute("setGroupHeaderVisibility",{windowId:e,options:{toShow:t}})},e.prototype.getGroupTitle=function(e){return this.execute("getGroupTitle",{windowId:e,options:{}}).then((function(e){return e.title}))},e.prototype.setGroupTitle=function(e,t){return this.execute("setGroupTitle",{windowId:e,options:{title:t}})},e.prototype.onClosing=function(e,t){var n="undefined"!==typeof window&&window.glue42gd;if(n)return n.addCloseHandler(e,t)},e.prototype.onRefreshing=function(e,t){var n="undefined"!==typeof window&&window.glue42gd;if(n)return n.addRefreshHandler(e,t)},e.prototype.ungroup=function(e,t){var n=this;return new Promise((function(r,i){var o={windowId:e.id,options:t};n.execute("ungroup",o).then((function(){r(e)})).catch((function(e){i(e)}))}))},e.prototype.reformatFlydownOptions=function(e,t){var n=function(e,n){if(t[n]&&(void 0===e[n]||null===e[n])){var r=t[n];e[n]=r}},r=t.zones.map((function(e){return n(e,"windowId"),n(e,"targetLocation"),!t.size||void 0!==e.flydownSize&&null!==e.flydownSize||(e.flydownSize=t.size),e.flydownBounds=e.flydownSize,e.flydownId=e.windowId,e.targetLocation||(e.targetLocation="bottom"),e}));return o(o({},t),{zones:r,targetId:e,flydownBounds:t.size,flydownActiveArea:t.activeArea})},e.prototype.clearFlydownArea=function(e,t){var n=this;return this.execute("clearFlydownWindowArea",{windowId:e,options:{}}).then((function(){t.forEach((function(t){n._registry.clearKey(e+"_"+t)}))}))},e}());function Vt(e,t){var n=Wt.list;return Object.keys(n).reduce((function(r,i){var o=n[i];return o.API.tabGroupId===t&&o.API.id!==e&&(r[i]=o),r}),{})}var Ht=function(){function e(e,t,n,r,i,o){this._registry=Pt(),this._waitTimeout=1e4,this._agm=e,this._logger=t.subLogger("gd-env"),this._agmInstance=this.normalizeInstance(i),this._windowId=o,this._appManagerGetter=n,this._displayAPIGetter=r}return e.prototype.init=function(){var e=this;return new Promise((function(t,n){"undefined"===typeof e._agmInstance&&(e._agmInstance="best"),e._agm.registerAsync("T42.Wnd.OnEventWithResponse",(function(t,n,r,i){e.respondToEvent(t).then(r).catch(i)}));new Promise((function(r,i){e._agm.subscribe("T42.Wnd.OnEvent",{waitTimeoutMs:e._waitTimeout,target:e._agmInstance,onData:function(n){e.updateWindow(n.data,t)},onConnected:function(t){e._agmInstance=e.normalizeInstance(t),Bt.init(e._agm,e._agmInstance)}}).catch((function(e){n("Can not subscribe for stream T42.Wnd.OnEvent. Err: "+e)}))}))}))},Object.defineProperty(e.prototype,"executor",{get:function(){return Bt},enumerable:!0,configurable:!0}),e.prototype.open=function(e,t,n,r,i){var a=o({},n=n||{});void 0!==e?(void 0!==a.relativeTo&&"string"!==typeof a.relativeTo&&(a.relativeTo=a.relativeTo.id||""),a.name=e,a.url=t,a.windowState=n.windowState||n.state,delete a.state,this._agm.invoke("T42.Wnd.Create",a,this._agmInstance).then((function(e){if(void 0!==e.returned){var t=e.returned.id;r(t)}else i({message:"failed to execute T42.Wnd.Create - unknown reason"})})).catch(i)):i({message:"The name is undefined"})},e.prototype.createFlydown=function(e,t){return this.executor.createFlydown(e,t)},e.prototype.showPopup=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:return n=Wt.get(e),[4,this.executor.showPopup(n.API,t)];case 1:return r.sent(),[2]}}))}))},e.prototype.tabAttached=function(e){return this._registry.add("tab-attached",e)},e.prototype.tabDetached=function(e){return this._registry.add("tab-detached",e)},e.prototype.onWindowFrameColorChanged=function(e){return this._registry.add("frame-color-changed",e)},e.prototype.onEvent=function(e){return this._registry.add("window-event",e)},e.prototype.my=function(){return this._windowId},e.prototype.execute=function(e,t,n){return this._agm.invoke("T42.Wnd.Execute",{command:e,options:n,windowId:t})},e.prototype.setGroupHeaderVisible=function(e,t){return this._agm.invoke("T42.Wnd.SetGroupHeaderVisible",{windowId:e,toShow:t},this._agmInstance)},e.prototype.onCompositionChanged=function(e){return this._registry.add("composition-changed",e)},e.prototype.onGroupHeaderVisibilityChanged=function(e){return this._registry.add("group-header-changed",e)},e.prototype.onWindowGotFocus=function(e){return this._registry.add("got-focus",e)},e.prototype.onWindowLostFocus=function(e){return this._registry.add("lost-focus",e)},e.prototype.normalizeInstance=function(e){if(e)return{application:e.application,machine:e.machine,user:e.user}},e.prototype.respondToEvent=function(e){return"ShowFlydownBoundsRequested"===e.type?this.executor.handleFlydownBoundsRequested(e.data.windowId,e.data):Promise.reject("There isn't a handler for "+e.type)},e.prototype.updateWindow=function(e,t){var n=this,r=this.getExtendedStreamEvent(e);if("Snapshot"===e.type)return e.windows.forEach((function(e){var t=n.createWindow(e.id,e);Wt.markReadyToShow(t.API.id),n._registry.execute("window-event",r)})),void t(this);if("Created"===e.type){var i=e,o=this.createWindow(i.windowId,i.data||{});return Wt.setReadyState(o.API.id),void this._registry.execute("window-event",r)}var a=Wt.get(e.windowId);if(a){var s=a.API,u=a.Events;if("BoundsChanged"===e.type){var c=e;u.handleBoundsChanged(c.data)}if("UrlChanged"===e.type){var l=e;Wt.setUrlChangedState(l.windowId),u.handleUrlChanged(l.data)}if("TitleChanged"===e.type){var d=e;u.handleTitleChanged(d.data)}if("IsStickyChanged"===e.type){var f=e;u.handleIsStickyChanged(f.data)}if("VisibilityChanged"===e.type&&u.handleVisibilityChanged(e.data),"ContextChanged"===e.type&&u.handleContextUpdated(e.data),"StateChanged"===e.type&&u.handleWindowChangeState(e.data),"FrameColorChanged"===e.type&&(u.handleFrameColorChanged(e.data),this._registry.execute("frame-color-changed",s)),"CompositionChanged"===e.type){var p=e;u.handleCompositionChanged(p.data.neighbors,p.data.groupId),this._registry.execute("composition-changed",p.data)}if("GroupHeaderVisibilityChanged"===e.type){var h=e;u.handleGroupHeaderVisibilityChanged(h.data.groupHeaderVisible),this._registry.execute("group-header-changed",h.data)}if("FocusChanged"===e.type){var g=e;this.focusChanged(u,s,g.data)}if("WindowFrameChanged"===e.type&&(u.handleFrameAttached(e.data.frameId,e.data.isTabHeaderVisible),this._registry.execute("frame-changed")),"WindowFrameAdded"===e.type){u.handleAttached(e.data.frameId,e.data.isTabHeaderVisible);var v=Vt(s.id,e.data.frameId);Object.keys(v).forEach((function(e){v[e].Events.handleWindowAttached(s)})),this._registry.execute("tab-attached",s,e.data.frameId,e.data.isTabHeaderVisible)}if("WindowFrameRemoved"===e.type){var y=s.tabGroupId;u.handleDetached(e.data.frameId);var m=Vt(s.id,y);Object.keys(m).forEach((function(e){m[e].Events.handleWindowDetached(s)}));var b=this._registry.add("frame-changed",(function(){b(),n._registry.execute("tab-detached",s,e.data.frameId,s.tabGroupId)}))}"TabHeaderVisibilityChanged"===e.type&&u.handleTabHeaderVisibilityChanged(e.data.isTabHeaderVisible),"FrameSelectionChanged"===e.type&&u.handleFrameSelectionChanged(e.data.newWindowId,e.data.prevWindowId),"ButtonClicked"===e.type&&u.handleFrameButtonClicked(e.data),"ButtonAdded"===e.type&&u.handleFrameButtonAdded(e.data),"ButtonRemoved"===e.type&&u.handleFrameButtonRemoved(e.data),"WindowZoomFactorChanged"===e.type&&u.handleZoomFactorChanged(e.data),"Closed"===e.type&&(Wt.remove(a),u.handleWindowClose()),"FrameIsLockedChanged"===e.type&&u.handleFrameIsLockedChanged(e.data),"PlacementSettingsChanged"===e.type&&u.handlePlacementSettingsChanged(e.data),this._registry.execute("window-event",r)}else this._logger.error("received update for unknown window. Stream:', "+JSON.stringify(e,null,4))},e.prototype.createWindow=function(e,t){var n,r=Wt.get(e),i=Ut(e,this.mapToWindowConstructorOptions(t),Bt,this._logger,this._appManagerGetter,this._displayAPIGetter,this._agm,null===(n=r)||void 0===n?void 0:n.Registry);return Wt.add(i),i},e.prototype.focusChanged=function(e,t,n){e.handleFocusChanged(n),n?this._registry.execute("got-focus",t):this._registry.execute("lost-focus",t)},e.prototype.mapToWindowConstructorOptions=function(e){return{name:e.name,context:e.context,bounds:e.bounds,url:e.url,title:e.title,isVisible:e.isVisible,focus:e.isFocused,state:e.state,frameColor:e.frameColor,groupId:e.groupId,neighbours:e.neighbors,isFocused:e.isFocused,isGroupHeaderVisible:e.groupHeaderVisible,isCollapsed:e.isCollapsed,tabGroupId:e.frameId,mode:e.mode,isTabHeaderVisible:e.isTabHeaderVisible,isTabSelected:e.isActiveTab,settings:e.settings,windowType:e.windowType,zoomFactor:e.zoomFactor,isLocked:e.isLocked,placementSettings:e.placementSettings,isSticky:e.isSticky}},e.prototype.getExtendedStreamEvent=function(e){try{var t=o({state:e.type,windowName:Wt.get(e.windowId).API.name},e);return"WindowFrameAdded"===t.state&&(t.state="TabAttached"),"StateChanged"===t.state&&(t.state=t.data.charAt(0).toUpperCase()+t.data.slice(1)),"ButtonAdded"===t.state&&(t.state="FrameButtonAdded"),"ButtonRemoved"===t.state&&(t.state="FrameButtonRemoved"),t}catch(n){return e}},e}(),zt=function(e,t){var n=Pt(),r=[];function i(){return new Promise((function(e,t){var n=u((function(t){n(),e()}))}))}function o(e,n,r,i){return new Promise((function(i,o){t.execute(e,n).then((function(e){"function"===typeof r&&r(c),i(c)})).catch((function(e){o(e)}))}))}function a(){var e=[];return r.forEach((function(t){var n=s(t);"undefined"!==typeof n&&e.push(n)})),e}function s(e){return Wt.get(e)?Wt.get(e).API:void 0}function u(e){return n.add("header-visibility-changed",e)}var c={id:e,get windows(){return function(e){var t=a();return"function"===typeof e&&e(t),t}()},find:function(e,t){if(!Ze(e)){var n;n="string"===typeof e?e:e.id;var i=r.indexOf(n);if(-1!==i){var o=s(r[i]);return"function"===typeof t&&t(o),o}}},get isHeaderVisible(){return void 0===a().find((function(e){return!e.isGroupHeaderVisible}))},showHeader:function(e,n){return new Promise((function(n,o){Promise.all([t.setGroupHeaderVisible(r[0],!0),i()]).then((function(){"function"===typeof e&&e(c),n(c)})).catch((function(e){o(e)}))}))},hideHeader:function(e,n){return new Promise((function(n,o){Promise.all([t.setGroupHeaderVisible(r[0],!1),i()]).then((function(){"function"===typeof e&&e(c),n(c)})).catch((function(e){}))}))},getTitle:function(){return t.getGroupTitle(r[0])},setTitle:function(e){return t.setGroupTitle(r[0],e)},capture:function(e){return t.captureGroup(r,e)},maximize:function(e,t){return o("maximizeGroup",{windowId:r[0]},e)},restore:function(e,t){return o("restoreGroup",{windowId:r[0]},e)},onHeaderVisibilityChanged:u,onWindowAdded:function(e){return n.add("window-added",e)},onWindowRemoved:function(e){return n.add("window-removed",e)}};return{groupAPI:c,groupInternal:{addWindow:function(e){if(-1===r.indexOf(e)){r.push(e);var t=Wt.get(e);t.Events.handleGroupAssociation(c),n.execute("window-added",c,t.API)}},removeWindow:function(e){var t=r.indexOf(e);if(-1!==t){r.splice(t,1);var i=s(e);n.execute("window-removed",c,i)}},handleGroupHeaderVisibilityChanged:function(e){n.execute("header-visibility-changed",c)}}}},qt=function(e,t){var n=t.subLogger("groups"),r=Pt(),i={},o=-1,a=Wt.list;function s(e,n){var r,o;if("undefined"!==typeof e)return r="string"===typeof e?e:e.id,Object.keys(i).forEach((function(e){var t=i[e].groupAPI;void 0===t.find(r)||(o=t)})),"function"===typeof n&&n(o),o;t.debug("trying to find a group by a window, but winId is undefined")}function u(e){n.trace("Adding new window "+e.API.id+" to win.API.groupId "+e.API.groupId);var t=c(e);t&&(n.trace("handleGroupAssociation "+e.API.id+" to group.groupAPI.id "+t.groupAPI.id),e.Events.handleGroupAssociation(t.groupAPI))}function c(t,r){var o=r||t.API.groupId,a=t.API.id;if("undefined"!==typeof o&&"undefined"!==typeof a){var s=function(t){if(i.hasOwnProperty(t))return i[t];var n=zt(t,e.executor);return i[t]=n,n}(o);return s.groupInternal.addWindow(a),s}n.debug("trying to add a window without group - winId: "+a)}function l(e,t){var n=e.API.id,r=t||e.API.groupId;"undefined"!==typeof r&&(i[r].groupInternal.removeWindow(n),e.Events.handleGroupAssociation(void 0),function(e){i.hasOwnProperty(e)&&"undefined"!==typeof i[e]&&0===i[e].groupAPI.windows.length&&delete i[e]}(r))}return Object.keys(a).forEach((function(e){u(a[e])})),e.onCompositionChanged((function(e){!function(e){var t=e.groupId,i=e.windowId,o=s(i),a=o?o.id:void 0;if(n.trace("handleCompositionChanged newGroupId: "+t+" windowId: "+i+" oldGroup: "+a),a===t)return void n.trace("handleCompositionChanged newGroupId: "+t+" windowId: "+i+" oldGroup: "+a+" are the same - returning...");var u=Wt.get(i)||Wt.get(i),d=c(u,t);o&&(l(u,a),r.execute("window-moved",i,o,t));u.Events.handleGroupChanged(d.groupAPI,o)}(e)})),e.onGroupHeaderVisibilityChanged((function(e){var t=s(e.windowId);if("undefined"!==typeof t){var n=i[t.id];-1===o&&(o=t.windows.length),0===--o&&(o=-1,n.groupInternal.handleGroupHeaderVisibilityChanged(e))}})),Wt.onAdded((function(e){u(e)})),Wt.onRemoved((function(e){l(e)})),{groupsAPI:{get my(){return s(e.my())},list:function(e){var t=Object.keys(i).map((function(e){if(i[e])return i[e].groupAPI}));return"function"===typeof e&&e(t),t},findGroupByWindow:s},groupsEvents:{onWindowMoved:function(e){return r.add("window-moved",e)}}}},Gt=function(e,t,n,r,i){var o,a,s=Pt(),u=t;Wt.init(u);var c=new Promise((function(t,s){(function(e,t,n,r,i){var o=t;return new Promise((function(t,a){if(2===i)throw o.trace("running in HC"),new Error("GD2 not supported");if(i>=3){o.trace("running in GD 3"),new Ht(e,o,n,r,void 0,window.glue42gd.windowId).init().then(t).catch(a)}else{var s=new Ht(e,o,n,r).init();Promise.race([s,(u=1e4,new Promise((function(e,t){return setTimeout((function(){t("timeout waiting for streams")}),u)})))]).then(t).catch(a)}var u}))})(e,u,n,r,i).then((function(e){a=e,o=qt(e,u),t()})).catch((function(e){var t="Environment detector fails with: "+e;u.error(t),s(t)}))}));function l(){var e=Wt.getIfReady(a.my());return e?e.API:void 0}function d(e){return s.add("window-added",e)}function f(e){return s.add("window-removed",e)}return Wt.onReadyWindow((function(e){s.execute("window-added",e.API)})),Wt.onRemoved((function(e){s.execute("window-removed",e.API)})),{my:l,open:function(e,t,n,r,i){return new Promise((function(o,s){var u=function(e){"function"===typeof i&&i(e),s(e)};a.open(e,t,n,(function(e){Wt.waitFor(e).then((function(e){"function"===typeof r&&r(e.API),o(e.API),"electron"===e.API.windowType&&e.Events.handleUrlChanged(e.API.url)})).catch(u)}),u)}))},find:function(e,t,n){var r=Wt.list,i=Object.keys(r).reduce((function(t,n){var i=r[n];return i&&i.API.name===e&&t.push(i.API),t}),[]);if("function"!==typeof t)return i[0];i.length>0?t(i[0]):"function"===typeof n&&n("There is no window with name:"+e)},findById:function(e,t,n){var r=Wt.list,i=Object.keys(r).reduce((function(t,n){var i=r[n];return"undefined"!==typeof i&&i.API.id===e&&t.push(i.API),t}),[]);if("function"!==typeof t)return i[0];i.length>0?t(i[0]):"function"===typeof n&&n("There is no window with such id:"+e)},list:function(e){var t=Wt.list,n=Object.keys(t).map((function(e){return t[e].API}));if("function"!==typeof e)return n;e(n)},ready:function(){return c},onWindowAdded:d,windowAdded:d,onWindowRemoved:f,windowRemoved:f,onTabAttached:function(e){var t,n=!1;return c.then((function(){n||(t=a.tabAttached(e))})),function(){n=!0,t&&t()}},onTabDetached:function(e){var t,n=!1;return c.then((function(){n||(t=a.tabDetached(e))})),function(){n=!0,t&&t()}},onWindowFrameColorChanged:function(e){var t,n=!1;return c.then((function(){n||(t=a.onWindowFrameColorChanged(e))})),function(){n=!0,t&&t()}},get groups(){return o.groupsAPI},onWindowGotFocus:function(e){var t,n=!1;return c.then((function(){n||(t=a.onWindowGotFocus(e))})),function(){n=!0,t&&t()}},onWindowLostFocus:function(e){var t,n=!1;return c.then((function(){n||(t=a.onWindowLostFocus(e))})),function(){n=!0,t&&t()}},onEvent:function(e){var t,n=!1;return c.then((function(){n||(t=a.onEvent(e))})),function(){n=!0,t&&t()}},createFlydown:function(e,t){return a.createFlydown(e,t)},showPopup:function(e,t){return a.showPopup(e,t)},configure:function(e){var t=l(),n=t?t.id:"";return Bt.configure(n,e)}}},Jt=new(function(){function e(){this.layouts=[]}return e.prototype.removeWhere=function(e){this.layouts=this.layouts.filter(e)},e.prototype.add=function(e){this.layouts.push(e)},Object.defineProperty(e.prototype,"all",{get:function(){return this.layouts},enumerable:!0,configurable:!0}),e.prototype.where=function(e){return this.layouts.filter(e)},e.prototype.first=function(e){return this.where(e)[0]},e}());var Kt=1;var Yt,$t,Qt,Xt={nextValue:function(){return(Kt=(9301*Kt+49297)%233280)/233280},seed:function(e){Kt=e}},Zt="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ_-";function en(){Qt=!1}function tn(e){if(e){if(e!==Yt){if(e.length!==Zt.length)throw new Error("Custom alphabet for shortid must be "+Zt.length+" unique characters. You submitted "+e.length+" characters: "+e);var t=e.split("").filter((function(e,t,n){return t!==n.lastIndexOf(e)}));if(t.length)throw new Error("Custom alphabet for shortid must be "+Zt.length+" unique characters. These characters were not unique: "+t.join(", "));Yt=e,en()}}else Yt!==Zt&&(Yt=Zt,en())}function nn(){return Qt||(Qt=function(){Yt||tn(Zt);for(var e,t=Yt.split(""),n=[],r=Xt.nextValue();t.length>0;)r=Xt.nextValue(),e=Math.floor(r*t.length),n.push(t.splice(e,1)[0]);return n.join("")}())}var rn={characters:function(e){return tn(e),Yt},seed:function(e){Xt.seed(e),$t!==e&&(en(),$t=e)},lookup:function(e){return nn()[e]},shuffled:nn},on="object"===typeof window&&(window.crypto||window.msCrypto);var an=function(){if(!on||!on.getRandomValues)return 48&Math.floor(256*Math.random());var e=new Uint8Array(1);return on.getRandomValues(e),48&e[0]};var sn=function(e,t){for(var n,r=0,i="";!n;)i+=e(t>>4*r&15|an()),n=t<Math.pow(16,r+1),r++;return i};var un,cn,ln=function(e){var t=rn.shuffled();return{version:15&t.indexOf(e.substr(0,1)),worker:15&t.indexOf(e.substr(1,1))}};var dn=function(e){var t="",n=Math.floor(.001*(Date.now()-1459707606518));return n===cn?un++:(un=0,cn=n),t+=sn(rn.lookup,6),t+=sn(rn.lookup,e),un>0&&(t+=sn(rn.lookup,un)),t+=sn(rn.lookup,n)};var fn=function(e){if(!e||"string"!==typeof e||e.length<6)return!1;for(var t=rn.characters(),n=e.length,r=0;r<n;r++)if(-1===t.indexOf(e[r]))return!1;return!0},pn=function(e,t){return e(t={exports:{}},t.exports),t.exports}((function(e){var t=0;function n(){return dn(t)}e.exports=n,e.exports.generate=n,e.exports.seed=function(t){return rn.seed(t),e.exports},e.exports.worker=function(n){return t=n,e.exports},e.exports.characters=function(e){return void 0!==e&&rn.characters(e),rn.shuffled()},e.exports.decode=ln,e.exports.isValid=fn})),hn=(pn.generate,pn.seed,pn.worker,pn.characters,pn.decode,pn.isValid,pn),gn=function(){function e(e,t,n,r){this.config=e,this.activitiesGetter=t,this.callbacks=n,this.logger=r,this.interop=e.agm,this.registerRequestMethods()}return e.prototype.onSaveRequested=function(e){return this.callbacks.add("saveRequested",e)},e.prototype.isActivityOwner=function(){if("undefined"!==typeof htmlContainer){var e=htmlContainer.getContext();return e&&e._t42&&e._t42.activityIsOwner}var t=this.activitiesGetter();if(!t)return!1;if(!t.inActivity)return!1;var n=t.my.window,r=t.my.activity;return!(!r&&!n)&&r.owner.id===n.id},e.prototype.registerRequestMethods=function(){var e=this;this.interop.register("T42.HC.GetSaveContext",(function(t){var n,r,i,o=e.callbacks.execute("saveRequested",t);(null===(n=o)||void 0===n?void 0:n.length)>1&&e.logger.warn('Multiple subscriptions for "glue.layouts.onSaveRequested" - only the first one will be used');var a=o[0],s=e.config.autoSaveWindowContext;if(s)return{autoSaveWindowContext:s};var u={windowContext:null===(r=a)||void 0===r?void 0:r.windowContext,activityContext:void 0};return e.isActivityOwner()&&(u.activityContext=null===(i=a)||void 0===i?void 0:i.activityContext),u}))},e}();function vn(e){if(!e)return e;if(Array.isArray(e))return e.map((function(e){return vn(e)}));if("string"===typeof e||"number"===typeof e||"boolean"===typeof e)return e;return Object.keys(e).reduce((function(t,n){var r=vn(e[n]),i=n;return n[0].toLowerCase()!==n[0]&&(i=n[0].toLowerCase()+n.substr(1)),t[i]=r,t}),{})}var yn=function(e){this.name=e.name,this.type=e.type,this.components=e.components,this.context=e.context,this.metadata=e.metadata,this.version=e.version,this.displays=e.displays},mn=function(){function e(e,t,n,r){this.config=e,this.stream=t,this.callbacks=n,this.appManager=e.appManager,this.onEvent=t.onEvent,this.provider=new gn(e,e.activityGetter,n,r),t.subscribe()}return e.prototype.setDefaultGlobal=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.config.agm.invoke("T42.ACS.SelectDefaultLayout",{name:e})];case 1:return t.sent(),[2]}}))}))},e.prototype.clearDefaultGlobal=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.config.agm.invoke("T42.ACS.DeselectDefaultLayout")];case 1:return e.sent(),[2]}}))}))},e.prototype.getDefaultGlobal=function(){return a(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return[4,this.config.agm.invoke("T42.ACS.GetDefaultLayout")];case 1:return e=n.sent(),(t=e.returned)?this.isSlimMode()?[2,t]:[2,this.list().find((function(e){return e.name===t.name&&"Global"===e.type}))]:[2,void 0]}}))}))},e.prototype.ready=function(){return"fullWaitSnapshot"===this.config.mode?this.stream.gotSnapshot:this.stream.ready},e.prototype.save=function(e){var t=this;return new Promise((function(n,r){if(t.verifyNotSlimMode(),!e.name)throw Error("layout.name argument is required");e.type||(e.type="Global"),e.activityId&&(e.type="Activity"),"undefined"===typeof e.ignoreHidden&&(e.ignoreHidden=!0);var i={name:e.name,actIds:[],appIds:[],type:e.type,context:e.context,metadata:e.metadata||{},options:{ignoreLayoutRestrictions:!1}};if("Activity"===e.type){var o=e.activityId;if(!o){if(!t.appManager.myInstance.inActivity)throw new Error("Current application is not in activity. Can not save activity layout for it");o=t.appManager.myInstance.activityId}i.actIds.push(o),i.options={ignoreLayoutRestrictions:!0}}else{if("Global"!==e.type)throw new Error("layout type "+e.type+" not supported");if(2===t.config.gdMajorVersion){var a=t.appManager.instances();e.ignoreHidden&&(a=a.filter((function(e){return t.isVisibleWindow(e)}))),e.ignoreMyInstance&&t.appManager.myInstance&&(a=a.filter((function(e){return e.id!==t.appManager.myInstance.id}))),a.reduce((function(e,t){if(!t.id)return e;if(t.inActivity){var n=t.activityId;-1===e.actIds.indexOf(n)&&e.actIds.push(n)}else e.appIds.push(t.id);return e}),i)}else i.autoCollectApps=!0}t.invokeMethodAndTrack("T42.ACS.SaveLayout",i,n,r)}))},e.prototype.restore=function(e){var t=this;return new Promise((function(n,r){if(t.verifyNotSlimMode(),"undefined"===typeof e)throw Error("options argument is required");if(!e.name)throw Error("options.name argument is required");e.type||(e.type="Global"),e.activityIdToJoin&&(e.type="Activity"),"undefined"===typeof e.restoreActivityOwner&&(e.restoreActivityOwner=!1),"undefined"===typeof e.ignoreActivityWindowTypes&&(e.ignoreActivityWindowTypes=[]),"undefined"===typeof e.setActivityContext&&(e.setActivityContext=!0),"undefined"===typeof e.closeRunningInstance&&("Global"===e.type?e.closeRunningInstance=!0:"Activity"===e.type&&(e.closeRunningInstance=!1)),"undefined"===typeof e.reuseWindows&&(e.reuseWindows=!0),e.context=e.context||{};var i={restoreOptions:{activityToJoin:e.activityIdToJoin,setActivityContext:e.setActivityContext,ignoreActivityWindowTypes:e.ignoreActivityWindowTypes,restoreActivityOwner:e.restoreActivityOwner,closeOldWindows:e.closeRunningInstance,reuseExistingWindows:e.reuseWindows}},o={type:e.type,name:e.name,context:e.context,toClose:[],splash:e.splash};2===t.config.gdMajorVersion&&e.closeRunningInstance&&(o.toClose=t.getInstancesToClose(e)),e.timeout&&(o.timeout=e.timeout),o.context._t42=i,t.invokeMethodAndTrack("T42.ACS.RestoreLayout",o,n,r,!0)}))},e.prototype.remove=function(e,t){var n=this;return new Promise((function(r,i){if(n.verifyNotSlimMode(),!t)throw Error("name argument is required");if(!e)throw Error("type argument is required");var o={type:e,name:t};n.invokeMethodAndTrack("T42.ACS.RemoveLayout",o,r,i)}))},e.prototype.list=function(){return this.verifyNotSlimMode(),Jt.all},e.prototype.import=function(e,t){var n=this;return new Promise((function(r,i){n.verifyNotSlimMode();var o={mode:t||"replace",layouts:e};n.invokeMethodAndTrack("T42.ACS.ImportLayouts",o,r,i,!0)}))},e.prototype.export=function(e){var t=this;return new Promise((function(n,r){t.invokeMethodAndTrack("T42.ACS.ExportLayouts",{},(function(r){var i=t.getObjectValues(r.Layouts).map((function(e){return new yn(vn(e))}));e&&(i=i.filter((function(t){return t.type=e}))),n(i)}),r,!0)}))},e.prototype.rename=function(e,t){var n=this;return new Promise((function(r,i){if(n.verifyNotSlimMode(),!e)throw Error("layout argument is required");if(!e.name)throw Error("name argument is required");if(!e.type)throw Error("type argument is required");var o={type:e.type,oldName:e.name,newName:t};n.invokeMethodAndTrack("T42.ACS.RenameLayout",o,r,i)}))},e.prototype.updateMetadata=function(e){var t=this;return new Promise((function(n,r){if(!e)throw Error("layout argument is required");if(!e.name)throw Error("name argument is required");if(!e.type)throw Error("type argument is required");if(!e.metadata)throw Error("metadata argument is required");var i={name:e.name,type:e.type,metadata:e.metadata};t.invokeMethodAndTrack("T42.ACS.UpdateMetadata",i,n,r,!0)}))},e.prototype.hibernate=function(e,t){var n=this;return new Promise((function(r,i){if(!e)return i("name cannot be empty");var o={name:e,type:"Global",context:(t=t||{}).context||{},metadata:t.metadata||{}};n.invokeMethodAndTrack("T42.ACS.HibernateLayout",o,r,i,!0)}))},e.prototype.resume=function(e,t,n){var r=this;return new Promise((function(i,a){if(!e)return a("name cannot be empty");var s=o({name:e,type:"Global",context:t},n);r.invokeMethodAndTrack("T42.ACS.ResumeLayout",s,i,a,!0)}))},e.prototype.getCurrentLayout=function(){return a(this,void 0,void 0,(function(){var e,t;return s(this,(function(n){switch(n.label){case 0:return[4,this.config.agm.invoke("T42.ACS.GetCurrentLayout",{},"best",{methodResponseTimeoutMs:12e4})];case 1:return e=n.sent(),(t=e.returned.layout)?(this.isSlimMode()||(t=this.list().find((function(e){return e.name===t.name&&e.type===t.type}))),[2,t]):[2,void 0]}}))}))},e.prototype.onAdded=function(e){var t=this.callbacks.add("added",e);return Jt.all.length>0&&Jt.all.forEach((function(t){try{e(t)}catch(n){}})),t},e.prototype.onRemoved=function(e){return this.callbacks.add("removed",e)},e.prototype.onChanged=function(e){return this.callbacks.add("changed",e)},e.prototype.onRestored=function(e){return this.callbacks.add("restored",e)},e.prototype.onRenamed=function(e){return this.callbacks.add("renamed",e)},e.prototype.onEvent=function(e){return this.stream.onEvent(e)},e.prototype.onSaveRequested=function(e){return this.provider.onSaveRequested(e)},e.prototype.updateAppContextInCurrent=function(e){var t=this;return new Promise((function(n,r){e&&"object"!==typeof e&&r("context must be an object");var i={context:e=null!==e&&void 0!==e?e:{}};t.invokeMethodAndTrack("T42.ACS.UpdateLayoutComponentContext",i,n,r,!0)}))},e.prototype.updateDefaultContext=function(e){var t=this;return new Promise((function(n,r){e&&"object"!==typeof e&&r("context must be an object");var i={context:e=null!==e&&void 0!==e?e:{}};t.invokeMethodAndTrack("T42.ACS.UpdateDefaultContext",i,n,r,!0)}))},e.prototype.get=function(e,t){var n=this.list().find((function(n){return n.name===e&&n.type===t}));return n?Promise.resolve(n):Promise.reject("can not find layout with name="+e+" and type="+t)},e.prototype.getAll=function(e){var t=this.list().filter((function(t){return e===t.type}));return Promise.resolve(t)},e.prototype.isSlimMode=function(){return"slim"===this.config.mode},e.prototype.verifyNotSlimMode=function(){if(this.isSlimMode())throw Error("Operation not allowed in slim mode. Run in full mode.")},e.prototype.isVisibleWindow=function(e){return"exe"===e.application.type||"node"===e.application.type||("activity"===e.application.type||!(!e||!e.window)&&e.window.isVisible)},e.prototype.invokeMethodAndTrack=function(e,t,n,r,i){var o,a=i,s=hn();t.token=s;var u=function(){a&&o&&n(o)};i||this.stream.waitFor(s).then((function(){a=!0,u()})).catch((function(e){r(e)}));this.config.agm.invoke(e,t,"best",{methodResponseTimeoutMs:12e4}).then((function(t){t.returned||r("No result from method "+e),t.returned.status&&"Success"!==t.returned.status&&"PartialSuccess"!==t.returned.status&&r(t.returned),o=t.returned,u()})).catch((function(e){return r(e)}))},e.prototype.getInstancesToClose=function(e){var t=this,n=[],r=this.appManager.applications().filter((function(e){return e.isShell}))[0],i=r?r.name:"AppManager";return this.appManager.instances().forEach((function(r){t.appManager.myInstance&&r.id===t.appManager.myInstance.id||r.application.name!==i&&t.isVisibleWindow(r)&&("Activity"===e.type&&r.activityId!==e.activityIdToJoin||n.push({application:r.application.name,instance:r.id}))})),n},e.prototype.getObjectValues=function(e){return e?Object.keys(e).map((function(t){return e[t]})):[]},e}(),bn=function(){function e(e,t){var n=this;this.agm=e,this.callbacks=t,this.ready=new Promise((function(e,t){n.resolveReady=e,n.rejectReady=t})),this.gotSnapshot=new Promise((function(e,t){n.resolveGotSnapshot=e,n.rejectGotSnapshot=t}))}return e.prototype.subscribe=function(e){var t=this,n=function(e){return t.getObjectValues(e).map((function(e){return vn(e)}))};this.checkForLayoutEventMethod()?this.agm.subscribe("T42.ACS.OnLayoutEvent",{waitTimeoutMs:1e4}).then((function(e){e.onData((function(e){var r=e.data;r.IsSnapshot&&t.resolveGotSnapshot(),t.addLayouts(n(r.OnLayoutAdded)),t.removeLayouts(n(r.OnLayoutRemoved)),t.changeLayouts(n(r.OnLayoutChanged)),t.renameLayouts(n(r.OnLayoutRenamed)),t.restoredLayout(n(r.OnLayoutRestored)),t.callbacks.execute("streamEvent",r)})),e.onFailed((function(e){var n="can not subscribe to T42.ACS.OnLayoutEvent "+e;t.rejectReady(n),t.rejectGotSnapshot(n)})),t.resolveReady()})).catch((function(e){var n="Error subscribing for T42.ACS.OnLayoutEvent stream. Err: "+e;t.rejectReady(n),t.rejectGotSnapshot(n)})):(e&&this.resolveReady(),setTimeout((function(){t.subscribe(!0)}),500))},e.prototype.onEvent=function(e){return this.callbacks.add("streamEvent",e)},e.prototype.waitFor=function(e,t){var n=this;return t||(t=1e4),new Promise((function(r,i){var o=!1,a=n.onEvent((function(t){t.Token===e&&(o=!0,a(),r())}));setTimeout((function(){o||i("timed out")}),t)}))},e.prototype.checkForLayoutEventMethod=function(){try{return-1!==this.agm.methods().map((function(e){return e.name})).indexOf("T42.ACS.OnLayoutEvent")}catch(e){return!1}},e.prototype.addLayouts=function(e){var t=this;e&&e.forEach((function(e){var n=new yn(e);Jt.add(n),t.callbacks.execute("added",n)}))},e.prototype.removeLayouts=function(e){var t=this;e&&e.forEach((function(e){Jt.removeWhere((function(n){return!t.compareLayouts(n,e)})),t.callbacks.execute("removed",e)}))},e.prototype.changeLayouts=function(e){var t=this;e&&e.forEach((function(e){Jt.removeWhere((function(n){return!t.compareLayouts(n,e)})),Jt.add(new yn(e)),t.callbacks.execute("changed",e)}))},e.prototype.renameLayouts=function(e){var t=this;e&&e.forEach((function(e){var n=Jt.first((function(n){return t.compareLayouts(n,{type:e.type,name:e.oldName})}));if(!n)throw Error("received rename event for unknown layout with type "+e.type+" and name "+e.oldName);n.name=e.newName,t.callbacks.execute("renamed",n)}))},e.prototype.compareLayouts=function(e,t){return e.name===t.name&&e.type===t.type},e.prototype.getObjectValues=function(e){return e?Object.keys(e).map((function(t){return e[t]})):[]},e.prototype.restoredLayout=function(e){var t=this;e&&e.forEach((function(e){var n=Jt.first((function(n){return t.compareLayouts(n,{type:e.type,name:e.name})}));t.callbacks.execute("restored",n)}))},e}();function wn(e){if(!e.agm)throw Error("config.agm is required");if(!e.logger)throw Error("config.logger is required");e.mode=e.mode||"slim";var t,n=e.logger,r=Pt();return e.mode,t=new bn(e.agm,r),new mn(e,t,r,n)}var _n,kn,xn,Sn=function(e,t){var n=this;this._agm=e,this._logger=t,this.all=function(){return a(n,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.callGD(_n.GetAll,{})];case 1:return[2,e.sent().map(this.decorateDisplay)]}}))}))},this.get=function(e){return a(n,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:return[4,this.callGD(_n.Get,{id:e})];case 1:return t=n.sent(),[2,this.decorateDisplay(t)]}}))}))},this.getPrimary=function(){return a(n,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.all()];case 1:return[2,e.sent().find((function(e){return e.isPrimary}))]}}))}))},this.capture=function(e){return a(n,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.callGD(_n.Capture,o({},e))];case 1:return[2,t.sent()]}}))}))},this.captureAll=function(e){return a(n,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.callGD(_n.CaptureAll,o({},e))];case 1:return[2,t.sent()]}}))}))},this.getMousePosition=function(){return a(n,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.callGD(_n.GetMousePosition)];case 1:return[2,e.sent()]}}))}))},this.callGD=function(e,t){return a(n,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this._agm.invoke("T42.Displays.Command",{options:o({},t),command:e})];case 1:return[2,n.sent().returned.data]}}))}))},this.decorateDisplay=function(e){return o(o({},e),{capture:function(t){return n.capture({id:e.id,size:t})}})}};function In(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){return kn.invoke("T42.Channels.Announce",{swId:null!==t&&void 0!==t?t:xn,command:"switchChannel",data:{newChannel:e}}),[2]}))}))}!function(e){e.Capture="capture",e.CaptureAll="captureAll",e.GetAll="getAll",e.Get="get",e.GetMousePosition="getMousePosition"}(_n||(_n={}));var Cn=function(){function e(e){this.contexts=e}return e.prototype.subscribe=function(e){this.callback=e},e.prototype.subscribeFor=function(e,t){if(!this.isChannel(e))return Promise.reject(new Error("Channel with name: "+e+" doesn't exist!"));var n=this.createContextName(e);return this.contexts.subscribe(n,(function(e,n,r,i,o){var a;t(e.data,e,null===(a=o)||void 0===a?void 0:a.updaterId)}))},e.prototype.switchChannel=function(e){return a(this,void 0,void 0,(function(){var t,n,r=this;return s(this,(function(i){switch(i.label){case 0:return this.unsubscribe(),t=this.createContextName(e),n=this,[4,this.contexts.subscribe(t,(function(e,t,n,i,o){var a;r.callback&&r.callback(e.data,e,null===(a=o)||void 0===a?void 0:a.updaterId)}))];case 1:return n.unsubscribeFunc=i.sent(),[2]}}))}))},e.prototype.unsubscribe=function(){this.unsubscribeFunc&&this.unsubscribeFunc()},e.prototype.all=function(){return this.contexts.all().filter((function(e){return e.startsWith("___channel___")})).map((function(e){return e.substr("___channel___".length)}))},e.prototype.getContextData=function(e){var t=this;return new Promise((function(n,r){if(!t.isChannel(e))return r(new Error("A channel with name: "+e+" doesn't exist!"));var i=t.createContextName(e);t.contexts.subscribe(i,(function(e){n(e)})).then((function(e){return e()}))}))},e.prototype.updateChannel=function(e,t){var n=this.createContextName(e);return this.contexts.update(n,t)},e.prototype.updateData=function(e,t){var n=this.createContextName(e);if(this.contexts.setPathSupported){var r=Object.keys(t).map((function(e){return{path:"data."+e,value:t[e]}}));return this.contexts.setPaths(n,r)}return this.contexts.update(n,{data:t})},e.prototype.isChannel=function(e){return this.all().some((function(t){return t===e}))},e.prototype.createContextName=function(e){return"___channel___"+e},e}(),Tn=function(){function e(e){this.shared=e,this.subsKey="subs",this.changedKey="changed",this.registry=Pt(),this.shared.subscribe(this.handler.bind(this))}return e.prototype.subscribe=function(e){if("function"!==typeof e)throw new Error("Please provide the callback as a function!");return this.registry.add(this.subsKey,e)},e.prototype.subscribeFor=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:if("string"!==typeof e)throw new Error("Please provide the name as a string!");if("function"!==typeof t)throw new Error("Please provide the callback as a function!");return[4,this.shared.subscribeFor(e,t)];case 1:return[2,n.sent()]}}))}))},e.prototype.publish=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){if("object"!==typeof e)throw new Error("Please provide the data as an object!");if(t){if("string"!==typeof t)throw new Error("Please provide the name as a string!");return this.shared.isChannel(t)?[2,this.shared.updateData(t,e)]:[2,Promise.reject(new Error("A channel with name: "+t+" doesn't exist!"))]}if(!this.currentContext)throw new Error("Not joined to any channel!");return[2,this.shared.updateData(this.currentContext,e)]}))}))},e.prototype.all=function(){var e=this.shared.all();return Promise.resolve(e)},e.prototype.list=function(){return a(this,void 0,void 0,(function(){var e,t=this;return s(this,(function(n){switch(n.label){case 0:return[4,this.all()];case 1:return e=n.sent(),[4,Promise.all(e.map((function(e){return t.get(e)})))];case 2:return[2,n.sent()]}}))}))},e.prototype.get=function(e){return"string"!==typeof e?Promise.reject(new Error("Please provide the channel name as a string!")):this.shared.getContextData(e)},e.prototype.join=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.joinCore(e)]}))}))},e.prototype.joinNoSelectorSwitch=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){return[2,this.joinCore(e,!1)]}))}))},e.prototype.leave=function(){return this.leaveCore()},e.prototype.leaveNoSelectorSwitch=function(){return this.leaveCore(!1)},e.prototype.current=function(){return this.currentContext},e.prototype.my=function(){return this.current()},e.prototype.changed=function(e){if("function"!==typeof e)throw new Error("Please provide the callback as a function!");return this.registry.add(this.changedKey,e)},e.prototype.onChanged=function(e){return this.changed(e)},e.prototype.add=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:if("object"!==typeof e)throw new Error("Please provide the info as an object!");if("undefined"===typeof e.name)throw new Error("info.name is missing!");if("string"!==typeof e.name)throw new Error("Please provide the info.name as a string!");if("undefined"===typeof e.meta)throw new Error("info.meta is missing!");if("object"!==typeof e.meta)throw new Error("Please provide the info.meta as an object!");if("undefined"===typeof e.meta.color)throw new Error("info.meta.color is missing!");if("string"!==typeof e.meta.color)throw new Error("Please provide the info.meta.color as a string!");return t={name:e.name,meta:e.meta||{},data:e.data||{}},[4,this.shared.updateChannel(e.name,t)];case 1:return n.sent(),[2,t]}}))}))},e.prototype.handler=function(e,t,n){this.registry.execute(this.subsKey,e,t,n)},e.prototype.joinCore=function(e,t){return void 0===t&&(t=!0),a(this,void 0,void 0,(function(){var n,r=this;return s(this,(function(i){switch(i.label){case 0:if("string"!==typeof e)throw new Error("Please provide the channel name as a string!");return e===this.currentContext?[2]:(n=function(e){return r.shared.all().includes(e)})(e)?[3,2]:[4,new Promise((function(t,r){var i,o=setInterval((function(){n(e)&&(clearTimeout(i),clearInterval(o),t())}),100);i=setTimeout((function(){return clearInterval(o),r(new Error("A channel with name: "+e+" doesn't exist!"))}),3e3)}))];case 1:i.sent(),i.label=2;case 2:return this.currentContext=e,[4,this.shared.switchChannel(e)];case 3:return i.sent(),t&&In(e),this.registry.execute(this.changedKey,e),[2]}}))}))},e.prototype.leaveCore=function(e){return void 0===e&&(e=!0),this.currentContext=void 0,this.registry.execute(this.changedKey,void 0),this.shared.unsubscribe(),e&&In(),Promise.resolve()},e}();function Pn(e,t){var n=new Cn(e),r=new Tn(n);return function(e,t){a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return kn=e,"undefined"!==typeof window&&window.glue42gd&&(xn=window.glue42gd.windowId),xn?[4,kn.register("T42.Channels.Command",(function(e){var n=e.command;if(!n)throw new Error("missing command argument");if("join"!==n){if("leave"!==n){if("get"===n)return{id:r=t.current()};throw new Error("unknown command "+n)}t.leaveNoSelectorSwitch()}else{var r;if(!(r=e.channel))throw new Error("missing argument id");t.joinNoSelectorSwitch(r)}}))]:[2];case 1:return n.sent(),kn.invoke("T42.Channels.Announce",{swId:xn,instance:kn.instance.instance}),[2]}}))}))}(t,r),{subscribe:r.subscribe.bind(r),subscribeFor:r.subscribeFor.bind(r),publish:r.publish.bind(r),all:r.all.bind(r),list:r.list.bind(r),get:r.get.bind(r),join:r.join.bind(r),leave:r.leave.bind(r),current:r.current.bind(r),my:r.my.bind(r),changed:r.changed.bind(r),onChanged:r.onChanged.bind(r),add:r.add.bind(r),ready:function(){return e.ready()}}}var An=function(){function e(e){this.agm=e,this.registry=Pt(),this.firstHotkey=!0,this.hotkeys=new Map}return e.prototype.register=function(e,t){return a(this,void 0,void 0,(function(){var n;return s(this,(function(r){switch(r.label){case 0:if("undefined"===typeof e)throw new Error("Hotkey parameter missing");if("string"===typeof e)e={hotkey:e};else{if(!e.hotkey)throw new Error("Info's hotkey parameter missing");e={hotkey:e.hotkey,description:e.description}}if(n=this.formatHotkey(e.hotkey),this.hotkeys.has(n))throw new Error("Shortcut for "+n+" already registered");return this.firstHotkey?(this.firstHotkey=!1,[4,this.registerInvokeAGMMethod()]):[3,2];case 1:r.sent(),r.label=2;case 2:return this.registry.add(n,t),[4,this.agm.invoke("T42.Hotkeys.Command",{command:"register",hotkey:n,description:e.description})];case 3:return r.sent(),this.hotkeys.set(n,e),[2]}}))}))},e.prototype.unregister=function(e){return a(this,void 0,void 0,(function(){var t;return s(this,(function(n){switch(n.label){case 0:if("undefined"===typeof e)throw new Error("hotkey parameter missing");if("string"!==typeof e)throw new Error("hotkey parameter must be string");return t=this.formatHotkey(e),[4,this.agm.invoke("T42.Hotkeys.Command",{command:"unregister",hotkey:t})];case 1:return n.sent(),this.hotkeys.delete(t),this.registry.clearKey(t),[2]}}))}))},e.prototype.unregisterAll=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.agm.invoke("T42.Hotkeys.Command",{command:"unregisterAll"})];case 1:return e.sent(),this.hotkeys.clear(),this.registry.clear(),[2]}}))}))},e.prototype.isRegistered=function(e){var t=this.formatHotkey(e);return this.hotkeys.has(t)},e.prototype.registerInvokeAGMMethod=function(){var e=this;this.agm.register("T42.Hotkeys.Invoke",(function(t){var n=t.key.toLowerCase(),r=e.hotkeys.get(n);e.registry.execute(n,r)}))},e.prototype.formatHotkey=function(e){if(e)return e.replace(/\s/g,"").toLowerCase()},e}();var En=function(e){function t(e,t,n){if("boolean"!==typeof e||e){var r=function e(t,n,r){if("object"===typeof t)return e(t.mode,n,r)+"";if("undefined"===typeof t)return"boolean"!==typeof n||n?n+"":void 0;if("boolean"===typeof t)return t?(void 0===r?n:r)+"":void 0;return t+""}(e,t,n);return"object"===typeof e?(e.mode=r,e):{mode:r}}}return{layouts:t(e.layouts,"slim"),activities:t(e.activities,"trackMyTypeAndInitiatedFromMe"),appManager:t(e.appManager,!1,"startOnly"),windows:t(e.windows,!0),channels:t(e.channels||!1,!1),displays:t(e.displays,!0)}},On=function(){function e(e){this.options=e,this.callbacks=Pt(),this.actions=e.actions,this.body=e.body,this.badge=e.badge,this.data=e.data,this.dir=e.dir,this.icon=e.icon,this.image=e.image,this.lang=e.lang,this.renotify=e.renotify,this.requireInteraction=e.requireInteraction,this.silent=e.silent,this.tag=e.tag,this.timestamp=e.timestamp,this.title=e.title}return e.prototype.close=function(){throw new Error("Method not implemented.")},e.prototype.addEventListener=function(e,t,n){this.callbacks.add(e,t)},e.prototype.removeEventListener=function(e,t,n){},e.prototype.dispatchEvent=function(e){return this.callbacks.execute(e.type,e),!0},e}(),Mn=function(){function e(e){this.interop=e,this.methodsRegistered=!1,this.methodNameRoot="T42.Notifications.Handler-"+hn(),this.nextId=0,this.notifications={}}return Object.defineProperty(e.prototype,"maxActions",{get:function(){return 2},enumerable:!0,configurable:!0}),e.prototype.raise=function(e){var t,n;return a(this,void 0,void 0,(function(){var r,i,o,a,u,c,l,d,f,p,h;return s(this,(function(s){switch(s.label){case 0:if(!e)throw new Error("invalid options - should be an object");if(!e.title)throw new Error("invalid options - should have title");if(this.methodsRegistered)return[3,2];for(r=[],u=0;u<this.maxActions;u++)r.push(this.interop.register(this.methodNameRoot+"_"+u,this.handleNotificationAction.bind(this)));return[4,Promise.all(r)];case 1:s.sent(),this.methodsRegistered=!0,s.label=2;case 2:if(i=String(this.nextId++),o={title:e.title,severity:"Medium",description:e.body,glueRoutingDetailMethodName:this.methodNameRoot+"_0",actions:[],source:i},e.actions)for(a=e.actions.slice(0,this.maxActions),u=0,c=function(e){var r={g42notificationId:i,g42action:e.action,g42interopMethod:null===(t=e.interop)||void 0===t?void 0:t.method,g42interopTarget:null===(n=e.interop)||void 0===n?void 0:n.target},a=Object.keys(r).map((function(e){return{name:e,value:{stringValue:r[e]}}})),s={name:l.methodNameRoot+"_"+u,description:e.title,displayName:e.title,parameters:a};o.actions.push(s),u++},l=this,d=0,f=a;d<f.length;d++)p=f[d],c(p);return[4,this.interop.invoke("T42.GNS.Publish.RaiseNotification",{notification:o})];case 3:return s.sent(),h=new On(e),this.notifications[i]=h,[2,h]}}))}))},e.prototype.handleNotificationAction=function(e){if(e.g42notificationId){var t=e,n=t.g42notificationId;if(!(o=this.notifications[n]))return;var r=new Event("onaction");r.action=t.g42action,o.onaction&&o.onaction(r);var i=(o.actions||[]).find((function(e){return e.action===t.g42action})).interop;i&&this.interop.invoke(i.method,i.arguments||{},i.target||"best"),o.dispatchEvent(r)}else if(e.notification&&e.notification.source){var o;n=e.notification.source;if(!(o=this.notifications[n]))return;var a=new Event("onclick");o.onclick&&o.onclick(a);var s=o.options.clickInterop;s&&this.interop.invoke(s.method,s.arguments||{},s.target||"best"),o.dispatchEvent(a)}},e}(),jn=function(){function e(e){this.core=e,this.registry=Pt(),this.isSubscribed=!1,this.getConfiguration()}return e.prototype.list=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.getConfiguration()];case 1:if(e.sent(),!this.getMethodName)throw new Error("not supported");return[4,this.getAll()];case 2:return[2,e.sent().returned.all]}}))}))},e.prototype.getCurrent=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return[4,this.getConfiguration()];case 1:if(t.sent(),!this.getMethodName)throw new Error("not supported");return[4,this.getAll()];case 2:return[2,(e=t.sent()).returned.all.find((function(t){return t.name===e.returned.selected}))]}}))}))},e.prototype.select=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.getConfiguration()];case 1:if(t.sent(),!this.setMethodName)throw new Error("not supported");return[4,this.core.interop.invoke(this.setMethodName,{theme:e})];case 2:return t.sent(),[2]}}))}))},e.prototype.onChanged=function(e){return this.subscribe(),this.registry.add("changed",e)},e.prototype.getConfiguration=function(){return a(this,void 0,void 0,(function(){var e;return s(this,(function(t){switch(t.label){case 0:return t.trys.push([0,2,,3]),this.sharedContextName?[2]:[4,this.core.interop.invoke("T42.Themes.Configuration")];case 1:return e=t.sent(),this.sharedContextName=e.returned.sharedContextName,this.getMethodName=e.returned.getThemesMethodName,this.setMethodName=e.returned.setThemesMethodName,[3,3];case 2:return t.sent(),[2];case 3:return[2]}}))}))},e.prototype.getAll=function(){return a(this,void 0,void 0,(function(){return s(this,(function(e){switch(e.label){case 0:return[4,this.getConfiguration()];case 1:return e.sent(),[4,this.core.interop.invoke(this.getMethodName)];case 2:return[2,e.sent()]}}))}))},e.prototype.subscribe=function(){return a(this,void 0,void 0,(function(){var e=this;return s(this,(function(t){switch(t.label){case 0:return[4,this.getConfiguration()];case 1:return t.sent(),this.isSubscribed?[2]:(this.isSubscribed=!0,this.core.contexts.subscribe(this.sharedContextName,(function(t){t&&t.all&&t.selected&&e.registry.execute("changed",t.all.find((function(e){return e.name===t.selected})))})),[2])}}))}))},e}();var Rn,Nn=function(){function e(e,t,n){this.interop=e,this.windows=t,this.logger=n}return e.prototype.find=function(e){return a(this,void 0,void 0,(function(){var t,n;return s(this,(function(r){switch(r.label){case 0:return[4,this.all()];case 1:if(t=r.sent(),"undefined"===typeof e)return[2,t];if("string"===typeof e)return[2,t.filter((function(t){return t.name===e}))];if("object"!==typeof e)throw new Error("Please provide the intentFilter as a string or an object!");return e.contextType&&(n=e.contextType.toLowerCase(),t=t.filter((function(e){return e.handlers.some((function(e){var t;return null===(t=e.contextTypes)||void 0===t?void 0:t.some((function(e){return e.toLowerCase()===n}))}))}))),e.name&&(t=t.filter((function(t){return t.name===e.name}))),[2,t]}}))}))},e.prototype.raise=function(e){return a(this,void 0,void 0,(function(){var t,n,r,i,o,a,u,c,l;return s(this,(function(s){switch(s.label){case 0:if("string"!==typeof e&&"object"!==typeof e||"object"===typeof e&&"string"!==typeof e.intent)throw new Error("Please provide the intent as a string or an object with an intent property!");return"string"===typeof e&&(e={intent:e}),t=e.intent,[4,this.get(t)];case 1:if("undefined"===typeof(n=s.sent()))throw new Error("Intent "+t+" not found.");if(r=!n.handlers.some((function(e){return"app"===e.type})),i=e.target||(r?"reuse":"startNew"),a=n.handlers.find((function(e){return"app"===e.type})),"startNew"===i)o=a;else if("reuse"===i)u=n.handlers.find((function(e){return"instance"===e.type})),o=u||a;else if(i.instance)o=n.handlers.find((function(e){return"instance"===e.type&&e.instanceId===i.instance}));else{if(!i.app)throw new Error("Invalid intent target: "+JSON.stringify(i));o=n.handlers.find((function(e){return"app"===e.type&&e.applicationName===i.app}))}if(!o)throw new Error("Can not raise intent for request "+JSON.stringify(e)+" - can not find intent handler.");return c=o.instanceId,"app"!==o.type?[3,3]:[4,this.startApp(o.applicationName,e.options)];case 2:c=s.sent(),s.label=3;case 3:return[4,this.raiseIntentToInstance(c,t,e.context)];case 4:return(l=s.sent()).request=e,l.handler=o,[2,l]}}))}))},e.prototype.all=function(){return a(this,void 0,void 0,(function(){var e,t,n,r,i,o,u,c,l,d,f,p,h,g,v,y,m,b,w,_,k,x=this;return s(this,(function(S){switch(S.label){case 0:return S.trys.push([0,2,,3]),[4,this.interop.invoke("T42.ACS.GetApplications",{withIntentsInfo:!0})];case 1:return m=S.sent(),e=m.returned.applications,[3,3];case 2:return t=S.sent(),this.logger.error("Failed to get the applications!",t),[2,[]];case 3:for(n={},r=e.filter((function(e){return e.intents&&e.intents.length>0})),i=0,o=r;i<o.length;i++)for(u=o[i],c=0,l=u.intents;c<l.length;c++)d=l[c],(f=n[d.name])||(f={name:d.name,handlers:[]},n[d.name]=f),p={applicationName:u.name,applicationTitle:u.title,applicationDescription:u.caption,displayName:d.displayName,contextTypes:d.contexts,applicationIcon:u.icon,type:"app"},f.handlers.push(p);if(h=this.interop.servers(),g=h.map((function(e){return e.windowId})).filter((function(e){return"undefined"!==typeof e})),v="T42.Wnd.GetInfo",!this.interop.methods().some((function(e){return e.name===v})))return[3,7];S.label=4;case 4:return S.trys.push([4,6,,7]),[4,this.interop.invoke(v,{ids:g})];case 5:return m=S.sent(),y=m.returned.windows,[3,7];case 6:return S.sent(),[3,7];case 7:b=function(t){return s(this,(function(r){switch(r.label){case 0:return[4,Promise.all(t.getMethods().filter((function(e){return e.name.startsWith("Tick42.FDC3.Intents.")})).map((function(r){return a(x,void 0,void 0,(function(){var i,o,a,u,c,l,d,f,p,h,g,v;return s(this,(function(s){switch(s.label){case 0:return i=r.name.replace("Tick42.FDC3.Intents.",""),(o=n[i])||(o={name:i,handlers:[]},n[i]=o),a=r.flags,(u=e.find((function(e){return e.name===t.application})))&&u.intents&&(c=u.intents.find((function(e){return e.name===i}))),[4,this.windowsIdToTitle(t.windowId,y)];case 1:return l=s.sent(),d={instanceId:t.instance,applicationName:t.application,applicationIcon:a.icon||(null===(f=u)||void 0===f?void 0:f.icon),applicationTitle:null===(p=u)||void 0===p?void 0:p.title,applicationDescription:a.description||(null===(h=u)||void 0===h?void 0:h.caption),displayName:a.displayName||(null===(g=c)||void 0===g?void 0:g.displayName),contextTypes:a.contextTypes||(null===(v=c)||void 0===v?void 0:v.contexts),instanceTitle:l,type:"instance"},o.handlers.push(d),[2]}}))}))})))];case 1:return r.sent(),[2]}}))},w=0,_=h,S.label=8;case 8:return w<_.length?(k=_[w],[5,b(k)]):[3,11];case 9:S.sent(),S.label=10;case 10:return w++,[3,8];case 11:return[2,Object.values(n)]}}))}))},e.prototype.addIntentListener=function(e,t){var n=this;if("string"!==typeof e&&"object"!==typeof e||"object"===typeof e&&"string"!==typeof e.intent)throw new Error("Please provide the intent as a string or an object with an intent property!");if("function"!==typeof t)throw new Error("Please provide the handler as a function!");var r={unsubscribe:function(){return console.log("Could not unsubscribe!")}},i="Tick42.FDC3.Intents."+("string"===typeof e?e:e.intent),o="string"===typeof e?{intent:e}:e;return this.interop.register({name:i,flags:o},(function(e){return t(e)})).then((function(){r.unsubscribe=function(){n.interop.unregister(i)}})),r},e.prototype.get=function(e){return a(this,void 0,void 0,(function(){return s(this,(function(t){switch(t.label){case 0:return[4,this.all()];case 1:return[2,t.sent().find((function(t){return t.name===e}))]}}))}))},e.prototype.startApp=function(e,t){return a(this,void 0,void 0,(function(){return s(this,(function(n){switch(n.label){case 0:return[4,this.interop.invoke("T42.ACS.StartApplication",{Name:e,options:t})];case 1:return[2,n.sent().returned.Id]}}))}))},e.prototype.raiseIntentToInstance=function(e,t,n){return a(this,void 0,void 0,(function(){var r,i,o=this;return s(this,(function(a){switch(a.label){case 0:return r="Tick42.FDC3.Intents."+t,(i=this.interop.servers().find((function(t){return t.instance===e})))?[3,2]:[4,new Promise((function(t,n){var r,a=o.interop.serverAdded((function(n){n.instance===e&&(i=n,t(),clearTimeout(r),a())}));r=setTimeout((function(){a(),n(new Error("Can not find interop server for instance "+e))}),3e4)}))];case 1:a.sent(),a.label=2;case 2:return i.getMethods().find((function(e){return e.name===r}))?[3,4]:[4,new Promise((function(t,n){var i,a=o.interop.methodAdded((function(e){e.name===r&&(t(),clearTimeout(i),a())}));i=setTimeout((function(){a(),n(new Error("Can not find interop method "+r+" for instance "+e))}),1e4)}))];case 3:a.sent(),a.label=4;case 4:return[4,this.interop.invoke(r,n,{instance:e})];case 5:return[2,{result:a.sent().returned}]}}))}))},e.prototype.windowsIdToTitle=function(e,t){var n,r,i;return a(this,void 0,void 0,(function(){var o;return s(this,(function(a){switch(a.label){case 0:return"undefined"!==typeof t?[2,null===(n=t.find((function(t){return t.id===e})))||void 0===n?void 0:n.title]:(o=null===(r=this.windows)||void 0===r?void 0:r.findById(e),[4,null===(i=o)||void 0===i?void 0:i.getTitle()]);case 1:return[2,a.sent()]}}))}))},e}(),Ln=function(){function e(){var e=this;this.numberOfCalls=0,this.numberOfCalls=1,this.promise=new Promise((function(t,n){e.resolve=t,e.reject=n}))}return e.prototype.getPromise=function(){return this.numberOfCalls++,this.promise},e.prototype.done=function(e){this.resolve(e)},e.prototype.error=function(e){this.reject(e)},e}(),Dn=function(e){return a(void 0,void 0,void 0,(function(){var t,n,r;return s(this,(function(i){switch(i.label){case 0:if(t="undefined"!==typeof window&&window.glue42gd){if(Rn)return[2,Rn.getPromise()];Rn=new Ln}return[4,Wn(e,t)];case 1:return n=i.sent(),null===(r=Rn)||void 0===r||r.resolve(n),[2,n]}}))}))},Wn=function(e,t){return a(void 0,void 0,void 0,(function(){function n(e){if(v.windows){var t=p("windows",e.logger,v.windows);return h(b=Gt(e.agm,t,(function(){return y}),(function(){return w}),g)),b}}function r(e){var n,r;if(v.activities&&Ct.checkIsUsingGW3Implementation&&Ct.checkIsUsingGW3Implementation(e.connection)){var i=p("activity",e.logger,v.activities);return h(m=new Ct({connection:e.connection,contexts:e.contexts,agm:e.agm,logger:i,logLevel:"info",disableAutoAnnounce:!1,disposeRequestHandling:"exit",announcementInfo:null,windows:b,appManagerGetter:function(){return y},mode:v.activities.mode,typesToTrack:v.activities.typesToTrack,activityId:null===(r=null===(n=t)||void 0===n?void 0:n.activityInfo)||void 0===r?void 0:r.activityId,gdMajorVersion:g}).api),m}}function i(e){if(v.appManager){var t=p("appManager",e.logger,v.appManager);return h(y=Dt({agm:e.agm,windows:b,logger:t,activities:m,mode:v.appManager.mode,gdMajorVersion:g})),y}}function o(e){var t;if(v.layouts){var n=p("layouts",e.logger,v.layouts),r=v.layouts,i=wn({agm:e.agm,appManager:y,activityGetter:function(){return m},logger:n,mode:r.mode,autoSaveWindowContext:(t=r.autoSaveWindowContext,null!==t&&void 0!==t&&t),gdMajorVersion:g});return h(i),i}}function a(e){if(v.channels&&e.contexts){var t=Pn(e.contexts,e.agm);return h(t),t}}function u(e){var t=function(e){var t=new An(e);return{register:t.register.bind(t),unregister:t.unregister.bind(t),unregisterAll:t.unregisterAll.bind(t),isRegistered:t.isRegistered.bind(t),ready:function(){return Promise.resolve()}}}(e.agm);return h(t),t}function c(e){var t=new Nn(e.agm,b,e.logger.subLogger("intents"));return h(t),t}function l(e){var t=new Mn(e.interop);return h(t),t}function d(e){if(v.displays){var t=p("displays",e.logger,v.displays);return h(w=new Sn(e.agm,t)),w}}function f(e){if(e.contexts){var t=function(e){var t=new jn(e);return{list:t.list.bind(t),getCurrent:t.getCurrent.bind(t),select:t.select.bind(t),onChanged:t.onChanged.bind(t),ready:function(){return Promise.resolve()}}}(e);return h(t),t}}function p(e,t,n){var r=t.subLogger(e);if(n&&n.logger){var i=n.logger;i.console&&r.consoleLevel(i.console),i.publish&&r.publishLevel(i.publish)}return r}function h(e){k.push(e)}var g,v,y,m,b,w,_,k,x,S;return s(this,(function(t){switch(t.label){case 0:return g=Ft.getGDMajorVersion(),v=En(e=e||{}),e.gateway=e.gateway||{},_={libs:[{name:"windows",create:n},{name:"activities",create:r},{name:"appManager",create:i},{name:"layouts",create:o},{name:"channels",create:a},{name:"hotkeys",create:u},{name:"displays",create:d},{name:"intents",create:c},{name:"notifications",create:l},{name:"themes",create:f}],version:"5.5.2",enrichGlue:function(e){e.config.activities=v.activities,e.config.windows=v.windows,e.config.appManager=v.appManager,e.config.layouts=v.layouts,e.config.channels=v.channels,e.config.displays=v.displays}},k=[],"undefined"!==typeof window&&(window.glueFactoryLog||(window.glueFactoryLog=[]),window.glueFactoryLog.push(k)),[4,Ke(e,_)];case 1:return x=t.sent(),Array.isArray(null===(S=e)||void 0===S?void 0:S.libraries)&&e.libraries.length?[4,Promise.all(e.libraries.map((function(t){return t(x,e)})))]:[3,3];case 2:t.sent(),t.label=3;case 3:return[2,x]}}))}))};Dn.coreVersion=Ke.version,Dn.version="5.5.2",Dn.initInfo=Rn;var Fn=Dn,Un=!0;if("undefined"!==typeof window){var Bn=window.glue42gd;Bn&&Bn.autoInjected&&(Fn=window.Glue,Un=!1),Un&&(window.Glue=Fn),delete window.GlueCore}return Fn.default=Fn,Fn}))}).call(this,n(13),n(18).Buffer,n(19))},function(e,t,n){"use strict";n(37),n(39),n(40),n(44),n(48);function r(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function o(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),e}n(49);function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e,t){if("function"!==typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}function u(e){return(u="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function l(e,t){return!t||"object"!==u(t)&&"function"!==typeof t?c(e):t}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var f=n(1),p=n.n(f);function h(e,t){if(e.length!==t.length)return!1;for(var n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}var g=function(e,t){var n;void 0===t&&(t=h);var r,i=[],o=!1;return function(){for(var a=[],s=0;s<arguments.length;s++)a[s]=arguments[s];return o&&n===this&&t(a,i)||(r=e.apply(this,a),o=!0,n=this,i=a),r}};var v=function(){function e(e){this.isSpeedy=void 0===e.speedy||e.speedy,this.tags=[],this.ctr=0,this.nonce=e.nonce,this.key=e.key,this.container=e.container,this.before=null}var t=e.prototype;return t.insert=function(e){if(this.ctr%(this.isSpeedy?65e3:1)===0){var t,n=function(e){var t=document.createElement("style");return t.setAttribute("data-emotion",e.key),void 0!==e.nonce&&t.setAttribute("nonce",e.nonce),t.appendChild(document.createTextNode("")),t}(this);t=0===this.tags.length?this.before:this.tags[this.tags.length-1].nextSibling,this.container.insertBefore(n,t),this.tags.push(n)}var r=this.tags[this.tags.length-1];if(this.isSpeedy){var i=function(e){if(e.sheet)return e.sheet;for(var t=0;t<document.styleSheets.length;t++)if(document.styleSheets[t].ownerNode===e)return document.styleSheets[t]}(r);try{var o=105===e.charCodeAt(1)&&64===e.charCodeAt(0);i.insertRule(e,o?0:i.cssRules.length)}catch(a){0}}else r.appendChild(document.createTextNode(e));this.ctr++},t.flush=function(){this.tags.forEach((function(e){return e.parentNode.removeChild(e)})),this.tags=[],this.ctr=0},e}();var y=function(e){function t(e,t,r){var i=t.trim().split(h);t=i;var o=i.length,a=e.length;switch(a){case 0:case 1:var s=0;for(e=0===a?"":e[0]+" ";s<o;++s)t[s]=n(e,t[s],r).trim();break;default:var u=s=0;for(t=[];s<o;++s)for(var c=0;c<a;++c)t[u++]=n(e[c]+" ",i[s],r).trim()}return t}function n(e,t,n){var r=t.charCodeAt(0);switch(33>r&&(r=(t=t.trim()).charCodeAt(0)),r){case 38:return t.replace(g,"$1"+e.trim());case 58:return e.trim()+t.replace(g,"$1"+e.trim());default:if(0<1*n&&0<t.indexOf("\f"))return t.replace(g,(58===e.charCodeAt(0)?"":"$1")+e.trim())}return e+t}function r(e,t,n,o){var a=e+";",s=2*t+3*n+4*o;if(944===s){e=a.indexOf(":",9)+1;var u=a.substring(e,a.length-1).trim();return u=a.substring(0,e).trim()+u+";",1===A||2===A&&i(u,1)?"-webkit-"+u+u:u}if(0===A||2===A&&!i(a,1))return a;switch(s){case 1015:return 97===a.charCodeAt(10)?"-webkit-"+a+a:a;case 951:return 116===a.charCodeAt(3)?"-webkit-"+a+a:a;case 963:return 110===a.charCodeAt(5)?"-webkit-"+a+a:a;case 1009:if(100!==a.charCodeAt(4))break;case 969:case 942:return"-webkit-"+a+a;case 978:return"-webkit-"+a+"-moz-"+a+a;case 1019:case 983:return"-webkit-"+a+"-moz-"+a+"-ms-"+a+a;case 883:if(45===a.charCodeAt(8))return"-webkit-"+a+a;if(0<a.indexOf("image-set(",11))return a.replace(I,"$1-webkit-$2")+a;break;case 932:if(45===a.charCodeAt(4))switch(a.charCodeAt(5)){case 103:return"-webkit-box-"+a.replace("-grow","")+"-webkit-"+a+"-ms-"+a.replace("grow","positive")+a;case 115:return"-webkit-"+a+"-ms-"+a.replace("shrink","negative")+a;case 98:return"-webkit-"+a+"-ms-"+a.replace("basis","preferred-size")+a}return"-webkit-"+a+"-ms-"+a+a;case 964:return"-webkit-"+a+"-ms-flex-"+a+a;case 1023:if(99!==a.charCodeAt(8))break;return"-webkit-box-pack"+(u=a.substring(a.indexOf(":",15)).replace("flex-","").replace("space-between","justify"))+"-webkit-"+a+"-ms-flex-pack"+u+a;case 1005:return f.test(a)?a.replace(d,":-webkit-")+a.replace(d,":-moz-")+a:a;case 1e3:switch(t=(u=a.substring(13).trim()).indexOf("-")+1,u.charCodeAt(0)+u.charCodeAt(t)){case 226:u=a.replace(b,"tb");break;case 232:u=a.replace(b,"tb-rl");break;case 220:u=a.replace(b,"lr");break;default:return a}return"-webkit-"+a+"-ms-"+u+a;case 1017:if(-1===a.indexOf("sticky",9))break;case 975:switch(t=(a=e).length-10,s=(u=(33===a.charCodeAt(t)?a.substring(0,t):a).substring(e.indexOf(":",7)+1).trim()).charCodeAt(0)+(0|u.charCodeAt(7))){case 203:if(111>u.charCodeAt(8))break;case 115:a=a.replace(u,"-webkit-"+u)+";"+a;break;case 207:case 102:a=a.replace(u,"-webkit-"+(102<s?"inline-":"")+"box")+";"+a.replace(u,"-webkit-"+u)+";"+a.replace(u,"-ms-"+u+"box")+";"+a}return a+";";case 938:if(45===a.charCodeAt(5))switch(a.charCodeAt(6)){case 105:return u=a.replace("-items",""),"-webkit-"+a+"-webkit-box-"+u+"-ms-flex-"+u+a;case 115:return"-webkit-"+a+"-ms-flex-item-"+a.replace(k,"")+a;default:return"-webkit-"+a+"-ms-flex-line-pack"+a.replace("align-content","").replace(k,"")+a}break;case 973:case 989:if(45!==a.charCodeAt(3)||122===a.charCodeAt(4))break;case 931:case 953:if(!0===S.test(e))return 115===(u=e.substring(e.indexOf(":")+1)).charCodeAt(0)?r(e.replace("stretch","fill-available"),t,n,o).replace(":fill-available",":stretch"):a.replace(u,"-webkit-"+u)+a.replace(u,"-moz-"+u.replace("fill-",""))+a;break;case 962:if(a="-webkit-"+a+(102===a.charCodeAt(5)?"-ms-"+a:"")+a,211===n+o&&105===a.charCodeAt(13)&&0<a.indexOf("transform",10))return a.substring(0,a.indexOf(";",27)+1).replace(p,"$1-webkit-$2")+a}return a}function i(e,t){var n=e.indexOf(1===t?":":"{"),r=e.substring(0,3!==t?n:10);return n=e.substring(n+1,e.length-1),j(2!==t?r:r.replace(x,"$1"),n,t)}function o(e,t){var n=r(t,t.charCodeAt(0),t.charCodeAt(1),t.charCodeAt(2));return n!==t+";"?n.replace(_," or ($1)").substring(4):"("+t+")"}function a(e,t,n,r,i,o,a,s,c,l){for(var d,f=0,p=t;f<M;++f)switch(d=O[f].call(u,e,p,n,r,i,o,a,s,c,l)){case void 0:case!1:case!0:case null:break;default:p=d}if(p!==t)return p}function s(e){return void 0!==(e=e.prefix)&&(j=null,e?"function"!==typeof e?A=1:(A=2,j=e):A=0),s}function u(e,n){var s=e;if(33>s.charCodeAt(0)&&(s=s.trim()),s=[s],0<M){var u=a(-1,n,s,s,T,C,0,0,0,0);void 0!==u&&"string"===typeof u&&(n=u)}var d=function e(n,s,u,d,f){for(var p,h,g,b,_,k=0,x=0,S=0,I=0,O=0,j=0,N=g=p=0,L=0,D=0,W=0,F=0,U=u.length,B=U-1,V="",H="",z="",q="";L<U;){if(h=u.charCodeAt(L),L===B&&0!==x+I+S+k&&(0!==x&&(h=47===x?10:47),I=S=k=0,U++,B++),0===x+I+S+k){if(L===B&&(0<D&&(V=V.replace(l,"")),0<V.trim().length)){switch(h){case 32:case 9:case 59:case 13:case 10:break;default:V+=u.charAt(L)}h=59}switch(h){case 123:for(p=(V=V.trim()).charCodeAt(0),g=1,F=++L;L<U;){switch(h=u.charCodeAt(L)){case 123:g++;break;case 125:g--;break;case 47:switch(h=u.charCodeAt(L+1)){case 42:case 47:e:{for(N=L+1;N<B;++N)switch(u.charCodeAt(N)){case 47:if(42===h&&42===u.charCodeAt(N-1)&&L+2!==N){L=N+1;break e}break;case 10:if(47===h){L=N+1;break e}}L=N}}break;case 91:h++;case 40:h++;case 34:case 39:for(;L++<B&&u.charCodeAt(L)!==h;);}if(0===g)break;L++}switch(g=u.substring(F,L),0===p&&(p=(V=V.replace(c,"").trim()).charCodeAt(0)),p){case 64:switch(0<D&&(V=V.replace(l,"")),h=V.charCodeAt(1)){case 100:case 109:case 115:case 45:D=s;break;default:D=E}if(F=(g=e(s,D,g,h,f+1)).length,0<M&&(_=a(3,g,D=t(E,V,W),s,T,C,F,h,f,d),V=D.join(""),void 0!==_&&0===(F=(g=_.trim()).length)&&(h=0,g="")),0<F)switch(h){case 115:V=V.replace(w,o);case 100:case 109:case 45:g=V+"{"+g+"}";break;case 107:g=(V=V.replace(v,"$1 $2"))+"{"+g+"}",g=1===A||2===A&&i("@"+g,3)?"@-webkit-"+g+"@"+g:"@"+g;break;default:g=V+g,112===d&&(H+=g,g="")}else g="";break;default:g=e(s,t(s,V,W),g,d,f+1)}z+=g,g=W=D=N=p=0,V="",h=u.charCodeAt(++L);break;case 125:case 59:if(1<(F=(V=(0<D?V.replace(l,""):V).trim()).length))switch(0===N&&(p=V.charCodeAt(0),45===p||96<p&&123>p)&&(F=(V=V.replace(" ",":")).length),0<M&&void 0!==(_=a(1,V,s,n,T,C,H.length,d,f,d))&&0===(F=(V=_.trim()).length)&&(V="\0\0"),p=V.charCodeAt(0),h=V.charCodeAt(1),p){case 0:break;case 64:if(105===h||99===h){q+=V+u.charAt(L);break}default:58!==V.charCodeAt(F-1)&&(H+=r(V,p,h,V.charCodeAt(2)))}W=D=N=p=0,V="",h=u.charCodeAt(++L)}}switch(h){case 13:case 10:47===x?x=0:0===1+p&&107!==d&&0<V.length&&(D=1,V+="\0"),0<M*R&&a(0,V,s,n,T,C,H.length,d,f,d),C=1,T++;break;case 59:case 125:if(0===x+I+S+k){C++;break}default:switch(C++,b=u.charAt(L),h){case 9:case 32:if(0===I+k+x)switch(O){case 44:case 58:case 9:case 32:b="";break;default:32!==h&&(b=" ")}break;case 0:b="\\0";break;case 12:b="\\f";break;case 11:b="\\v";break;case 38:0===I+x+k&&(D=W=1,b="\f"+b);break;case 108:if(0===I+x+k+P&&0<N)switch(L-N){case 2:112===O&&58===u.charCodeAt(L-3)&&(P=O);case 8:111===j&&(P=j)}break;case 58:0===I+x+k&&(N=L);break;case 44:0===x+S+I+k&&(D=1,b+="\r");break;case 34:case 39:0===x&&(I=I===h?0:0===I?h:I);break;case 91:0===I+x+S&&k++;break;case 93:0===I+x+S&&k--;break;case 41:0===I+x+k&&S--;break;case 40:if(0===I+x+k){if(0===p)switch(2*O+3*j){case 533:break;default:p=1}S++}break;case 64:0===x+S+I+k+N+g&&(g=1);break;case 42:case 47:if(!(0<I+k+S))switch(x){case 0:switch(2*h+3*u.charCodeAt(L+1)){case 235:x=47;break;case 220:F=L,x=42}break;case 42:47===h&&42===O&&F+2!==L&&(33===u.charCodeAt(F+2)&&(H+=u.substring(F,L+1)),b="",x=0)}}0===x&&(V+=b)}j=O,O=h,L++}if(0<(F=H.length)){if(D=s,0<M&&(void 0!==(_=a(2,H,D,n,T,C,F,d,f,d))&&0===(H=_).length))return q+H+z;if(H=D.join(",")+"{"+H+"}",0!==A*P){switch(2!==A||i(H,2)||(P=0),P){case 111:H=H.replace(m,":-moz-$1")+H;break;case 112:H=H.replace(y,"::-webkit-input-$1")+H.replace(y,"::-moz-$1")+H.replace(y,":-ms-input-$1")+H}P=0}}return q+H+z}(E,s,n,0,0);return 0<M&&(void 0!==(u=a(-2,d,s,s,T,C,d.length,0,0,0))&&(d=u)),"",P=0,C=T=1,d}var c=/^\0+/g,l=/[\0\r\f]/g,d=/: */g,f=/zoo|gra/,p=/([,: ])(transform)/g,h=/,\r+?/g,g=/([\t\r\n ])*\f?&/g,v=/@(k\w+)\s*(\S*)\s*/,y=/::(place)/g,m=/:(read-only)/g,b=/[svh]\w+-[tblr]{2}/,w=/\(\s*(.*)\s*\)/g,_=/([\s\S]*?);/g,k=/-self|flex-/g,x=/[^]*?(:[rp][el]a[\w-]+)[^]*/,S=/stretch|:\s*\w+\-(?:conte|avail)/,I=/([^-])(image-set\()/,C=1,T=1,P=0,A=1,E=[],O=[],M=0,j=null,R=0;return u.use=function e(t){switch(t){case void 0:case null:M=O.length=0;break;default:if("function"===typeof t)O[M++]=t;else if("object"===typeof t)for(var n=0,r=t.length;n<r;++n)e(t[n]);else R=0|!!t}return e},u.set=s,void 0!==e&&s(e),u};function m(e){e&&b.current.insert(e+"}")}var b={current:null},w=function(e,t,n,r,i,o,a,s,u,c){switch(e){case 1:switch(t.charCodeAt(0)){case 64:return b.current.insert(t+";"),"";case 108:if(98===t.charCodeAt(2))return""}break;case 2:if(0===s)return t+"/*|*/";break;case 3:switch(s){case 102:case 112:return b.current.insert(n[0]+t),"";default:return t+(0===c?"/*|*/":"")}case-2:t.split("/*|*/}").forEach(m)}},_=function(e){void 0===e&&(e={});var t,n=e.key||"css";void 0!==e.prefix&&(t={prefix:e.prefix});var r=new y(t);var i,o={};i=e.container||document.head;var a,s=document.querySelectorAll("style[data-emotion-"+n+"]");Array.prototype.forEach.call(s,(function(e){e.getAttribute("data-emotion-"+n).split(" ").forEach((function(e){o[e]=!0})),e.parentNode!==i&&i.appendChild(e)})),r.use(e.stylisPlugins)(w),a=function(e,t,n,i){var o=t.name;b.current=n,r(e,t.styles),i&&(u.inserted[o]=!0)};var u={key:n,sheet:new v({key:n,container:i,nonce:e.nonce,speedy:e.speedy}),nonce:e.nonce,inserted:o,registered:{},insert:a};return u};n(50);function k(e,t,n){var r="";return n.split(" ").forEach((function(n){void 0!==e[n]?t.push(e[n]):r+=n+" "})),r}var x=function(e,t,n){var r=e.key+"-"+t.name;if(!1===n&&void 0===e.registered[r]&&(e.registered[r]=t.styles),void 0===e.inserted[t.name]){var i=t;do{e.insert("."+r,i,e.sheet,!0);i=i.next}while(void 0!==i)}};var S=function(e){for(var t,n=0,r=0,i=e.length;i>=4;++r,i-=4)t=1540483477*(65535&(t=255&e.charCodeAt(r)|(255&e.charCodeAt(++r))<<8|(255&e.charCodeAt(++r))<<16|(255&e.charCodeAt(++r))<<24))+(59797*(t>>>16)<<16),n=1540483477*(65535&(t^=t>>>24))+(59797*(t>>>16)<<16)^1540483477*(65535&n)+(59797*(n>>>16)<<16);switch(i){case 3:n^=(255&e.charCodeAt(r+2))<<16;case 2:n^=(255&e.charCodeAt(r+1))<<8;case 1:n=1540483477*(65535&(n^=255&e.charCodeAt(r)))+(59797*(n>>>16)<<16)}return(((n=1540483477*(65535&(n^=n>>>13))+(59797*(n>>>16)<<16))^n>>>15)>>>0).toString(36)},I={animationIterationCount:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1};var C=/[A-Z]|^ms/g,T=/_EMO_([^_]+?)_([^]*?)_EMO_/g,P=function(e){return 45===e.charCodeAt(1)},A=function(e){return null!=e&&"boolean"!==typeof e},E=function(e){var t={};return function(n){return void 0===t[n]&&(t[n]=e(n)),t[n]}}((function(e){return P(e)?e:e.replace(C,"-$&").toLowerCase()})),O=function(e,t){switch(e){case"animation":case"animationName":if("string"===typeof t)return t.replace(T,(function(e,t,n){return j={name:t,styles:n,next:j},t}))}return 1===I[e]||P(e)||"number"!==typeof t||0===t?t:t+"px"};function M(e,t,n,r){if(null==n)return"";if(void 0!==n.__emotion_styles)return n;switch(typeof n){case"boolean":return"";case"object":if(1===n.anim)return j={name:n.name,styles:n.styles,next:j},n.name;if(void 0!==n.styles){var i=n.next;if(void 0!==i)for(;void 0!==i;)j={name:i.name,styles:i.styles,next:j},i=i.next;return n.styles+";"}return function(e,t,n){var r="";if(Array.isArray(n))for(var i=0;i<n.length;i++)r+=M(e,t,n[i],!1);else for(var o in n){var a=n[o];if("object"!==typeof a)null!=t&&void 0!==t[a]?r+=o+"{"+t[a]+"}":A(a)&&(r+=E(o)+":"+O(o,a)+";");else if(!Array.isArray(a)||"string"!==typeof a[0]||null!=t&&void 0!==t[a[0]]){var s=M(e,t,a,!1);switch(o){case"animation":case"animationName":r+=E(o)+":"+s+";";break;default:r+=o+"{"+s+"}"}}else for(var u=0;u<a.length;u++)A(a[u])&&(r+=E(o)+":"+O(o,a[u])+";")}return r}(e,t,n);case"function":if(void 0!==e){var o=j,a=n(e);return j=o,M(e,t,a,r)}break;case"string":}if(null==t)return n;var s=t[n];return void 0===s||r?n:s}var j,R=/label:\s*([^\s;\n{]+)\s*;/g;var N=function(e,t,n){if(1===e.length&&"object"===typeof e[0]&&null!==e[0]&&void 0!==e[0].styles)return e[0];var r=!0,i="";j=void 0;var o=e[0];null==o||void 0===o.raw?(r=!1,i+=M(n,t,o,!1)):i+=o[0];for(var a=1;a<e.length;a++)i+=M(n,t,e[a],46===i.charCodeAt(i.length-1)),r&&(i+=o[a]);R.lastIndex=0;for(var s,u="";null!==(s=R.exec(i));)u+="-"+s[1];return{name:S(i)+u,styles:i,next:j}},L=Object.prototype.hasOwnProperty,D=Object(f.createContext)("undefined"!==typeof HTMLElement?_():null),W=Object(f.createContext)({}),F=D.Provider,U=function(e){var t=function(t,n){return Object(f.createElement)(D.Consumer,null,(function(r){return e(t,r,n)}))};return Object(f.forwardRef)(t)},B="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",V=function(e,t){var n={};for(var r in t)L.call(t,r)&&(n[r]=t[r]);return n[B]=e,n},H=function(e,t,n,r){var i=null===n?t.css:t.css(n);"string"===typeof i&&void 0!==e.registered[i]&&(i=e.registered[i]);var o=t[B],a=[i],s="";"string"===typeof t.className?s=k(e.registered,a,t.className):null!=t.className&&(s=t.className+" ");var u=N(a);x(e,u,"string"===typeof o);s+=e.key+"-"+u.name;var c={};for(var l in t)L.call(t,l)&&"css"!==l&&l!==B&&(c[l]=t[l]);return c.ref=r,c.className=s,Object(f.createElement)(o,c)},z=U((function(e,t,n){return"function"===typeof e.css?Object(f.createElement)(W.Consumer,null,(function(r){return H(t,e,r,n)})):H(t,e,null,n)}));var q=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return N(t)},G=function(e,t){var n=arguments;if(null==t||!L.call(t,"css"))return f.createElement.apply(void 0,n);var r=n.length,i=new Array(r);i[0]=z,i[1]=V(e,t);for(var o=2;o<r;o++)i[o]=n[o];return f.createElement.apply(null,i)},J=(f.Component,function e(t){for(var n=t.length,r=0,i="";r<n;r++){var o=t[r];if(null!=o){var a=void 0;switch(typeof o){case"boolean":break;case"object":if(Array.isArray(o))a=e(o);else for(var s in a="",o)o[s]&&s&&(a&&(a+=" "),a+=s);break;default:a=o}a&&(i&&(i+=" "),i+=a)}}return i});function K(e,t,n){var r=[],i=k(e,r,n);return r.length<2?n:i+t(r)}var Y=U((function(e,t){return Object(f.createElement)(W.Consumer,null,(function(n){var r=function(){for(var e=arguments.length,n=new Array(e),r=0;r<e;r++)n[r]=arguments[r];var i=N(n,t.registered);return x(t,i,!1),t.key+"-"+i.name},i={css:r,cx:function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return K(t.registered,r,J(n))},theme:n},o=e.children(i);return!0,o}))})),$=n(7);n(51);function Q(e,t){if(null==e)return{};var n,r,i=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}function X(){return(X=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}).apply(this,arguments)}function Z(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function ee(e,t){if(e){if("string"===typeof e)return Z(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Z(e,t):void 0}}function te(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}(e,t)||ee(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function ne(e){return function(e){if(Array.isArray(e))return Z(e)}(e)||function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}(e)||ee(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function re(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var ie=n(14),oe=n.n(ie),ae=function(){};function se(e,t){return t?"-"===t[0]?e+t:e+"__"+t:e}function ue(e,t,n){var r=[n];if(t&&e)for(var i in t)t.hasOwnProperty(i)&&t[i]&&r.push("".concat(se(e,i)));return r.filter((function(e){return e})).map((function(e){return String(e).trim()})).join(" ")}var ce=function(e){return Array.isArray(e)?e.filter(Boolean):"object"===u(e)&&null!==e?[e]:[]};function le(e){return[document.documentElement,document.body,window].indexOf(e)>-1}function de(e){return le(e)?window.pageYOffset:e.scrollTop}function fe(e,t){le(e)?window.scrollTo(0,t):e.scrollTop=t}function pe(e,t,n,r){return n*((e=e/r-1)*e*e+1)+t}function he(e,t){var n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:200,r=arguments.length>3&&void 0!==arguments[3]?arguments[3]:ae,i=de(e),o=t-i,a=10,s=0;function u(){var t=pe(s+=a,i,o,n);fe(e,t),s<n?window.requestAnimationFrame(u):r(e)}u()}function ge(){try{return document.createEvent("TouchEvent"),!0}catch(e){return!1}}function ve(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function ye(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ve(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ve(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function me(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}function be(e){var t=e.maxHeight,n=e.menuEl,r=e.minHeight,i=e.placement,o=e.shouldScroll,a=e.isFixedPosition,s=e.theme.spacing,u=function(e){var t=getComputedStyle(e),n="absolute"===t.position,r=/(auto|scroll)/,i=document.documentElement;if("fixed"===t.position)return i;for(var o=e;o=o.parentElement;)if(t=getComputedStyle(o),(!n||"static"!==t.position)&&r.test(t.overflow+t.overflowY+t.overflowX))return o;return i}(n),c={placement:"bottom",maxHeight:t};if(!n||!n.offsetParent)return c;var l=u.getBoundingClientRect().height,d=n.getBoundingClientRect(),f=d.bottom,p=d.height,h=d.top,g=n.offsetParent.getBoundingClientRect().top,v=window.innerHeight,y=de(u),m=parseInt(getComputedStyle(n).marginBottom,10),b=parseInt(getComputedStyle(n).marginTop,10),w=g-b,_=v-h,k=w+y,x=l-y-h,S=f-v+y+m,I=y+h-b;switch(i){case"auto":case"bottom":if(_>=p)return{placement:"bottom",maxHeight:t};if(x>=p&&!a)return o&&he(u,S,160),{placement:"bottom",maxHeight:t};if(!a&&x>=r||a&&_>=r)return o&&he(u,S,160),{placement:"bottom",maxHeight:a?_-m:x-m};if("auto"===i||a){var C=t,T=a?w:k;return T>=r&&(C=Math.min(T-m-s.controlHeight,t)),{placement:"top",maxHeight:C}}if("bottom"===i)return fe(u,S),{placement:"bottom",maxHeight:t};break;case"top":if(w>=p)return{placement:"top",maxHeight:t};if(k>=p&&!a)return o&&he(u,I,160),{placement:"top",maxHeight:t};if(!a&&k>=r||a&&w>=r){var P=t;return(!a&&k>=r||a&&w>=r)&&(P=a?w-b:k-b),o&&he(u,I,160),{placement:"top",maxHeight:P}}return{placement:"bottom",maxHeight:t};default:throw new Error('Invalid placement provided "'.concat(i,'".'))}return c}var we=function(e){return"auto"===e?"bottom":e},_e=Object(f.createContext)({getPortalPlacement:null}),ke=function(e){s(n,e);var t=me(n);function n(){var e;r(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).state={maxHeight:e.props.maxMenuHeight,placement:null},e.getPlacement=function(t){var n=e.props,r=n.minMenuHeight,i=n.maxMenuHeight,o=n.menuPlacement,a=n.menuPosition,s=n.menuShouldScrollIntoView,u=n.theme;if(t){var c="fixed"===a,l=be({maxHeight:i,menuEl:t,minHeight:r,placement:o,shouldScroll:s&&!c,isFixedPosition:c,theme:u}),d=e.context.getPortalPlacement;d&&d(l),e.setState(l)}},e.getUpdatedProps=function(){var t=e.props.menuPlacement,n=e.state.placement||we(t);return ye(ye({},e.props),{},{placement:n,maxHeight:e.state.maxHeight})},e}return o(n,[{key:"render",value:function(){return(0,this.props.children)({ref:this.getPlacement,placerProps:this.getUpdatedProps()})}}]),n}(f.Component);ke.contextType=_e;var xe=function(e){var t=e.theme,n=t.spacing.baseUnit;return{color:t.colors.neutral40,padding:"".concat(2*n,"px ").concat(3*n,"px"),textAlign:"center"}},Se=xe,Ie=xe,Ce=function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.innerProps;return G("div",X({css:i("noOptionsMessage",e),className:r({"menu-notice":!0,"menu-notice--no-options":!0},n)},o),t)};Ce.defaultProps={children:"No options"};var Te=function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.innerProps;return G("div",X({css:i("loadingMessage",e),className:r({"menu-notice":!0,"menu-notice--loading":!0},n)},o),t)};Te.defaultProps={children:"Loading..."};var Pe=function(e){s(n,e);var t=me(n);function n(){var e;r(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).state={placement:null},e.getPortalPlacement=function(t){var n=t.placement;n!==we(e.props.menuPlacement)&&e.setState({placement:n})},e}return o(n,[{key:"render",value:function(){var e=this.props,t=e.appendTo,n=e.children,r=e.controlElement,i=e.menuPlacement,o=e.menuPosition,a=e.getStyles,s="fixed"===o;if(!t&&!s||!r)return null;var u=this.state.placement||we(i),c=function(e){var t=e.getBoundingClientRect();return{bottom:t.bottom,height:t.height,left:t.left,right:t.right,top:t.top,width:t.width}}(r),l=s?0:window.pageYOffset,d=c[u]+l,f=G("div",{css:a("menuPortal",{offset:d,position:o,rect:c})},n);return G(_e.Provider,{value:{getPortalPlacement:this.getPortalPlacement}},t?Object($.createPortal)(f,t):f)}}]),n}(f.Component),Ae=Array.isArray,Ee=Object.keys,Oe=Object.prototype.hasOwnProperty;function Me(e,t){try{return function e(t,n){if(t===n)return!0;if(t&&n&&"object"==u(t)&&"object"==u(n)){var r,i,o,a=Ae(t),s=Ae(n);if(a&&s){if((i=t.length)!=n.length)return!1;for(r=i;0!==r--;)if(!e(t[r],n[r]))return!1;return!0}if(a!=s)return!1;var c=t instanceof Date,l=n instanceof Date;if(c!=l)return!1;if(c&&l)return t.getTime()==n.getTime();var d=t instanceof RegExp,f=n instanceof RegExp;if(d!=f)return!1;if(d&&f)return t.toString()==n.toString();var p=Ee(t);if((i=p.length)!==Ee(n).length)return!1;for(r=i;0!==r--;)if(!Oe.call(n,p[r]))return!1;for(r=i;0!==r--;)if(("_owner"!==(o=p[r])||!t.$$typeof)&&!e(t[o],n[o]))return!1;return!0}return t!==t&&n!==n}(e,t)}catch(n){if(n.message&&n.message.match(/stack|recursion/i))return console.warn("Warning: react-fast-compare does not handle circular references.",n.name,n.message),!1;throw n}}function je(){var e,t,n=(e=["\n  0%, 80%, 100% { opacity: 0; }\n  40% { opacity: 1; }\n"],t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}})));return je=function(){return n},n}var Re={name:"19bqh2r",styles:"display:inline-block;fill:currentColor;line-height:1;stroke:currentColor;stroke-width:0;"},Ne=function(e){var t=e.size,n=Q(e,["size"]);return G("svg",X({height:t,width:t,viewBox:"0 0 20 20","aria-hidden":"true",focusable:"false",css:Re},n))},Le=function(e){return G(Ne,X({size:20},e),G("path",{d:"M14.348 14.849c-0.469 0.469-1.229 0.469-1.697 0l-2.651-3.030-2.651 3.029c-0.469 0.469-1.229 0.469-1.697 0-0.469-0.469-0.469-1.229 0-1.697l2.758-3.15-2.759-3.152c-0.469-0.469-0.469-1.228 0-1.697s1.228-0.469 1.697 0l2.652 3.031 2.651-3.031c0.469-0.469 1.228-0.469 1.697 0s0.469 1.229 0 1.697l-2.758 3.152 2.758 3.15c0.469 0.469 0.469 1.229 0 1.698z"}))},De=function(e){return G(Ne,X({size:20},e),G("path",{d:"M4.516 7.548c0.436-0.446 1.043-0.481 1.576 0l3.908 3.747 3.908-3.747c0.533-0.481 1.141-0.446 1.574 0 0.436 0.445 0.408 1.197 0 1.615-0.406 0.418-4.695 4.502-4.695 4.502-0.217 0.223-0.502 0.335-0.787 0.335s-0.57-0.112-0.789-0.335c0 0-4.287-4.084-4.695-4.502s-0.436-1.17 0-1.615z"}))},We=function(e){var t=e.isFocused,n=e.theme,r=n.spacing.baseUnit,i=n.colors;return{label:"indicatorContainer",color:t?i.neutral60:i.neutral20,display:"flex",padding:2*r,transition:"color 150ms",":hover":{color:t?i.neutral80:i.neutral40}}},Fe=We,Ue=We,Be=function(){var e=q.apply(void 0,arguments),t="animation-"+e.name;return{name:t,styles:"@keyframes "+t+"{"+e.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}(je()),Ve=function(e){var t=e.delay,n=e.offset;return G("span",{css:q({animation:"".concat(Be," 1s ease-in-out ").concat(t,"ms infinite;"),backgroundColor:"currentColor",borderRadius:"1em",display:"inline-block",marginLeft:n?"1em":null,height:"1em",verticalAlign:"top",width:"1em"},"")})},He=function(e){var t=e.className,n=e.cx,r=e.getStyles,i=e.innerProps,o=e.isRtl;return G("div",X({},i,{css:r("loadingIndicator",e),className:n({indicator:!0,"loading-indicator":!0},t)}),G(Ve,{delay:0,offset:o}),G(Ve,{delay:160,offset:!0}),G(Ve,{delay:320,offset:!o}))};He.defaultProps={size:4};function ze(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function qe(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?ze(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Ge(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Je(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ge(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Ke=function(e){return{label:"input",background:0,border:0,fontSize:"inherit",opacity:e?0:1,outline:0,padding:0,color:"inherit"}};function Ye(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function $e(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ye(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ye(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}var Qe=function(e){var t=e.children,n=e.innerProps;return G("div",n,t)},Xe=Qe,Ze=Qe;var et=function(e){var t=e.children,n=e.className,r=e.components,i=e.cx,o=e.data,a=e.getStyles,s=e.innerProps,u=e.isDisabled,c=e.removeProps,l=e.selectProps,d=r.Container,f=r.Label,p=r.Remove;return G(Y,null,(function(r){var h=r.css,g=r.cx;return G(d,{data:o,innerProps:$e($e({},s),{},{className:g(h(a("multiValue",e)),i({"multi-value":!0,"multi-value--is-disabled":u},n))}),selectProps:l},G(f,{data:o,innerProps:{className:g(h(a("multiValueLabel",e)),i({"multi-value__label":!0},n))},selectProps:l},t),G(p,{data:o,innerProps:$e({className:g(h(a("multiValueRemove",e)),i({"multi-value__remove":!0},n))},c),selectProps:l}))}))};et.defaultProps={cropWithEllipsis:!0};function tt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function nt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?tt(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):tt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}for(var rt={ClearIndicator:function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.innerProps;return G("div",X({},o,{css:i("clearIndicator",e),className:r({indicator:!0,"clear-indicator":!0},n)}),t||G(Le,null))},Control:function(e){var t=e.children,n=e.cx,r=e.getStyles,i=e.className,o=e.isDisabled,a=e.isFocused,s=e.innerRef,u=e.innerProps,c=e.menuIsOpen;return G("div",X({ref:s,css:r("control",e),className:n({control:!0,"control--is-disabled":o,"control--is-focused":a,"control--menu-is-open":c},i)},u),t)},DropdownIndicator:function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.innerProps;return G("div",X({},o,{css:i("dropdownIndicator",e),className:r({indicator:!0,"dropdown-indicator":!0},n)}),t||G(De,null))},DownChevron:De,CrossIcon:Le,Group:function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.Heading,a=e.headingProps,s=e.label,u=e.theme,c=e.selectProps;return G("div",{css:i("group",e),className:r({group:!0},n)},G(o,X({},a,{selectProps:c,theme:u,getStyles:i,cx:r}),s),G("div",null,t))},GroupHeading:function(e){var t=e.className,n=e.cx,r=e.getStyles,i=e.theme,o=(e.selectProps,Q(e,["className","cx","getStyles","theme","selectProps"]));return G("div",X({css:r("groupHeading",qe({theme:i},o)),className:n({"group-heading":!0},t)},o))},IndicatorsContainer:function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles;return G("div",{css:i("indicatorsContainer",e),className:r({indicators:!0},n)},t)},IndicatorSeparator:function(e){var t=e.className,n=e.cx,r=e.getStyles,i=e.innerProps;return G("span",X({},i,{css:r("indicatorSeparator",e),className:n({"indicator-separator":!0},t)}))},Input:function(e){var t=e.className,n=e.cx,r=e.getStyles,i=e.innerRef,o=e.isHidden,a=e.isDisabled,s=e.theme,u=(e.selectProps,Q(e,["className","cx","getStyles","innerRef","isHidden","isDisabled","theme","selectProps"]));return G("div",{css:r("input",Je({theme:s},u))},G(oe.a,X({className:n({input:!0},t),inputRef:i,inputStyle:Ke(o),disabled:a},u)))},LoadingIndicator:He,Menu:function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.innerRef,a=e.innerProps;return G("div",X({css:i("menu",e),className:r({menu:!0},n)},a,{ref:o}),t)},MenuList:function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.isMulti,a=e.innerRef,s=e.innerProps;return G("div",X({css:i("menuList",e),className:r({"menu-list":!0,"menu-list--is-multi":o},n),ref:a},s),t)},MenuPortal:Pe,LoadingMessage:Te,NoOptionsMessage:Ce,MultiValue:et,MultiValueContainer:Xe,MultiValueLabel:Ze,MultiValueRemove:function(e){var t=e.children,n=e.innerProps;return G("div",n,t||G(Le,{size:14}))},Option:function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.isDisabled,a=e.isFocused,s=e.isSelected,u=e.innerRef,c=e.innerProps;return G("div",X({css:i("option",e),className:r({option:!0,"option--is-disabled":o,"option--is-focused":a,"option--is-selected":s},n),ref:u},c),t)},Placeholder:function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.innerProps;return G("div",X({css:i("placeholder",e),className:r({placeholder:!0},n)},o),t)},SelectContainer:function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.innerProps,a=e.isDisabled,s=e.isRtl;return G("div",X({css:i("container",e),className:r({"--is-disabled":a,"--is-rtl":s},n)},o),t)},SingleValue:function(e){var t=e.children,n=e.className,r=e.cx,i=e.getStyles,o=e.isDisabled,a=e.innerProps;return G("div",X({css:i("singleValue",e),className:r({"single-value":!0,"single-value--is-disabled":o},n)},a),t)},ValueContainer:function(e){var t=e.children,n=e.className,r=e.cx,i=e.isMulti,o=e.getStyles,a=e.hasValue;return G("div",{css:o("valueContainer",e),className:r({"value-container":!0,"value-container--is-multi":i,"value-container--has-value":a},n)},t)}},it=[{base:"A",letters:"A\u24b6\uff21\xc0\xc1\xc2\u1ea6\u1ea4\u1eaa\u1ea8\xc3\u0100\u0102\u1eb0\u1eae\u1eb4\u1eb2\u0226\u01e0\xc4\u01de\u1ea2\xc5\u01fa\u01cd\u0200\u0202\u1ea0\u1eac\u1eb6\u1e00\u0104\u023a\u2c6f"},{base:"AA",letters:"\ua732"},{base:"AE",letters:"\xc6\u01fc\u01e2"},{base:"AO",letters:"\ua734"},{base:"AU",letters:"\ua736"},{base:"AV",letters:"\ua738\ua73a"},{base:"AY",letters:"\ua73c"},{base:"B",letters:"B\u24b7\uff22\u1e02\u1e04\u1e06\u0243\u0182\u0181"},{base:"C",letters:"C\u24b8\uff23\u0106\u0108\u010a\u010c\xc7\u1e08\u0187\u023b\ua73e"},{base:"D",letters:"D\u24b9\uff24\u1e0a\u010e\u1e0c\u1e10\u1e12\u1e0e\u0110\u018b\u018a\u0189\ua779"},{base:"DZ",letters:"\u01f1\u01c4"},{base:"Dz",letters:"\u01f2\u01c5"},{base:"E",letters:"E\u24ba\uff25\xc8\xc9\xca\u1ec0\u1ebe\u1ec4\u1ec2\u1ebc\u0112\u1e14\u1e16\u0114\u0116\xcb\u1eba\u011a\u0204\u0206\u1eb8\u1ec6\u0228\u1e1c\u0118\u1e18\u1e1a\u0190\u018e"},{base:"F",letters:"F\u24bb\uff26\u1e1e\u0191\ua77b"},{base:"G",letters:"G\u24bc\uff27\u01f4\u011c\u1e20\u011e\u0120\u01e6\u0122\u01e4\u0193\ua7a0\ua77d\ua77e"},{base:"H",letters:"H\u24bd\uff28\u0124\u1e22\u1e26\u021e\u1e24\u1e28\u1e2a\u0126\u2c67\u2c75\ua78d"},{base:"I",letters:"I\u24be\uff29\xcc\xcd\xce\u0128\u012a\u012c\u0130\xcf\u1e2e\u1ec8\u01cf\u0208\u020a\u1eca\u012e\u1e2c\u0197"},{base:"J",letters:"J\u24bf\uff2a\u0134\u0248"},{base:"K",letters:"K\u24c0\uff2b\u1e30\u01e8\u1e32\u0136\u1e34\u0198\u2c69\ua740\ua742\ua744\ua7a2"},{base:"L",letters:"L\u24c1\uff2c\u013f\u0139\u013d\u1e36\u1e38\u013b\u1e3c\u1e3a\u0141\u023d\u2c62\u2c60\ua748\ua746\ua780"},{base:"LJ",letters:"\u01c7"},{base:"Lj",letters:"\u01c8"},{base:"M",letters:"M\u24c2\uff2d\u1e3e\u1e40\u1e42\u2c6e\u019c"},{base:"N",letters:"N\u24c3\uff2e\u01f8\u0143\xd1\u1e44\u0147\u1e46\u0145\u1e4a\u1e48\u0220\u019d\ua790\ua7a4"},{base:"NJ",letters:"\u01ca"},{base:"Nj",letters:"\u01cb"},{base:"O",letters:"O\u24c4\uff2f\xd2\xd3\xd4\u1ed2\u1ed0\u1ed6\u1ed4\xd5\u1e4c\u022c\u1e4e\u014c\u1e50\u1e52\u014e\u022e\u0230\xd6\u022a\u1ece\u0150\u01d1\u020c\u020e\u01a0\u1edc\u1eda\u1ee0\u1ede\u1ee2\u1ecc\u1ed8\u01ea\u01ec\xd8\u01fe\u0186\u019f\ua74a\ua74c"},{base:"OI",letters:"\u01a2"},{base:"OO",letters:"\ua74e"},{base:"OU",letters:"\u0222"},{base:"P",letters:"P\u24c5\uff30\u1e54\u1e56\u01a4\u2c63\ua750\ua752\ua754"},{base:"Q",letters:"Q\u24c6\uff31\ua756\ua758\u024a"},{base:"R",letters:"R\u24c7\uff32\u0154\u1e58\u0158\u0210\u0212\u1e5a\u1e5c\u0156\u1e5e\u024c\u2c64\ua75a\ua7a6\ua782"},{base:"S",letters:"S\u24c8\uff33\u1e9e\u015a\u1e64\u015c\u1e60\u0160\u1e66\u1e62\u1e68\u0218\u015e\u2c7e\ua7a8\ua784"},{base:"T",letters:"T\u24c9\uff34\u1e6a\u0164\u1e6c\u021a\u0162\u1e70\u1e6e\u0166\u01ac\u01ae\u023e\ua786"},{base:"TZ",letters:"\ua728"},{base:"U",letters:"U\u24ca\uff35\xd9\xda\xdb\u0168\u1e78\u016a\u1e7a\u016c\xdc\u01db\u01d7\u01d5\u01d9\u1ee6\u016e\u0170\u01d3\u0214\u0216\u01af\u1eea\u1ee8\u1eee\u1eec\u1ef0\u1ee4\u1e72\u0172\u1e76\u1e74\u0244"},{base:"V",letters:"V\u24cb\uff36\u1e7c\u1e7e\u01b2\ua75e\u0245"},{base:"VY",letters:"\ua760"},{base:"W",letters:"W\u24cc\uff37\u1e80\u1e82\u0174\u1e86\u1e84\u1e88\u2c72"},{base:"X",letters:"X\u24cd\uff38\u1e8a\u1e8c"},{base:"Y",letters:"Y\u24ce\uff39\u1ef2\xdd\u0176\u1ef8\u0232\u1e8e\u0178\u1ef6\u1ef4\u01b3\u024e\u1efe"},{base:"Z",letters:"Z\u24cf\uff3a\u0179\u1e90\u017b\u017d\u1e92\u1e94\u01b5\u0224\u2c7f\u2c6b\ua762"},{base:"a",letters:"a\u24d0\uff41\u1e9a\xe0\xe1\xe2\u1ea7\u1ea5\u1eab\u1ea9\xe3\u0101\u0103\u1eb1\u1eaf\u1eb5\u1eb3\u0227\u01e1\xe4\u01df\u1ea3\xe5\u01fb\u01ce\u0201\u0203\u1ea1\u1ead\u1eb7\u1e01\u0105\u2c65\u0250"},{base:"aa",letters:"\ua733"},{base:"ae",letters:"\xe6\u01fd\u01e3"},{base:"ao",letters:"\ua735"},{base:"au",letters:"\ua737"},{base:"av",letters:"\ua739\ua73b"},{base:"ay",letters:"\ua73d"},{base:"b",letters:"b\u24d1\uff42\u1e03\u1e05\u1e07\u0180\u0183\u0253"},{base:"c",letters:"c\u24d2\uff43\u0107\u0109\u010b\u010d\xe7\u1e09\u0188\u023c\ua73f\u2184"},{base:"d",letters:"d\u24d3\uff44\u1e0b\u010f\u1e0d\u1e11\u1e13\u1e0f\u0111\u018c\u0256\u0257\ua77a"},{base:"dz",letters:"\u01f3\u01c6"},{base:"e",letters:"e\u24d4\uff45\xe8\xe9\xea\u1ec1\u1ebf\u1ec5\u1ec3\u1ebd\u0113\u1e15\u1e17\u0115\u0117\xeb\u1ebb\u011b\u0205\u0207\u1eb9\u1ec7\u0229\u1e1d\u0119\u1e19\u1e1b\u0247\u025b\u01dd"},{base:"f",letters:"f\u24d5\uff46\u1e1f\u0192\ua77c"},{base:"g",letters:"g\u24d6\uff47\u01f5\u011d\u1e21\u011f\u0121\u01e7\u0123\u01e5\u0260\ua7a1\u1d79\ua77f"},{base:"h",letters:"h\u24d7\uff48\u0125\u1e23\u1e27\u021f\u1e25\u1e29\u1e2b\u1e96\u0127\u2c68\u2c76\u0265"},{base:"hv",letters:"\u0195"},{base:"i",letters:"i\u24d8\uff49\xec\xed\xee\u0129\u012b\u012d\xef\u1e2f\u1ec9\u01d0\u0209\u020b\u1ecb\u012f\u1e2d\u0268\u0131"},{base:"j",letters:"j\u24d9\uff4a\u0135\u01f0\u0249"},{base:"k",letters:"k\u24da\uff4b\u1e31\u01e9\u1e33\u0137\u1e35\u0199\u2c6a\ua741\ua743\ua745\ua7a3"},{base:"l",letters:"l\u24db\uff4c\u0140\u013a\u013e\u1e37\u1e39\u013c\u1e3d\u1e3b\u017f\u0142\u019a\u026b\u2c61\ua749\ua781\ua747"},{base:"lj",letters:"\u01c9"},{base:"m",letters:"m\u24dc\uff4d\u1e3f\u1e41\u1e43\u0271\u026f"},{base:"n",letters:"n\u24dd\uff4e\u01f9\u0144\xf1\u1e45\u0148\u1e47\u0146\u1e4b\u1e49\u019e\u0272\u0149\ua791\ua7a5"},{base:"nj",letters:"\u01cc"},{base:"o",letters:"o\u24de\uff4f\xf2\xf3\xf4\u1ed3\u1ed1\u1ed7\u1ed5\xf5\u1e4d\u022d\u1e4f\u014d\u1e51\u1e53\u014f\u022f\u0231\xf6\u022b\u1ecf\u0151\u01d2\u020d\u020f\u01a1\u1edd\u1edb\u1ee1\u1edf\u1ee3\u1ecd\u1ed9\u01eb\u01ed\xf8\u01ff\u0254\ua74b\ua74d\u0275"},{base:"oi",letters:"\u01a3"},{base:"ou",letters:"\u0223"},{base:"oo",letters:"\ua74f"},{base:"p",letters:"p\u24df\uff50\u1e55\u1e57\u01a5\u1d7d\ua751\ua753\ua755"},{base:"q",letters:"q\u24e0\uff51\u024b\ua757\ua759"},{base:"r",letters:"r\u24e1\uff52\u0155\u1e59\u0159\u0211\u0213\u1e5b\u1e5d\u0157\u1e5f\u024d\u027d\ua75b\ua7a7\ua783"},{base:"s",letters:"s\u24e2\uff53\xdf\u015b\u1e65\u015d\u1e61\u0161\u1e67\u1e63\u1e69\u0219\u015f\u023f\ua7a9\ua785\u1e9b"},{base:"t",letters:"t\u24e3\uff54\u1e6b\u1e97\u0165\u1e6d\u021b\u0163\u1e71\u1e6f\u0167\u01ad\u0288\u2c66\ua787"},{base:"tz",letters:"\ua729"},{base:"u",letters:"u\u24e4\uff55\xf9\xfa\xfb\u0169\u1e79\u016b\u1e7b\u016d\xfc\u01dc\u01d8\u01d6\u01da\u1ee7\u016f\u0171\u01d4\u0215\u0217\u01b0\u1eeb\u1ee9\u1eef\u1eed\u1ef1\u1ee5\u1e73\u0173\u1e77\u1e75\u0289"},{base:"v",letters:"v\u24e5\uff56\u1e7d\u1e7f\u028b\ua75f\u028c"},{base:"vy",letters:"\ua761"},{base:"w",letters:"w\u24e6\uff57\u1e81\u1e83\u0175\u1e87\u1e85\u1e98\u1e89\u2c73"},{base:"x",letters:"x\u24e7\uff58\u1e8b\u1e8d"},{base:"y",letters:"y\u24e8\uff59\u1ef3\xfd\u0177\u1ef9\u0233\u1e8f\xff\u1ef7\u1e99\u1ef5\u01b4\u024f\u1eff"},{base:"z",letters:"z\u24e9\uff5a\u017a\u1e91\u017c\u017e\u1e93\u1e95\u01b6\u0225\u0240\u2c6c\ua763"}],ot=new RegExp("["+it.map((function(e){return e.letters})).join("")+"]","g"),at={},st=0;st<it.length;st++)for(var ut=it[st],ct=0;ct<ut.letters.length;ct++)at[ut.letters[ct]]=ut.base;var lt=function(e){return e.replace(ot,(function(e){return at[e]}))};function dt(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}var ft=function(e){return e.replace(/^\s+|\s+$/g,"")},pt=function(e){return"".concat(e.label," ").concat(e.value)};var ht={name:"1laao21-a11yText",styles:"label:a11yText;z-index:9999;border:0;clip:rect(1px, 1px, 1px, 1px);height:1px;width:1px;position:absolute;overflow:hidden;padding:0;white-space:nowrap;"},gt=function(e){return G("span",X({css:ht},e))};function vt(e){e.in,e.out,e.onExited,e.appear,e.enter,e.exit;var t=e.innerRef,n=(e.emotion,Q(e,["in","out","onExited","appear","enter","exit","innerRef","emotion"]));return G("input",X({ref:t},n,{css:q({label:"dummyInput",background:0,border:0,fontSize:"inherit",outline:0,padding:0,width:1,color:"transparent",left:-100,opacity:0,position:"relative",transform:"scale(0)"},"")}))}function yt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}var mt=function(e){s(n,e);var t=yt(n);function n(){return r(this,n),t.apply(this,arguments)}return o(n,[{key:"componentDidMount",value:function(){this.props.innerRef(Object($.findDOMNode)(this))}},{key:"componentWillUnmount",value:function(){this.props.innerRef(null)}},{key:"render",value:function(){return this.props.children}}]),n}(f.Component),bt=["boxSizing","height","overflow","paddingRight","position"],wt={boxSizing:"border-box",overflow:"hidden",position:"relative",height:"100%"};function _t(e){e.preventDefault()}function kt(e){e.stopPropagation()}function xt(){var e=this.scrollTop,t=this.scrollHeight,n=e+this.offsetHeight;0===e?this.scrollTop=1:n===t&&(this.scrollTop=e-1)}function St(){return"ontouchstart"in window||navigator.maxTouchPoints}function It(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}var Ct=!(!window.document||!window.document.createElement),Tt=0,Pt=function(e){s(n,e);var t=It(n);function n(){var e;r(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).originalStyles={},e.listenerOptions={capture:!1,passive:!1},e}return o(n,[{key:"componentDidMount",value:function(){var e=this;if(Ct){var t=this.props,n=t.accountForScrollbars,r=t.touchScrollTarget,i=document.body,o=i&&i.style;if(n&&bt.forEach((function(t){var n=o&&o[t];e.originalStyles[t]=n})),n&&Tt<1){var a=parseInt(this.originalStyles.paddingRight,10)||0,s=document.body?document.body.clientWidth:0,u=window.innerWidth-s+a||0;Object.keys(wt).forEach((function(e){var t=wt[e];o&&(o[e]=t)})),o&&(o.paddingRight="".concat(u,"px"))}i&&St()&&(i.addEventListener("touchmove",_t,this.listenerOptions),r&&(r.addEventListener("touchstart",xt,this.listenerOptions),r.addEventListener("touchmove",kt,this.listenerOptions))),Tt+=1}}},{key:"componentWillUnmount",value:function(){var e=this;if(Ct){var t=this.props,n=t.accountForScrollbars,r=t.touchScrollTarget,i=document.body,o=i&&i.style;Tt=Math.max(Tt-1,0),n&&Tt<1&&bt.forEach((function(t){var n=e.originalStyles[t];o&&(o[t]=n)})),i&&St()&&(i.removeEventListener("touchmove",_t,this.listenerOptions),r&&(r.removeEventListener("touchstart",xt,this.listenerOptions),r.removeEventListener("touchmove",kt,this.listenerOptions)))}}},{key:"render",value:function(){return null}}]),n}(f.Component);function At(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}Pt.defaultProps={accountForScrollbars:!0};var Et={name:"1dsbpcp",styles:"position:fixed;left:0;bottom:0;right:0;top:0;"},Ot=function(e){s(n,e);var t=At(n);function n(){var e;r(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).state={touchScrollTarget:null},e.getScrollTarget=function(t){t!==e.state.touchScrollTarget&&e.setState({touchScrollTarget:t})},e.blurSelectInput=function(){document.activeElement&&document.activeElement.blur()},e}return o(n,[{key:"render",value:function(){var e=this.props,t=e.children,n=e.isEnabled,r=this.state.touchScrollTarget;return n?G("div",null,G("div",{onClick:this.blurSelectInput,css:Et}),G(mt,{innerRef:this.getScrollTarget},t),r?G(Pt,{touchScrollTarget:r}):null):t}}]),n}(f.PureComponent);function Mt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}var jt=function(e){s(n,e);var t=Mt(n);function n(){var e;r(this,n);for(var i=arguments.length,o=new Array(i),a=0;a<i;a++)o[a]=arguments[a];return(e=t.call.apply(t,[this].concat(o))).isBottom=!1,e.isTop=!1,e.scrollTarget=void 0,e.touchStart=void 0,e.cancelScroll=function(e){e.preventDefault(),e.stopPropagation()},e.handleEventDelta=function(t,n){var r=e.props,i=r.onBottomArrive,o=r.onBottomLeave,a=r.onTopArrive,s=r.onTopLeave,u=e.scrollTarget,c=u.scrollTop,l=u.scrollHeight,d=u.clientHeight,f=e.scrollTarget,p=n>0,h=l-d-c,g=!1;h>n&&e.isBottom&&(o&&o(t),e.isBottom=!1),p&&e.isTop&&(s&&s(t),e.isTop=!1),p&&n>h?(i&&!e.isBottom&&i(t),f.scrollTop=l,g=!0,e.isBottom=!0):!p&&-n>c&&(a&&!e.isTop&&a(t),f.scrollTop=0,g=!0,e.isTop=!0),g&&e.cancelScroll(t)},e.onWheel=function(t){e.handleEventDelta(t,t.deltaY)},e.onTouchStart=function(t){e.touchStart=t.changedTouches[0].clientY},e.onTouchMove=function(t){var n=e.touchStart-t.changedTouches[0].clientY;e.handleEventDelta(t,n)},e.getScrollTarget=function(t){e.scrollTarget=t},e}return o(n,[{key:"componentDidMount",value:function(){this.startListening(this.scrollTarget)}},{key:"componentWillUnmount",value:function(){this.stopListening(this.scrollTarget)}},{key:"startListening",value:function(e){e&&("function"===typeof e.addEventListener&&e.addEventListener("wheel",this.onWheel,!1),"function"===typeof e.addEventListener&&e.addEventListener("touchstart",this.onTouchStart,!1),"function"===typeof e.addEventListener&&e.addEventListener("touchmove",this.onTouchMove,!1))}},{key:"stopListening",value:function(e){e&&("function"===typeof e.removeEventListener&&e.removeEventListener("wheel",this.onWheel,!1),"function"===typeof e.removeEventListener&&e.removeEventListener("touchstart",this.onTouchStart,!1),"function"===typeof e.removeEventListener&&e.removeEventListener("touchmove",this.onTouchMove,!1))}},{key:"render",value:function(){return p.a.createElement(mt,{innerRef:this.getScrollTarget},this.props.children)}}]),n}(f.Component);function Rt(e){var t=e.isEnabled,n=void 0===t||t,r=Q(e,["isEnabled"]);return n?p.a.createElement(jt,r):r.children}var Nt=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.isSearchable,r=t.isMulti,i=t.label,o=t.isDisabled,a=t.tabSelectsValue;switch(e){case"menu":return"Use Up and Down to choose options".concat(o?"":", press Enter to select the currently focused option",", press Escape to exit the menu").concat(a?", press Tab to select the option and exit the menu":"",".");case"input":return"".concat(i||"Select"," is focused ").concat(n?",type to refine list":"",", press Down to open the menu, ").concat(r?" press left to focus selected values":"");case"value":return"Use left and right to toggle between focused values, press Backspace to remove the currently focused value"}},Lt=function(e,t){var n=t.value,r=t.isDisabled;if(n)switch(e){case"deselect-option":case"pop-value":case"remove-value":return"option ".concat(n,", deselected.");case"select-option":return"option ".concat(n,r?" is disabled. Select another option.":", selected.")}},Dt=function(e){return!!e.isDisabled};var Wt={clearIndicator:Ue,container:function(e){var t=e.isDisabled;return{label:"container",direction:e.isRtl?"rtl":null,pointerEvents:t?"none":null,position:"relative"}},control:function(e){var t=e.isDisabled,n=e.isFocused,r=e.theme,i=r.colors,o=r.borderRadius,a=r.spacing;return{label:"control",alignItems:"center",backgroundColor:t?i.neutral5:i.neutral0,borderColor:t?i.neutral10:n?i.primary:i.neutral20,borderRadius:o,borderStyle:"solid",borderWidth:1,boxShadow:n?"0 0 0 1px ".concat(i.primary):null,cursor:"default",display:"flex",flexWrap:"wrap",justifyContent:"space-between",minHeight:a.controlHeight,outline:"0 !important",position:"relative",transition:"all 100ms","&:hover":{borderColor:n?i.primary:i.neutral30}}},dropdownIndicator:Fe,group:function(e){var t=e.theme.spacing;return{paddingBottom:2*t.baseUnit,paddingTop:2*t.baseUnit}},groupHeading:function(e){var t=e.theme.spacing;return{label:"group",color:"#999",cursor:"default",display:"block",fontSize:"75%",fontWeight:"500",marginBottom:"0.25em",paddingLeft:3*t.baseUnit,paddingRight:3*t.baseUnit,textTransform:"uppercase"}},indicatorsContainer:function(){return{alignItems:"center",alignSelf:"stretch",display:"flex",flexShrink:0}},indicatorSeparator:function(e){var t=e.isDisabled,n=e.theme,r=n.spacing.baseUnit,i=n.colors;return{label:"indicatorSeparator",alignSelf:"stretch",backgroundColor:t?i.neutral10:i.neutral20,marginBottom:2*r,marginTop:2*r,width:1}},input:function(e){var t=e.isDisabled,n=e.theme,r=n.spacing,i=n.colors;return{margin:r.baseUnit/2,paddingBottom:r.baseUnit/2,paddingTop:r.baseUnit/2,visibility:t?"hidden":"visible",color:i.neutral80}},loadingIndicator:function(e){var t=e.isFocused,n=e.size,r=e.theme,i=r.colors,o=r.spacing.baseUnit;return{label:"loadingIndicator",color:t?i.neutral60:i.neutral20,display:"flex",padding:2*o,transition:"color 150ms",alignSelf:"center",fontSize:n,lineHeight:1,marginRight:n,textAlign:"center",verticalAlign:"middle"}},loadingMessage:Ie,menu:function(e){var t,n=e.placement,r=e.theme,i=r.borderRadius,o=r.spacing,a=r.colors;return re(t={label:"menu"},function(e){return e?{bottom:"top",top:"bottom"}[e]:"bottom"}(n),"100%"),re(t,"backgroundColor",a.neutral0),re(t,"borderRadius",i),re(t,"boxShadow","0 0 0 1px hsla(0, 0%, 0%, 0.1), 0 4px 11px hsla(0, 0%, 0%, 0.1)"),re(t,"marginBottom",o.menuGutter),re(t,"marginTop",o.menuGutter),re(t,"position","absolute"),re(t,"width","100%"),re(t,"zIndex",1),t},menuList:function(e){var t=e.maxHeight,n=e.theme.spacing.baseUnit;return{maxHeight:t,overflowY:"auto",paddingBottom:n,paddingTop:n,position:"relative",WebkitOverflowScrolling:"touch"}},menuPortal:function(e){var t=e.rect,n=e.offset,r=e.position;return{left:t.left,position:r,top:n,width:t.width,zIndex:1}},multiValue:function(e){var t=e.theme,n=t.spacing,r=t.borderRadius;return{label:"multiValue",backgroundColor:t.colors.neutral10,borderRadius:r/2,display:"flex",margin:n.baseUnit/2,minWidth:0}},multiValueLabel:function(e){var t=e.theme,n=t.borderRadius,r=t.colors,i=e.cropWithEllipsis;return{borderRadius:n/2,color:r.neutral80,fontSize:"85%",overflow:"hidden",padding:3,paddingLeft:6,textOverflow:i?"ellipsis":null,whiteSpace:"nowrap"}},multiValueRemove:function(e){var t=e.theme,n=t.spacing,r=t.borderRadius,i=t.colors;return{alignItems:"center",borderRadius:r/2,backgroundColor:e.isFocused&&i.dangerLight,display:"flex",paddingLeft:n.baseUnit,paddingRight:n.baseUnit,":hover":{backgroundColor:i.dangerLight,color:i.danger}}},noOptionsMessage:Se,option:function(e){var t=e.isDisabled,n=e.isFocused,r=e.isSelected,i=e.theme,o=i.spacing,a=i.colors;return{label:"option",backgroundColor:r?a.primary:n?a.primary25:"transparent",color:t?a.neutral20:r?a.neutral0:"inherit",cursor:"default",display:"block",fontSize:"inherit",padding:"".concat(2*o.baseUnit,"px ").concat(3*o.baseUnit,"px"),width:"100%",userSelect:"none",WebkitTapHighlightColor:"rgba(0, 0, 0, 0)",":active":{backgroundColor:!t&&(r?a.primary:a.primary50)}}},placeholder:function(e){var t=e.theme,n=t.spacing;return{label:"placeholder",color:t.colors.neutral50,marginLeft:n.baseUnit/2,marginRight:n.baseUnit/2,position:"absolute",top:"50%",transform:"translateY(-50%)"}},singleValue:function(e){var t=e.isDisabled,n=e.theme,r=n.spacing,i=n.colors;return{label:"singleValue",color:t?i.neutral40:i.neutral80,marginLeft:r.baseUnit/2,marginRight:r.baseUnit/2,maxWidth:"calc(100% - ".concat(2*r.baseUnit,"px)"),overflow:"hidden",position:"absolute",textOverflow:"ellipsis",whiteSpace:"nowrap",top:"50%",transform:"translateY(-50%)"}},valueContainer:function(e){var t=e.theme.spacing;return{alignItems:"center",display:"flex",flex:1,flexWrap:"wrap",padding:"".concat(t.baseUnit/2,"px ").concat(2*t.baseUnit,"px"),WebkitOverflowScrolling:"touch",position:"relative",overflow:"hidden"}}};var Ft={borderRadius:4,colors:{primary:"#2684FF",primary75:"#4C9AFF",primary50:"#B2D4FF",primary25:"#DEEBFF",danger:"#DE350B",dangerLight:"#FFBDAD",neutral0:"hsl(0, 0%, 100%)",neutral5:"hsl(0, 0%, 95%)",neutral10:"hsl(0, 0%, 90%)",neutral20:"hsl(0, 0%, 80%)",neutral30:"hsl(0, 0%, 70%)",neutral40:"hsl(0, 0%, 60%)",neutral50:"hsl(0, 0%, 50%)",neutral60:"hsl(0, 0%, 40%)",neutral70:"hsl(0, 0%, 30%)",neutral80:"hsl(0, 0%, 20%)",neutral90:"hsl(0, 0%, 10%)"},spacing:{baseUnit:4,controlHeight:38,menuGutter:8}};function Ut(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function Bt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?Ut(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):Ut(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function Vt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}var Ht,zt={backspaceRemovesValue:!0,blurInputOnSelect:ge(),captureMenuScroll:!ge(),closeMenuOnSelect:!0,closeMenuOnScroll:!1,components:{},controlShouldRenderValue:!0,escapeClearsValue:!1,filterOption:function(e,t){var n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?dt(Object(n),!0).forEach((function(t){re(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):dt(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({ignoreCase:!0,ignoreAccents:!0,stringify:pt,trim:!0,matchFrom:"any"},Ht),r=n.ignoreCase,i=n.ignoreAccents,o=n.stringify,a=n.trim,s=n.matchFrom,u=a?ft(t):t,c=a?ft(o(e)):o(e);return r&&(u=u.toLowerCase(),c=c.toLowerCase()),i&&(u=lt(u),c=lt(c)),"start"===s?c.substr(0,u.length)===u:c.indexOf(u)>-1},formatGroupLabel:function(e){return e.label},getOptionLabel:function(e){return e.label},getOptionValue:function(e){return e.value},isDisabled:!1,isLoading:!1,isMulti:!1,isRtl:!1,isSearchable:!0,isOptionDisabled:Dt,loadingMessage:function(){return"Loading..."},maxMenuHeight:300,minMenuHeight:140,menuIsOpen:!1,menuPlacement:"bottom",menuPosition:"absolute",menuShouldBlockScroll:!1,menuShouldScrollIntoView:!function(){try{return/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)}catch(e){return!1}}(),noOptionsMessage:function(){return"No options"},openMenuOnFocus:!1,openMenuOnClick:!0,options:[],pageSize:5,placeholder:"Select...",screenReaderStatus:function(e){var t=e.count;return"".concat(t," result").concat(1!==t?"s":""," available")},styles:{},tabIndex:"0",tabSelectsValue:!0},qt=1,Gt=function(e){s(n,e);var t=Vt(n);function n(e){var i;r(this,n),(i=t.call(this,e)).state={ariaLiveSelection:"",ariaLiveContext:"",focusedOption:null,focusedValue:null,inputIsHidden:!1,isFocused:!1,menuOptions:{render:[],focusable:[]},selectValue:[]},i.blockOptionHover=!1,i.isComposing=!1,i.clearFocusValueOnUpdate=!1,i.commonProps=void 0,i.components=void 0,i.hasGroups=!1,i.initialTouchX=0,i.initialTouchY=0,i.inputIsHiddenAfterUpdate=void 0,i.instancePrefix="",i.openAfterFocus=!1,i.scrollToFocusedOptionOnUpdate=!1,i.userIsDragging=void 0,i.controlRef=null,i.getControlRef=function(e){i.controlRef=e},i.focusedOptionRef=null,i.getFocusedOptionRef=function(e){i.focusedOptionRef=e},i.menuListRef=null,i.getMenuListRef=function(e){i.menuListRef=e},i.inputRef=null,i.getInputRef=function(e){i.inputRef=e},i.cacheComponents=function(e){var t;i.components=(t={components:e},nt(nt({},rt),t.components))},i.focus=i.focusInput,i.blur=i.blurInput,i.onChange=function(e,t){var n=i.props,r=n.onChange,o=n.name;r(e,Bt(Bt({},t),{},{name:o}))},i.setValue=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"set-value",n=arguments.length>2?arguments[2]:void 0,r=i.props,o=r.closeMenuOnSelect,a=r.isMulti;i.onInputChange("",{action:"set-value"}),o&&(i.inputIsHiddenAfterUpdate=!a,i.onMenuClose()),i.clearFocusValueOnUpdate=!0,i.onChange(e,{action:t,option:n})},i.selectOption=function(e){var t=i.props,n=t.blurInputOnSelect,r=t.isMulti,o=i.state.selectValue;if(r)if(i.isOptionSelected(e,o)){var a=i.getOptionValue(e);i.setValue(o.filter((function(e){return i.getOptionValue(e)!==a})),"deselect-option",e),i.announceAriaLiveSelection({event:"deselect-option",context:{value:i.getOptionLabel(e)}})}else i.isOptionDisabled(e,o)?i.announceAriaLiveSelection({event:"select-option",context:{value:i.getOptionLabel(e),isDisabled:!0}}):(i.setValue([].concat(ne(o),[e]),"select-option",e),i.announceAriaLiveSelection({event:"select-option",context:{value:i.getOptionLabel(e)}}));else i.isOptionDisabled(e,o)?i.announceAriaLiveSelection({event:"select-option",context:{value:i.getOptionLabel(e),isDisabled:!0}}):(i.setValue(e,"select-option"),i.announceAriaLiveSelection({event:"select-option",context:{value:i.getOptionLabel(e)}}));n&&i.blurInput()},i.removeValue=function(e){var t=i.state.selectValue,n=i.getOptionValue(e),r=t.filter((function(e){return i.getOptionValue(e)!==n}));i.onChange(r.length?r:null,{action:"remove-value",removedValue:e}),i.announceAriaLiveSelection({event:"remove-value",context:{value:e?i.getOptionLabel(e):""}}),i.focusInput()},i.clearValue=function(){i.onChange(null,{action:"clear"})},i.popValue=function(){var e=i.state.selectValue,t=e[e.length-1],n=e.slice(0,e.length-1);i.announceAriaLiveSelection({event:"pop-value",context:{value:t?i.getOptionLabel(t):""}}),i.onChange(n.length?n:null,{action:"pop-value",removedValue:t})},i.getValue=function(){return i.state.selectValue},i.cx=function(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return ue.apply(void 0,[i.props.classNamePrefix].concat(t))},i.getOptionLabel=function(e){return i.props.getOptionLabel(e)},i.getOptionValue=function(e){return i.props.getOptionValue(e)},i.getStyles=function(e,t){var n=Wt[e](t);n.boxSizing="border-box";var r=i.props.styles[e];return r?r(n,t):n},i.getElementId=function(e){return"".concat(i.instancePrefix,"-").concat(e)},i.getActiveDescendentId=function(){var e=i.props.menuIsOpen,t=i.state,n=t.menuOptions,r=t.focusedOption;if(r&&e){var o=n.focusable.indexOf(r),a=n.render[o];return a&&a.key}},i.announceAriaLiveSelection=function(e){var t=e.event,n=e.context;i.setState({ariaLiveSelection:Lt(t,n)})},i.announceAriaLiveContext=function(e){var t=e.event,n=e.context;i.setState({ariaLiveContext:Nt(t,Bt(Bt({},n),{},{label:i.props["aria-label"]}))})},i.onMenuMouseDown=function(e){0===e.button&&(e.stopPropagation(),e.preventDefault(),i.focusInput())},i.onMenuMouseMove=function(e){i.blockOptionHover=!1},i.onControlMouseDown=function(e){var t=i.props.openMenuOnClick;i.state.isFocused?i.props.menuIsOpen?"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&i.onMenuClose():t&&i.openMenu("first"):(t&&(i.openAfterFocus=!0),i.focusInput()),"INPUT"!==e.target.tagName&&"TEXTAREA"!==e.target.tagName&&e.preventDefault()},i.onDropdownIndicatorMouseDown=function(e){if((!e||"mousedown"!==e.type||0===e.button)&&!i.props.isDisabled){var t=i.props,n=t.isMulti,r=t.menuIsOpen;i.focusInput(),r?(i.inputIsHiddenAfterUpdate=!n,i.onMenuClose()):i.openMenu("first"),e.preventDefault(),e.stopPropagation()}},i.onClearIndicatorMouseDown=function(e){e&&"mousedown"===e.type&&0!==e.button||(i.clearValue(),e.stopPropagation(),i.openAfterFocus=!1,"touchend"===e.type?i.focusInput():setTimeout((function(){return i.focusInput()})))},i.onScroll=function(e){"boolean"===typeof i.props.closeMenuOnScroll?e.target instanceof HTMLElement&&le(e.target)&&i.props.onMenuClose():"function"===typeof i.props.closeMenuOnScroll&&i.props.closeMenuOnScroll(e)&&i.props.onMenuClose()},i.onCompositionStart=function(){i.isComposing=!0},i.onCompositionEnd=function(){i.isComposing=!1},i.onTouchStart=function(e){var t=e.touches,n=t&&t.item(0);n&&(i.initialTouchX=n.clientX,i.initialTouchY=n.clientY,i.userIsDragging=!1)},i.onTouchMove=function(e){var t=e.touches,n=t&&t.item(0);if(n){var r=Math.abs(n.clientX-i.initialTouchX),o=Math.abs(n.clientY-i.initialTouchY);i.userIsDragging=r>5||o>5}},i.onTouchEnd=function(e){i.userIsDragging||(i.controlRef&&!i.controlRef.contains(e.target)&&i.menuListRef&&!i.menuListRef.contains(e.target)&&i.blurInput(),i.initialTouchX=0,i.initialTouchY=0)},i.onControlTouchEnd=function(e){i.userIsDragging||i.onControlMouseDown(e)},i.onClearIndicatorTouchEnd=function(e){i.userIsDragging||i.onClearIndicatorMouseDown(e)},i.onDropdownIndicatorTouchEnd=function(e){i.userIsDragging||i.onDropdownIndicatorMouseDown(e)},i.handleInputChange=function(e){var t=e.currentTarget.value;i.inputIsHiddenAfterUpdate=!1,i.onInputChange(t,{action:"input-change"}),i.props.menuIsOpen||i.onMenuOpen()},i.onInputFocus=function(e){var t=i.props,n=t.isSearchable,r=t.isMulti;i.props.onFocus&&i.props.onFocus(e),i.inputIsHiddenAfterUpdate=!1,i.announceAriaLiveContext({event:"input",context:{isSearchable:n,isMulti:r}}),i.setState({isFocused:!0}),(i.openAfterFocus||i.props.openMenuOnFocus)&&i.openMenu("first"),i.openAfterFocus=!1},i.onInputBlur=function(e){i.menuListRef&&i.menuListRef.contains(document.activeElement)?i.inputRef.focus():(i.props.onBlur&&i.props.onBlur(e),i.onInputChange("",{action:"input-blur"}),i.onMenuClose(),i.setState({focusedValue:null,isFocused:!1}))},i.onOptionHover=function(e){i.blockOptionHover||i.state.focusedOption===e||i.setState({focusedOption:e})},i.shouldHideSelectedOptions=function(){var e=i.props,t=e.hideSelectedOptions,n=e.isMulti;return void 0===t?n:t},i.onKeyDown=function(e){var t=i.props,n=t.isMulti,r=t.backspaceRemovesValue,o=t.escapeClearsValue,a=t.inputValue,s=t.isClearable,u=t.isDisabled,c=t.menuIsOpen,l=t.onKeyDown,d=t.tabSelectsValue,f=t.openMenuOnFocus,p=i.state,h=p.focusedOption,g=p.focusedValue,v=p.selectValue;if(!u&&("function"!==typeof l||(l(e),!e.defaultPrevented))){switch(i.blockOptionHover=!0,e.key){case"ArrowLeft":if(!n||a)return;i.focusValue("previous");break;case"ArrowRight":if(!n||a)return;i.focusValue("next");break;case"Delete":case"Backspace":if(a)return;if(g)i.removeValue(g);else{if(!r)return;n?i.popValue():s&&i.clearValue()}break;case"Tab":if(i.isComposing)return;if(e.shiftKey||!c||!d||!h||f&&i.isOptionSelected(h,v))return;i.selectOption(h);break;case"Enter":if(229===e.keyCode)break;if(c){if(!h)return;if(i.isComposing)return;i.selectOption(h);break}return;case"Escape":c?(i.inputIsHiddenAfterUpdate=!1,i.onInputChange("",{action:"menu-close"}),i.onMenuClose()):s&&o&&i.clearValue();break;case" ":if(a)return;if(!c){i.openMenu("first");break}if(!h)return;i.selectOption(h);break;case"ArrowUp":c?i.focusOption("up"):i.openMenu("last");break;case"ArrowDown":c?i.focusOption("down"):i.openMenu("first");break;case"PageUp":if(!c)return;i.focusOption("pageup");break;case"PageDown":if(!c)return;i.focusOption("pagedown");break;case"Home":if(!c)return;i.focusOption("first");break;case"End":if(!c)return;i.focusOption("last");break;default:return}e.preventDefault()}},i.buildMenuOptions=function(e,t){var n=e.inputValue,r=void 0===n?"":n,o=e.options,a=function(e,n){var o=i.isOptionDisabled(e,t),a=i.isOptionSelected(e,t),s=i.getOptionLabel(e),u=i.getOptionValue(e);if(!(i.shouldHideSelectedOptions()&&a||!i.filterOption({label:s,value:u,data:e},r))){var c=o?void 0:function(){return i.onOptionHover(e)},l=o?void 0:function(){return i.selectOption(e)},d="".concat(i.getElementId("option"),"-").concat(n);return{innerProps:{id:d,onClick:l,onMouseMove:c,onMouseOver:c,tabIndex:-1},data:e,isDisabled:o,isSelected:a,key:d,label:s,type:"option",value:u}}};return o.reduce((function(e,t,n){if(t.options){i.hasGroups||(i.hasGroups=!0);var r=t.options.map((function(t,r){var i=a(t,"".concat(n,"-").concat(r));return i&&e.focusable.push(t),i})).filter(Boolean);if(r.length){var o="".concat(i.getElementId("group"),"-").concat(n);e.render.push({type:"group",key:o,data:t,options:r})}}else{var s=a(t,"".concat(n));s&&(e.render.push(s),e.focusable.push(t))}return e}),{render:[],focusable:[]})};var o=e.value;i.cacheComponents=g(i.cacheComponents,Me).bind(c(i)),i.cacheComponents(e.components),i.instancePrefix="react-select-"+(i.props.instanceId||++qt);var a=ce(o);i.buildMenuOptions=g(i.buildMenuOptions,(function(e,t){var n=te(e,2),r=n[0],i=n[1],o=te(t,2),a=o[0];return i===o[1]&&r.inputValue===a.inputValue&&r.options===a.options})).bind(c(i));var s=e.menuIsOpen?i.buildMenuOptions(e,a):{render:[],focusable:[]};return i.state.menuOptions=s,i.state.selectValue=a,i}return o(n,[{key:"componentDidMount",value:function(){this.startListeningComposition(),this.startListeningToTouch(),this.props.closeMenuOnScroll&&document&&document.addEventListener&&document.addEventListener("scroll",this.onScroll,!0),this.props.autoFocus&&this.focusInput()}},{key:"UNSAFE_componentWillReceiveProps",value:function(e){var t=this.props,n=t.options,r=t.value,i=t.menuIsOpen,o=t.inputValue;if(this.cacheComponents(e.components),e.value!==r||e.options!==n||e.menuIsOpen!==i||e.inputValue!==o){var a=ce(e.value),s=e.menuIsOpen?this.buildMenuOptions(e,a):{render:[],focusable:[]},u=this.getNextFocusedValue(a),c=this.getNextFocusedOption(s.focusable);this.setState({menuOptions:s,selectValue:a,focusedOption:c,focusedValue:u})}null!=this.inputIsHiddenAfterUpdate&&(this.setState({inputIsHidden:this.inputIsHiddenAfterUpdate}),delete this.inputIsHiddenAfterUpdate)}},{key:"componentDidUpdate",value:function(e){var t=this.props,n=t.isDisabled,r=t.menuIsOpen,i=this.state.isFocused;(i&&!n&&e.isDisabled||i&&r&&!e.menuIsOpen)&&this.focusInput(),i&&n&&!e.isDisabled&&this.setState({isFocused:!1},this.onMenuClose),this.menuListRef&&this.focusedOptionRef&&this.scrollToFocusedOptionOnUpdate&&(!function(e,t){var n=e.getBoundingClientRect(),r=t.getBoundingClientRect(),i=t.offsetHeight/3;r.bottom+i>n.bottom?fe(e,Math.min(t.offsetTop+t.clientHeight-e.offsetHeight+i,e.scrollHeight)):r.top-i<n.top&&fe(e,Math.max(t.offsetTop-i,0))}(this.menuListRef,this.focusedOptionRef),this.scrollToFocusedOptionOnUpdate=!1)}},{key:"componentWillUnmount",value:function(){this.stopListeningComposition(),this.stopListeningToTouch(),document.removeEventListener("scroll",this.onScroll,!0)}},{key:"onMenuOpen",value:function(){this.props.onMenuOpen()}},{key:"onMenuClose",value:function(){var e=this.props,t=e.isSearchable,n=e.isMulti;this.announceAriaLiveContext({event:"input",context:{isSearchable:t,isMulti:n}}),this.onInputChange("",{action:"menu-close"}),this.props.onMenuClose()}},{key:"onInputChange",value:function(e,t){this.props.onInputChange(e,t)}},{key:"focusInput",value:function(){this.inputRef&&this.inputRef.focus()}},{key:"blurInput",value:function(){this.inputRef&&this.inputRef.blur()}},{key:"openMenu",value:function(e){var t=this,n=this.state,r=n.selectValue,i=n.isFocused,o=this.buildMenuOptions(this.props,r),a=this.props,s=a.isMulti,u=a.tabSelectsValue,c="first"===e?0:o.focusable.length-1;if(!s){var l=o.focusable.indexOf(r[0]);l>-1&&(c=l)}this.scrollToFocusedOptionOnUpdate=!(i&&this.menuListRef),this.inputIsHiddenAfterUpdate=!1,this.setState({menuOptions:o,focusedValue:null,focusedOption:o.focusable[c]},(function(){t.onMenuOpen(),t.announceAriaLiveContext({event:"menu",context:{tabSelectsValue:u}})}))}},{key:"focusValue",value:function(e){var t=this.props,n=t.isMulti,r=t.isSearchable,i=this.state,o=i.selectValue,a=i.focusedValue;if(n){this.setState({focusedOption:null});var s=o.indexOf(a);a||(s=-1,this.announceAriaLiveContext({event:"value"}));var u=o.length-1,c=-1;if(o.length){switch(e){case"previous":c=0===s?0:-1===s?u:s-1;break;case"next":s>-1&&s<u&&(c=s+1)}-1===c&&this.announceAriaLiveContext({event:"input",context:{isSearchable:r,isMulti:n}}),this.setState({inputIsHidden:-1!==c,focusedValue:o[c]})}}}},{key:"focusOption",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"first",t=this.props,n=t.pageSize,r=t.tabSelectsValue,i=this.state,o=i.focusedOption,a=i.menuOptions,s=a.focusable;if(s.length){var u=0,c=s.indexOf(o);o||(c=-1,this.announceAriaLiveContext({event:"menu",context:{tabSelectsValue:r}})),"up"===e?u=c>0?c-1:s.length-1:"down"===e?u=(c+1)%s.length:"pageup"===e?(u=c-n)<0&&(u=0):"pagedown"===e?(u=c+n)>s.length-1&&(u=s.length-1):"last"===e&&(u=s.length-1),this.scrollToFocusedOptionOnUpdate=!0,this.setState({focusedOption:s[u],focusedValue:null}),this.announceAriaLiveContext({event:"menu",context:{isDisabled:Dt(s[u]),tabSelectsValue:r}})}}},{key:"getTheme",value:function(){return this.props.theme?"function"===typeof this.props.theme?this.props.theme(Ft):Bt(Bt({},Ft),this.props.theme):Ft}},{key:"getCommonProps",value:function(){var e=this.clearValue,t=this.cx,n=this.getStyles,r=this.getValue,i=this.setValue,o=this.selectOption,a=this.props,s=a.isMulti,u=a.isRtl,c=a.options;return{cx:t,clearValue:e,getStyles:n,getValue:r,hasValue:this.hasValue(),isMulti:s,isRtl:u,options:c,selectOption:o,setValue:i,selectProps:a,theme:this.getTheme()}}},{key:"getNextFocusedValue",value:function(e){if(this.clearFocusValueOnUpdate)return this.clearFocusValueOnUpdate=!1,null;var t=this.state,n=t.focusedValue,r=t.selectValue.indexOf(n);if(r>-1){if(e.indexOf(n)>-1)return n;if(r<e.length)return e[r]}return null}},{key:"getNextFocusedOption",value:function(e){var t=this.state.focusedOption;return t&&e.indexOf(t)>-1?t:e[0]}},{key:"hasValue",value:function(){return this.state.selectValue.length>0}},{key:"hasOptions",value:function(){return!!this.state.menuOptions.render.length}},{key:"countOptions",value:function(){return this.state.menuOptions.focusable.length}},{key:"isClearable",value:function(){var e=this.props,t=e.isClearable,n=e.isMulti;return void 0===t?n:t}},{key:"isOptionDisabled",value:function(e,t){return"function"===typeof this.props.isOptionDisabled&&this.props.isOptionDisabled(e,t)}},{key:"isOptionSelected",value:function(e,t){var n=this;if(t.indexOf(e)>-1)return!0;if("function"===typeof this.props.isOptionSelected)return this.props.isOptionSelected(e,t);var r=this.getOptionValue(e);return t.some((function(e){return n.getOptionValue(e)===r}))}},{key:"filterOption",value:function(e,t){return!this.props.filterOption||this.props.filterOption(e,t)}},{key:"formatOptionLabel",value:function(e,t){if("function"===typeof this.props.formatOptionLabel){var n=this.props.inputValue,r=this.state.selectValue;return this.props.formatOptionLabel(e,{context:t,inputValue:n,selectValue:r})}return this.getOptionLabel(e)}},{key:"formatGroupLabel",value:function(e){return this.props.formatGroupLabel(e)}},{key:"startListeningComposition",value:function(){document&&document.addEventListener&&(document.addEventListener("compositionstart",this.onCompositionStart,!1),document.addEventListener("compositionend",this.onCompositionEnd,!1))}},{key:"stopListeningComposition",value:function(){document&&document.removeEventListener&&(document.removeEventListener("compositionstart",this.onCompositionStart),document.removeEventListener("compositionend",this.onCompositionEnd))}},{key:"startListeningToTouch",value:function(){document&&document.addEventListener&&(document.addEventListener("touchstart",this.onTouchStart,!1),document.addEventListener("touchmove",this.onTouchMove,!1),document.addEventListener("touchend",this.onTouchEnd,!1))}},{key:"stopListeningToTouch",value:function(){document&&document.removeEventListener&&(document.removeEventListener("touchstart",this.onTouchStart),document.removeEventListener("touchmove",this.onTouchMove),document.removeEventListener("touchend",this.onTouchEnd))}},{key:"constructAriaLiveMessage",value:function(){var e=this.state,t=e.ariaLiveContext,n=e.selectValue,r=e.focusedValue,i=e.focusedOption,o=this.props,a=o.options,s=o.menuIsOpen,u=o.inputValue,c=o.screenReaderStatus,l=r?function(e){var t=e.focusedValue,n=e.getOptionLabel,r=e.selectValue;return"value ".concat(n(t)," focused, ").concat(r.indexOf(t)+1," of ").concat(r.length,".")}({focusedValue:r,getOptionLabel:this.getOptionLabel,selectValue:n}):"",d=i&&s?function(e){var t=e.focusedOption,n=e.getOptionLabel,r=e.options;return"option ".concat(n(t)," focused").concat(t.isDisabled?" disabled":"",", ").concat(r.indexOf(t)+1," of ").concat(r.length,".")}({focusedOption:i,getOptionLabel:this.getOptionLabel,options:a}):"",f=function(e){var t=e.inputValue,n=e.screenReaderMessage;return"".concat(n).concat(t?" for search term "+t:"",".")}({inputValue:u,screenReaderMessage:c({count:this.countOptions()})});return"".concat(l," ").concat(d," ").concat(f," ").concat(t)}},{key:"renderInput",value:function(){var e=this.props,t=e.isDisabled,n=e.isSearchable,r=e.inputId,i=e.inputValue,o=e.tabIndex,a=e.form,s=this.components.Input,u=this.state.inputIsHidden,c=r||this.getElementId("input"),l={"aria-autocomplete":"list","aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"]};if(!n)return p.a.createElement(vt,X({id:c,innerRef:this.getInputRef,onBlur:this.onInputBlur,onChange:ae,onFocus:this.onInputFocus,readOnly:!0,disabled:t,tabIndex:o,form:a,value:""},l));var d=this.commonProps,f=d.cx,h=d.theme,g=d.selectProps;return p.a.createElement(s,X({autoCapitalize:"none",autoComplete:"off",autoCorrect:"off",cx:f,getStyles:this.getStyles,id:c,innerRef:this.getInputRef,isDisabled:t,isHidden:u,onBlur:this.onInputBlur,onChange:this.handleInputChange,onFocus:this.onInputFocus,selectProps:g,spellCheck:"false",tabIndex:o,form:a,theme:h,type:"text",value:i},l))}},{key:"renderPlaceholderOrValue",value:function(){var e=this,t=this.components,n=t.MultiValue,r=t.MultiValueContainer,i=t.MultiValueLabel,o=t.MultiValueRemove,a=t.SingleValue,s=t.Placeholder,u=this.commonProps,c=this.props,l=c.controlShouldRenderValue,d=c.isDisabled,f=c.isMulti,h=c.inputValue,g=c.placeholder,v=this.state,y=v.selectValue,m=v.focusedValue,b=v.isFocused;if(!this.hasValue()||!l)return h?null:p.a.createElement(s,X({},u,{key:"placeholder",isDisabled:d,isFocused:b}),g);if(f)return y.map((function(t,a){var s=t===m;return p.a.createElement(n,X({},u,{components:{Container:r,Label:i,Remove:o},isFocused:s,isDisabled:d,key:"".concat(e.getOptionValue(t)).concat(a),index:a,removeProps:{onClick:function(){return e.removeValue(t)},onTouchEnd:function(){return e.removeValue(t)},onMouseDown:function(e){e.preventDefault(),e.stopPropagation()}},data:t}),e.formatOptionLabel(t,"value"))}));if(h)return null;var w=y[0];return p.a.createElement(a,X({},u,{data:w,isDisabled:d}),this.formatOptionLabel(w,"value"))}},{key:"renderClearIndicator",value:function(){var e=this.components.ClearIndicator,t=this.commonProps,n=this.props,r=n.isDisabled,i=n.isLoading,o=this.state.isFocused;if(!this.isClearable()||!e||r||!this.hasValue()||i)return null;var a={onMouseDown:this.onClearIndicatorMouseDown,onTouchEnd:this.onClearIndicatorTouchEnd,"aria-hidden":"true"};return p.a.createElement(e,X({},t,{innerProps:a,isFocused:o}))}},{key:"renderLoadingIndicator",value:function(){var e=this.components.LoadingIndicator,t=this.commonProps,n=this.props,r=n.isDisabled,i=n.isLoading,o=this.state.isFocused;if(!e||!i)return null;return p.a.createElement(e,X({},t,{innerProps:{"aria-hidden":"true"},isDisabled:r,isFocused:o}))}},{key:"renderIndicatorSeparator",value:function(){var e=this.components,t=e.DropdownIndicator,n=e.IndicatorSeparator;if(!t||!n)return null;var r=this.commonProps,i=this.props.isDisabled,o=this.state.isFocused;return p.a.createElement(n,X({},r,{isDisabled:i,isFocused:o}))}},{key:"renderDropdownIndicator",value:function(){var e=this.components.DropdownIndicator;if(!e)return null;var t=this.commonProps,n=this.props.isDisabled,r=this.state.isFocused,i={onMouseDown:this.onDropdownIndicatorMouseDown,onTouchEnd:this.onDropdownIndicatorTouchEnd,"aria-hidden":"true"};return p.a.createElement(e,X({},t,{innerProps:i,isDisabled:n,isFocused:r}))}},{key:"renderMenu",value:function(){var e=this,t=this.components,n=t.Group,r=t.GroupHeading,i=t.Menu,o=t.MenuList,a=t.MenuPortal,s=t.LoadingMessage,u=t.NoOptionsMessage,c=t.Option,l=this.commonProps,d=this.state,f=d.focusedOption,h=d.menuOptions,g=this.props,v=g.captureMenuScroll,y=g.inputValue,m=g.isLoading,b=g.loadingMessage,w=g.minMenuHeight,_=g.maxMenuHeight,k=g.menuIsOpen,x=g.menuPlacement,S=g.menuPosition,I=g.menuPortalTarget,C=g.menuShouldBlockScroll,T=g.menuShouldScrollIntoView,P=g.noOptionsMessage,A=g.onMenuScrollToTop,E=g.onMenuScrollToBottom;if(!k)return null;var O,M=function(t){var n=f===t.data;return t.innerRef=n?e.getFocusedOptionRef:void 0,p.a.createElement(c,X({},l,t,{isFocused:n}),e.formatOptionLabel(t.data,"menu"))};if(this.hasOptions())O=h.render.map((function(t){if("group"===t.type){t.type;var i=Q(t,["type"]),o="".concat(t.key,"-heading");return p.a.createElement(n,X({},l,i,{Heading:r,headingProps:{id:o,data:t.data},label:e.formatGroupLabel(t.data)}),t.options.map((function(e){return M(e)})))}if("option"===t.type)return M(t)}));else if(m){var j=b({inputValue:y});if(null===j)return null;O=p.a.createElement(s,l,j)}else{var R=P({inputValue:y});if(null===R)return null;O=p.a.createElement(u,l,R)}var N={minMenuHeight:w,maxMenuHeight:_,menuPlacement:x,menuPosition:S,menuShouldScrollIntoView:T},L=p.a.createElement(ke,X({},l,N),(function(t){var n=t.ref,r=t.placerProps,a=r.placement,s=r.maxHeight;return p.a.createElement(i,X({},l,N,{innerRef:n,innerProps:{onMouseDown:e.onMenuMouseDown,onMouseMove:e.onMenuMouseMove},isLoading:m,placement:a}),p.a.createElement(Rt,{isEnabled:v,onTopArrive:A,onBottomArrive:E},p.a.createElement(Ot,{isEnabled:C},p.a.createElement(o,X({},l,{innerRef:e.getMenuListRef,isLoading:m,maxHeight:s}),O))))}));return I||"fixed"===S?p.a.createElement(a,X({},l,{appendTo:I,controlElement:this.controlRef,menuPlacement:x,menuPosition:S}),L):L}},{key:"renderFormField",value:function(){var e=this,t=this.props,n=t.delimiter,r=t.isDisabled,i=t.isMulti,o=t.name,a=this.state.selectValue;if(o&&!r){if(i){if(n){var s=a.map((function(t){return e.getOptionValue(t)})).join(n);return p.a.createElement("input",{name:o,type:"hidden",value:s})}var u=a.length>0?a.map((function(t,n){return p.a.createElement("input",{key:"i-".concat(n),name:o,type:"hidden",value:e.getOptionValue(t)})})):p.a.createElement("input",{name:o,type:"hidden"});return p.a.createElement("div",null,u)}var c=a[0]?this.getOptionValue(a[0]):"";return p.a.createElement("input",{name:o,type:"hidden",value:c})}}},{key:"renderLiveRegion",value:function(){return this.state.isFocused?p.a.createElement(gt,{"aria-live":"polite"},p.a.createElement("span",{id:"aria-selection-event"},"\xa0",this.state.ariaLiveSelection),p.a.createElement("span",{id:"aria-context"},"\xa0",this.constructAriaLiveMessage())):null}},{key:"render",value:function(){var e=this.components,t=e.Control,n=e.IndicatorsContainer,r=e.SelectContainer,i=e.ValueContainer,o=this.props,a=o.className,s=o.id,u=o.isDisabled,c=o.menuIsOpen,l=this.state.isFocused,d=this.commonProps=this.getCommonProps();return p.a.createElement(r,X({},d,{className:a,innerProps:{id:s,onKeyDown:this.onKeyDown},isDisabled:u,isFocused:l}),this.renderLiveRegion(),p.a.createElement(t,X({},d,{innerRef:this.getControlRef,innerProps:{onMouseDown:this.onControlMouseDown,onTouchEnd:this.onControlTouchEnd},isDisabled:u,isFocused:l,menuIsOpen:c}),p.a.createElement(i,X({},d,{isDisabled:u}),this.renderPlaceholderOrValue(),this.renderInput()),p.a.createElement(n,X({},d,{isDisabled:u}),this.renderClearIndicator(),this.renderLoadingIndicator(),this.renderIndicatorSeparator(),this.renderDropdownIndicator())),this.renderMenu(),this.renderFormField())}}]),n}(f.Component);Gt.defaultProps=zt;n(52);function Jt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}var Kt={defaultInputValue:"",defaultMenuIsOpen:!1,defaultValue:null};function Yt(e){var t=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=d(e);if(t){var i=d(this).constructor;n=Reflect.construct(r,arguments,i)}else n=r.apply(this,arguments);return l(this,n)}}f.Component;var $t=function(e){var t,n;return n=t=function(t){s(i,t);var n=Jt(i);function i(){var e;r(this,i);for(var t=arguments.length,o=new Array(t),a=0;a<t;a++)o[a]=arguments[a];return(e=n.call.apply(n,[this].concat(o))).select=void 0,e.state={inputValue:void 0!==e.props.inputValue?e.props.inputValue:e.props.defaultInputValue,menuIsOpen:void 0!==e.props.menuIsOpen?e.props.menuIsOpen:e.props.defaultMenuIsOpen,value:void 0!==e.props.value?e.props.value:e.props.defaultValue},e.onChange=function(t,n){e.callProp("onChange",t,n),e.setState({value:t})},e.onInputChange=function(t,n){var r=e.callProp("onInputChange",t,n);e.setState({inputValue:void 0!==r?r:t})},e.onMenuOpen=function(){e.callProp("onMenuOpen"),e.setState({menuIsOpen:!0})},e.onMenuClose=function(){e.callProp("onMenuClose"),e.setState({menuIsOpen:!1})},e}return o(i,[{key:"focus",value:function(){this.select.focus()}},{key:"blur",value:function(){this.select.blur()}},{key:"getProp",value:function(e){return void 0!==this.props[e]?this.props[e]:this.state[e]}},{key:"callProp",value:function(e){if("function"===typeof this.props[e]){for(var t,n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return(t=this.props)[e].apply(t,r)}}},{key:"render",value:function(){var t=this,n=this.props,r=(n.defaultInputValue,n.defaultMenuIsOpen,n.defaultValue,Q(n,["defaultInputValue","defaultMenuIsOpen","defaultValue"]));return p.a.createElement(e,X({},r,{ref:function(e){t.select=e},inputValue:this.getProp("inputValue"),menuIsOpen:this.getProp("menuIsOpen"),onChange:this.onChange,onInputChange:this.onInputChange,onMenuClose:this.onMenuClose,onMenuOpen:this.onMenuOpen,value:this.getProp("value")}))}}]),i}(f.Component),t.defaultProps=Kt,n}(Gt);t.a=$t},,function(e,t,n){"use strict";var r=n(17),i="function"===typeof Symbol&&Symbol.for,o=i?Symbol.for("react.element"):60103,a=i?Symbol.for("react.portal"):60106,s=i?Symbol.for("react.fragment"):60107,u=i?Symbol.for("react.strict_mode"):60108,c=i?Symbol.for("react.profiler"):60114,l=i?Symbol.for("react.provider"):60109,d=i?Symbol.for("react.context"):60110,f=i?Symbol.for("react.forward_ref"):60112,p=i?Symbol.for("react.suspense"):60113,h=i?Symbol.for("react.memo"):60115,g=i?Symbol.for("react.lazy"):60116,v="function"===typeof Symbol&&Symbol.iterator;function y(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var m={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},b={};function w(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||m}function _(){}function k(e,t,n){this.props=e,this.context=t,this.refs=b,this.updater=n||m}w.prototype.isReactComponent={},w.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error(y(85));this.updater.enqueueSetState(this,e,t,"setState")},w.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},_.prototype=w.prototype;var x=k.prototype=new _;x.constructor=k,r(x,w.prototype),x.isPureReactComponent=!0;var S={current:null},I=Object.prototype.hasOwnProperty,C={key:!0,ref:!0,__self:!0,__source:!0};function T(e,t,n){var r,i={},a=null,s=null;if(null!=t)for(r in void 0!==t.ref&&(s=t.ref),void 0!==t.key&&(a=""+t.key),t)I.call(t,r)&&!C.hasOwnProperty(r)&&(i[r]=t[r]);var u=arguments.length-2;if(1===u)i.children=n;else if(1<u){for(var c=Array(u),l=0;l<u;l++)c[l]=arguments[l+2];i.children=c}if(e&&e.defaultProps)for(r in u=e.defaultProps)void 0===i[r]&&(i[r]=u[r]);return{$$typeof:o,type:e,key:a,ref:s,props:i,_owner:S.current}}function P(e){return"object"===typeof e&&null!==e&&e.$$typeof===o}var A=/\/+/g,E=[];function O(e,t,n,r){if(E.length){var i=E.pop();return i.result=e,i.keyPrefix=t,i.func=n,i.context=r,i.count=0,i}return{result:e,keyPrefix:t,func:n,context:r,count:0}}function M(e){e.result=null,e.keyPrefix=null,e.func=null,e.context=null,e.count=0,10>E.length&&E.push(e)}function j(e,t,n){return null==e?0:function e(t,n,r,i){var s=typeof t;"undefined"!==s&&"boolean"!==s||(t=null);var u=!1;if(null===t)u=!0;else switch(s){case"string":case"number":u=!0;break;case"object":switch(t.$$typeof){case o:case a:u=!0}}if(u)return r(i,t,""===n?"."+R(t,0):n),1;if(u=0,n=""===n?".":n+":",Array.isArray(t))for(var c=0;c<t.length;c++){var l=n+R(s=t[c],c);u+=e(s,l,r,i)}else if(null===t||"object"!==typeof t?l=null:l="function"===typeof(l=v&&t[v]||t["@@iterator"])?l:null,"function"===typeof l)for(t=l.call(t),c=0;!(s=t.next()).done;)u+=e(s=s.value,l=n+R(s,c++),r,i);else if("object"===s)throw r=""+t,Error(y(31,"[object Object]"===r?"object with keys {"+Object.keys(t).join(", ")+"}":r,""));return u}(e,"",t,n)}function R(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+(""+e).replace(/[=:]/g,(function(e){return t[e]}))}(e.key):t.toString(36)}function N(e,t){e.func.call(e.context,t,e.count++)}function L(e,t,n){var r=e.result,i=e.keyPrefix;e=e.func.call(e.context,t,e.count++),Array.isArray(e)?D(e,r,n,(function(e){return e})):null!=e&&(P(e)&&(e=function(e,t){return{$$typeof:o,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(e,i+(!e.key||t&&t.key===e.key?"":(""+e.key).replace(A,"$&/")+"/")+n)),r.push(e))}function D(e,t,n,r,i){var o="";null!=n&&(o=(""+n).replace(A,"$&/")+"/"),j(e,L,t=O(t,o,r,i)),M(t)}var W={current:null};function F(){var e=W.current;if(null===e)throw Error(y(321));return e}var U={ReactCurrentDispatcher:W,ReactCurrentBatchConfig:{suspense:null},ReactCurrentOwner:S,IsSomeRendererActing:{current:!1},assign:r};t.Children={map:function(e,t,n){if(null==e)return e;var r=[];return D(e,r,null,t,n),r},forEach:function(e,t,n){if(null==e)return e;j(e,N,t=O(null,null,t,n)),M(t)},count:function(e){return j(e,(function(){return null}),null)},toArray:function(e){var t=[];return D(e,t,null,(function(e){return e})),t},only:function(e){if(!P(e))throw Error(y(143));return e}},t.Component=w,t.Fragment=s,t.Profiler=c,t.PureComponent=k,t.StrictMode=u,t.Suspense=p,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=U,t.cloneElement=function(e,t,n){if(null===e||void 0===e)throw Error(y(267,e));var i=r({},e.props),a=e.key,s=e.ref,u=e._owner;if(null!=t){if(void 0!==t.ref&&(s=t.ref,u=S.current),void 0!==t.key&&(a=""+t.key),e.type&&e.type.defaultProps)var c=e.type.defaultProps;for(l in t)I.call(t,l)&&!C.hasOwnProperty(l)&&(i[l]=void 0===t[l]&&void 0!==c?c[l]:t[l])}var l=arguments.length-2;if(1===l)i.children=n;else if(1<l){c=Array(l);for(var d=0;d<l;d++)c[d]=arguments[d+2];i.children=c}return{$$typeof:o,type:e.type,key:a,ref:s,props:i,_owner:u}},t.createContext=function(e,t){return void 0===t&&(t=null),(e={$$typeof:d,_calculateChangedBits:t,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null}).Provider={$$typeof:l,_context:e},e.Consumer=e},t.createElement=T,t.createFactory=function(e){var t=T.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:f,render:e}},t.isValidElement=P,t.lazy=function(e){return{$$typeof:g,_ctor:e,_status:-1,_result:null}},t.memo=function(e,t){return{$$typeof:h,type:e,compare:void 0===t?null:t}},t.useCallback=function(e,t){return F().useCallback(e,t)},t.useContext=function(e,t){return F().useContext(e,t)},t.useDebugValue=function(){},t.useEffect=function(e,t){return F().useEffect(e,t)},t.useImperativeHandle=function(e,t,n){return F().useImperativeHandle(e,t,n)},t.useLayoutEffect=function(e,t){return F().useLayoutEffect(e,t)},t.useMemo=function(e,t){return F().useMemo(e,t)},t.useReducer=function(e,t,n){return F().useReducer(e,t,n)},t.useRef=function(e){return F().useRef(e)},t.useState=function(e){return F().useState(e)},t.version="16.14.0"},function(e,t,n){"use strict";var r=n(1),i=n(17),o=n(28);function a(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}if(!r)throw Error(a(227));function s(e,t,n,r,i,o,a,s,u){var c=Array.prototype.slice.call(arguments,3);try{t.apply(n,c)}catch(l){this.onError(l)}}var u=!1,c=null,l=!1,d=null,f={onError:function(e){u=!0,c=e}};function p(e,t,n,r,i,o,a,l,d){u=!1,c=null,s.apply(f,arguments)}var h=null,g=null,v=null;function y(e,t,n){var r=e.type||"unknown-event";e.currentTarget=v(n),function(e,t,n,r,i,o,s,f,h){if(p.apply(this,arguments),u){if(!u)throw Error(a(198));var g=c;u=!1,c=null,l||(l=!0,d=g)}}(r,t,void 0,e),e.currentTarget=null}var m=null,b={};function w(){if(m)for(var e in b){var t=b[e],n=m.indexOf(e);if(!(-1<n))throw Error(a(96,e));if(!k[n]){if(!t.extractEvents)throw Error(a(97,e));for(var r in k[n]=t,n=t.eventTypes){var i=void 0,o=n[r],s=t,u=r;if(x.hasOwnProperty(u))throw Error(a(99,u));x[u]=o;var c=o.phasedRegistrationNames;if(c){for(i in c)c.hasOwnProperty(i)&&_(c[i],s,u);i=!0}else o.registrationName?(_(o.registrationName,s,u),i=!0):i=!1;if(!i)throw Error(a(98,r,e))}}}}function _(e,t,n){if(S[e])throw Error(a(100,e));S[e]=t,I[e]=t.eventTypes[n].dependencies}var k=[],x={},S={},I={};function C(e){var t,n=!1;for(t in e)if(e.hasOwnProperty(t)){var r=e[t];if(!b.hasOwnProperty(t)||b[t]!==r){if(b[t])throw Error(a(102,t));b[t]=r,n=!0}}n&&w()}var T=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),P=null,A=null,E=null;function O(e){if(e=g(e)){if("function"!==typeof P)throw Error(a(280));var t=e.stateNode;t&&(t=h(t),P(e.stateNode,e.type,t))}}function M(e){A?E?E.push(e):E=[e]:A=e}function j(){if(A){var e=A,t=E;if(E=A=null,O(e),t)for(e=0;e<t.length;e++)O(t[e])}}function R(e,t){return e(t)}function N(e,t,n,r,i){return e(t,n,r,i)}function L(){}var D=R,W=!1,F=!1;function U(){null===A&&null===E||(L(),j())}function B(e,t,n){if(F)return e(t,n);F=!0;try{return D(e,t,n)}finally{F=!1,U()}}var V=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,H=Object.prototype.hasOwnProperty,z={},q={};function G(e,t,n,r,i,o){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=o}var J={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach((function(e){J[e]=new G(e,0,!1,e,null,!1)})),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach((function(e){var t=e[0];J[t]=new G(t,1,!1,e[1],null,!1)})),["contentEditable","draggable","spellCheck","value"].forEach((function(e){J[e]=new G(e,2,!1,e.toLowerCase(),null,!1)})),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach((function(e){J[e]=new G(e,2,!1,e,null,!1)})),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach((function(e){J[e]=new G(e,3,!1,e.toLowerCase(),null,!1)})),["checked","multiple","muted","selected"].forEach((function(e){J[e]=new G(e,3,!0,e,null,!1)})),["capture","download"].forEach((function(e){J[e]=new G(e,4,!1,e,null,!1)})),["cols","rows","size","span"].forEach((function(e){J[e]=new G(e,6,!1,e,null,!1)})),["rowSpan","start"].forEach((function(e){J[e]=new G(e,5,!1,e.toLowerCase(),null,!1)}));var K=/[\-:]([a-z])/g;function Y(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach((function(e){var t=e.replace(K,Y);J[t]=new G(t,1,!1,e,null,!1)})),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach((function(e){var t=e.replace(K,Y);J[t]=new G(t,1,!1,e,"http://www.w3.org/1999/xlink",!1)})),["xml:base","xml:lang","xml:space"].forEach((function(e){var t=e.replace(K,Y);J[t]=new G(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1)})),["tabIndex","crossOrigin"].forEach((function(e){J[e]=new G(e,1,!1,e.toLowerCase(),null,!1)})),J.xlinkHref=new G("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0),["src","href","action","formAction"].forEach((function(e){J[e]=new G(e,1,!1,e.toLowerCase(),null,!0)}));var $=r.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED;function Q(e,t,n,r){var i=J.hasOwnProperty(t)?J[t]:null;(null!==i?0===i.type:!r&&(2<t.length&&("o"===t[0]||"O"===t[0])&&("n"===t[1]||"N"===t[1])))||(function(e,t,n,r){if(null===t||"undefined"===typeof t||function(e,t,n,r){if(null!==n&&0===n.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,n,r))return!0;if(r)return!1;if(null!==n)switch(n.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,n,i,r)&&(n=null),r||null===i?function(e){return!!H.call(q,e)||!H.call(z,e)&&(V.test(e)?q[e]=!0:(z[e]=!0,!1))}(t)&&(null===n?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=null===n?3!==i.type&&"":n:(t=i.attributeName,r=i.attributeNamespace,null===n?e.removeAttribute(t):(n=3===(i=i.type)||4===i&&!0===n?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}$.hasOwnProperty("ReactCurrentDispatcher")||($.ReactCurrentDispatcher={current:null}),$.hasOwnProperty("ReactCurrentBatchConfig")||($.ReactCurrentBatchConfig={suspense:null});var X=/^(.*)[\\\/]/,Z="function"===typeof Symbol&&Symbol.for,ee=Z?Symbol.for("react.element"):60103,te=Z?Symbol.for("react.portal"):60106,ne=Z?Symbol.for("react.fragment"):60107,re=Z?Symbol.for("react.strict_mode"):60108,ie=Z?Symbol.for("react.profiler"):60114,oe=Z?Symbol.for("react.provider"):60109,ae=Z?Symbol.for("react.context"):60110,se=Z?Symbol.for("react.concurrent_mode"):60111,ue=Z?Symbol.for("react.forward_ref"):60112,ce=Z?Symbol.for("react.suspense"):60113,le=Z?Symbol.for("react.suspense_list"):60120,de=Z?Symbol.for("react.memo"):60115,fe=Z?Symbol.for("react.lazy"):60116,pe=Z?Symbol.for("react.block"):60121,he="function"===typeof Symbol&&Symbol.iterator;function ge(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=he&&e[he]||e["@@iterator"])?e:null}function ve(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case ne:return"Fragment";case te:return"Portal";case ie:return"Profiler";case re:return"StrictMode";case ce:return"Suspense";case le:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case ae:return"Context.Consumer";case oe:return"Context.Provider";case ue:var t=e.render;return t=t.displayName||t.name||"",e.displayName||(""!==t?"ForwardRef("+t+")":"ForwardRef");case de:return ve(e.type);case pe:return ve(e.render);case fe:if(e=1===e._status?e._result:null)return ve(e)}return null}function ye(e){var t="";do{e:switch(e.tag){case 3:case 4:case 6:case 7:case 10:case 9:var n="";break e;default:var r=e._debugOwner,i=e._debugSource,o=ve(e.type);n=null,r&&(n=ve(r.type)),r=o,o="",i?o=" (at "+i.fileName.replace(X,"")+":"+i.lineNumber+")":n&&(o=" (created by "+n+")"),n="\n    in "+(r||"Unknown")+o}t+=n,e=e.return}while(e);return t}function me(e){switch(typeof e){case"boolean":case"number":case"object":case"string":case"undefined":return e;default:return""}}function be(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function we(e){e._valueTracker||(e._valueTracker=function(e){var t=be(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof n&&"function"===typeof n.get&&"function"===typeof n.set){var i=n.get,o=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(e){r=""+e,o.call(this,e)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(e){r=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function _e(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=be(e)?e.checked?"true":"false":e.value),(e=r)!==n&&(t.setValue(e),!0)}function ke(e,t){var n=t.checked;return i({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:e._wrapperState.initialChecked})}function xe(e,t){var n=null==t.defaultValue?"":t.defaultValue,r=null!=t.checked?t.checked:t.defaultChecked;n=me(null!=t.value?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function Se(e,t){null!=(t=t.checked)&&Q(e,"checked",t,!1)}function Ie(e,t){Se(e,t);var n=me(t.value),r=t.type;if(null!=n)"number"===r?(0===n&&""===e.value||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if("submit"===r||"reset"===r)return void e.removeAttribute("value");t.hasOwnProperty("value")?Te(e,t.type,n):t.hasOwnProperty("defaultValue")&&Te(e,t.type,me(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Ce(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!("submit"!==r&&"reset"!==r||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}""!==(n=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==n&&(e.name=n)}function Te(e,t,n){"number"===t&&e.ownerDocument.activeElement===e||(null==n?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}function Pe(e,t){return e=i({children:void 0},t),(t=function(e){var t="";return r.Children.forEach(e,(function(e){null!=e&&(t+=e)})),t}(t.children))&&(e.children=t),e}function Ae(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+me(n),t=null,i=0;i<e.length;i++){if(e[i].value===n)return e[i].selected=!0,void(r&&(e[i].defaultSelected=!0));null!==t||e[i].disabled||(t=e[i])}null!==t&&(t.selected=!0)}}function Ee(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(a(91));return i({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Oe(e,t){var n=t.value;if(null==n){if(n=t.children,t=t.defaultValue,null!=n){if(null!=t)throw Error(a(92));if(Array.isArray(n)){if(!(1>=n.length))throw Error(a(93));n=n[0]}t=n}null==t&&(t=""),n=t}e._wrapperState={initialValue:me(n)}}function Me(e,t){var n=me(t.value),r=me(t.defaultValue);null!=n&&((n=""+n)!==e.value&&(e.value=n),null==t.defaultValue&&e.defaultValue!==n&&(e.defaultValue=n)),null!=r&&(e.defaultValue=""+r)}function je(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}var Re="http://www.w3.org/1999/xhtml",Ne="http://www.w3.org/2000/svg";function Le(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function De(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?Le(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var We,Fe=function(e){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction((function(){return e(t,n)}))}:e}((function(e,t){if(e.namespaceURI!==Ne||"innerHTML"in e)e.innerHTML=t;else{for((We=We||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=We.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}}));function Ue(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&3===n.nodeType)return void(n.nodeValue=t)}e.textContent=t}function Be(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var Ve={animationend:Be("Animation","AnimationEnd"),animationiteration:Be("Animation","AnimationIteration"),animationstart:Be("Animation","AnimationStart"),transitionend:Be("Transition","TransitionEnd")},He={},ze={};function qe(e){if(He[e])return He[e];if(!Ve[e])return e;var t,n=Ve[e];for(t in n)if(n.hasOwnProperty(t)&&t in ze)return He[e]=n[t];return e}T&&(ze=document.createElement("div").style,"AnimationEvent"in window||(delete Ve.animationend.animation,delete Ve.animationiteration.animation,delete Ve.animationstart.animation),"TransitionEvent"in window||delete Ve.transitionend.transition);var Ge=qe("animationend"),Je=qe("animationiteration"),Ke=qe("animationstart"),Ye=qe("transitionend"),$e="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Qe=new("function"===typeof WeakMap?WeakMap:Map);function Xe(e){var t=Qe.get(e);return void 0===t&&(t=new Map,Qe.set(e,t)),t}function Ze(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(1026&(t=e).effectTag)&&(n=t.return),e=t.return}while(e)}return 3===t.tag?n:null}function et(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function tt(e){if(Ze(e)!==e)throw Error(a(188))}function nt(e){if(!(e=function(e){var t=e.alternate;if(!t){if(null===(t=Ze(e)))throw Error(a(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(null===i)break;var o=i.alternate;if(null===o){if(null!==(r=i.return)){n=r;continue}break}if(i.child===o.child){for(o=i.child;o;){if(o===n)return tt(i),e;if(o===r)return tt(i),t;o=o.sibling}throw Error(a(188))}if(n.return!==r.return)n=i,r=o;else{for(var s=!1,u=i.child;u;){if(u===n){s=!0,n=i,r=o;break}if(u===r){s=!0,r=i,n=o;break}u=u.sibling}if(!s){for(u=o.child;u;){if(u===n){s=!0,n=o,r=i;break}if(u===r){s=!0,r=o,n=i;break}u=u.sibling}if(!s)throw Error(a(189))}}if(n.alternate!==r)throw Error(a(190))}if(3!==n.tag)throw Error(a(188));return n.stateNode.current===n?e:t}(e)))return null;for(var t=e;;){if(5===t.tag||6===t.tag)return t;if(t.child)t.child.return=t,t=t.child;else{if(t===e)break;for(;!t.sibling;){if(!t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}}return null}function rt(e,t){if(null==t)throw Error(a(30));return null==e?t:Array.isArray(e)?Array.isArray(t)?(e.push.apply(e,t),e):(e.push(t),e):Array.isArray(t)?[e].concat(t):[e,t]}function it(e,t,n){Array.isArray(e)?e.forEach(t,n):e&&t.call(n,e)}var ot=null;function at(e){if(e){var t=e._dispatchListeners,n=e._dispatchInstances;if(Array.isArray(t))for(var r=0;r<t.length&&!e.isPropagationStopped();r++)y(e,t[r],n[r]);else t&&y(e,t,n);e._dispatchListeners=null,e._dispatchInstances=null,e.isPersistent()||e.constructor.release(e)}}function st(e){if(null!==e&&(ot=rt(ot,e)),e=ot,ot=null,e){if(it(e,at),ot)throw Error(a(95));if(l)throw e=d,l=!1,d=null,e}}function ut(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}function ct(e){if(!T)return!1;var t=(e="on"+e)in document;return t||((t=document.createElement("div")).setAttribute(e,"return;"),t="function"===typeof t[e]),t}var lt=[];function dt(e){e.topLevelType=null,e.nativeEvent=null,e.targetInst=null,e.ancestors.length=0,10>lt.length&&lt.push(e)}function ft(e,t,n,r){if(lt.length){var i=lt.pop();return i.topLevelType=e,i.eventSystemFlags=r,i.nativeEvent=t,i.targetInst=n,i}return{topLevelType:e,eventSystemFlags:r,nativeEvent:t,targetInst:n,ancestors:[]}}function pt(e){var t=e.targetInst,n=t;do{if(!n){e.ancestors.push(n);break}var r=n;if(3===r.tag)r=r.stateNode.containerInfo;else{for(;r.return;)r=r.return;r=3!==r.tag?null:r.stateNode.containerInfo}if(!r)break;5!==(t=n.tag)&&6!==t||e.ancestors.push(n),n=Tn(r)}while(n);for(n=0;n<e.ancestors.length;n++){t=e.ancestors[n];var i=ut(e.nativeEvent);r=e.topLevelType;var o=e.nativeEvent,a=e.eventSystemFlags;0===n&&(a|=64);for(var s=null,u=0;u<k.length;u++){var c=k[u];c&&(c=c.extractEvents(r,t,o,i,a))&&(s=rt(s,c))}st(s)}}function ht(e,t,n){if(!n.has(e)){switch(e){case"scroll":Kt(t,"scroll",!0);break;case"focus":case"blur":Kt(t,"focus",!0),Kt(t,"blur",!0),n.set("blur",null),n.set("focus",null);break;case"cancel":case"close":ct(e)&&Kt(t,e,!0);break;case"invalid":case"submit":case"reset":break;default:-1===$e.indexOf(e)&&Jt(e,t)}n.set(e,null)}}var gt,vt,yt,mt=!1,bt=[],wt=null,_t=null,kt=null,xt=new Map,St=new Map,It=[],Ct="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput close cancel copy cut paste click change contextmenu reset submit".split(" "),Tt="focus blur dragenter dragleave mouseover mouseout pointerover pointerout gotpointercapture lostpointercapture".split(" ");function Pt(e,t,n,r,i){return{blockedOn:e,topLevelType:t,eventSystemFlags:32|n,nativeEvent:i,container:r}}function At(e,t){switch(e){case"focus":case"blur":wt=null;break;case"dragenter":case"dragleave":_t=null;break;case"mouseover":case"mouseout":kt=null;break;case"pointerover":case"pointerout":xt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":St.delete(t.pointerId)}}function Et(e,t,n,r,i,o){return null===e||e.nativeEvent!==o?(e=Pt(t,n,r,i,o),null!==t&&(null!==(t=Pn(t))&&vt(t)),e):(e.eventSystemFlags|=r,e)}function Ot(e){var t=Tn(e.target);if(null!==t){var n=Ze(t);if(null!==n)if(13===(t=n.tag)){if(null!==(t=et(n)))return e.blockedOn=t,void o.unstable_runWithPriority(e.priority,(function(){yt(n)}))}else if(3===t&&n.stateNode.hydrate)return void(e.blockedOn=3===n.tag?n.stateNode.containerInfo:null)}e.blockedOn=null}function Mt(e){if(null!==e.blockedOn)return!1;var t=Xt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);if(null!==t){var n=Pn(t);return null!==n&&vt(n),e.blockedOn=t,!1}return!0}function jt(e,t,n){Mt(e)&&n.delete(t)}function Rt(){for(mt=!1;0<bt.length;){var e=bt[0];if(null!==e.blockedOn){null!==(e=Pn(e.blockedOn))&&gt(e);break}var t=Xt(e.topLevelType,e.eventSystemFlags,e.container,e.nativeEvent);null!==t?e.blockedOn=t:bt.shift()}null!==wt&&Mt(wt)&&(wt=null),null!==_t&&Mt(_t)&&(_t=null),null!==kt&&Mt(kt)&&(kt=null),xt.forEach(jt),St.forEach(jt)}function Nt(e,t){e.blockedOn===t&&(e.blockedOn=null,mt||(mt=!0,o.unstable_scheduleCallback(o.unstable_NormalPriority,Rt)))}function Lt(e){function t(t){return Nt(t,e)}if(0<bt.length){Nt(bt[0],e);for(var n=1;n<bt.length;n++){var r=bt[n];r.blockedOn===e&&(r.blockedOn=null)}}for(null!==wt&&Nt(wt,e),null!==_t&&Nt(_t,e),null!==kt&&Nt(kt,e),xt.forEach(t),St.forEach(t),n=0;n<It.length;n++)(r=It[n]).blockedOn===e&&(r.blockedOn=null);for(;0<It.length&&null===(n=It[0]).blockedOn;)Ot(n),null===n.blockedOn&&It.shift()}var Dt={},Wt=new Map,Ft=new Map,Ut=["abort","abort",Ge,"animationEnd",Je,"animationIteration",Ke,"animationStart","canplay","canPlay","canplaythrough","canPlayThrough","durationchange","durationChange","emptied","emptied","encrypted","encrypted","ended","ended","error","error","gotpointercapture","gotPointerCapture","load","load","loadeddata","loadedData","loadedmetadata","loadedMetadata","loadstart","loadStart","lostpointercapture","lostPointerCapture","playing","playing","progress","progress","seeking","seeking","stalled","stalled","suspend","suspend","timeupdate","timeUpdate",Ye,"transitionEnd","waiting","waiting"];function Bt(e,t){for(var n=0;n<e.length;n+=2){var r=e[n],i=e[n+1],o="on"+(i[0].toUpperCase()+i.slice(1));o={phasedRegistrationNames:{bubbled:o,captured:o+"Capture"},dependencies:[r],eventPriority:t},Ft.set(r,t),Wt.set(r,o),Dt[i]=o}}Bt("blur blur cancel cancel click click close close contextmenu contextMenu copy copy cut cut auxclick auxClick dblclick doubleClick dragend dragEnd dragstart dragStart drop drop focus focus input input invalid invalid keydown keyDown keypress keyPress keyup keyUp mousedown mouseDown mouseup mouseUp paste paste pause pause play play pointercancel pointerCancel pointerdown pointerDown pointerup pointerUp ratechange rateChange reset reset seeked seeked submit submit touchcancel touchCancel touchend touchEnd touchstart touchStart volumechange volumeChange".split(" "),0),Bt("drag drag dragenter dragEnter dragexit dragExit dragleave dragLeave dragover dragOver mousemove mouseMove mouseout mouseOut mouseover mouseOver pointermove pointerMove pointerout pointerOut pointerover pointerOver scroll scroll toggle toggle touchmove touchMove wheel wheel".split(" "),1),Bt(Ut,2);for(var Vt="change selectionchange textInput compositionstart compositionend compositionupdate".split(" "),Ht=0;Ht<Vt.length;Ht++)Ft.set(Vt[Ht],0);var zt=o.unstable_UserBlockingPriority,qt=o.unstable_runWithPriority,Gt=!0;function Jt(e,t){Kt(t,e,!1)}function Kt(e,t,n){var r=Ft.get(t);switch(void 0===r?2:r){case 0:r=Yt.bind(null,t,1,e);break;case 1:r=$t.bind(null,t,1,e);break;default:r=Qt.bind(null,t,1,e)}n?e.addEventListener(t,r,!0):e.addEventListener(t,r,!1)}function Yt(e,t,n,r){W||L();var i=Qt,o=W;W=!0;try{N(i,e,t,n,r)}finally{(W=o)||U()}}function $t(e,t,n,r){qt(zt,Qt.bind(null,e,t,n,r))}function Qt(e,t,n,r){if(Gt)if(0<bt.length&&-1<Ct.indexOf(e))e=Pt(null,e,t,n,r),bt.push(e);else{var i=Xt(e,t,n,r);if(null===i)At(e,r);else if(-1<Ct.indexOf(e))e=Pt(i,e,t,n,r),bt.push(e);else if(!function(e,t,n,r,i){switch(t){case"focus":return wt=Et(wt,e,t,n,r,i),!0;case"dragenter":return _t=Et(_t,e,t,n,r,i),!0;case"mouseover":return kt=Et(kt,e,t,n,r,i),!0;case"pointerover":var o=i.pointerId;return xt.set(o,Et(xt.get(o)||null,e,t,n,r,i)),!0;case"gotpointercapture":return o=i.pointerId,St.set(o,Et(St.get(o)||null,e,t,n,r,i)),!0}return!1}(i,e,t,n,r)){At(e,r),e=ft(e,r,null,t);try{B(pt,e)}finally{dt(e)}}}}function Xt(e,t,n,r){if(null!==(n=Tn(n=ut(r)))){var i=Ze(n);if(null===i)n=null;else{var o=i.tag;if(13===o){if(null!==(n=et(i)))return n;n=null}else if(3===o){if(i.stateNode.hydrate)return 3===i.tag?i.stateNode.containerInfo:null;n=null}else i!==n&&(n=null)}}e=ft(e,r,n,t);try{B(pt,e)}finally{dt(e)}return null}var Zt={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},en=["Webkit","ms","Moz","O"];function tn(e,t,n){return null==t||"boolean"===typeof t||""===t?"":n||"number"!==typeof t||0===t||Zt.hasOwnProperty(e)&&Zt[e]?(""+t).trim():t+"px"}function nn(e,t){for(var n in e=e.style,t)if(t.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=tn(n,t[n],r);"float"===n&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}Object.keys(Zt).forEach((function(e){en.forEach((function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),Zt[t]=Zt[e]}))}));var rn=i({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function on(e,t){if(t){if(rn[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(a(137,e,""));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(a(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(a(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(a(62,""))}}function an(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var sn=Re;function un(e,t){var n=Xe(e=9===e.nodeType||11===e.nodeType?e:e.ownerDocument);t=I[t];for(var r=0;r<t.length;r++)ht(t[r],e,n)}function cn(){}function ln(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function dn(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function fn(e,t){var n,r=dn(e);for(e=0;r;){if(3===r.nodeType){if(n=e+r.textContent.length,e<=t&&n>=t)return{node:r,offset:t-e};e=n}e:{for(;r;){if(r.nextSibling){r=r.nextSibling;break e}r=r.parentNode}r=void 0}r=dn(r)}}function pn(){for(var e=window,t=ln();t instanceof e.HTMLIFrameElement;){try{var n="string"===typeof t.contentWindow.location.href}catch(r){n=!1}if(!n)break;t=ln((e=t.contentWindow).document)}return t}function hn(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}var gn=null,vn=null;function yn(e,t){switch(e){case"button":case"input":case"select":case"textarea":return!!t.autoFocus}return!1}function mn(e,t){return"textarea"===e||"option"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var bn="function"===typeof setTimeout?setTimeout:void 0,wn="function"===typeof clearTimeout?clearTimeout:void 0;function _n(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break}return e}function kn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var n=e.data;if("$"===n||"$!"===n||"$?"===n){if(0===t)return e;t--}else"/$"===n&&t++}e=e.previousSibling}return null}var xn=Math.random().toString(36).slice(2),Sn="__reactInternalInstance$"+xn,In="__reactEventHandlers$"+xn,Cn="__reactContainere$"+xn;function Tn(e){var t=e[Sn];if(t)return t;for(var n=e.parentNode;n;){if(t=n[Cn]||n[Sn]){if(n=t.alternate,null!==t.child||null!==n&&null!==n.child)for(e=kn(e);null!==e;){if(n=e[Sn])return n;e=kn(e)}return t}n=(e=n).parentNode}return null}function Pn(e){return!(e=e[Sn]||e[Cn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function An(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(a(33))}function En(e){return e[In]||null}function On(e){do{e=e.return}while(e&&5!==e.tag);return e||null}function Mn(e,t){var n=e.stateNode;if(!n)return null;var r=h(n);if(!r)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(r=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!r;break e;default:e=!1}if(e)return null;if(n&&"function"!==typeof n)throw Error(a(231,t,typeof n));return n}function jn(e,t,n){(t=Mn(e,n.dispatchConfig.phasedRegistrationNames[t]))&&(n._dispatchListeners=rt(n._dispatchListeners,t),n._dispatchInstances=rt(n._dispatchInstances,e))}function Rn(e){if(e&&e.dispatchConfig.phasedRegistrationNames){for(var t=e._targetInst,n=[];t;)n.push(t),t=On(t);for(t=n.length;0<t--;)jn(n[t],"captured",e);for(t=0;t<n.length;t++)jn(n[t],"bubbled",e)}}function Nn(e,t,n){e&&n&&n.dispatchConfig.registrationName&&(t=Mn(e,n.dispatchConfig.registrationName))&&(n._dispatchListeners=rt(n._dispatchListeners,t),n._dispatchInstances=rt(n._dispatchInstances,e))}function Ln(e){e&&e.dispatchConfig.registrationName&&Nn(e._targetInst,null,e)}function Dn(e){it(e,Rn)}var Wn=null,Fn=null,Un=null;function Bn(){if(Un)return Un;var e,t,n=Fn,r=n.length,i="value"in Wn?Wn.value:Wn.textContent,o=i.length;for(e=0;e<r&&n[e]===i[e];e++);var a=r-e;for(t=1;t<=a&&n[r-t]===i[o-t];t++);return Un=i.slice(e,1<t?1-t:void 0)}function Vn(){return!0}function Hn(){return!1}function zn(e,t,n,r){for(var i in this.dispatchConfig=e,this._targetInst=t,this.nativeEvent=n,e=this.constructor.Interface)e.hasOwnProperty(i)&&((t=e[i])?this[i]=t(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?Vn:Hn,this.isPropagationStopped=Hn,this}function qn(e,t,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,e,t,n,r),i}return new this(e,t,n,r)}function Gn(e){if(!(e instanceof this))throw Error(a(279));e.destructor(),10>this.eventPool.length&&this.eventPool.push(e)}function Jn(e){e.eventPool=[],e.getPooled=qn,e.release=Gn}i(zn.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=Vn)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=Vn)},persist:function(){this.isPersistent=Vn},isPersistent:Hn,destructor:function(){var e,t=this.constructor.Interface;for(e in t)this[e]=null;this.nativeEvent=this._targetInst=this.dispatchConfig=null,this.isPropagationStopped=this.isDefaultPrevented=Hn,this._dispatchInstances=this._dispatchListeners=null}}),zn.Interface={type:null,target:null,currentTarget:function(){return null},eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null},zn.extend=function(e){function t(){}function n(){return r.apply(this,arguments)}var r=this;t.prototype=r.prototype;var o=new t;return i(o,n.prototype),n.prototype=o,n.prototype.constructor=n,n.Interface=i({},r.Interface,e),n.extend=r.extend,Jn(n),n},Jn(zn);var Kn=zn.extend({data:null}),Yn=zn.extend({data:null}),$n=[9,13,27,32],Qn=T&&"CompositionEvent"in window,Xn=null;T&&"documentMode"in document&&(Xn=document.documentMode);var Zn=T&&"TextEvent"in window&&!Xn,er=T&&(!Qn||Xn&&8<Xn&&11>=Xn),tr=String.fromCharCode(32),nr={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["compositionend","keypress","textInput","paste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"blur compositionend keydown keypress keyup mousedown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"blur compositionstart keydown keypress keyup mousedown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"blur compositionupdate keydown keypress keyup mousedown".split(" ")}},rr=!1;function ir(e,t){switch(e){case"keyup":return-1!==$n.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"blur":return!0;default:return!1}}function or(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var ar=!1;var sr={eventTypes:nr,extractEvents:function(e,t,n,r){var i;if(Qn)e:{switch(e){case"compositionstart":var o=nr.compositionStart;break e;case"compositionend":o=nr.compositionEnd;break e;case"compositionupdate":o=nr.compositionUpdate;break e}o=void 0}else ar?ir(e,n)&&(o=nr.compositionEnd):"keydown"===e&&229===n.keyCode&&(o=nr.compositionStart);return o?(er&&"ko"!==n.locale&&(ar||o!==nr.compositionStart?o===nr.compositionEnd&&ar&&(i=Bn()):(Fn="value"in(Wn=r)?Wn.value:Wn.textContent,ar=!0)),o=Kn.getPooled(o,t,n,r),i?o.data=i:null!==(i=or(n))&&(o.data=i),Dn(o),i=o):i=null,(e=Zn?function(e,t){switch(e){case"compositionend":return or(t);case"keypress":return 32!==t.which?null:(rr=!0,tr);case"textInput":return(e=t.data)===tr&&rr?null:e;default:return null}}(e,n):function(e,t){if(ar)return"compositionend"===e||!Qn&&ir(e,t)?(e=Bn(),Un=Fn=Wn=null,ar=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return er&&"ko"!==t.locale?null:t.data;default:return null}}(e,n))?((t=Yn.getPooled(nr.beforeInput,t,n,r)).data=e,Dn(t)):t=null,null===i?t:null===t?i:[i,t]}},ur={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function cr(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!ur[e.type]:"textarea"===t}var lr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"blur change click focus input keydown keyup selectionchange".split(" ")}};function dr(e,t,n){return(e=zn.getPooled(lr.change,e,t,n)).type="change",M(n),Dn(e),e}var fr=null,pr=null;function hr(e){st(e)}function gr(e){if(_e(An(e)))return e}function vr(e,t){if("change"===e)return t}var yr=!1;function mr(){fr&&(fr.detachEvent("onpropertychange",br),pr=fr=null)}function br(e){if("value"===e.propertyName&&gr(pr))if(e=dr(pr,e,ut(e)),W)st(e);else{W=!0;try{R(hr,e)}finally{W=!1,U()}}}function wr(e,t,n){"focus"===e?(mr(),pr=n,(fr=t).attachEvent("onpropertychange",br)):"blur"===e&&mr()}function _r(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return gr(pr)}function kr(e,t){if("click"===e)return gr(t)}function xr(e,t){if("input"===e||"change"===e)return gr(t)}T&&(yr=ct("input")&&(!document.documentMode||9<document.documentMode));var Sr={eventTypes:lr,_isInputEventSupported:yr,extractEvents:function(e,t,n,r){var i=t?An(t):window,o=i.nodeName&&i.nodeName.toLowerCase();if("select"===o||"input"===o&&"file"===i.type)var a=vr;else if(cr(i))if(yr)a=xr;else{a=_r;var s=wr}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(a=kr);if(a&&(a=a(e,t)))return dr(a,n,r);s&&s(e,i,t),"blur"===e&&(e=i._wrapperState)&&e.controlled&&"number"===i.type&&Te(i,"number",i.value)}},Ir=zn.extend({view:null,detail:null}),Cr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Tr(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=Cr[e])&&!!t[e]}function Pr(){return Tr}var Ar=0,Er=0,Or=!1,Mr=!1,jr=Ir.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Pr,button:null,buttons:null,relatedTarget:function(e){return e.relatedTarget||(e.fromElement===e.srcElement?e.toElement:e.fromElement)},movementX:function(e){if("movementX"in e)return e.movementX;var t=Ar;return Ar=e.screenX,Or?"mousemove"===e.type?e.screenX-t:0:(Or=!0,0)},movementY:function(e){if("movementY"in e)return e.movementY;var t=Er;return Er=e.screenY,Mr?"mousemove"===e.type?e.screenY-t:0:(Mr=!0,0)}}),Rr=jr.extend({pointerId:null,width:null,height:null,pressure:null,tangentialPressure:null,tiltX:null,tiltY:null,twist:null,pointerType:null,isPrimary:null}),Nr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["mouseout","mouseover"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["mouseout","mouseover"]},pointerEnter:{registrationName:"onPointerEnter",dependencies:["pointerout","pointerover"]},pointerLeave:{registrationName:"onPointerLeave",dependencies:["pointerout","pointerover"]}},Lr={eventTypes:Nr,extractEvents:function(e,t,n,r,i){var o="mouseover"===e||"pointerover"===e,a="mouseout"===e||"pointerout"===e;if(o&&0===(32&i)&&(n.relatedTarget||n.fromElement)||!a&&!o)return null;(o=r.window===r?r:(o=r.ownerDocument)?o.defaultView||o.parentWindow:window,a)?(a=t,null!==(t=(t=n.relatedTarget||n.toElement)?Tn(t):null)&&(t!==Ze(t)||5!==t.tag&&6!==t.tag)&&(t=null)):a=null;if(a===t)return null;if("mouseout"===e||"mouseover"===e)var s=jr,u=Nr.mouseLeave,c=Nr.mouseEnter,l="mouse";else"pointerout"!==e&&"pointerover"!==e||(s=Rr,u=Nr.pointerLeave,c=Nr.pointerEnter,l="pointer");if(e=null==a?o:An(a),o=null==t?o:An(t),(u=s.getPooled(u,a,n,r)).type=l+"leave",u.target=e,u.relatedTarget=o,(n=s.getPooled(c,t,n,r)).type=l+"enter",n.target=o,n.relatedTarget=e,l=t,(r=a)&&l)e:{for(c=l,a=0,e=s=r;e;e=On(e))a++;for(e=0,t=c;t;t=On(t))e++;for(;0<a-e;)s=On(s),a--;for(;0<e-a;)c=On(c),e--;for(;a--;){if(s===c||s===c.alternate)break e;s=On(s),c=On(c)}s=null}else s=null;for(c=s,s=[];r&&r!==c&&(null===(a=r.alternate)||a!==c);)s.push(r),r=On(r);for(r=[];l&&l!==c&&(null===(a=l.alternate)||a!==c);)r.push(l),l=On(l);for(l=0;l<s.length;l++)Nn(s[l],"bubbled",u);for(l=r.length;0<l--;)Nn(r[l],"captured",n);return 0===(64&i)?[u]:[u,n]}};var Dr="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t},Wr=Object.prototype.hasOwnProperty;function Fr(e,t){if(Dr(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++)if(!Wr.call(t,n[r])||!Dr(e[n[r]],t[n[r]]))return!1;return!0}var Ur=T&&"documentMode"in document&&11>=document.documentMode,Br={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"blur contextmenu dragend focus keydown keyup mousedown mouseup selectionchange".split(" ")}},Vr=null,Hr=null,zr=null,qr=!1;function Gr(e,t){var n=t.window===t?t.document:9===t.nodeType?t:t.ownerDocument;return qr||null==Vr||Vr!==ln(n)?null:("selectionStart"in(n=Vr)&&hn(n)?n={start:n.selectionStart,end:n.selectionEnd}:n={anchorNode:(n=(n.ownerDocument&&n.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset},zr&&Fr(zr,n)?null:(zr=n,(e=zn.getPooled(Br.select,Hr,e,t)).type="select",e.target=Vr,Dn(e),e))}var Jr={eventTypes:Br,extractEvents:function(e,t,n,r,i,o){if(!(o=!(i=o||(r.window===r?r.document:9===r.nodeType?r:r.ownerDocument)))){e:{i=Xe(i),o=I.onSelect;for(var a=0;a<o.length;a++)if(!i.has(o[a])){i=!1;break e}i=!0}o=!i}if(o)return null;switch(i=t?An(t):window,e){case"focus":(cr(i)||"true"===i.contentEditable)&&(Vr=i,Hr=t,zr=null);break;case"blur":zr=Hr=Vr=null;break;case"mousedown":qr=!0;break;case"contextmenu":case"mouseup":case"dragend":return qr=!1,Gr(n,r);case"selectionchange":if(Ur)break;case"keydown":case"keyup":return Gr(n,r)}return null}},Kr=zn.extend({animationName:null,elapsedTime:null,pseudoElement:null}),Yr=zn.extend({clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),$r=Ir.extend({relatedTarget:null});function Qr(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}var Xr={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Zr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ei=Ir.extend({key:function(e){if(e.key){var t=Xr[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=Qr(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?Zr[e.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Pr,charCode:function(e){return"keypress"===e.type?Qr(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?Qr(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),ti=jr.extend({dataTransfer:null}),ni=Ir.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Pr}),ri=zn.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),ii=jr.extend({deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:null,deltaMode:null}),oi={eventTypes:Dt,extractEvents:function(e,t,n,r){var i=Wt.get(e);if(!i)return null;switch(e){case"keypress":if(0===Qr(n))return null;case"keydown":case"keyup":e=ei;break;case"blur":case"focus":e=$r;break;case"click":if(2===n.button)return null;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":e=jr;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":e=ti;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":e=ni;break;case Ge:case Je:case Ke:e=Kr;break;case Ye:e=ri;break;case"scroll":e=Ir;break;case"wheel":e=ii;break;case"copy":case"cut":case"paste":e=Yr;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":e=Rr;break;default:e=zn}return Dn(t=e.getPooled(i,t,n,r)),t}};if(m)throw Error(a(101));m=Array.prototype.slice.call("ResponderEventPlugin SimpleEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),w(),h=En,g=Pn,v=An,C({SimpleEventPlugin:oi,EnterLeaveEventPlugin:Lr,ChangeEventPlugin:Sr,SelectEventPlugin:Jr,BeforeInputEventPlugin:sr});var ai=[],si=-1;function ui(e){0>si||(e.current=ai[si],ai[si]=null,si--)}function ci(e,t){si++,ai[si]=e.current,e.current=t}var li={},di={current:li},fi={current:!1},pi=li;function hi(e,t){var n=e.type.contextTypes;if(!n)return li;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i,o={};for(i in n)o[i]=t[i];return r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=o),o}function gi(e){return null!==(e=e.childContextTypes)&&void 0!==e}function vi(){ui(fi),ui(di)}function yi(e,t,n){if(di.current!==li)throw Error(a(168));ci(di,t),ci(fi,n)}function mi(e,t,n){var r=e.stateNode;if(e=t.childContextTypes,"function"!==typeof r.getChildContext)return n;for(var o in r=r.getChildContext())if(!(o in e))throw Error(a(108,ve(t)||"Unknown",o));return i({},n,{},r)}function bi(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||li,pi=di.current,ci(di,e),ci(fi,fi.current),!0}function wi(e,t,n){var r=e.stateNode;if(!r)throw Error(a(169));n?(e=mi(e,t,pi),r.__reactInternalMemoizedMergedChildContext=e,ui(fi),ui(di),ci(di,e)):ui(fi),ci(fi,n)}var _i=o.unstable_runWithPriority,ki=o.unstable_scheduleCallback,xi=o.unstable_cancelCallback,Si=o.unstable_requestPaint,Ii=o.unstable_now,Ci=o.unstable_getCurrentPriorityLevel,Ti=o.unstable_ImmediatePriority,Pi=o.unstable_UserBlockingPriority,Ai=o.unstable_NormalPriority,Ei=o.unstable_LowPriority,Oi=o.unstable_IdlePriority,Mi={},ji=o.unstable_shouldYield,Ri=void 0!==Si?Si:function(){},Ni=null,Li=null,Di=!1,Wi=Ii(),Fi=1e4>Wi?Ii:function(){return Ii()-Wi};function Ui(){switch(Ci()){case Ti:return 99;case Pi:return 98;case Ai:return 97;case Ei:return 96;case Oi:return 95;default:throw Error(a(332))}}function Bi(e){switch(e){case 99:return Ti;case 98:return Pi;case 97:return Ai;case 96:return Ei;case 95:return Oi;default:throw Error(a(332))}}function Vi(e,t){return e=Bi(e),_i(e,t)}function Hi(e,t,n){return e=Bi(e),ki(e,t,n)}function zi(e){return null===Ni?(Ni=[e],Li=ki(Ti,Gi)):Ni.push(e),Mi}function qi(){if(null!==Li){var e=Li;Li=null,xi(e)}Gi()}function Gi(){if(!Di&&null!==Ni){Di=!0;var e=0;try{var t=Ni;Vi(99,(function(){for(;e<t.length;e++){var n=t[e];do{n=n(!0)}while(null!==n)}})),Ni=null}catch(n){throw null!==Ni&&(Ni=Ni.slice(e+1)),ki(Ti,qi),n}finally{Di=!1}}}function Ji(e,t,n){return 1073741821-(1+((1073741821-e+t/10)/(n/=10)|0))*n}function Ki(e,t){if(e&&e.defaultProps)for(var n in t=i({},t),e=e.defaultProps)void 0===t[n]&&(t[n]=e[n]);return t}var Yi={current:null},$i=null,Qi=null,Xi=null;function Zi(){Xi=Qi=$i=null}function eo(e){var t=Yi.current;ui(Yi),e.type._context._currentValue=t}function to(e,t){for(;null!==e;){var n=e.alternate;if(e.childExpirationTime<t)e.childExpirationTime=t,null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t);else{if(!(null!==n&&n.childExpirationTime<t))break;n.childExpirationTime=t}e=e.return}}function no(e,t){$i=e,Xi=Qi=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(e.expirationTime>=t&&(Ea=!0),e.firstContext=null)}function ro(e,t){if(Xi!==e&&!1!==t&&0!==t)if("number"===typeof t&&1073741823!==t||(Xi=e,t=1073741823),t={context:e,observedBits:t,next:null},null===Qi){if(null===$i)throw Error(a(308));Qi=t,$i.dependencies={expirationTime:0,firstContext:t,responders:null}}else Qi=Qi.next=t;return e._currentValue}var io=!1;function oo(e){e.updateQueue={baseState:e.memoizedState,baseQueue:null,shared:{pending:null},effects:null}}function ao(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,baseQueue:e.baseQueue,shared:e.shared,effects:e.effects})}function so(e,t){return(e={expirationTime:e,suspenseConfig:t,tag:0,payload:null,callback:null,next:null}).next=e}function uo(e,t){if(null!==(e=e.updateQueue)){var n=(e=e.shared).pending;null===n?t.next=t:(t.next=n.next,n.next=t),e.pending=t}}function co(e,t){var n=e.alternate;null!==n&&ao(n,e),null===(n=(e=e.updateQueue).baseQueue)?(e.baseQueue=t.next=t,t.next=t):(t.next=n.next,n.next=t)}function lo(e,t,n,r){var o=e.updateQueue;io=!1;var a=o.baseQueue,s=o.shared.pending;if(null!==s){if(null!==a){var u=a.next;a.next=s.next,s.next=u}a=s,o.shared.pending=null,null!==(u=e.alternate)&&(null!==(u=u.updateQueue)&&(u.baseQueue=s))}if(null!==a){u=a.next;var c=o.baseState,l=0,d=null,f=null,p=null;if(null!==u)for(var h=u;;){if((s=h.expirationTime)<r){var g={expirationTime:h.expirationTime,suspenseConfig:h.suspenseConfig,tag:h.tag,payload:h.payload,callback:h.callback,next:null};null===p?(f=p=g,d=c):p=p.next=g,s>l&&(l=s)}else{null!==p&&(p=p.next={expirationTime:1073741823,suspenseConfig:h.suspenseConfig,tag:h.tag,payload:h.payload,callback:h.callback,next:null}),ou(s,h.suspenseConfig);e:{var v=e,y=h;switch(s=t,g=n,y.tag){case 1:if("function"===typeof(v=y.payload)){c=v.call(g,c,s);break e}c=v;break e;case 3:v.effectTag=-4097&v.effectTag|64;case 0:if(null===(s="function"===typeof(v=y.payload)?v.call(g,c,s):v)||void 0===s)break e;c=i({},c,s);break e;case 2:io=!0}}null!==h.callback&&(e.effectTag|=32,null===(s=o.effects)?o.effects=[h]:s.push(h))}if(null===(h=h.next)||h===u){if(null===(s=o.shared.pending))break;h=a.next=s.next,s.next=u,o.baseQueue=a=s,o.shared.pending=null}}null===p?d=c:p.next=f,o.baseState=d,o.baseQueue=p,au(l),e.expirationTime=l,e.memoizedState=c}}function fo(e,t,n){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(null!==i){if(r.callback=null,r=i,i=n,"function"!==typeof r)throw Error(a(191,r));r.call(i)}}}var po=$.ReactCurrentBatchConfig,ho=(new r.Component).refs;function go(e,t,n,r){n=null===(n=n(r,t=e.memoizedState))||void 0===n?t:i({},t,n),e.memoizedState=n,0===e.expirationTime&&(e.updateQueue.baseState=n)}var vo={isMounted:function(e){return!!(e=e._reactInternalFiber)&&Ze(e)===e},enqueueSetState:function(e,t,n){e=e._reactInternalFiber;var r=Gs(),i=po.suspense;(i=so(r=Js(r,e,i),i)).payload=t,void 0!==n&&null!==n&&(i.callback=n),uo(e,i),Ks(e,r)},enqueueReplaceState:function(e,t,n){e=e._reactInternalFiber;var r=Gs(),i=po.suspense;(i=so(r=Js(r,e,i),i)).tag=1,i.payload=t,void 0!==n&&null!==n&&(i.callback=n),uo(e,i),Ks(e,r)},enqueueForceUpdate:function(e,t){e=e._reactInternalFiber;var n=Gs(),r=po.suspense;(r=so(n=Js(n,e,r),r)).tag=2,void 0!==t&&null!==t&&(r.callback=t),uo(e,r),Ks(e,n)}};function yo(e,t,n,r,i,o,a){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(r,o,a):!t.prototype||!t.prototype.isPureReactComponent||(!Fr(n,r)||!Fr(i,o))}function mo(e,t,n){var r=!1,i=li,o=t.contextType;return"object"===typeof o&&null!==o?o=ro(o):(i=gi(t)?pi:di.current,o=(r=null!==(r=t.contextTypes)&&void 0!==r)?hi(e,i):li),t=new t(n,o),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=vo,e.stateNode=t,t._reactInternalFiber=e,r&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=o),t}function bo(e,t,n,r){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(n,r),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&vo.enqueueReplaceState(t,t.state,null)}function wo(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs=ho,oo(e);var o=t.contextType;"object"===typeof o&&null!==o?i.context=ro(o):(o=gi(t)?pi:di.current,i.context=hi(e,o)),lo(e,n,i,r),i.state=e.memoizedState,"function"===typeof(o=t.getDerivedStateFromProps)&&(go(e,t,o,n),i.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(t=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),t!==i.state&&vo.enqueueReplaceState(i,i.state,null),lo(e,n,i,r),i.state=e.memoizedState),"function"===typeof i.componentDidMount&&(e.effectTag|=4)}var _o=Array.isArray;function ko(e,t,n){if(null!==(e=n.ref)&&"function"!==typeof e&&"object"!==typeof e){if(n._owner){if(n=n._owner){if(1!==n.tag)throw Error(a(309));var r=n.stateNode}if(!r)throw Error(a(147,e));var i=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===i?t.ref:((t=function(e){var t=r.refs;t===ho&&(t=r.refs={}),null===e?delete t[i]:t[i]=e})._stringRef=i,t)}if("string"!==typeof e)throw Error(a(284));if(!n._owner)throw Error(a(290,e))}return e}function xo(e,t){if("textarea"!==e.type)throw Error(a(31,"[object Object]"===Object.prototype.toString.call(t)?"object with keys {"+Object.keys(t).join(", ")+"}":t,""))}function So(e){function t(t,n){if(e){var r=t.lastEffect;null!==r?(r.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!e)return null;for(;null!==r;)t(n,r),r=r.sibling;return null}function r(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function i(e,t){return(e=Cu(e,t)).index=0,e.sibling=null,e}function o(t,n,r){return t.index=r,e?null!==(r=t.alternate)?(r=r.index)<n?(t.effectTag=2,n):r:(t.effectTag=2,n):n}function s(t){return e&&null===t.alternate&&(t.effectTag=2),t}function u(e,t,n,r){return null===t||6!==t.tag?((t=Au(n,e.mode,r)).return=e,t):((t=i(t,n)).return=e,t)}function c(e,t,n,r){return null!==t&&t.elementType===n.type?((r=i(t,n.props)).ref=ko(e,t,n),r.return=e,r):((r=Tu(n.type,n.key,n.props,null,e.mode,r)).ref=ko(e,t,n),r.return=e,r)}function l(e,t,n,r){return null===t||4!==t.tag||t.stateNode.containerInfo!==n.containerInfo||t.stateNode.implementation!==n.implementation?((t=Eu(n,e.mode,r)).return=e,t):((t=i(t,n.children||[])).return=e,t)}function d(e,t,n,r,o){return null===t||7!==t.tag?((t=Pu(n,e.mode,r,o)).return=e,t):((t=i(t,n)).return=e,t)}function f(e,t,n){if("string"===typeof t||"number"===typeof t)return(t=Au(""+t,e.mode,n)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case ee:return(n=Tu(t.type,t.key,t.props,null,e.mode,n)).ref=ko(e,null,t),n.return=e,n;case te:return(t=Eu(t,e.mode,n)).return=e,t}if(_o(t)||ge(t))return(t=Pu(t,e.mode,n,null)).return=e,t;xo(e,t)}return null}function p(e,t,n,r){var i=null!==t?t.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:u(e,t,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case ee:return n.key===i?n.type===ne?d(e,t,n.props.children,r,i):c(e,t,n,r):null;case te:return n.key===i?l(e,t,n,r):null}if(_o(n)||ge(n))return null!==i?null:d(e,t,n,r,null);xo(e,n)}return null}function h(e,t,n,r,i){if("string"===typeof r||"number"===typeof r)return u(t,e=e.get(n)||null,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case ee:return e=e.get(null===r.key?n:r.key)||null,r.type===ne?d(t,e,r.props.children,i,r.key):c(t,e,r,i);case te:return l(t,e=e.get(null===r.key?n:r.key)||null,r,i)}if(_o(r)||ge(r))return d(t,e=e.get(n)||null,r,i,null);xo(t,r)}return null}function g(i,a,s,u){for(var c=null,l=null,d=a,g=a=0,v=null;null!==d&&g<s.length;g++){d.index>g?(v=d,d=null):v=d.sibling;var y=p(i,d,s[g],u);if(null===y){null===d&&(d=v);break}e&&d&&null===y.alternate&&t(i,d),a=o(y,a,g),null===l?c=y:l.sibling=y,l=y,d=v}if(g===s.length)return n(i,d),c;if(null===d){for(;g<s.length;g++)null!==(d=f(i,s[g],u))&&(a=o(d,a,g),null===l?c=d:l.sibling=d,l=d);return c}for(d=r(i,d);g<s.length;g++)null!==(v=h(d,i,g,s[g],u))&&(e&&null!==v.alternate&&d.delete(null===v.key?g:v.key),a=o(v,a,g),null===l?c=v:l.sibling=v,l=v);return e&&d.forEach((function(e){return t(i,e)})),c}function v(i,s,u,c){var l=ge(u);if("function"!==typeof l)throw Error(a(150));if(null==(u=l.call(u)))throw Error(a(151));for(var d=l=null,g=s,v=s=0,y=null,m=u.next();null!==g&&!m.done;v++,m=u.next()){g.index>v?(y=g,g=null):y=g.sibling;var b=p(i,g,m.value,c);if(null===b){null===g&&(g=y);break}e&&g&&null===b.alternate&&t(i,g),s=o(b,s,v),null===d?l=b:d.sibling=b,d=b,g=y}if(m.done)return n(i,g),l;if(null===g){for(;!m.done;v++,m=u.next())null!==(m=f(i,m.value,c))&&(s=o(m,s,v),null===d?l=m:d.sibling=m,d=m);return l}for(g=r(i,g);!m.done;v++,m=u.next())null!==(m=h(g,i,v,m.value,c))&&(e&&null!==m.alternate&&g.delete(null===m.key?v:m.key),s=o(m,s,v),null===d?l=m:d.sibling=m,d=m);return e&&g.forEach((function(e){return t(i,e)})),l}return function(e,r,o,u){var c="object"===typeof o&&null!==o&&o.type===ne&&null===o.key;c&&(o=o.props.children);var l="object"===typeof o&&null!==o;if(l)switch(o.$$typeof){case ee:e:{for(l=o.key,c=r;null!==c;){if(c.key===l){switch(c.tag){case 7:if(o.type===ne){n(e,c.sibling),(r=i(c,o.props.children)).return=e,e=r;break e}break;default:if(c.elementType===o.type){n(e,c.sibling),(r=i(c,o.props)).ref=ko(e,c,o),r.return=e,e=r;break e}}n(e,c);break}t(e,c),c=c.sibling}o.type===ne?((r=Pu(o.props.children,e.mode,u,o.key)).return=e,e=r):((u=Tu(o.type,o.key,o.props,null,e.mode,u)).ref=ko(e,r,o),u.return=e,e=u)}return s(e);case te:e:{for(c=o.key;null!==r;){if(r.key===c){if(4===r.tag&&r.stateNode.containerInfo===o.containerInfo&&r.stateNode.implementation===o.implementation){n(e,r.sibling),(r=i(r,o.children||[])).return=e,e=r;break e}n(e,r);break}t(e,r),r=r.sibling}(r=Eu(o,e.mode,u)).return=e,e=r}return s(e)}if("string"===typeof o||"number"===typeof o)return o=""+o,null!==r&&6===r.tag?(n(e,r.sibling),(r=i(r,o)).return=e,e=r):(n(e,r),(r=Au(o,e.mode,u)).return=e,e=r),s(e);if(_o(o))return g(e,r,o,u);if(ge(o))return v(e,r,o,u);if(l&&xo(e,o),"undefined"===typeof o&&!c)switch(e.tag){case 1:case 0:throw e=e.type,Error(a(152,e.displayName||e.name||"Component"))}return n(e,r)}}var Io=So(!0),Co=So(!1),To={},Po={current:To},Ao={current:To},Eo={current:To};function Oo(e){if(e===To)throw Error(a(174));return e}function Mo(e,t){switch(ci(Eo,t),ci(Ao,e),ci(Po,To),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:De(null,"");break;default:t=De(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}ui(Po),ci(Po,t)}function jo(){ui(Po),ui(Ao),ui(Eo)}function Ro(e){Oo(Eo.current);var t=Oo(Po.current),n=De(t,e.type);t!==n&&(ci(Ao,e),ci(Po,n))}function No(e){Ao.current===e&&(ui(Po),ui(Ao))}var Lo={current:0};function Do(e){for(var t=e;null!==t;){if(13===t.tag){var n=t.memoizedState;if(null!==n&&(null===(n=n.dehydrated)||"$?"===n.data||"$!"===n.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(64&t.effectTag))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}function Wo(e,t){return{responder:e,props:t}}var Fo=$.ReactCurrentDispatcher,Uo=$.ReactCurrentBatchConfig,Bo=0,Vo=null,Ho=null,zo=null,qo=!1;function Go(){throw Error(a(321))}function Jo(e,t){if(null===t)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!Dr(e[n],t[n]))return!1;return!0}function Ko(e,t,n,r,i,o){if(Bo=o,Vo=t,t.memoizedState=null,t.updateQueue=null,t.expirationTime=0,Fo.current=null===e||null===e.memoizedState?ya:ma,e=n(r,i),t.expirationTime===Bo){o=0;do{if(t.expirationTime=0,!(25>o))throw Error(a(301));o+=1,zo=Ho=null,t.updateQueue=null,Fo.current=ba,e=n(r,i)}while(t.expirationTime===Bo)}if(Fo.current=va,t=null!==Ho&&null!==Ho.next,Bo=0,zo=Ho=Vo=null,qo=!1,t)throw Error(a(300));return e}function Yo(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===zo?Vo.memoizedState=zo=e:zo=zo.next=e,zo}function $o(){if(null===Ho){var e=Vo.alternate;e=null!==e?e.memoizedState:null}else e=Ho.next;var t=null===zo?Vo.memoizedState:zo.next;if(null!==t)zo=t,Ho=e;else{if(null===e)throw Error(a(310));e={memoizedState:(Ho=e).memoizedState,baseState:Ho.baseState,baseQueue:Ho.baseQueue,queue:Ho.queue,next:null},null===zo?Vo.memoizedState=zo=e:zo=zo.next=e}return zo}function Qo(e,t){return"function"===typeof t?t(e):t}function Xo(e){var t=$o(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=Ho,i=r.baseQueue,o=n.pending;if(null!==o){if(null!==i){var s=i.next;i.next=o.next,o.next=s}r.baseQueue=i=o,n.pending=null}if(null!==i){i=i.next,r=r.baseState;var u=s=o=null,c=i;do{var l=c.expirationTime;if(l<Bo){var d={expirationTime:c.expirationTime,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null};null===u?(s=u=d,o=r):u=u.next=d,l>Vo.expirationTime&&(Vo.expirationTime=l,au(l))}else null!==u&&(u=u.next={expirationTime:1073741823,suspenseConfig:c.suspenseConfig,action:c.action,eagerReducer:c.eagerReducer,eagerState:c.eagerState,next:null}),ou(l,c.suspenseConfig),r=c.eagerReducer===e?c.eagerState:e(r,c.action);c=c.next}while(null!==c&&c!==i);null===u?o=r:u.next=s,Dr(r,t.memoizedState)||(Ea=!0),t.memoizedState=r,t.baseState=o,t.baseQueue=u,n.lastRenderedState=r}return[t.memoizedState,n.dispatch]}function Zo(e){var t=$o(),n=t.queue;if(null===n)throw Error(a(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,o=t.memoizedState;if(null!==i){n.pending=null;var s=i=i.next;do{o=e(o,s.action),s=s.next}while(s!==i);Dr(o,t.memoizedState)||(Ea=!0),t.memoizedState=o,null===t.baseQueue&&(t.baseState=o),n.lastRenderedState=o}return[o,r]}function ea(e){var t=Yo();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e=(e=t.queue={pending:null,dispatch:null,lastRenderedReducer:Qo,lastRenderedState:e}).dispatch=ga.bind(null,Vo,e),[t.memoizedState,e]}function ta(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},null===(t=Vo.updateQueue)?(t={lastEffect:null},Vo.updateQueue=t,t.lastEffect=e.next=e):null===(n=t.lastEffect)?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e),e}function na(){return $o().memoizedState}function ra(e,t,n,r){var i=Yo();Vo.effectTag|=e,i.memoizedState=ta(1|t,n,void 0,void 0===r?null:r)}function ia(e,t,n,r){var i=$o();r=void 0===r?null:r;var o=void 0;if(null!==Ho){var a=Ho.memoizedState;if(o=a.destroy,null!==r&&Jo(r,a.deps))return void ta(t,n,o,r)}Vo.effectTag|=e,i.memoizedState=ta(1|t,n,o,r)}function oa(e,t){return ra(516,4,e,t)}function aa(e,t){return ia(516,4,e,t)}function sa(e,t){return ia(4,2,e,t)}function ua(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function ca(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,ia(4,2,ua.bind(null,t,e),n)}function la(){}function da(e,t){return Yo().memoizedState=[e,void 0===t?null:t],e}function fa(e,t){var n=$o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Jo(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function pa(e,t){var n=$o();t=void 0===t?null:t;var r=n.memoizedState;return null!==r&&null!==t&&Jo(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function ha(e,t,n){var r=Ui();Vi(98>r?98:r,(function(){e(!0)})),Vi(97<r?97:r,(function(){var r=Uo.suspense;Uo.suspense=void 0===t?null:t;try{e(!1),n()}finally{Uo.suspense=r}}))}function ga(e,t,n){var r=Gs(),i=po.suspense;i={expirationTime:r=Js(r,e,i),suspenseConfig:i,action:n,eagerReducer:null,eagerState:null,next:null};var o=t.pending;if(null===o?i.next=i:(i.next=o.next,o.next=i),t.pending=i,o=e.alternate,e===Vo||null!==o&&o===Vo)qo=!0,i.expirationTime=Bo,Vo.expirationTime=Bo;else{if(0===e.expirationTime&&(null===o||0===o.expirationTime)&&null!==(o=t.lastRenderedReducer))try{var a=t.lastRenderedState,s=o(a,n);if(i.eagerReducer=o,i.eagerState=s,Dr(s,a))return}catch(u){}Ks(e,r)}}var va={readContext:ro,useCallback:Go,useContext:Go,useEffect:Go,useImperativeHandle:Go,useLayoutEffect:Go,useMemo:Go,useReducer:Go,useRef:Go,useState:Go,useDebugValue:Go,useResponder:Go,useDeferredValue:Go,useTransition:Go},ya={readContext:ro,useCallback:da,useContext:ro,useEffect:oa,useImperativeHandle:function(e,t,n){return n=null!==n&&void 0!==n?n.concat([e]):null,ra(4,2,ua.bind(null,t,e),n)},useLayoutEffect:function(e,t){return ra(4,2,e,t)},useMemo:function(e,t){var n=Yo();return t=void 0===t?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Yo();return t=void 0!==n?n(t):t,r.memoizedState=r.baseState=t,e=(e=r.queue={pending:null,dispatch:null,lastRenderedReducer:e,lastRenderedState:t}).dispatch=ga.bind(null,Vo,e),[r.memoizedState,e]},useRef:function(e){return e={current:e},Yo().memoizedState=e},useState:ea,useDebugValue:la,useResponder:Wo,useDeferredValue:function(e,t){var n=ea(e),r=n[0],i=n[1];return oa((function(){var n=Uo.suspense;Uo.suspense=void 0===t?null:t;try{i(e)}finally{Uo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=ea(!1),n=t[0];return t=t[1],[da(ha.bind(null,t,e),[t,e]),n]}},ma={readContext:ro,useCallback:fa,useContext:ro,useEffect:aa,useImperativeHandle:ca,useLayoutEffect:sa,useMemo:pa,useReducer:Xo,useRef:na,useState:function(){return Xo(Qo)},useDebugValue:la,useResponder:Wo,useDeferredValue:function(e,t){var n=Xo(Qo),r=n[0],i=n[1];return aa((function(){var n=Uo.suspense;Uo.suspense=void 0===t?null:t;try{i(e)}finally{Uo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=Xo(Qo),n=t[0];return t=t[1],[fa(ha.bind(null,t,e),[t,e]),n]}},ba={readContext:ro,useCallback:fa,useContext:ro,useEffect:aa,useImperativeHandle:ca,useLayoutEffect:sa,useMemo:pa,useReducer:Zo,useRef:na,useState:function(){return Zo(Qo)},useDebugValue:la,useResponder:Wo,useDeferredValue:function(e,t){var n=Zo(Qo),r=n[0],i=n[1];return aa((function(){var n=Uo.suspense;Uo.suspense=void 0===t?null:t;try{i(e)}finally{Uo.suspense=n}}),[e,t]),r},useTransition:function(e){var t=Zo(Qo),n=t[0];return t=t[1],[fa(ha.bind(null,t,e),[t,e]),n]}},wa=null,_a=null,ka=!1;function xa(e,t){var n=Su(5,null,null,0);n.elementType="DELETED",n.type="DELETED",n.stateNode=t,n.return=e,n.effectTag=8,null!==e.lastEffect?(e.lastEffect.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n}function Sa(e,t){switch(e.tag){case 5:var n=e.type;return null!==(t=1!==t.nodeType||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,!0);case 13:default:return!1}}function Ia(e){if(ka){var t=_a;if(t){var n=t;if(!Sa(e,t)){if(!(t=_n(n.nextSibling))||!Sa(e,t))return e.effectTag=-1025&e.effectTag|2,ka=!1,void(wa=e);xa(wa,n)}wa=e,_a=_n(t.firstChild)}else e.effectTag=-1025&e.effectTag|2,ka=!1,wa=e}}function Ca(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;wa=e}function Ta(e){if(e!==wa)return!1;if(!ka)return Ca(e),ka=!0,!1;var t=e.type;if(5!==e.tag||"head"!==t&&"body"!==t&&!mn(t,e.memoizedProps))for(t=_a;t;)xa(e,t),t=_n(t.nextSibling);if(Ca(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(a(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var n=e.data;if("/$"===n){if(0===t){_a=_n(e.nextSibling);break e}t--}else"$"!==n&&"$!"!==n&&"$?"!==n||t++}e=e.nextSibling}_a=null}}else _a=wa?_n(e.stateNode.nextSibling):null;return!0}function Pa(){_a=wa=null,ka=!1}var Aa=$.ReactCurrentOwner,Ea=!1;function Oa(e,t,n,r){t.child=null===e?Co(t,null,n,r):Io(t,e.child,n,r)}function Ma(e,t,n,r,i){n=n.render;var o=t.ref;return no(t,i),r=Ko(e,t,n,r,o,i),null===e||Ea?(t.effectTag|=1,Oa(e,t,r,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),Ka(e,t,i))}function ja(e,t,n,r,i,o){if(null===e){var a=n.type;return"function"!==typeof a||Iu(a)||void 0!==a.defaultProps||null!==n.compare||void 0!==n.defaultProps?((e=Tu(n.type,null,r,null,t.mode,o)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=a,Ra(e,t,a,r,i,o))}return a=e.child,i<o&&(i=a.memoizedProps,(n=null!==(n=n.compare)?n:Fr)(i,r)&&e.ref===t.ref)?Ka(e,t,o):(t.effectTag|=1,(e=Cu(a,r)).ref=t.ref,e.return=t,t.child=e)}function Ra(e,t,n,r,i,o){return null!==e&&Fr(e.memoizedProps,r)&&e.ref===t.ref&&(Ea=!1,i<o)?(t.expirationTime=e.expirationTime,Ka(e,t,o)):La(e,t,n,r,o)}function Na(e,t){var n=t.ref;(null===e&&null!==n||null!==e&&e.ref!==n)&&(t.effectTag|=128)}function La(e,t,n,r,i){var o=gi(n)?pi:di.current;return o=hi(t,o),no(t,i),n=Ko(e,t,n,r,o,i),null===e||Ea?(t.effectTag|=1,Oa(e,t,n,i),t.child):(t.updateQueue=e.updateQueue,t.effectTag&=-517,e.expirationTime<=i&&(e.expirationTime=0),Ka(e,t,i))}function Da(e,t,n,r,i){if(gi(n)){var o=!0;bi(t)}else o=!1;if(no(t,i),null===t.stateNode)null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),mo(t,n,r),wo(t,n,r,i),r=!0;else if(null===e){var a=t.stateNode,s=t.memoizedProps;a.props=s;var u=a.context,c=n.contextType;"object"===typeof c&&null!==c?c=ro(c):c=hi(t,c=gi(n)?pi:di.current);var l=n.getDerivedStateFromProps,d="function"===typeof l||"function"===typeof a.getSnapshotBeforeUpdate;d||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==c)&&bo(t,a,r,c),io=!1;var f=t.memoizedState;a.state=f,lo(t,r,a,i),u=t.memoizedState,s!==r||f!==u||fi.current||io?("function"===typeof l&&(go(t,n,l,r),u=t.memoizedState),(s=io||yo(t,n,s,r,f,u,c))?(d||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.effectTag|=4)):("function"===typeof a.componentDidMount&&(t.effectTag|=4),t.memoizedProps=r,t.memoizedState=u),a.props=r,a.state=u,a.context=c,r=s):("function"===typeof a.componentDidMount&&(t.effectTag|=4),r=!1)}else a=t.stateNode,ao(e,t),s=t.memoizedProps,a.props=t.type===t.elementType?s:Ki(t.type,s),u=a.context,"object"===typeof(c=n.contextType)&&null!==c?c=ro(c):c=hi(t,c=gi(n)?pi:di.current),(d="function"===typeof(l=n.getDerivedStateFromProps)||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(s!==r||u!==c)&&bo(t,a,r,c),io=!1,u=t.memoizedState,a.state=u,lo(t,r,a,i),f=t.memoizedState,s!==r||u!==f||fi.current||io?("function"===typeof l&&(go(t,n,l,r),f=t.memoizedState),(l=io||yo(t,n,s,r,u,f,c))?(d||"function"!==typeof a.UNSAFE_componentWillUpdate&&"function"!==typeof a.componentWillUpdate||("function"===typeof a.componentWillUpdate&&a.componentWillUpdate(r,f,c),"function"===typeof a.UNSAFE_componentWillUpdate&&a.UNSAFE_componentWillUpdate(r,f,c)),"function"===typeof a.componentDidUpdate&&(t.effectTag|=4),"function"===typeof a.getSnapshotBeforeUpdate&&(t.effectTag|=256)):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.effectTag|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.effectTag|=256),t.memoizedProps=r,t.memoizedState=f),a.props=r,a.state=f,a.context=c,r=l):("function"!==typeof a.componentDidUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.effectTag|=4),"function"!==typeof a.getSnapshotBeforeUpdate||s===e.memoizedProps&&u===e.memoizedState||(t.effectTag|=256),r=!1);return Wa(e,t,n,r,o,i)}function Wa(e,t,n,r,i,o){Na(e,t);var a=0!==(64&t.effectTag);if(!r&&!a)return i&&wi(t,n,!1),Ka(e,t,o);r=t.stateNode,Aa.current=t;var s=a&&"function"!==typeof n.getDerivedStateFromError?null:r.render();return t.effectTag|=1,null!==e&&a?(t.child=Io(t,e.child,null,o),t.child=Io(t,null,s,o)):Oa(e,t,s,o),t.memoizedState=r.state,i&&wi(t,n,!0),t.child}function Fa(e){var t=e.stateNode;t.pendingContext?yi(0,t.pendingContext,t.pendingContext!==t.context):t.context&&yi(0,t.context,!1),Mo(e,t.containerInfo)}var Ua,Ba,Va,Ha={dehydrated:null,retryTime:0};function za(e,t,n){var r,i=t.mode,o=t.pendingProps,a=Lo.current,s=!1;if((r=0!==(64&t.effectTag))||(r=0!==(2&a)&&(null===e||null!==e.memoizedState)),r?(s=!0,t.effectTag&=-65):null!==e&&null===e.memoizedState||void 0===o.fallback||!0===o.unstable_avoidThisFallback||(a|=1),ci(Lo,1&a),null===e){if(void 0!==o.fallback&&Ia(t),s){if(s=o.fallback,(o=Pu(null,i,0,null)).return=t,0===(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=Pu(s,i,n,null)).return=t,o.sibling=n,t.memoizedState=Ha,t.child=o,n}return i=o.children,t.memoizedState=null,t.child=Co(t,null,i,n)}if(null!==e.memoizedState){if(i=(e=e.child).sibling,s){if(o=o.fallback,(n=Cu(e,e.pendingProps)).return=t,0===(2&t.mode)&&(s=null!==t.memoizedState?t.child.child:t.child)!==e.child)for(n.child=s;null!==s;)s.return=n,s=s.sibling;return(i=Cu(i,o)).return=t,n.sibling=i,n.childExpirationTime=0,t.memoizedState=Ha,t.child=n,i}return n=Io(t,e.child,o.children,n),t.memoizedState=null,t.child=n}if(e=e.child,s){if(s=o.fallback,(o=Pu(null,i,0,null)).return=t,o.child=e,null!==e&&(e.return=o),0===(2&t.mode))for(e=null!==t.memoizedState?t.child.child:t.child,o.child=e;null!==e;)e.return=o,e=e.sibling;return(n=Pu(s,i,n,null)).return=t,o.sibling=n,n.effectTag|=2,o.childExpirationTime=0,t.memoizedState=Ha,t.child=o,n}return t.memoizedState=null,t.child=Io(t,e,o.children,n)}function qa(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t),to(e.return,t)}function Ga(e,t,n,r,i,o){var a=e.memoizedState;null===a?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailExpiration:0,tailMode:i,lastEffect:o}:(a.isBackwards=t,a.rendering=null,a.renderingStartTime=0,a.last=r,a.tail=n,a.tailExpiration=0,a.tailMode=i,a.lastEffect=o)}function Ja(e,t,n){var r=t.pendingProps,i=r.revealOrder,o=r.tail;if(Oa(e,t,r.children,n),0!==(2&(r=Lo.current)))r=1&r|2,t.effectTag|=64;else{if(null!==e&&0!==(64&e.effectTag))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&qa(e,n);else if(19===e.tag)qa(e,n);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(ci(Lo,r),0===(2&t.mode))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;null!==n;)null!==(e=n.alternate)&&null===Do(e)&&(i=n),n=n.sibling;null===(n=i)?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Ga(t,!1,i,n,o,t.lastEffect);break;case"backwards":for(n=null,i=t.child,t.child=null;null!==i;){if(null!==(e=i.alternate)&&null===Do(e)){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Ga(t,!0,n,null,o,t.lastEffect);break;case"together":Ga(t,!1,null,null,void 0,t.lastEffect);break;default:t.memoizedState=null}return t.child}function Ka(e,t,n){null!==e&&(t.dependencies=e.dependencies);var r=t.expirationTime;if(0!==r&&au(r),t.childExpirationTime<n)return null;if(null!==e&&t.child!==e.child)throw Error(a(153));if(null!==t.child){for(n=Cu(e=t.child,e.pendingProps),t.child=n,n.return=t;null!==e.sibling;)e=e.sibling,(n=n.sibling=Cu(e,e.pendingProps)).return=t;n.sibling=null}return t.child}function Ya(e,t){switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;null!==t;)null!==t.alternate&&(n=t),t=t.sibling;null===n?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;null!==n;)null!==n.alternate&&(r=n),n=n.sibling;null===r?t||null===e.tail?e.tail=null:e.tail.sibling=null:r.sibling=null}}function $a(e,t,n){var r=t.pendingProps;switch(t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return null;case 1:return gi(t.type)&&vi(),null;case 3:return jo(),ui(fi),ui(di),(n=t.stateNode).pendingContext&&(n.context=n.pendingContext,n.pendingContext=null),null!==e&&null!==e.child||!Ta(t)||(t.effectTag|=4),null;case 5:No(t),n=Oo(Eo.current);var o=t.type;if(null!==e&&null!=t.stateNode)Ba(e,t,o,r,n),e.ref!==t.ref&&(t.effectTag|=128);else{if(!r){if(null===t.stateNode)throw Error(a(166));return null}if(e=Oo(Po.current),Ta(t)){r=t.stateNode,o=t.type;var s=t.memoizedProps;switch(r[Sn]=t,r[In]=s,o){case"iframe":case"object":case"embed":Jt("load",r);break;case"video":case"audio":for(e=0;e<$e.length;e++)Jt($e[e],r);break;case"source":Jt("error",r);break;case"img":case"image":case"link":Jt("error",r),Jt("load",r);break;case"form":Jt("reset",r),Jt("submit",r);break;case"details":Jt("toggle",r);break;case"input":xe(r,s),Jt("invalid",r),un(n,"onChange");break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Jt("invalid",r),un(n,"onChange");break;case"textarea":Oe(r,s),Jt("invalid",r),un(n,"onChange")}for(var u in on(o,s),e=null,s)if(s.hasOwnProperty(u)){var c=s[u];"children"===u?"string"===typeof c?r.textContent!==c&&(e=["children",c]):"number"===typeof c&&r.textContent!==""+c&&(e=["children",""+c]):S.hasOwnProperty(u)&&null!=c&&un(n,u)}switch(o){case"input":we(r),Ce(r,s,!0);break;case"textarea":we(r),je(r);break;case"select":case"option":break;default:"function"===typeof s.onClick&&(r.onclick=cn)}n=e,t.updateQueue=n,null!==n&&(t.effectTag|=4)}else{switch(u=9===n.nodeType?n:n.ownerDocument,e===sn&&(e=Le(o)),e===sn?"script"===o?((e=u.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof r.is?e=u.createElement(o,{is:r.is}):(e=u.createElement(o),"select"===o&&(u=e,r.multiple?u.multiple=!0:r.size&&(u.size=r.size))):e=u.createElementNS(e,o),e[Sn]=t,e[In]=r,Ua(e,t),t.stateNode=e,u=an(o,r),o){case"iframe":case"object":case"embed":Jt("load",e),c=r;break;case"video":case"audio":for(c=0;c<$e.length;c++)Jt($e[c],e);c=r;break;case"source":Jt("error",e),c=r;break;case"img":case"image":case"link":Jt("error",e),Jt("load",e),c=r;break;case"form":Jt("reset",e),Jt("submit",e),c=r;break;case"details":Jt("toggle",e),c=r;break;case"input":xe(e,r),c=ke(e,r),Jt("invalid",e),un(n,"onChange");break;case"option":c=Pe(e,r);break;case"select":e._wrapperState={wasMultiple:!!r.multiple},c=i({},r,{value:void 0}),Jt("invalid",e),un(n,"onChange");break;case"textarea":Oe(e,r),c=Ee(e,r),Jt("invalid",e),un(n,"onChange");break;default:c=r}on(o,c);var l=c;for(s in l)if(l.hasOwnProperty(s)){var d=l[s];"style"===s?nn(e,d):"dangerouslySetInnerHTML"===s?null!=(d=d?d.__html:void 0)&&Fe(e,d):"children"===s?"string"===typeof d?("textarea"!==o||""!==d)&&Ue(e,d):"number"===typeof d&&Ue(e,""+d):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(S.hasOwnProperty(s)?null!=d&&un(n,s):null!=d&&Q(e,s,d,u))}switch(o){case"input":we(e),Ce(e,r,!1);break;case"textarea":we(e),je(e);break;case"option":null!=r.value&&e.setAttribute("value",""+me(r.value));break;case"select":e.multiple=!!r.multiple,null!=(n=r.value)?Ae(e,!!r.multiple,n,!1):null!=r.defaultValue&&Ae(e,!!r.multiple,r.defaultValue,!0);break;default:"function"===typeof c.onClick&&(e.onclick=cn)}yn(o,r)&&(t.effectTag|=4)}null!==t.ref&&(t.effectTag|=128)}return null;case 6:if(e&&null!=t.stateNode)Va(0,t,e.memoizedProps,r);else{if("string"!==typeof r&&null===t.stateNode)throw Error(a(166));n=Oo(Eo.current),Oo(Po.current),Ta(t)?(n=t.stateNode,r=t.memoizedProps,n[Sn]=t,n.nodeValue!==r&&(t.effectTag|=4)):((n=(9===n.nodeType?n:n.ownerDocument).createTextNode(r))[Sn]=t,t.stateNode=n)}return null;case 13:return ui(Lo),r=t.memoizedState,0!==(64&t.effectTag)?(t.expirationTime=n,t):(n=null!==r,r=!1,null===e?void 0!==t.memoizedProps.fallback&&Ta(t):(r=null!==(o=e.memoizedState),n||null===o||null!==(o=e.child.sibling)&&(null!==(s=t.firstEffect)?(t.firstEffect=o,o.nextEffect=s):(t.firstEffect=t.lastEffect=o,o.nextEffect=null),o.effectTag=8)),n&&!r&&0!==(2&t.mode)&&(null===e&&!0!==t.memoizedProps.unstable_avoidThisFallback||0!==(1&Lo.current)?Ts===ws&&(Ts=_s):(Ts!==ws&&Ts!==_s||(Ts=ks),0!==Ms&&null!==Ss&&(ju(Ss,Cs),Ru(Ss,Ms)))),(n||r)&&(t.effectTag|=4),null);case 4:return jo(),null;case 10:return eo(t),null;case 17:return gi(t.type)&&vi(),null;case 19:if(ui(Lo),null===(r=t.memoizedState))return null;if(o=0!==(64&t.effectTag),null===(s=r.rendering)){if(o)Ya(r,!1);else if(Ts!==ws||null!==e&&0!==(64&e.effectTag))for(s=t.child;null!==s;){if(null!==(e=Do(s))){for(t.effectTag|=64,Ya(r,!1),null!==(o=e.updateQueue)&&(t.updateQueue=o,t.effectTag|=4),null===r.lastEffect&&(t.firstEffect=null),t.lastEffect=r.lastEffect,r=t.child;null!==r;)s=n,(o=r).effectTag&=2,o.nextEffect=null,o.firstEffect=null,o.lastEffect=null,null===(e=o.alternate)?(o.childExpirationTime=0,o.expirationTime=s,o.child=null,o.memoizedProps=null,o.memoizedState=null,o.updateQueue=null,o.dependencies=null):(o.childExpirationTime=e.childExpirationTime,o.expirationTime=e.expirationTime,o.child=e.child,o.memoizedProps=e.memoizedProps,o.memoizedState=e.memoizedState,o.updateQueue=e.updateQueue,s=e.dependencies,o.dependencies=null===s?null:{expirationTime:s.expirationTime,firstContext:s.firstContext,responders:s.responders}),r=r.sibling;return ci(Lo,1&Lo.current|2),t.child}s=s.sibling}}else{if(!o)if(null!==(e=Do(s))){if(t.effectTag|=64,o=!0,null!==(n=e.updateQueue)&&(t.updateQueue=n,t.effectTag|=4),Ya(r,!0),null===r.tail&&"hidden"===r.tailMode&&!s.alternate)return null!==(t=t.lastEffect=r.lastEffect)&&(t.nextEffect=null),null}else 2*Fi()-r.renderingStartTime>r.tailExpiration&&1<n&&(t.effectTag|=64,o=!0,Ya(r,!1),t.expirationTime=t.childExpirationTime=n-1);r.isBackwards?(s.sibling=t.child,t.child=s):(null!==(n=r.last)?n.sibling=s:t.child=s,r.last=s)}return null!==r.tail?(0===r.tailExpiration&&(r.tailExpiration=Fi()+500),n=r.tail,r.rendering=n,r.tail=n.sibling,r.lastEffect=t.lastEffect,r.renderingStartTime=Fi(),n.sibling=null,t=Lo.current,ci(Lo,o?1&t|2:1&t),n):null}throw Error(a(156,t.tag))}function Qa(e){switch(e.tag){case 1:gi(e.type)&&vi();var t=e.effectTag;return 4096&t?(e.effectTag=-4097&t|64,e):null;case 3:if(jo(),ui(fi),ui(di),0!==(64&(t=e.effectTag)))throw Error(a(285));return e.effectTag=-4097&t|64,e;case 5:return No(e),null;case 13:return ui(Lo),4096&(t=e.effectTag)?(e.effectTag=-4097&t|64,e):null;case 19:return ui(Lo),null;case 4:return jo(),null;case 10:return eo(e),null;default:return null}}function Xa(e,t){return{value:e,source:t,stack:ye(t)}}Ua=function(e,t){for(var n=t.child;null!==n;){if(5===n.tag||6===n.tag)e.appendChild(n.stateNode);else if(4!==n.tag&&null!==n.child){n.child.return=n,n=n.child;continue}if(n===t)break;for(;null===n.sibling;){if(null===n.return||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}},Ba=function(e,t,n,r,o){var a=e.memoizedProps;if(a!==r){var s,u,c=t.stateNode;switch(Oo(Po.current),e=null,n){case"input":a=ke(c,a),r=ke(c,r),e=[];break;case"option":a=Pe(c,a),r=Pe(c,r),e=[];break;case"select":a=i({},a,{value:void 0}),r=i({},r,{value:void 0}),e=[];break;case"textarea":a=Ee(c,a),r=Ee(c,r),e=[];break;default:"function"!==typeof a.onClick&&"function"===typeof r.onClick&&(c.onclick=cn)}for(s in on(n,r),n=null,a)if(!r.hasOwnProperty(s)&&a.hasOwnProperty(s)&&null!=a[s])if("style"===s)for(u in c=a[s])c.hasOwnProperty(u)&&(n||(n={}),n[u]="");else"dangerouslySetInnerHTML"!==s&&"children"!==s&&"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&"autoFocus"!==s&&(S.hasOwnProperty(s)?e||(e=[]):(e=e||[]).push(s,null));for(s in r){var l=r[s];if(c=null!=a?a[s]:void 0,r.hasOwnProperty(s)&&l!==c&&(null!=l||null!=c))if("style"===s)if(c){for(u in c)!c.hasOwnProperty(u)||l&&l.hasOwnProperty(u)||(n||(n={}),n[u]="");for(u in l)l.hasOwnProperty(u)&&c[u]!==l[u]&&(n||(n={}),n[u]=l[u])}else n||(e||(e=[]),e.push(s,n)),n=l;else"dangerouslySetInnerHTML"===s?(l=l?l.__html:void 0,c=c?c.__html:void 0,null!=l&&c!==l&&(e=e||[]).push(s,l)):"children"===s?c===l||"string"!==typeof l&&"number"!==typeof l||(e=e||[]).push(s,""+l):"suppressContentEditableWarning"!==s&&"suppressHydrationWarning"!==s&&(S.hasOwnProperty(s)?(null!=l&&un(o,s),e||c===l||(e=[])):(e=e||[]).push(s,l))}n&&(e=e||[]).push("style",n),o=e,(t.updateQueue=o)&&(t.effectTag|=4)}},Va=function(e,t,n,r){n!==r&&(t.effectTag|=4)};var Za="function"===typeof WeakSet?WeakSet:Set;function es(e,t){var n=t.source,r=t.stack;null===r&&null!==n&&(r=ye(n)),null!==n&&ve(n.type),t=t.value,null!==e&&1===e.tag&&ve(e.type);try{console.error(t)}catch(i){setTimeout((function(){throw i}))}}function ts(e){var t=e.ref;if(null!==t)if("function"===typeof t)try{t(null)}catch(n){mu(e,n)}else t.current=null}function ns(e,t){switch(t.tag){case 0:case 11:case 15:case 22:return;case 1:if(256&t.effectTag&&null!==e){var n=e.memoizedProps,r=e.memoizedState;t=(e=t.stateNode).getSnapshotBeforeUpdate(t.elementType===t.type?n:Ki(t.type,n),r),e.__reactInternalSnapshotBeforeUpdate=t}return;case 3:case 5:case 6:case 4:case 17:return}throw Error(a(163))}function rs(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&r()}n=n.next}while(n!==t)}}function is(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function os(e,t,n){switch(n.tag){case 0:case 11:case 15:case 22:return void is(3,n);case 1:if(e=n.stateNode,4&n.effectTag)if(null===t)e.componentDidMount();else{var r=n.elementType===n.type?t.memoizedProps:Ki(n.type,t.memoizedProps);e.componentDidUpdate(r,t.memoizedState,e.__reactInternalSnapshotBeforeUpdate)}return void(null!==(t=n.updateQueue)&&fo(n,t,e));case 3:if(null!==(t=n.updateQueue)){if(e=null,null!==n.child)switch(n.child.tag){case 5:e=n.child.stateNode;break;case 1:e=n.child.stateNode}fo(n,t,e)}return;case 5:return e=n.stateNode,void(null===t&&4&n.effectTag&&yn(n.type,n.memoizedProps)&&e.focus());case 6:case 4:case 12:return;case 13:return void(null===n.memoizedState&&(n=n.alternate,null!==n&&(n=n.memoizedState,null!==n&&(n=n.dehydrated,null!==n&&Lt(n)))));case 19:case 17:case 20:case 21:return}throw Error(a(163))}function as(e,t,n){switch("function"===typeof ku&&ku(t),t.tag){case 0:case 11:case 14:case 15:case 22:if(null!==(e=t.updateQueue)&&null!==(e=e.lastEffect)){var r=e.next;Vi(97<n?97:n,(function(){var e=r;do{var n=e.destroy;if(void 0!==n){var i=t;try{n()}catch(o){mu(i,o)}}e=e.next}while(e!==r)}))}break;case 1:ts(t),"function"===typeof(n=t.stateNode).componentWillUnmount&&function(e,t){try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(n){mu(e,n)}}(t,n);break;case 5:ts(t);break;case 4:ls(e,t,n)}}function ss(e){var t=e.alternate;e.return=null,e.child=null,e.memoizedState=null,e.updateQueue=null,e.dependencies=null,e.alternate=null,e.firstEffect=null,e.lastEffect=null,e.pendingProps=null,e.memoizedProps=null,e.stateNode=null,null!==t&&ss(t)}function us(e){return 5===e.tag||3===e.tag||4===e.tag}function cs(e){e:{for(var t=e.return;null!==t;){if(us(t)){var n=t;break e}t=t.return}throw Error(a(160))}switch(t=n.stateNode,n.tag){case 5:var r=!1;break;case 3:case 4:t=t.containerInfo,r=!0;break;default:throw Error(a(161))}16&n.effectTag&&(Ue(t,""),n.effectTag&=-17);e:t:for(n=e;;){for(;null===n.sibling;){if(null===n.return||us(n.return)){n=null;break e}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag&&18!==n.tag;){if(2&n.effectTag)continue t;if(null===n.child||4===n.tag)continue t;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break e}}r?function e(t,n,r){var i=t.tag,o=5===i||6===i;if(o)t=o?t.stateNode:t.stateNode.instance,n?8===r.nodeType?r.parentNode.insertBefore(t,n):r.insertBefore(t,n):(8===r.nodeType?(n=r.parentNode).insertBefore(t,r):(n=r).appendChild(t),null!==(r=r._reactRootContainer)&&void 0!==r||null!==n.onclick||(n.onclick=cn));else if(4!==i&&null!==(t=t.child))for(e(t,n,r),t=t.sibling;null!==t;)e(t,n,r),t=t.sibling}(e,n,t):function e(t,n,r){var i=t.tag,o=5===i||6===i;if(o)t=o?t.stateNode:t.stateNode.instance,n?r.insertBefore(t,n):r.appendChild(t);else if(4!==i&&null!==(t=t.child))for(e(t,n,r),t=t.sibling;null!==t;)e(t,n,r),t=t.sibling}(e,n,t)}function ls(e,t,n){for(var r,i,o=t,s=!1;;){if(!s){s=o.return;e:for(;;){if(null===s)throw Error(a(160));switch(r=s.stateNode,s.tag){case 5:i=!1;break e;case 3:case 4:r=r.containerInfo,i=!0;break e}s=s.return}s=!0}if(5===o.tag||6===o.tag){e:for(var u=e,c=o,l=n,d=c;;)if(as(u,d,l),null!==d.child&&4!==d.tag)d.child.return=d,d=d.child;else{if(d===c)break e;for(;null===d.sibling;){if(null===d.return||d.return===c)break e;d=d.return}d.sibling.return=d.return,d=d.sibling}i?(u=r,c=o.stateNode,8===u.nodeType?u.parentNode.removeChild(c):u.removeChild(c)):r.removeChild(o.stateNode)}else if(4===o.tag){if(null!==o.child){r=o.stateNode.containerInfo,i=!0,o.child.return=o,o=o.child;continue}}else if(as(e,o,n),null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;4===(o=o.return).tag&&(s=!1)}o.sibling.return=o.return,o=o.sibling}}function ds(e,t){switch(t.tag){case 0:case 11:case 14:case 15:case 22:return void rs(3,t);case 1:return;case 5:var n=t.stateNode;if(null!=n){var r=t.memoizedProps,i=null!==e?e.memoizedProps:r;e=t.type;var o=t.updateQueue;if(t.updateQueue=null,null!==o){for(n[In]=r,"input"===e&&"radio"===r.type&&null!=r.name&&Se(n,r),an(e,i),t=an(e,r),i=0;i<o.length;i+=2){var s=o[i],u=o[i+1];"style"===s?nn(n,u):"dangerouslySetInnerHTML"===s?Fe(n,u):"children"===s?Ue(n,u):Q(n,s,u,t)}switch(e){case"input":Ie(n,r);break;case"textarea":Me(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,null!=(e=r.value)?Ae(n,!!r.multiple,e,!1):t!==!!r.multiple&&(null!=r.defaultValue?Ae(n,!!r.multiple,r.defaultValue,!0):Ae(n,!!r.multiple,r.multiple?[]:"",!1))}}}return;case 6:if(null===t.stateNode)throw Error(a(162));return void(t.stateNode.nodeValue=t.memoizedProps);case 3:return void((t=t.stateNode).hydrate&&(t.hydrate=!1,Lt(t.containerInfo)));case 12:return;case 13:if(n=t,null===t.memoizedState?r=!1:(r=!0,n=t.child,Rs=Fi()),null!==n)e:for(e=n;;){if(5===e.tag)o=e.stateNode,r?"function"===typeof(o=o.style).setProperty?o.setProperty("display","none","important"):o.display="none":(o=e.stateNode,i=void 0!==(i=e.memoizedProps.style)&&null!==i&&i.hasOwnProperty("display")?i.display:null,o.style.display=tn("display",i));else if(6===e.tag)e.stateNode.nodeValue=r?"":e.memoizedProps;else{if(13===e.tag&&null!==e.memoizedState&&null===e.memoizedState.dehydrated){(o=e.child.sibling).return=e,e=o;continue}if(null!==e.child){e.child.return=e,e=e.child;continue}}if(e===n)break;for(;null===e.sibling;){if(null===e.return||e.return===n)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}return void fs(t);case 19:return void fs(t);case 17:return}throw Error(a(163))}function fs(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var n=e.stateNode;null===n&&(n=e.stateNode=new Za),t.forEach((function(t){var r=wu.bind(null,e,t);n.has(t)||(n.add(t),t.then(r,r))}))}}var ps="function"===typeof WeakMap?WeakMap:Map;function hs(e,t,n){(n=so(n,null)).tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){Ls||(Ls=!0,Ds=r),es(e,t)},n}function gs(e,t,n){(n=so(n,null)).tag=3;var r=e.type.getDerivedStateFromError;if("function"===typeof r){var i=t.value;n.payload=function(){return es(e,t),r(i)}}var o=e.stateNode;return null!==o&&"function"===typeof o.componentDidCatch&&(n.callback=function(){"function"!==typeof r&&(null===Ws?Ws=new Set([this]):Ws.add(this),es(e,t));var n=t.stack;this.componentDidCatch(t.value,{componentStack:null!==n?n:""})}),n}var vs,ys=Math.ceil,ms=$.ReactCurrentDispatcher,bs=$.ReactCurrentOwner,ws=0,_s=3,ks=4,xs=0,Ss=null,Is=null,Cs=0,Ts=ws,Ps=null,As=1073741823,Es=1073741823,Os=null,Ms=0,js=!1,Rs=0,Ns=null,Ls=!1,Ds=null,Ws=null,Fs=!1,Us=null,Bs=90,Vs=null,Hs=0,zs=null,qs=0;function Gs(){return 0!==(48&xs)?1073741821-(Fi()/10|0):0!==qs?qs:qs=1073741821-(Fi()/10|0)}function Js(e,t,n){if(0===(2&(t=t.mode)))return 1073741823;var r=Ui();if(0===(4&t))return 99===r?1073741823:1073741822;if(0!==(16&xs))return Cs;if(null!==n)e=Ji(e,0|n.timeoutMs||5e3,250);else switch(r){case 99:e=1073741823;break;case 98:e=Ji(e,150,100);break;case 97:case 96:e=Ji(e,5e3,250);break;case 95:e=2;break;default:throw Error(a(326))}return null!==Ss&&e===Cs&&--e,e}function Ks(e,t){if(50<Hs)throw Hs=0,zs=null,Error(a(185));if(null!==(e=Ys(e,t))){var n=Ui();1073741823===t?0!==(8&xs)&&0===(48&xs)?Zs(e):(Qs(e),0===xs&&qi()):Qs(e),0===(4&xs)||98!==n&&99!==n||(null===Vs?Vs=new Map([[e,t]]):(void 0===(n=Vs.get(e))||n>t)&&Vs.set(e,t))}}function Ys(e,t){e.expirationTime<t&&(e.expirationTime=t);var n=e.alternate;null!==n&&n.expirationTime<t&&(n.expirationTime=t);var r=e.return,i=null;if(null===r&&3===e.tag)i=e.stateNode;else for(;null!==r;){if(n=r.alternate,r.childExpirationTime<t&&(r.childExpirationTime=t),null!==n&&n.childExpirationTime<t&&(n.childExpirationTime=t),null===r.return&&3===r.tag){i=r.stateNode;break}r=r.return}return null!==i&&(Ss===i&&(au(t),Ts===ks&&ju(i,Cs)),Ru(i,t)),i}function $s(e){var t=e.lastExpiredTime;if(0!==t)return t;if(!Mu(e,t=e.firstPendingTime))return t;var n=e.lastPingedTime;return 2>=(e=n>(e=e.nextKnownPendingLevel)?n:e)&&t!==e?0:e}function Qs(e){if(0!==e.lastExpiredTime)e.callbackExpirationTime=1073741823,e.callbackPriority=99,e.callbackNode=zi(Zs.bind(null,e));else{var t=$s(e),n=e.callbackNode;if(0===t)null!==n&&(e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90);else{var r=Gs();if(1073741823===t?r=99:1===t||2===t?r=95:r=0>=(r=10*(1073741821-t)-10*(1073741821-r))?99:250>=r?98:5250>=r?97:95,null!==n){var i=e.callbackPriority;if(e.callbackExpirationTime===t&&i>=r)return;n!==Mi&&xi(n)}e.callbackExpirationTime=t,e.callbackPriority=r,t=1073741823===t?zi(Zs.bind(null,e)):Hi(r,Xs.bind(null,e),{timeout:10*(1073741821-t)-Fi()}),e.callbackNode=t}}}function Xs(e,t){if(qs=0,t)return Nu(e,t=Gs()),Qs(e),null;var n=$s(e);if(0!==n){if(t=e.callbackNode,0!==(48&xs))throw Error(a(327));if(gu(),e===Ss&&n===Cs||nu(e,n),null!==Is){var r=xs;xs|=16;for(var i=iu();;)try{uu();break}catch(u){ru(e,u)}if(Zi(),xs=r,ms.current=i,1===Ts)throw t=Ps,nu(e,n),ju(e,n),Qs(e),t;if(null===Is)switch(i=e.finishedWork=e.current.alternate,e.finishedExpirationTime=n,r=Ts,Ss=null,r){case ws:case 1:throw Error(a(345));case 2:Nu(e,2<n?2:n);break;case _s:if(ju(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=du(i)),1073741823===As&&10<(i=Rs+500-Fi())){if(js){var o=e.lastPingedTime;if(0===o||o>=n){e.lastPingedTime=n,nu(e,n);break}}if(0!==(o=$s(e))&&o!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}e.timeoutHandle=bn(fu.bind(null,e),i);break}fu(e);break;case ks:if(ju(e,n),n===(r=e.lastSuspendedTime)&&(e.nextKnownPendingLevel=du(i)),js&&(0===(i=e.lastPingedTime)||i>=n)){e.lastPingedTime=n,nu(e,n);break}if(0!==(i=$s(e))&&i!==n)break;if(0!==r&&r!==n){e.lastPingedTime=r;break}if(1073741823!==Es?r=10*(1073741821-Es)-Fi():1073741823===As?r=0:(r=10*(1073741821-As)-5e3,0>(r=(i=Fi())-r)&&(r=0),(n=10*(1073741821-n)-i)<(r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*ys(r/1960))-r)&&(r=n)),10<r){e.timeoutHandle=bn(fu.bind(null,e),r);break}fu(e);break;case 5:if(1073741823!==As&&null!==Os){o=As;var s=Os;if(0>=(r=0|s.busyMinDurationMs)?r=0:(i=0|s.busyDelayMs,r=(o=Fi()-(10*(1073741821-o)-(0|s.timeoutMs||5e3)))<=i?0:i+r-o),10<r){ju(e,n),e.timeoutHandle=bn(fu.bind(null,e),r);break}}fu(e);break;default:throw Error(a(329))}if(Qs(e),e.callbackNode===t)return Xs.bind(null,e)}}return null}function Zs(e){var t=e.lastExpiredTime;if(t=0!==t?t:1073741823,0!==(48&xs))throw Error(a(327));if(gu(),e===Ss&&t===Cs||nu(e,t),null!==Is){var n=xs;xs|=16;for(var r=iu();;)try{su();break}catch(i){ru(e,i)}if(Zi(),xs=n,ms.current=r,1===Ts)throw n=Ps,nu(e,t),ju(e,t),Qs(e),n;if(null!==Is)throw Error(a(261));e.finishedWork=e.current.alternate,e.finishedExpirationTime=t,Ss=null,fu(e),Qs(e)}return null}function eu(e,t){var n=xs;xs|=1;try{return e(t)}finally{0===(xs=n)&&qi()}}function tu(e,t){var n=xs;xs&=-2,xs|=8;try{return e(t)}finally{0===(xs=n)&&qi()}}function nu(e,t){e.finishedWork=null,e.finishedExpirationTime=0;var n=e.timeoutHandle;if(-1!==n&&(e.timeoutHandle=-1,wn(n)),null!==Is)for(n=Is.return;null!==n;){var r=n;switch(r.tag){case 1:null!==(r=r.type.childContextTypes)&&void 0!==r&&vi();break;case 3:jo(),ui(fi),ui(di);break;case 5:No(r);break;case 4:jo();break;case 13:case 19:ui(Lo);break;case 10:eo(r)}n=n.return}Ss=e,Is=Cu(e.current,null),Cs=t,Ts=ws,Ps=null,Es=As=1073741823,Os=null,Ms=0,js=!1}function ru(e,t){for(;;){try{if(Zi(),Fo.current=va,qo)for(var n=Vo.memoizedState;null!==n;){var r=n.queue;null!==r&&(r.pending=null),n=n.next}if(Bo=0,zo=Ho=Vo=null,qo=!1,null===Is||null===Is.return)return Ts=1,Ps=t,Is=null;e:{var i=e,o=Is.return,a=Is,s=t;if(t=Cs,a.effectTag|=2048,a.firstEffect=a.lastEffect=null,null!==s&&"object"===typeof s&&"function"===typeof s.then){var u=s;if(0===(2&a.mode)){var c=a.alternate;c?(a.updateQueue=c.updateQueue,a.memoizedState=c.memoizedState,a.expirationTime=c.expirationTime):(a.updateQueue=null,a.memoizedState=null)}var l=0!==(1&Lo.current),d=o;do{var f;if(f=13===d.tag){var p=d.memoizedState;if(null!==p)f=null!==p.dehydrated;else{var h=d.memoizedProps;f=void 0!==h.fallback&&(!0!==h.unstable_avoidThisFallback||!l)}}if(f){var g=d.updateQueue;if(null===g){var v=new Set;v.add(u),d.updateQueue=v}else g.add(u);if(0===(2&d.mode)){if(d.effectTag|=64,a.effectTag&=-2981,1===a.tag)if(null===a.alternate)a.tag=17;else{var y=so(1073741823,null);y.tag=2,uo(a,y)}a.expirationTime=1073741823;break e}s=void 0,a=t;var m=i.pingCache;if(null===m?(m=i.pingCache=new ps,s=new Set,m.set(u,s)):void 0===(s=m.get(u))&&(s=new Set,m.set(u,s)),!s.has(a)){s.add(a);var b=bu.bind(null,i,u,a);u.then(b,b)}d.effectTag|=4096,d.expirationTime=t;break e}d=d.return}while(null!==d);s=Error((ve(a.type)||"A React component")+" suspended while rendering, but no fallback UI was specified.\n\nAdd a <Suspense fallback=...> component higher in the tree to provide a loading indicator or placeholder to display."+ye(a))}5!==Ts&&(Ts=2),s=Xa(s,a),d=o;do{switch(d.tag){case 3:u=s,d.effectTag|=4096,d.expirationTime=t,co(d,hs(d,u,t));break e;case 1:u=s;var w=d.type,_=d.stateNode;if(0===(64&d.effectTag)&&("function"===typeof w.getDerivedStateFromError||null!==_&&"function"===typeof _.componentDidCatch&&(null===Ws||!Ws.has(_)))){d.effectTag|=4096,d.expirationTime=t,co(d,gs(d,u,t));break e}}d=d.return}while(null!==d)}Is=lu(Is)}catch(k){t=k;continue}break}}function iu(){var e=ms.current;return ms.current=va,null===e?va:e}function ou(e,t){e<As&&2<e&&(As=e),null!==t&&e<Es&&2<e&&(Es=e,Os=t)}function au(e){e>Ms&&(Ms=e)}function su(){for(;null!==Is;)Is=cu(Is)}function uu(){for(;null!==Is&&!ji();)Is=cu(Is)}function cu(e){var t=vs(e.alternate,e,Cs);return e.memoizedProps=e.pendingProps,null===t&&(t=lu(e)),bs.current=null,t}function lu(e){Is=e;do{var t=Is.alternate;if(e=Is.return,0===(2048&Is.effectTag)){if(t=$a(t,Is,Cs),1===Cs||1!==Is.childExpirationTime){for(var n=0,r=Is.child;null!==r;){var i=r.expirationTime,o=r.childExpirationTime;i>n&&(n=i),o>n&&(n=o),r=r.sibling}Is.childExpirationTime=n}if(null!==t)return t;null!==e&&0===(2048&e.effectTag)&&(null===e.firstEffect&&(e.firstEffect=Is.firstEffect),null!==Is.lastEffect&&(null!==e.lastEffect&&(e.lastEffect.nextEffect=Is.firstEffect),e.lastEffect=Is.lastEffect),1<Is.effectTag&&(null!==e.lastEffect?e.lastEffect.nextEffect=Is:e.firstEffect=Is,e.lastEffect=Is))}else{if(null!==(t=Qa(Is)))return t.effectTag&=2047,t;null!==e&&(e.firstEffect=e.lastEffect=null,e.effectTag|=2048)}if(null!==(t=Is.sibling))return t;Is=e}while(null!==Is);return Ts===ws&&(Ts=5),null}function du(e){var t=e.expirationTime;return t>(e=e.childExpirationTime)?t:e}function fu(e){var t=Ui();return Vi(99,pu.bind(null,e,t)),null}function pu(e,t){do{gu()}while(null!==Us);if(0!==(48&xs))throw Error(a(327));var n=e.finishedWork,r=e.finishedExpirationTime;if(null===n)return null;if(e.finishedWork=null,e.finishedExpirationTime=0,n===e.current)throw Error(a(177));e.callbackNode=null,e.callbackExpirationTime=0,e.callbackPriority=90,e.nextKnownPendingLevel=0;var i=du(n);if(e.firstPendingTime=i,r<=e.lastSuspendedTime?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:r<=e.firstSuspendedTime&&(e.firstSuspendedTime=r-1),r<=e.lastPingedTime&&(e.lastPingedTime=0),r<=e.lastExpiredTime&&(e.lastExpiredTime=0),e===Ss&&(Is=Ss=null,Cs=0),1<n.effectTag?null!==n.lastEffect?(n.lastEffect.nextEffect=n,i=n.firstEffect):i=n:i=n.firstEffect,null!==i){var o=xs;xs|=32,bs.current=null,gn=Gt;var s=pn();if(hn(s)){if("selectionStart"in s)var u={start:s.selectionStart,end:s.selectionEnd};else e:{var c=(u=(u=s.ownerDocument)&&u.defaultView||window).getSelection&&u.getSelection();if(c&&0!==c.rangeCount){u=c.anchorNode;var l=c.anchorOffset,d=c.focusNode;c=c.focusOffset;try{u.nodeType,d.nodeType}catch(C){u=null;break e}var f=0,p=-1,h=-1,g=0,v=0,y=s,m=null;t:for(;;){for(var b;y!==u||0!==l&&3!==y.nodeType||(p=f+l),y!==d||0!==c&&3!==y.nodeType||(h=f+c),3===y.nodeType&&(f+=y.nodeValue.length),null!==(b=y.firstChild);)m=y,y=b;for(;;){if(y===s)break t;if(m===u&&++g===l&&(p=f),m===d&&++v===c&&(h=f),null!==(b=y.nextSibling))break;m=(y=m).parentNode}y=b}u=-1===p||-1===h?null:{start:p,end:h}}else u=null}u=u||{start:0,end:0}}else u=null;vn={activeElementDetached:null,focusedElem:s,selectionRange:u},Gt=!1,Ns=i;do{try{hu()}catch(C){if(null===Ns)throw Error(a(330));mu(Ns,C),Ns=Ns.nextEffect}}while(null!==Ns);Ns=i;do{try{for(s=e,u=t;null!==Ns;){var w=Ns.effectTag;if(16&w&&Ue(Ns.stateNode,""),128&w){var _=Ns.alternate;if(null!==_){var k=_.ref;null!==k&&("function"===typeof k?k(null):k.current=null)}}switch(1038&w){case 2:cs(Ns),Ns.effectTag&=-3;break;case 6:cs(Ns),Ns.effectTag&=-3,ds(Ns.alternate,Ns);break;case 1024:Ns.effectTag&=-1025;break;case 1028:Ns.effectTag&=-1025,ds(Ns.alternate,Ns);break;case 4:ds(Ns.alternate,Ns);break;case 8:ls(s,l=Ns,u),ss(l)}Ns=Ns.nextEffect}}catch(C){if(null===Ns)throw Error(a(330));mu(Ns,C),Ns=Ns.nextEffect}}while(null!==Ns);if(k=vn,_=pn(),w=k.focusedElem,u=k.selectionRange,_!==w&&w&&w.ownerDocument&&function e(t,n){return!(!t||!n)&&(t===n||(!t||3!==t.nodeType)&&(n&&3===n.nodeType?e(t,n.parentNode):"contains"in t?t.contains(n):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(n))))}(w.ownerDocument.documentElement,w)){null!==u&&hn(w)&&(_=u.start,void 0===(k=u.end)&&(k=_),"selectionStart"in w?(w.selectionStart=_,w.selectionEnd=Math.min(k,w.value.length)):(k=(_=w.ownerDocument||document)&&_.defaultView||window).getSelection&&(k=k.getSelection(),l=w.textContent.length,s=Math.min(u.start,l),u=void 0===u.end?s:Math.min(u.end,l),!k.extend&&s>u&&(l=u,u=s,s=l),l=fn(w,s),d=fn(w,u),l&&d&&(1!==k.rangeCount||k.anchorNode!==l.node||k.anchorOffset!==l.offset||k.focusNode!==d.node||k.focusOffset!==d.offset)&&((_=_.createRange()).setStart(l.node,l.offset),k.removeAllRanges(),s>u?(k.addRange(_),k.extend(d.node,d.offset)):(_.setEnd(d.node,d.offset),k.addRange(_))))),_=[];for(k=w;k=k.parentNode;)1===k.nodeType&&_.push({element:k,left:k.scrollLeft,top:k.scrollTop});for("function"===typeof w.focus&&w.focus(),w=0;w<_.length;w++)(k=_[w]).element.scrollLeft=k.left,k.element.scrollTop=k.top}Gt=!!gn,vn=gn=null,e.current=n,Ns=i;do{try{for(w=e;null!==Ns;){var x=Ns.effectTag;if(36&x&&os(w,Ns.alternate,Ns),128&x){_=void 0;var S=Ns.ref;if(null!==S){var I=Ns.stateNode;switch(Ns.tag){case 5:_=I;break;default:_=I}"function"===typeof S?S(_):S.current=_}}Ns=Ns.nextEffect}}catch(C){if(null===Ns)throw Error(a(330));mu(Ns,C),Ns=Ns.nextEffect}}while(null!==Ns);Ns=null,Ri(),xs=o}else e.current=n;if(Fs)Fs=!1,Us=e,Bs=t;else for(Ns=i;null!==Ns;)t=Ns.nextEffect,Ns.nextEffect=null,Ns=t;if(0===(t=e.firstPendingTime)&&(Ws=null),1073741823===t?e===zs?Hs++:(Hs=0,zs=e):Hs=0,"function"===typeof _u&&_u(n.stateNode,r),Qs(e),Ls)throw Ls=!1,e=Ds,Ds=null,e;return 0!==(8&xs)||qi(),null}function hu(){for(;null!==Ns;){var e=Ns.effectTag;0!==(256&e)&&ns(Ns.alternate,Ns),0===(512&e)||Fs||(Fs=!0,Hi(97,(function(){return gu(),null}))),Ns=Ns.nextEffect}}function gu(){if(90!==Bs){var e=97<Bs?97:Bs;return Bs=90,Vi(e,vu)}}function vu(){if(null===Us)return!1;var e=Us;if(Us=null,0!==(48&xs))throw Error(a(331));var t=xs;for(xs|=32,e=e.current.firstEffect;null!==e;){try{var n=e;if(0!==(512&n.effectTag))switch(n.tag){case 0:case 11:case 15:case 22:rs(5,n),is(5,n)}}catch(r){if(null===e)throw Error(a(330));mu(e,r)}n=e.nextEffect,e.nextEffect=null,e=n}return xs=t,qi(),!0}function yu(e,t,n){uo(e,t=hs(e,t=Xa(n,t),1073741823)),null!==(e=Ys(e,1073741823))&&Qs(e)}function mu(e,t){if(3===e.tag)yu(e,e,t);else for(var n=e.return;null!==n;){if(3===n.tag){yu(n,e,t);break}if(1===n.tag){var r=n.stateNode;if("function"===typeof n.type.getDerivedStateFromError||"function"===typeof r.componentDidCatch&&(null===Ws||!Ws.has(r))){uo(n,e=gs(n,e=Xa(t,e),1073741823)),null!==(n=Ys(n,1073741823))&&Qs(n);break}}n=n.return}}function bu(e,t,n){var r=e.pingCache;null!==r&&r.delete(t),Ss===e&&Cs===n?Ts===ks||Ts===_s&&1073741823===As&&Fi()-Rs<500?nu(e,Cs):js=!0:Mu(e,n)&&(0!==(t=e.lastPingedTime)&&t<n||(e.lastPingedTime=n,Qs(e)))}function wu(e,t){var n=e.stateNode;null!==n&&n.delete(t),0===(t=0)&&(t=Js(t=Gs(),e,null)),null!==(e=Ys(e,t))&&Qs(e)}vs=function(e,t,n){var r=t.expirationTime;if(null!==e){var i=t.pendingProps;if(e.memoizedProps!==i||fi.current)Ea=!0;else{if(r<n){switch(Ea=!1,t.tag){case 3:Fa(t),Pa();break;case 5:if(Ro(t),4&t.mode&&1!==n&&i.hidden)return t.expirationTime=t.childExpirationTime=1,null;break;case 1:gi(t.type)&&bi(t);break;case 4:Mo(t,t.stateNode.containerInfo);break;case 10:r=t.memoizedProps.value,i=t.type._context,ci(Yi,i._currentValue),i._currentValue=r;break;case 13:if(null!==t.memoizedState)return 0!==(r=t.child.childExpirationTime)&&r>=n?za(e,t,n):(ci(Lo,1&Lo.current),null!==(t=Ka(e,t,n))?t.sibling:null);ci(Lo,1&Lo.current);break;case 19:if(r=t.childExpirationTime>=n,0!==(64&e.effectTag)){if(r)return Ja(e,t,n);t.effectTag|=64}if(null!==(i=t.memoizedState)&&(i.rendering=null,i.tail=null),ci(Lo,Lo.current),!r)return null}return Ka(e,t,n)}Ea=!1}}else Ea=!1;switch(t.expirationTime=0,t.tag){case 2:if(r=t.type,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,i=hi(t,di.current),no(t,n),i=Ko(null,t,r,e,i,n),t.effectTag|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof){if(t.tag=1,t.memoizedState=null,t.updateQueue=null,gi(r)){var o=!0;bi(t)}else o=!1;t.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,oo(t);var s=r.getDerivedStateFromProps;"function"===typeof s&&go(t,r,s,e),i.updater=vo,t.stateNode=i,i._reactInternalFiber=t,wo(t,r,e,n),t=Wa(null,t,r,!0,o,n)}else t.tag=0,Oa(null,t,i,n),t=t.child;return t;case 16:e:{if(i=t.elementType,null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),e=t.pendingProps,function(e){if(-1===e._status){e._status=0;var t=e._ctor;t=t(),e._result=t,t.then((function(t){0===e._status&&(t=t.default,e._status=1,e._result=t)}),(function(t){0===e._status&&(e._status=2,e._result=t)}))}}(i),1!==i._status)throw i._result;switch(i=i._result,t.type=i,o=t.tag=function(e){if("function"===typeof e)return Iu(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===ue)return 11;if(e===de)return 14}return 2}(i),e=Ki(i,e),o){case 0:t=La(null,t,i,e,n);break e;case 1:t=Da(null,t,i,e,n);break e;case 11:t=Ma(null,t,i,e,n);break e;case 14:t=ja(null,t,i,Ki(i.type,e),r,n);break e}throw Error(a(306,i,""))}return t;case 0:return r=t.type,i=t.pendingProps,La(e,t,r,i=t.elementType===r?i:Ki(r,i),n);case 1:return r=t.type,i=t.pendingProps,Da(e,t,r,i=t.elementType===r?i:Ki(r,i),n);case 3:if(Fa(t),r=t.updateQueue,null===e||null===r)throw Error(a(282));if(r=t.pendingProps,i=null!==(i=t.memoizedState)?i.element:null,ao(e,t),lo(t,r,null,n),(r=t.memoizedState.element)===i)Pa(),t=Ka(e,t,n);else{if((i=t.stateNode.hydrate)&&(_a=_n(t.stateNode.containerInfo.firstChild),wa=t,i=ka=!0),i)for(n=Co(t,null,r,n),t.child=n;n;)n.effectTag=-3&n.effectTag|1024,n=n.sibling;else Oa(e,t,r,n),Pa();t=t.child}return t;case 5:return Ro(t),null===e&&Ia(t),r=t.type,i=t.pendingProps,o=null!==e?e.memoizedProps:null,s=i.children,mn(r,i)?s=null:null!==o&&mn(r,o)&&(t.effectTag|=16),Na(e,t),4&t.mode&&1!==n&&i.hidden?(t.expirationTime=t.childExpirationTime=1,t=null):(Oa(e,t,s,n),t=t.child),t;case 6:return null===e&&Ia(t),null;case 13:return za(e,t,n);case 4:return Mo(t,t.stateNode.containerInfo),r=t.pendingProps,null===e?t.child=Io(t,null,r,n):Oa(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,Ma(e,t,r,i=t.elementType===r?i:Ki(r,i),n);case 7:return Oa(e,t,t.pendingProps,n),t.child;case 8:case 12:return Oa(e,t,t.pendingProps.children,n),t.child;case 10:e:{r=t.type._context,i=t.pendingProps,s=t.memoizedProps,o=i.value;var u=t.type._context;if(ci(Yi,u._currentValue),u._currentValue=o,null!==s)if(u=s.value,0===(o=Dr(u,o)?0:0|("function"===typeof r._calculateChangedBits?r._calculateChangedBits(u,o):1073741823))){if(s.children===i.children&&!fi.current){t=Ka(e,t,n);break e}}else for(null!==(u=t.child)&&(u.return=t);null!==u;){var c=u.dependencies;if(null!==c){s=u.child;for(var l=c.firstContext;null!==l;){if(l.context===r&&0!==(l.observedBits&o)){1===u.tag&&((l=so(n,null)).tag=2,uo(u,l)),u.expirationTime<n&&(u.expirationTime=n),null!==(l=u.alternate)&&l.expirationTime<n&&(l.expirationTime=n),to(u.return,n),c.expirationTime<n&&(c.expirationTime=n);break}l=l.next}}else s=10===u.tag&&u.type===t.type?null:u.child;if(null!==s)s.return=u;else for(s=u;null!==s;){if(s===t){s=null;break}if(null!==(u=s.sibling)){u.return=s.return,s=u;break}s=s.return}u=s}Oa(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=(o=t.pendingProps).children,no(t,n),r=r(i=ro(i,o.unstable_observedBits)),t.effectTag|=1,Oa(e,t,r,n),t.child;case 14:return o=Ki(i=t.type,t.pendingProps),ja(e,t,i,o=Ki(i.type,o),r,n);case 15:return Ra(e,t,t.type,t.pendingProps,r,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Ki(r,i),null!==e&&(e.alternate=null,t.alternate=null,t.effectTag|=2),t.tag=1,gi(r)?(e=!0,bi(t)):e=!1,no(t,n),mo(t,r,i),wo(t,r,i,n),Wa(null,t,r,!0,e,n);case 19:return Ja(e,t,n)}throw Error(a(156,t.tag))};var _u=null,ku=null;function xu(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.childExpirationTime=this.expirationTime=0,this.alternate=null}function Su(e,t,n,r){return new xu(e,t,n,r)}function Iu(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Cu(e,t){var n=e.alternate;return null===n?((n=Su(e.tag,t,e.key,e.mode)).elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.effectTag=0,n.nextEffect=null,n.firstEffect=null,n.lastEffect=null),n.childExpirationTime=e.childExpirationTime,n.expirationTime=e.expirationTime,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=null===t?null:{expirationTime:t.expirationTime,firstContext:t.firstContext,responders:t.responders},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function Tu(e,t,n,r,i,o){var s=2;if(r=e,"function"===typeof e)Iu(e)&&(s=1);else if("string"===typeof e)s=5;else e:switch(e){case ne:return Pu(n.children,i,o,t);case se:s=8,i|=7;break;case re:s=8,i|=1;break;case ie:return(e=Su(12,n,t,8|i)).elementType=ie,e.type=ie,e.expirationTime=o,e;case ce:return(e=Su(13,n,t,i)).type=ce,e.elementType=ce,e.expirationTime=o,e;case le:return(e=Su(19,n,t,i)).elementType=le,e.expirationTime=o,e;default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case oe:s=10;break e;case ae:s=9;break e;case ue:s=11;break e;case de:s=14;break e;case fe:s=16,r=null;break e;case pe:s=22;break e}throw Error(a(130,null==e?e:typeof e,""))}return(t=Su(s,n,t,i)).elementType=e,t.type=r,t.expirationTime=o,t}function Pu(e,t,n,r){return(e=Su(7,e,r,t)).expirationTime=n,e}function Au(e,t,n){return(e=Su(6,e,null,t)).expirationTime=n,e}function Eu(e,t,n){return(t=Su(4,null!==e.children?e.children:[],e.key,t)).expirationTime=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function Ou(e,t,n){this.tag=t,this.current=null,this.containerInfo=e,this.pingCache=this.pendingChildren=null,this.finishedExpirationTime=0,this.finishedWork=null,this.timeoutHandle=-1,this.pendingContext=this.context=null,this.hydrate=n,this.callbackNode=null,this.callbackPriority=90,this.lastExpiredTime=this.lastPingedTime=this.nextKnownPendingLevel=this.lastSuspendedTime=this.firstSuspendedTime=this.firstPendingTime=0}function Mu(e,t){var n=e.firstSuspendedTime;return e=e.lastSuspendedTime,0!==n&&n>=t&&e<=t}function ju(e,t){var n=e.firstSuspendedTime,r=e.lastSuspendedTime;n<t&&(e.firstSuspendedTime=t),(r>t||0===n)&&(e.lastSuspendedTime=t),t<=e.lastPingedTime&&(e.lastPingedTime=0),t<=e.lastExpiredTime&&(e.lastExpiredTime=0)}function Ru(e,t){t>e.firstPendingTime&&(e.firstPendingTime=t);var n=e.firstSuspendedTime;0!==n&&(t>=n?e.firstSuspendedTime=e.lastSuspendedTime=e.nextKnownPendingLevel=0:t>=e.lastSuspendedTime&&(e.lastSuspendedTime=t+1),t>e.nextKnownPendingLevel&&(e.nextKnownPendingLevel=t))}function Nu(e,t){var n=e.lastExpiredTime;(0===n||n>t)&&(e.lastExpiredTime=t)}function Lu(e,t,n,r){var i=t.current,o=Gs(),s=po.suspense;o=Js(o,i,s);e:if(n){t:{if(Ze(n=n._reactInternalFiber)!==n||1!==n.tag)throw Error(a(170));var u=n;do{switch(u.tag){case 3:u=u.stateNode.context;break t;case 1:if(gi(u.type)){u=u.stateNode.__reactInternalMemoizedMergedChildContext;break t}}u=u.return}while(null!==u);throw Error(a(171))}if(1===n.tag){var c=n.type;if(gi(c)){n=mi(n,c,u);break e}}n=u}else n=li;return null===t.context?t.context=n:t.pendingContext=n,(t=so(o,s)).payload={element:e},null!==(r=void 0===r?null:r)&&(t.callback=r),uo(i,t),Ks(i,o),o}function Du(e){if(!(e=e.current).child)return null;switch(e.child.tag){case 5:default:return e.child.stateNode}}function Wu(e,t){null!==(e=e.memoizedState)&&null!==e.dehydrated&&e.retryTime<t&&(e.retryTime=t)}function Fu(e,t){Wu(e,t),(e=e.alternate)&&Wu(e,t)}function Uu(e,t,n){var r=new Ou(e,t,n=null!=n&&!0===n.hydrate),i=Su(3,null,null,2===t?7:1===t?3:0);r.current=i,i.stateNode=r,oo(i),e[Cn]=r.current,n&&0!==t&&function(e,t){var n=Xe(t);Ct.forEach((function(e){ht(e,t,n)})),Tt.forEach((function(e){ht(e,t,n)}))}(0,9===e.nodeType?e:e.ownerDocument),this._internalRoot=r}function Bu(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Vu(e,t,n,r,i){var o=n._reactRootContainer;if(o){var a=o._internalRoot;if("function"===typeof i){var s=i;i=function(){var e=Du(a);s.call(e)}}Lu(t,a,e,i)}else{if(o=n._reactRootContainer=function(e,t){if(t||(t=!(!(t=e?9===e.nodeType?e.documentElement:e.firstChild:null)||1!==t.nodeType||!t.hasAttribute("data-reactroot"))),!t)for(var n;n=e.lastChild;)e.removeChild(n);return new Uu(e,0,t?{hydrate:!0}:void 0)}(n,r),a=o._internalRoot,"function"===typeof i){var u=i;i=function(){var e=Du(a);u.call(e)}}tu((function(){Lu(t,a,e,i)}))}return Du(a)}function Hu(e,t,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:te,key:null==r?null:""+r,children:e,containerInfo:t,implementation:n}}function zu(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Bu(t))throw Error(a(200));return Hu(e,t,null,n)}Uu.prototype.render=function(e){Lu(e,this._internalRoot,null,null)},Uu.prototype.unmount=function(){var e=this._internalRoot,t=e.containerInfo;Lu(null,e,null,(function(){t[Cn]=null}))},gt=function(e){if(13===e.tag){var t=Ji(Gs(),150,100);Ks(e,t),Fu(e,t)}},vt=function(e){13===e.tag&&(Ks(e,3),Fu(e,3))},yt=function(e){if(13===e.tag){var t=Gs();Ks(e,t=Js(t,e,null)),Fu(e,t)}},P=function(e,t,n){switch(t){case"input":if(Ie(e,n),t=n.name,"radio"===n.type&&null!=t){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=En(r);if(!i)throw Error(a(90));_e(r),Ie(r,i)}}}break;case"textarea":Me(e,n);break;case"select":null!=(t=n.value)&&Ae(e,!!n.multiple,t,!1)}},R=eu,N=function(e,t,n,r,i){var o=xs;xs|=4;try{return Vi(98,e.bind(null,t,n,r,i))}finally{0===(xs=o)&&qi()}},L=function(){0===(49&xs)&&(function(){if(null!==Vs){var e=Vs;Vs=null,e.forEach((function(e,t){Nu(t,e),Qs(t)})),qi()}}(),gu())},D=function(e,t){var n=xs;xs|=2;try{return e(t)}finally{0===(xs=n)&&qi()}};var qu={Events:[Pn,An,En,C,x,Dn,function(e){it(e,Ln)},M,j,Qt,st,gu,{current:!1}]};!function(e){var t=e.findFiberByHostInstance;(function(e){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var t=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(t.isDisabled||!t.supportsFiber)return!0;try{var n=t.inject(e);_u=function(e){try{t.onCommitFiberRoot(n,e,void 0,64===(64&e.current.effectTag))}catch(r){}},ku=function(e){try{t.onCommitFiberUnmount(n,e)}catch(r){}}}catch(r){}})(i({},e,{overrideHookState:null,overrideProps:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:$.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=nt(e))?null:e.stateNode},findFiberByHostInstance:function(e){return t?t(e):null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null}))}({findFiberByHostInstance:Tn,bundleType:0,version:"16.14.0",rendererPackageName:"react-dom"}),t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=qu,t.createPortal=zu,t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternalFiber;if(void 0===t){if("function"===typeof e.render)throw Error(a(188));throw Error(a(268,Object.keys(e)))}return e=null===(e=nt(t))?null:e.stateNode},t.flushSync=function(e,t){if(0!==(48&xs))throw Error(a(187));var n=xs;xs|=1;try{return Vi(99,e.bind(null,t))}finally{xs=n,qi()}},t.hydrate=function(e,t,n){if(!Bu(t))throw Error(a(200));return Vu(null,e,t,!0,n)},t.render=function(e,t,n){if(!Bu(t))throw Error(a(200));return Vu(null,e,t,!1,n)},t.unmountComponentAtNode=function(e){if(!Bu(e))throw Error(a(40));return!!e._reactRootContainer&&(tu((function(){Vu(null,null,e,!1,(function(){e._reactRootContainer=null,e[Cn]=null}))})),!0)},t.unstable_batchedUpdates=eu,t.unstable_createPortal=function(e,t){return zu(e,t,2<arguments.length&&void 0!==arguments[2]?arguments[2]:null)},t.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Bu(n))throw Error(a(200));if(null==e||void 0===e._reactInternalFiber)throw Error(a(38));return Vu(e,t,n,!1,r)},t.version="16.14.0"},function(e,t,n){"use strict";e.exports=n(29)},function(e,t,n){"use strict";var r,i,o,a,s;if("undefined"===typeof window||"function"!==typeof MessageChannel){var u=null,c=null,l=function e(){if(null!==u)try{var n=t.unstable_now();u(!0,n),u=null}catch(r){throw setTimeout(e,0),r}},d=Date.now();t.unstable_now=function(){return Date.now()-d},r=function(e){null!==u?setTimeout(r,0,e):(u=e,setTimeout(l,0))},i=function(e,t){c=setTimeout(e,t)},o=function(){clearTimeout(c)},a=function(){return!1},s=t.unstable_forceFrameRate=function(){}}else{var f=window.performance,p=window.Date,h=window.setTimeout,g=window.clearTimeout;if("undefined"!==typeof console){var v=window.cancelAnimationFrame;"function"!==typeof window.requestAnimationFrame&&console.error("This browser doesn't support requestAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills"),"function"!==typeof v&&console.error("This browser doesn't support cancelAnimationFrame. Make sure that you load a polyfill in older browsers. https://fb.me/react-polyfills")}if("object"===typeof f&&"function"===typeof f.now)t.unstable_now=function(){return f.now()};else{var y=p.now();t.unstable_now=function(){return p.now()-y}}var m=!1,b=null,w=-1,_=5,k=0;a=function(){return t.unstable_now()>=k},s=function(){},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing framerates higher than 125 fps is not unsupported"):_=0<e?Math.floor(1e3/e):5};var x=new MessageChannel,S=x.port2;x.port1.onmessage=function(){if(null!==b){var e=t.unstable_now();k=e+_;try{b(!0,e)?S.postMessage(null):(m=!1,b=null)}catch(n){throw S.postMessage(null),n}}else m=!1},r=function(e){b=e,m||(m=!0,S.postMessage(null))},i=function(e,n){w=h((function(){e(t.unstable_now())}),n)},o=function(){g(w),w=-1}}function I(e,t){var n=e.length;e.push(t);e:for(;;){var r=n-1>>>1,i=e[r];if(!(void 0!==i&&0<P(i,t)))break e;e[r]=t,e[n]=i,n=r}}function C(e){return void 0===(e=e[0])?null:e}function T(e){var t=e[0];if(void 0!==t){var n=e.pop();if(n!==t){e[0]=n;e:for(var r=0,i=e.length;r<i;){var o=2*(r+1)-1,a=e[o],s=o+1,u=e[s];if(void 0!==a&&0>P(a,n))void 0!==u&&0>P(u,a)?(e[r]=u,e[s]=n,r=s):(e[r]=a,e[o]=n,r=o);else{if(!(void 0!==u&&0>P(u,n)))break e;e[r]=u,e[s]=n,r=s}}}return t}return null}function P(e,t){var n=e.sortIndex-t.sortIndex;return 0!==n?n:e.id-t.id}var A=[],E=[],O=1,M=null,j=3,R=!1,N=!1,L=!1;function D(e){for(var t=C(E);null!==t;){if(null===t.callback)T(E);else{if(!(t.startTime<=e))break;T(E),t.sortIndex=t.expirationTime,I(A,t)}t=C(E)}}function W(e){if(L=!1,D(e),!N)if(null!==C(A))N=!0,r(F);else{var t=C(E);null!==t&&i(W,t.startTime-e)}}function F(e,n){N=!1,L&&(L=!1,o()),R=!0;var r=j;try{for(D(n),M=C(A);null!==M&&(!(M.expirationTime>n)||e&&!a());){var s=M.callback;if(null!==s){M.callback=null,j=M.priorityLevel;var u=s(M.expirationTime<=n);n=t.unstable_now(),"function"===typeof u?M.callback=u:M===C(A)&&T(A),D(n)}else T(A);M=C(A)}if(null!==M)var c=!0;else{var l=C(E);null!==l&&i(W,l.startTime-n),c=!1}return c}finally{M=null,j=r,R=!1}}function U(e){switch(e){case 1:return-1;case 2:return 250;case 5:return 1073741823;case 4:return 1e4;default:return 5e3}}var B=s;t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){N||R||(N=!0,r(F))},t.unstable_getCurrentPriorityLevel=function(){return j},t.unstable_getFirstCallbackNode=function(){return C(A)},t.unstable_next=function(e){switch(j){case 1:case 2:case 3:var t=3;break;default:t=j}var n=j;j=t;try{return e()}finally{j=n}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=B,t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var n=j;j=e;try{return t()}finally{j=n}},t.unstable_scheduleCallback=function(e,n,a){var s=t.unstable_now();if("object"===typeof a&&null!==a){var u=a.delay;u="number"===typeof u&&0<u?s+u:s,a="number"===typeof a.timeout?a.timeout:U(e)}else a=U(e),u=s;return e={id:O++,callback:n,priorityLevel:e,startTime:u,expirationTime:a=u+a,sortIndex:-1},u>s?(e.sortIndex=u,I(E,e),null===C(A)&&e===C(E)&&(L?o():L=!0,i(W,u-s))):(e.sortIndex=a,I(A,e),N||R||(N=!0,r(F))),e},t.unstable_shouldYield=function(){var e=t.unstable_now();D(e);var n=C(A);return n!==M&&null!==M&&null!==n&&null!==n.callback&&n.startTime<=e&&n.expirationTime<M.expirationTime||a()},t.unstable_wrapCallback=function(e){var t=j;return function(){var n=j;j=t;try{return e.apply(this,arguments)}finally{j=n}}}},function(e,t,n){"use strict";t.byteLength=function(e){var t=c(e),n=t[0],r=t[1];return 3*(n+r)/4-r},t.toByteArray=function(e){var t,n,r=c(e),a=r[0],s=r[1],u=new o(function(e,t,n){return 3*(t+n)/4-n}(0,a,s)),l=0,d=s>0?a-4:a;for(n=0;n<d;n+=4)t=i[e.charCodeAt(n)]<<18|i[e.charCodeAt(n+1)]<<12|i[e.charCodeAt(n+2)]<<6|i[e.charCodeAt(n+3)],u[l++]=t>>16&255,u[l++]=t>>8&255,u[l++]=255&t;2===s&&(t=i[e.charCodeAt(n)]<<2|i[e.charCodeAt(n+1)]>>4,u[l++]=255&t);1===s&&(t=i[e.charCodeAt(n)]<<10|i[e.charCodeAt(n+1)]<<4|i[e.charCodeAt(n+2)]>>2,u[l++]=t>>8&255,u[l++]=255&t);return u},t.fromByteArray=function(e){for(var t,n=e.length,i=n%3,o=[],a=0,s=n-i;a<s;a+=16383)o.push(l(e,a,a+16383>s?s:a+16383));1===i?(t=e[n-1],o.push(r[t>>2]+r[t<<4&63]+"==")):2===i&&(t=(e[n-2]<<8)+e[n-1],o.push(r[t>>10]+r[t>>4&63]+r[t<<2&63]+"="));return o.join("")};for(var r=[],i=[],o="undefined"!==typeof Uint8Array?Uint8Array:Array,a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",s=0,u=a.length;s<u;++s)r[s]=a[s],i[a.charCodeAt(s)]=s;function c(e){var t=e.length;if(t%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=e.indexOf("=");return-1===n&&(n=t),[n,n===t?0:4-n%4]}function l(e,t,n){for(var i,o,a=[],s=t;s<n;s+=3)i=(e[s]<<16&16711680)+(e[s+1]<<8&65280)+(255&e[s+2]),a.push(r[(o=i)>>18&63]+r[o>>12&63]+r[o>>6&63]+r[63&o]);return a.join("")}i["-".charCodeAt(0)]=62,i["_".charCodeAt(0)]=63},function(e,t){t.read=function(e,t,n,r,i){var o,a,s=8*i-r-1,u=(1<<s)-1,c=u>>1,l=-7,d=n?i-1:0,f=n?-1:1,p=e[t+d];for(d+=f,o=p&(1<<-l)-1,p>>=-l,l+=s;l>0;o=256*o+e[t+d],d+=f,l-=8);for(a=o&(1<<-l)-1,o>>=-l,l+=r;l>0;a=256*a+e[t+d],d+=f,l-=8);if(0===o)o=1-c;else{if(o===u)return a?NaN:1/0*(p?-1:1);a+=Math.pow(2,r),o-=c}return(p?-1:1)*a*Math.pow(2,o-r)},t.write=function(e,t,n,r,i,o){var a,s,u,c=8*o-i-1,l=(1<<c)-1,d=l>>1,f=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,p=r?0:o-1,h=r?1:-1,g=t<0||0===t&&1/t<0?1:0;for(t=Math.abs(t),isNaN(t)||t===1/0?(s=isNaN(t)?1:0,a=l):(a=Math.floor(Math.log(t)/Math.LN2),t*(u=Math.pow(2,-a))<1&&(a--,u*=2),(t+=a+d>=1?f/u:f*Math.pow(2,1-d))*u>=2&&(a++,u/=2),a+d>=l?(s=0,a=l):a+d>=1?(s=(t*u-1)*Math.pow(2,i),a+=d):(s=t*Math.pow(2,d-1)*Math.pow(2,i),a=0));i>=8;e[n+p]=255&s,p+=h,s/=256,i-=8);for(a=a<<i|s,c+=i;c>0;e[n+p]=255&a,p+=h,a/=256,c-=8);e[n+p-h]|=128*g}},function(e,t){var n={}.toString;e.exports=Array.isArray||function(e){return"[object Array]"==n.call(e)}},function(e,t,n){var r=function(e){"use strict";var t=Object.prototype,n=t.hasOwnProperty,r="function"===typeof Symbol?Symbol:{},i=r.iterator||"@@iterator",o=r.asyncIterator||"@@asyncIterator",a=r.toStringTag||"@@toStringTag";function s(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{s({},"")}catch(C){s=function(e,t,n){return e[t]=n}}function u(e,t,n,r){var i=t&&t.prototype instanceof d?t:d,o=Object.create(i.prototype),a=new x(r||[]);return o._invoke=function(e,t,n){var r="suspendedStart";return function(i,o){if("executing"===r)throw new Error("Generator is already running");if("completed"===r){if("throw"===i)throw o;return I()}for(n.method=i,n.arg=o;;){var a=n.delegate;if(a){var s=w(a,n);if(s){if(s===l)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if("suspendedStart"===r)throw r="completed",n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);r="executing";var u=c(e,t,n);if("normal"===u.type){if(r=n.done?"completed":"suspendedYield",u.arg===l)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(r="completed",n.method="throw",n.arg=u.arg)}}}(e,n,a),o}function c(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(C){return{type:"throw",arg:C}}}e.wrap=u;var l={};function d(){}function f(){}function p(){}var h={};h[i]=function(){return this};var g=Object.getPrototypeOf,v=g&&g(g(S([])));v&&v!==t&&n.call(v,i)&&(h=v);var y=p.prototype=d.prototype=Object.create(h);function m(e){["next","throw","return"].forEach((function(t){s(e,t,(function(e){return this._invoke(t,e)}))}))}function b(e,t){var r;this._invoke=function(i,o){function a(){return new t((function(r,a){!function r(i,o,a,s){var u=c(e[i],e,o);if("throw"!==u.type){var l=u.arg,d=l.value;return d&&"object"===typeof d&&n.call(d,"__await")?t.resolve(d.__await).then((function(e){r("next",e,a,s)}),(function(e){r("throw",e,a,s)})):t.resolve(d).then((function(e){l.value=e,a(l)}),(function(e){return r("throw",e,a,s)}))}s(u.arg)}(i,o,r,a)}))}return r=r?r.then(a,a):a()}}function w(e,t){var n=e.iterator[t.method];if(void 0===n){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,w(e,t),"throw"===t.method))return l;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return l}var r=c(n,e.iterator,t.arg);if("throw"===r.type)return t.method="throw",t.arg=r.arg,t.delegate=null,l;var i=r.arg;return i?i.done?(t[e.resultName]=i.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,l):i:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,l)}function _(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function k(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function x(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(_,this),this.reset(!0)}function S(e){if(e){var t=e[i];if(t)return t.call(e);if("function"===typeof e.next)return e;if(!isNaN(e.length)){var r=-1,o=function t(){for(;++r<e.length;)if(n.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t};return o.next=o}}return{next:I}}function I(){return{value:void 0,done:!0}}return f.prototype=y.constructor=p,p.constructor=f,f.displayName=s(p,a,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"===typeof e&&e.constructor;return!!t&&(t===f||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,s(e,a,"GeneratorFunction")),e.prototype=Object.create(y),e},e.awrap=function(e){return{__await:e}},m(b.prototype),b.prototype[o]=function(){return this},e.AsyncIterator=b,e.async=function(t,n,r,i,o){void 0===o&&(o=Promise);var a=new b(u(t,n,r,i),o);return e.isGeneratorFunction(n)?a:a.next().then((function(e){return e.done?e.value:a.next()}))},m(y),s(y,a,"Generator"),y[i]=function(){return this},y.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function n(){for(;t.length;){var r=t.pop();if(r in e)return n.value=r,n.done=!1,n}return n.done=!0,n}},e.values=S,x.prototype={constructor:x,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(k),!e)for(var t in this)"t"===t.charAt(0)&&n.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function r(n,r){return a.type="throw",a.arg=e,t.next=n,r&&(t.method="next",t.arg=void 0),!!r}for(var i=this.tryEntries.length-1;i>=0;--i){var o=this.tryEntries[i],a=o.completion;if("root"===o.tryLoc)return r("end");if(o.tryLoc<=this.prev){var s=n.call(o,"catchLoc"),u=n.call(o,"finallyLoc");if(s&&u){if(this.prev<o.catchLoc)return r(o.catchLoc,!0);if(this.prev<o.finallyLoc)return r(o.finallyLoc)}else if(s){if(this.prev<o.catchLoc)return r(o.catchLoc,!0)}else{if(!u)throw new Error("try statement without catch or finally");if(this.prev<o.finallyLoc)return r(o.finallyLoc)}}}},abrupt:function(e,t){for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r];if(i.tryLoc<=this.prev&&n.call(i,"finallyLoc")&&this.prev<i.finallyLoc){var o=i;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var a=o?o.completion:{};return a.type=e,a.arg=t,o?(this.method="next",this.next=o.finallyLoc,l):this.complete(a)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),l},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),k(n),l}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var i=r.arg;k(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,n){return this.delegate={iterator:S(e),resultName:t,nextLoc:n},"next"===this.method&&(this.arg=void 0),l}},e}(e.exports);try{regeneratorRuntime=r}catch(i){Function("r","regeneratorRuntime = r")(r)}},function(e,t,n){"use strict";e.exports=function(){throw new Error("ws does not work in the browser. Browser clients must use the native WebSocket object")}},function(e,t,n){},,function(e,t,n){var r=n(38);e.exports=function(e,t){if(null==e)return{};var n,i,o=r(e,t);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);for(i=0;i<a.length;i++)n=a[i],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(o[n]=e[n])}return o}},function(e,t){e.exports=function(e,t){if(null==e)return{};var n,r,i={},o=Object.keys(e);for(r=0;r<o.length;r++)n=o[r],t.indexOf(n)>=0||(i[n]=e[n]);return i}},function(e,t){function n(){return e.exports=n=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var n=arguments[t];for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e},n.apply(this,arguments)}e.exports=n},function(e,t,n){var r=n(41),i=n(42),o=n(20),a=n(43);e.exports=function(e,t){return r(e)||i(e,t)||o(e,t)||a()}},function(e,t){e.exports=function(e){if(Array.isArray(e))return e}},function(e,t){e.exports=function(e,t){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e)){var n=[],r=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(r=(a=s.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(u){i=!0,o=u}finally{try{r||null==s.return||s.return()}finally{if(i)throw o}}return n}}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t,n){var r=n(45),i=n(46),o=n(20),a=n(47);e.exports=function(e){return r(e)||i(e)||o(e)||a()}},function(e,t,n){var r=n(21);e.exports=function(e){if(Array.isArray(e))return r(e)}},function(e,t){e.exports=function(e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(e))return Array.from(e)}},function(e,t){e.exports=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}},function(e,t){e.exports=function(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t){e.exports=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}},function(e,t){e.exports=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t}},function(e,t){function n(t){return"function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?e.exports=n=function(e){return typeof e}:e.exports=n=function(e){return e&&"function"===typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},n(t)}e.exports=n},function(e,t){e.exports=function(e,t){return t||(t=e.slice(0)),Object.freeze(Object.defineProperties(e,{raw:{value:Object.freeze(t)}}))}},function(e,t,n){"use strict";var r=n(54);function i(){}function o(){}o.resetWarningCache=i,e.exports=function(){function e(e,t,n,i,o,a){if(a!==r){var s=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw s.name="Invariant Violation",s}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:o,resetWarningCache:i};return n.PropTypes=n,n}},function(e,t,n){"use strict";e.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"}]]);
//# sourceMappingURL=2.d4aa7607.chunk.js.map